<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="NoughtQçš„ç¬”è®°æœ¬ï¼Œä¸»è¦è®°å½•ä¸€äº› CS ç›¸å…³çš„ç¬”è®°" name="description"/>
<meta content="NoughtQ" name="author"/>
<link href="https://notebook.noughtq.top/system/ca/5.html" rel="canonical"/>
<link href="4.html" rel="prev"/>
<link href="../db/index.html" rel="next"/>
<link href="../../feed_rss_created.xml" rel="alternate" title="RSS è®¢é˜…" type="application/rss+xml"/>
<link href="../../feed_rss_updated.xml" rel="alternate" title="å·²æ›´æ–°å†…å®¹çš„ RSS è®¢é˜…" type="application/rss+xml"/>
<link href="../../assets/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.14" name="generator"/>
<title>Chap 5: Thread-Level Parallelism - NoughtQçš„ç¬”è®°æœ¬</title>
<link href="../../assets/stylesheets/main.342714a4.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=JetBrains+Mono,+LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono,+Consolas:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"JetBrains Mono, LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono, Consolas"}</style>
<link href="../../css/heti.css" rel="stylesheet"/>
<link href="../../css/toc_extra.css" rel="stylesheet"/>
<link href="../../css/timeline.css" rel="stylesheet"/>
<link href="../../css/card.css" rel="stylesheet"/>
<link href="../../css/custom.css" rel="stylesheet"/>
<link href="../../css/extra_changelog.css" rel="stylesheet"/>
<link href="https://unpkg.com/katex@0/dist/katex.min.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&amp;display=swap" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-43NH8CVRCJ"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-43NH8CVRCJ",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-43NH8CVRCJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#chap-5-thread-level-parallelism">
          è·³è½¬è‡³
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="é¡µçœ‰" class="md-header__inner md-grid">
<a aria-label="NoughtQçš„ç¬”è®°æœ¬" class="md-header__button md-logo" data-md-component="logo" href="../.." title="NoughtQçš„ç¬”è®°æœ¬">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.05 9H7.06V6h1.99V4.03H7.06v-1c0-1.11.89-1.99 1.99-1.99h5.98V8l2.47-1.5L20 8V1.04h1c1.05 0 2 .96 2 1.99V17c0 1.03-.95 2-2 2H9.05c-1.05 0-1.99-.95-1.99-2v-1h1.99v-2H7.06v-3h1.99zM1 18h2v-3H1v-2h2v-3H1V8h2V5h2v3H3v2h2v3H3v2h2v3H3v2h2v1h16v2H5a2 2 0 0 1-2-2v-1H1z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            NoughtQçš„ç¬”è®°æœ¬
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Chap 5: Thread-Level Parallelism
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Dark Mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefer-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Dark Mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
<input aria-label="Light Mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefer-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Light Mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="æœç´¢" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="æœç´¢" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path></svg>
</label>
<nav aria-label="æŸ¥æ‰¾" class="md-search__options">
<a aria-label="åˆ†äº«" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="åˆ†äº«">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="æ¸…ç©ºå½“å‰å†…å®¹" class="md-search__icon md-icon" tabindex="-1" title="æ¸…ç©ºå½“å‰å†…å®¹" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/noughtq/notebook" title="å‰å¾€ä»“åº“">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    NoughtQ/Notebook
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="æ ‡ç­¾" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../index.html">
          
  
  
    
  
  ğŸ«ä¸»é¡µ

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../lang/index.html">
          
  
  
    
  
  ğŸ”¡è¯­è¨€

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../math/index.html">
          
  
  
    
  
  ğŸ“Šæ•°å­¦ç›¸å…³

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../algorithms/index.html">
          
  
  
    
  
  ğŸ§®ç®—æ³•ç›¸å…³

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../software/index.html">
          
  
  
    
  
  ğŸ’¾è½¯ä»¶ç›¸å…³

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../index.html">
          
  
  
    
  
  ğŸ’»ç³»ç»Ÿç›¸å…³

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../web/index.html">
          
  
  
    
  
  ğŸŒWebç›¸å…³

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../sec/ctf-101/index.html">
          
  
  
    
  
  ğŸ›¡ï¸ä¿¡æ¯å®‰å…¨

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../ai/index.html">
          
  
  
    
  
  ğŸ¤–äººå·¥æ™ºèƒ½

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../misc/index.html">
          
  
  
    
  
  ğŸ—ƒï¸æ‚é¡¹

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../tools/index.html">
          
  
  
    
  
  ğŸ› ï¸å·¥å…·

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../papers/index.html">
          
  
  
    
  
  ğŸ“‘è®ºæ–‡é˜…è¯»

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="å¯¼èˆªæ " class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="NoughtQçš„ç¬”è®°æœ¬" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="NoughtQçš„ç¬”è®°æœ¬">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.05 9H7.06V6h1.99V4.03H7.06v-1c0-1.11.89-1.99 1.99-1.99h5.98V8l2.47-1.5L20 8V1.04h1c1.05 0 2 .96 2 1.99V17c0 1.03-.95 2-2 2H9.05c-1.05 0-1.99-.95-1.99-2v-1h1.99v-2H7.06v-3h1.99zM1 18h2v-3H1v-2h2v-3H1V8h2V5h2v3H3v2h2v3H3v2h2v3H3v2h2v1h16v2H5a2 2 0 0 1-2-2v-1H1z"></path></svg>
</a>
    NoughtQçš„ç¬”è®°æœ¬
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/noughtq/notebook" title="å‰å¾€ä»“åº“">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"></path></svg>
</div>
<div class="md-source__repository">
    NoughtQ/Notebook
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../index.html">
<span class="md-ellipsis">
    ğŸ«ä¸»é¡µ
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../lang/index.html">
<span class="md-ellipsis">
    ğŸ”¡è¯­è¨€
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../math/index.html">
<span class="md-ellipsis">
    ğŸ“Šæ•°å­¦ç›¸å…³
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../algorithms/index.html">
<span class="md-ellipsis">
    ğŸ§®ç®—æ³•ç›¸å…³
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../software/index.html">
<span class="md-ellipsis">
    ğŸ’¾è½¯ä»¶ç›¸å…³
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../index.html">
<span class="md-ellipsis">
    ğŸ’»ç³»ç»Ÿç›¸å…³
    
  </span>
</a>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            ğŸ’»ç³»ç»Ÿç›¸å…³
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../csapp/index.html">
<span class="md-ellipsis">
    CSAPP
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../dld/index.html">
<span class="md-ellipsis">
    æ•°å­—é€»è¾‘è®¾è®¡
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../co/index.html">
<span class="md-ellipsis">
    è®¡ç®—æœºç»„æˆ
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6_5" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="index.html">
<span class="md-ellipsis">
    è®¡ç®—æœºä½“ç³»ç»“æ„
    
  </span>
</a>
<label class="md-nav__link" for="__nav_6_5" id="__nav_6_5_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_6_5_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_5">
<span class="md-nav__icon md-icon"></span>
            è®¡ç®—æœºä½“ç³»ç»“æ„
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="1.html">
<span class="md-ellipsis">
    Chap 1: Fundamentals of Quantitative Design and Analysis
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="2.html">
<span class="md-ellipsis">
    Chap 2: Memory Hierarchy Design
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="3.html">
<span class="md-ellipsis">
    Chap 3: Instruction-Level Parallelism
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="4.html">
<span class="md-ellipsis">
    Chap 4: Data-Level Parallelism
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Chap 5: Thread-Level Parallelism
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="5.html">
<span class="md-ellipsis">
    Chap 5: Thread-Level Parallelism
    
  </span>
</a>
<nav aria-label="ç›®å½•" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
        ç›®å½•
      </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
<nav aria-label="Introduction" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#multiprocessor-architecture">
<span class="md-ellipsis">
      Multiprocessor Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenges-of-parallel-processing">
<span class="md-ellipsis">
      Challenges of Parallel Processing
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#centralized-shared-memory-architectures">
<span class="md-ellipsis">
      Centralized Shared-Memory Architectures
    </span>
</a>
<nav aria-label="Centralized Shared-Memory Architectures" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#multiprocessor-cache-coherence">
<span class="md-ellipsis">
      Multiprocessor Cache Coherence
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-schemes-for-enforcing-coherence">
<span class="md-ellipsis">
      Basic Schemes for Enforcing Coherence
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#snooping-coherence-protocols">
<span class="md-ellipsis">
      Snooping Coherence Protocols
    </span>
</a>
<nav aria-label="Snooping Coherence Protocols" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-implementation-techniques">
<span class="md-ellipsis">
      Basic Implementation Techniques
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#a-simple-protocol">
<span class="md-ellipsis">
      A Simple Protocol
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#extensions-to-the-basic-coherence-protols">
<span class="md-ellipsis">
      Extensions to the Basic Coherence Protols
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#limitations-in-smps-and-snooping-protocols">
<span class="md-ellipsis">
      Limitations in SMPs and Snooping Protocols
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementing-snooping-cache-coherence">
<span class="md-ellipsis">
      Implementing Snooping Cache Coherence
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-of-symmetric-shared-memory-multiprocessors">
<span class="md-ellipsis">
      Performance of Symmetric Shared-Memory Multiprocessors
    </span>
</a>
<nav aria-label="Performance of Symmetric Shared-Memory Multiprocessors" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#commercial-workload">
<span class="md-ellipsis">
      Commercial Workload
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiprogramming-and-os-workload">
<span class="md-ellipsis">
      Multiprogramming and OS Workload
    </span>
</a>
<nav aria-label="Multiprogramming and OS Workload" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#performance">
<span class="md-ellipsis">
      Performance
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#distributed-shared-memory-and-directory-based-coherence">
<span class="md-ellipsis">
      Distributed Shared-Memory and Directory-Based Coherence
    </span>
</a>
<nav aria-label="Distributed Shared-Memory and Directory-Based Coherence" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#directory-based-cache-coherence-protocols">
<span class="md-ellipsis">
      Directory-Based Cache Coherence Protocols
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#an-example-directory-protocol">
<span class="md-ellipsis">
      An Example Directory Protocol
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#synchronization">
<span class="md-ellipsis">
      Synchronization
    </span>
</a>
<nav aria-label="Synchronization" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-hardware-primitives">
<span class="md-ellipsis">
      Basic Hardware Primitives
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementing-locks-using-coherence">
<span class="md-ellipsis">
      Implementing Locks Using Coherence
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#barrier-synchronization">
<span class="md-ellipsis">
      Barrier Synchronization
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#models-of-memory-consistency">
<span class="md-ellipsis">
      Models of Memory Consistency
    </span>
</a>
<nav aria-label="Models of Memory Consistency" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-programmers-view">
<span class="md-ellipsis">
      The Programmer's View
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#relaxed-consistency-models">
<span class="md-ellipsis">
      Relaxed Consistency Models
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cross-cutting-issues">
<span class="md-ellipsis">
      Cross-Cutting Issues
    </span>
</a>
<nav aria-label="Cross-Cutting Issues" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#compiler-optimization-and-the-consistency-model">
<span class="md-ellipsis">
      Compiler Optimization and the Consistency Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-speculation-to-hide-latency-in-strict-consistency-model">
<span class="md-ellipsis">
      Using Speculation to Hide Latency in Strict Consistency Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inclusion-and-its-implementation">
<span class="md-ellipsis">
      Inclusion and Its Implementation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fallacies-and-pitfalls">
<span class="md-ellipsis">
      Fallacies and Pitfalls
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../db/index.html">
<span class="md-ellipsis">
    æ•°æ®åº“ç³»ç»Ÿ
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../web/index.html">
<span class="md-ellipsis">
    ğŸŒWebç›¸å…³
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../sec/ctf-101/index.html">
<span class="md-ellipsis">
    ğŸ›¡ï¸ä¿¡æ¯å®‰å…¨
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../ai/index.html">
<span class="md-ellipsis">
    ğŸ¤–äººå·¥æ™ºèƒ½
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../misc/index.html">
<span class="md-ellipsis">
    ğŸ—ƒï¸æ‚é¡¹
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../tools/index.html">
<span class="md-ellipsis">
    ğŸ› ï¸å·¥å…·
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../papers/index.html">
<span class="md-ellipsis">
    ğŸ“‘è®ºæ–‡é˜…è¯»
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="ç›®å½•" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
        ç›®å½•
      </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#introduction">
<span class="md-ellipsis">
      Introduction
    </span>
</a>
<nav aria-label="Introduction" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#multiprocessor-architecture">
<span class="md-ellipsis">
      Multiprocessor Architecture
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#challenges-of-parallel-processing">
<span class="md-ellipsis">
      Challenges of Parallel Processing
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#centralized-shared-memory-architectures">
<span class="md-ellipsis">
      Centralized Shared-Memory Architectures
    </span>
</a>
<nav aria-label="Centralized Shared-Memory Architectures" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#multiprocessor-cache-coherence">
<span class="md-ellipsis">
      Multiprocessor Cache Coherence
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-schemes-for-enforcing-coherence">
<span class="md-ellipsis">
      Basic Schemes for Enforcing Coherence
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#snooping-coherence-protocols">
<span class="md-ellipsis">
      Snooping Coherence Protocols
    </span>
</a>
<nav aria-label="Snooping Coherence Protocols" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-implementation-techniques">
<span class="md-ellipsis">
      Basic Implementation Techniques
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#a-simple-protocol">
<span class="md-ellipsis">
      A Simple Protocol
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#extensions-to-the-basic-coherence-protols">
<span class="md-ellipsis">
      Extensions to the Basic Coherence Protols
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#limitations-in-smps-and-snooping-protocols">
<span class="md-ellipsis">
      Limitations in SMPs and Snooping Protocols
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementing-snooping-cache-coherence">
<span class="md-ellipsis">
      Implementing Snooping Cache Coherence
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#performance-of-symmetric-shared-memory-multiprocessors">
<span class="md-ellipsis">
      Performance of Symmetric Shared-Memory Multiprocessors
    </span>
</a>
<nav aria-label="Performance of Symmetric Shared-Memory Multiprocessors" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#commercial-workload">
<span class="md-ellipsis">
      Commercial Workload
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#multiprogramming-and-os-workload">
<span class="md-ellipsis">
      Multiprogramming and OS Workload
    </span>
</a>
<nav aria-label="Multiprogramming and OS Workload" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#performance">
<span class="md-ellipsis">
      Performance
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#distributed-shared-memory-and-directory-based-coherence">
<span class="md-ellipsis">
      Distributed Shared-Memory and Directory-Based Coherence
    </span>
</a>
<nav aria-label="Distributed Shared-Memory and Directory-Based Coherence" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#directory-based-cache-coherence-protocols">
<span class="md-ellipsis">
      Directory-Based Cache Coherence Protocols
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#an-example-directory-protocol">
<span class="md-ellipsis">
      An Example Directory Protocol
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#synchronization">
<span class="md-ellipsis">
      Synchronization
    </span>
</a>
<nav aria-label="Synchronization" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#basic-hardware-primitives">
<span class="md-ellipsis">
      Basic Hardware Primitives
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#implementing-locks-using-coherence">
<span class="md-ellipsis">
      Implementing Locks Using Coherence
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#barrier-synchronization">
<span class="md-ellipsis">
      Barrier Synchronization
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#models-of-memory-consistency">
<span class="md-ellipsis">
      Models of Memory Consistency
    </span>
</a>
<nav aria-label="Models of Memory Consistency" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#the-programmers-view">
<span class="md-ellipsis">
      The Programmer's View
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#relaxed-consistency-models">
<span class="md-ellipsis">
      Relaxed Consistency Models
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#cross-cutting-issues">
<span class="md-ellipsis">
      Cross-Cutting Issues
    </span>
</a>
<nav aria-label="Cross-Cutting Issues" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#compiler-optimization-and-the-consistency-model">
<span class="md-ellipsis">
      Compiler Optimization and the Consistency Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-speculation-to-hide-latency-in-strict-consistency-model">
<span class="md-ellipsis">
      Using Speculation to Hide Latency in Strict Consistency Model
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#inclusion-and-its-implementation">
<span class="md-ellipsis">
      Inclusion and Its Implementation
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#fallacies-and-pitfalls">
<span class="md-ellipsis">
      Fallacies and Pitfalls
    </span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/noughtq/notebook/edit/master/docs/system/ca/5.md" title="ç¼–è¾‘æ­¤é¡µ">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/noughtq/notebook/raw/master/docs/system/ca/5.md" title="æŸ¥çœ‹æœ¬é¡µçš„æºä»£ç ">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg>
</a>
<h1 id="chap-5-thread-level-parallelism">Chap 5: Thread-Level Parallelism<a class="headerlink" href="#chap-5-thread-level-parallelism" title="Permanent link">âš“ï¸</a></h1>
<div style="margin-top: -30px; font-size: 0.9em; opacity: 0.7;">
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"></path></svg></span> çº¦<span class="heti-skip"><span class="heti-spacing"> </span>20827<span class="heti-spacing"> </span></span>ä¸ªå­— <span class="twemoji"><svg viewbox="0 0 640 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M392.8 1.2c-17-4.9-34.7 5-39.6 22l-128 448c-4.9 17 5 34.7 22 39.6s34.7-5 39.6-22l128-448c4.9-17-5-34.7-22-39.6m80.6 120.1c-12.5 12.5-12.5 32.8 0 45.3l89.3 89.4-89.4 89.4c-12.5 12.5-12.5 32.8 0 45.3s32.8 12.5 45.3 0l112-112c12.5-12.5 12.5-32.8 0-45.3l-112-112c-12.5-12.5-32.8-12.5-45.3 0zm-306.7 0c-12.5-12.5-32.8-12.5-45.3 0l-112 112c-12.5 12.5-12.5 32.8 0 45.3l112 112c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l89.4-89.4c12.5-12.5 12.5-32.8 0-45.3"></path></svg></span> <span>50<span class="heti-spacing"> </span></span>è¡Œä»£ç  <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"></path></svg></span> é¢„è®¡é˜…è¯»æ—¶é—´<span class="heti-skip"><span class="heti-spacing"> </span>105<span class="heti-spacing"> </span></span>åˆ†é’Ÿ</p>
</div>
<details class="abstract">
<summary>æ ¸å¿ƒçŸ¥è¯†</summary>
<ul>
<li>å¤šå¤„ç†å™¨æ¶æ„<ul>
<li>SMP</li>
<li>DSM</li>
</ul>
</li>
<li>é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§<ul>
<li>ç›‘å¬æœºåˆ¶</li>
<li>åŸºäºç›®å½•çš„æœºåˆ¶</li>
<li>çŠ¶æ€ï¼šä¿®æ”¹<span><span class="heti-spacing"> </span>M</span>ã€å…±äº«<span><span class="heti-spacing"> </span>S</span>ã€æ— æ•ˆ<span><span class="heti-spacing"> </span>I</span></li>
<li>æ‰©å±•ï¼šMESIã€MOESI</li>
</ul>
</li>
<li>åŒæ­¥æœºåˆ¶<ul>
<li>ç¡¬ä»¶åŸè¯­</li>
<li>è‡ªæ—‹é”</li>
</ul>
</li>
<li>å†…å­˜è¿è´¯æ€§æ¨¡å‹<ul>
<li>é¡ºåºè¿è´¯æ€§</li>
<li>æ¾å¼›è¿è´¯æ€§æ¨¡å‹</li>
</ul>
</li>
</ul>
</details>
<details class="info">
<summary>è¿›ç¨‹<span class="heti-skip"><span class="heti-spacing"> </span>vs.<span class="heti-spacing"> </span></span>çº¿ç¨‹</summary>
<blockquote>
<p>æ¥è‡ª<span class="heti-skip"><span class="heti-spacing"> </span>Gemini 2.5 Flash<span class="heti-spacing"> </span></span>çš„å›ç­”ã€‚</p>
</blockquote>
<p>ç®€å•æ¥è¯´ï¼Œçº¿ç¨‹å’Œè¿›ç¨‹çš„ä¸»è¦åŒºåˆ«åœ¨äºï¼š</p>
<ul>
<li><strong>è¿›ç¨‹æ˜¯ç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒï¼Œæ‹¥æœ‰è‡ªå·±çš„èµ„æºï¼ˆå†…å­˜ã€æ–‡ä»¶å¥æŸ„ç­‰<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</strong> å°±åƒä¸€ä¸ªç‹¬ç«‹çš„åº”ç”¨ç¨‹åºã€‚</li>
<li><strong>çº¿ç¨‹æ˜¯è¿›ç¨‹å†…éƒ¨çš„æ‰§è¡Œå•å…ƒï¼Œå…±äº«è¿›ç¨‹çš„èµ„æºã€‚</strong> å°±åƒä¸€ä¸ªåº”ç”¨ç¨‹åºå†…éƒ¨çš„ä¸åŒåŠŸèƒ½æ¨¡å—ã€‚</li>
</ul>
<p><strong>æ›´å½¢è±¡çš„æ¯”å–»ï¼š</strong></p>
<ul>
<li><strong>è¿›ç¨‹ï¼š</strong> ä¸€å®¶å·¥å‚ã€‚å®ƒæœ‰è‡ªå·±çš„å‚æˆ¿ã€è®¾å¤‡ã€åŸææ–™ä»“åº“ç­‰ã€‚</li>
<li><strong>çº¿ç¨‹ï¼š</strong> å·¥å‚é‡Œçš„å·¥äººã€‚ä»–ä»¬éƒ½åœ¨åŒä¸€ä¸ªå‚æˆ¿é‡Œå·¥ä½œï¼Œå…±äº«å·¥å‚çš„è®¾å¤‡å’ŒåŸææ–™ï¼Œä½†æ¯ä¸ªå·¥äººè´Ÿè´£ä¸åŒçš„ç”Ÿäº§çº¿æˆ–ä»»åŠ¡ã€‚</li>
</ul>
<p><strong>æ ¸å¿ƒåŒºåˆ«æ€»ç»“ï¼š</strong></p>
<table>
<thead>
<tr>
<th>ç‰¹æ€§</th>
<th>è¿›ç¨‹</th>
<th>çº¿ç¨‹</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>èµ„æº</strong></td>
<td>ç‹¬ç«‹æ‹¥æœ‰ï¼Œä¸å…±äº«</td>
<td>å…±äº«è¿›ç¨‹çš„èµ„æº</td>
</tr>
<tr>
<td><strong>å¼€é”€</strong></td>
<td>åˆ›å»ºã€é”€æ¯ã€åˆ‡æ¢å¼€é”€å¤§</td>
<td>åˆ›å»ºã€é”€æ¯ã€åˆ‡æ¢å¼€é”€å°</td>
</tr>
<tr>
<td><strong>é€šä¿¡</strong></td>
<td>éœ€è¦<span><span class="heti-spacing"> </span>IPC</span>ï¼ˆè¿›ç¨‹é—´é€šä¿¡ï¼‰æœºåˆ¶</td>
<td>ç›´æ¥å…±äº«å†…å­˜ï¼Œé€šä¿¡æ›´æ–¹ä¾¿å¿«æ·</td>
</tr>
<tr>
<td><strong>ç‹¬ç«‹æ€§</strong></td>
<td>ç‹¬ç«‹æ€§å¼ºï¼Œä¸€ä¸ªè¿›ç¨‹å´©æºƒä¸å½±å“å…¶ä»–è¿›ç¨‹</td>
<td>ç‹¬ç«‹æ€§å¼±ï¼Œä¸€ä¸ªçº¿ç¨‹å´©æºƒå¯èƒ½å½±å“æ•´ä¸ªè¿›ç¨‹</td>
</tr>
<tr>
<td><strong>å¹¶å‘</strong></td>
<td>è¿›ç¨‹é—´å¹¶å‘ï¼ˆå¤šä»»åŠ¡ï¼‰</td>
<td>çº¿ç¨‹å†…å¹¶å‘ï¼ˆåŒä¸€ä»»åŠ¡çš„ä¸åŒéƒ¨åˆ†ï¼‰</td>
</tr>
</tbody>
</table>
</details>
<h2 id="introduction">Introduction<a class="headerlink" href="#introduction" title="Permanent link">âš“ï¸</a></h2>
<p>æœ¬ç« ä¸»è¦æ¢ç´¢çš„æ˜¯<strong>çº¿ç¨‹çº§å¹¶è¡Œ</strong>(thread-level parallelism, <strong>TLP</strong>)ã€‚è€Œ<span class="heti-skip"><span class="heti-spacing"> </span>TLP<span class="heti-spacing"> </span></span>åˆ©ç”¨åˆ°äº† <strong>MIMD</strong>(multiple instructions, multiple data)ã€‚</p>
<p>å‰é¢æåˆ°è¿‡ï¼Œç”±äº<span class="heti-skip"><span class="heti-spacing"> </span>ILP<span class="heti-spacing"> </span></span>å·¥è‰ºè¿›æ­¥çš„æ”¾ç¼“ï¼Œå•å¤„ç†å™¨<span class="heti-skip"><span class="heti-spacing"> </span>(uniprocessor)<span class="heti-spacing"> </span></span>çš„å‘å±•é€æ¸èµ°å‘å°¾å£°ï¼Œå› è€Œ<strong>å¤šå¤„ç†å™¨</strong><span>(multiprocessor)<span class="heti-spacing"> </span></span>çš„é‡è¦æ€§æ—¥æ¸æå‡â€”â€”å®ƒç”±ä¸€ç»„ç´§å¯†è€¦åˆçš„å¤„ç†å™¨æ„æˆï¼Œè¿™äº›å¤„ç†å™¨å—æ“ä½œç³»ç»Ÿæ§åˆ¶ï¼Œå¹¶é€šè¿‡ä¸€ä¸ªå…±äº«çš„åœ°å€ç©ºé—´æ¥å…±äº«å†…å­˜ï¼ˆä¸ä¸€å®šåªæœ‰ä¸€å—ç‰©ç†å†…å­˜<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚å¤šå¤„ç†å™¨é€šè¿‡ä»¥ä¸‹ä¸¤ç±»ä¸åŒçš„è½¯ä»¶æ¨¡å‹æ¥å®ç°<span><span class="heti-spacing"> </span>TLP</span>ï¼š</p>
<ul>
<li><strong>å¹¶è¡Œå¤„ç†</strong>(parallel processing)ï¼šä¸€ç»„åœ¨å•ä»»åŠ¡ä¸Šåä½œçš„ç´§å¯†è€¦åˆçš„çº¿ç¨‹æ‰§è¡Œ</li>
<li><strong>è¯·æ±‚çº§å¹¶è¡Œ</strong>(request-level parallelism)ï¼šæ¥è‡ªä¸€åæˆ–å¤šåç”¨æˆ·çš„å¤šä¸ªç›¸å¯¹ç‹¬ç«‹çš„è¿›ç¨‹æ‰§è¡Œ<ul>
<li>è¿è¡Œåœ¨å¤šä¸ªå¤„ç†å™¨ä¸Šçš„å•ä¸€åº”ç”¨ç¨‹åºä¼šåˆ©ç”¨è¯·æ±‚çº§å¹¶è¡Œï¼Œä¾‹å¦‚æ•°æ®åº“å“åº”æŸ¥è¯¢ï¼Œæˆ–è€…é€šè¿‡å¤šä¸ªç‹¬ç«‹è¿è¡Œçš„åº”ç”¨ç¨‹åºï¼ˆåè€…é€šå¸¸è¢«ç§°ä¸º<strong>å¤šé“ç¨‹åºè®¾è®¡</strong>(multiprogramming)ï¼‰</li>
</ul>
</li>
</ul>
<p>å¤šå¤„ç†å™¨æ—¢åŒ…å«å…·æœ‰å¤šä¸ªæ ¸å¿ƒçš„å•èŠ¯ç‰‡ç³»ç»Ÿï¼Œå³æ‰€è°“çš„<strong>å¤šæ ¸</strong>(multicore)ï¼Œä¹Ÿæ¶µç›–ç”±å¤šä¸ªèŠ¯ç‰‡ç»„æˆçš„è®¡ç®—æœºï¼Œå…¶ä¸­æ¯ä¸ªèŠ¯ç‰‡é€šå¸¸ä¹Ÿæ˜¯ä¸€ä¸ªå¤šæ ¸å•å…ƒã€‚</p>
<p>ä¹‹åæˆ‘ä»¬è¿˜ä¼šæ¢è®¨<strong>å¤šçº¿ç¨‹</strong><span>(multithreading)<span class="heti-spacing"> </span></span>æŠ€æœ¯â€”â€”è¿™æ˜¯ä¸€ç§æ”¯æŒåœ¨å•ä¸ªå¤šå‘å°„å¤„ç†å™¨ä¸Šä»¥äº¤é”™æ–¹å¼æ‰§è¡Œå¤šä¸ªçº¿ç¨‹çš„æŠ€æœ¯ã€‚è®¸å¤šå¤šæ ¸å¤„ç†å™¨åŒæ ·åŒ…å«å¯¹å¤šçº¿ç¨‹çš„æ”¯æŒã€‚</p>
<h3 id="multiprocessor-architecture">Multiprocessor Architecture<a class="headerlink" href="#multiprocessor-architecture" title="Permanent link">âš“ï¸</a></h3>
<p>è¦å……åˆ†åˆ©ç”¨å…·æœ‰<span class="heti-skip"><span class="heti-spacing"> </span>n<span class="heti-spacing"> </span></span>ä¸ªå¤„ç†å™¨çš„<span class="heti-skip"><span class="heti-spacing"> </span>MIMD<span class="heti-spacing"> </span></span>å¤šå¤„ç†å™¨ï¼Œé€šå¸¸éœ€è¦è‡³å°‘<span class="heti-skip"><span class="heti-spacing"> </span>n<span class="heti-spacing"> </span></span>ä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹æ¥æ‰§è¡Œã€‚å•ä¸ªè¿›ç¨‹å†…çš„ç‹¬ç«‹çº¿ç¨‹é€šå¸¸ç”±<strong>ç¨‹åºå‘˜</strong>æ˜¾å¼æŒ‡å®šï¼Œæˆ–ç”±<strong>æ“ä½œç³»ç»Ÿ</strong>æ ¹æ®å¤šä¸ªç‹¬ç«‹è¯·æ±‚åŠ¨æ€åˆ›å»ºã€‚å¦ä¸€ç§æç«¯æƒ…å†µæ˜¯ï¼Œä¸€ä¸ªçº¿ç¨‹å¯èƒ½ä»…åŒ…å«å¾ªç¯çš„æ•°åæ¬¡è¿­ä»£â€”â€”è¿™æ˜¯ç”±<strong>å¹¶è¡Œç¼–è¯‘å™¨</strong>åˆ©ç”¨å¾ªç¯ä¸­çš„æ•°æ®å¹¶è¡Œç”Ÿæˆçš„ã€‚</p>
<p>å°½ç®¡åˆ†é…ç»™çº¿ç¨‹çš„è®¡ç®—é‡ï¼ˆç§°ä¸º<strong>ç²’åº¦å¤§å°</strong>(grain size)ï¼‰å¯¹äºé«˜æ•ˆåˆ©ç”¨<span class="heti-skip"><span class="heti-spacing"> </span>TLP<span class="heti-spacing"> </span></span>è‡³å…³é‡è¦ï¼Œä½†ä¸<span class="heti-skip"><span class="heti-spacing"> </span>ILP<span class="heti-spacing"> </span></span>çš„æœ¬è´¨åŒºåˆ«åœ¨äºï¼š<span>TLP<span class="heti-spacing"> </span></span>æ˜¯ç”±<strong>è½¯ä»¶ç³»ç»Ÿ</strong>æˆ–<strong>ç¨‹åºå‘˜</strong>åœ¨é«˜å±‚æŠ½è±¡ä¸­è¯†åˆ«å‡ºçš„ã€ç”±æ•°ç™¾è‡³æ•°ç™¾ä¸‡æ¡å¯å¹¶è¡Œæ‰§è¡Œçš„æŒ‡ä»¤æ„æˆçš„ä»£ç æ®µã€‚</p>
<p>çº¿ç¨‹ä¹Ÿå¯ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>DLP<span class="heti-spacing"> </span></span>æ‰€åˆ©ç”¨ï¼Œä½†å…¶å¼€é”€é€šå¸¸é«˜äº<span class="heti-skip"><span class="heti-spacing"> </span>SIMD<span class="heti-spacing"> </span></span>å¤„ç†å™¨æˆ–<span><span class="heti-spacing"> </span>GPU</span>ã€‚å¿…é¡»ç¡®ä¿ç²’åº¦è¶³å¤Ÿå¤§ï¼Œæ‰èƒ½é«˜æ•ˆåˆ©ç”¨å…¶å¹¶è¡Œæ€§ã€‚</p>
<p>å¯¹äºç°æœ‰çš„å…±äº«å†…å­˜å¤šå¤„ç†å™¨ï¼Œæ ¹æ®å…¶å†…å­˜ç»„ç»‡çš„ä¸åŒï¼Œå¯ä»¥åˆ’åˆ†ä¸ºä»¥ä¸‹ä¸¤å¤§ç±»ï¼š</p>
<ul>
<li>
<p><strong>å¯¹ç§°ï¼ˆå…±äº«å†…å­˜ï¼‰å¤šå¤„ç†å™¨</strong>(symmetric (shared-memory) multiprocessors, <strong>SMP</strong>)ï¼ˆæˆ–<strong>é›†ä¸­å¼</strong>(centralized)<strong>å…±äº«å†…å­˜å¤šå¤„ç†å™¨</strong>ï¼‰</p>
<ul>
<li>å…·æœ‰å°åˆ°ä¸­ç­‰æ•°é‡çš„æ ¸å¿ƒï¼Œé€šå¸¸ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>32<span class="heti-spacing"> </span></span>ä¸ªæˆ–æ›´å°‘</li>
<li>å¯¹äºè¿™ç§æ ¸å¿ƒæ•°é‡è¾ƒå°‘çš„å¤šå¤„ç†å™¨ï¼Œé‡Œé¢çš„è¿™äº›å¤„ç†å™¨å¯ä»¥å…±äº«ä¸€ä¸ªæ‰€æœ‰å¤„ç†å™¨éƒ½æœ‰å¹³ç­‰è®¿é—®æƒçš„å•ä¸€é›†ä¸­å¼å†…å­˜ï¼Œå› æ­¤ç§°ä¸ºâ€œå¯¹ç§°â€</li>
<li>ç°åœ¨å¤§å¤šæ•°å¤šæ ¸éƒ½å±äº<span><span class="heti-spacing"> </span>SMP</span></li>
<li>
<p><span>SMP<span class="heti-spacing"> </span></span>æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º<strong>ç»Ÿä¸€å†…å­˜è®¿é—®</strong><span>(uniform memory access, UMA)<span class="heti-spacing"> </span></span>å¤šå¤„ç†å™¨ï¼Œè¿™æ˜¯å› ä¸ºæ‰€æœ‰å¤„ç†å™¨å¯¹å†…å­˜çš„è®¿é—®å»¶è¿Ÿæ˜¯å‡ç­‰çš„ï¼Œå³ä¾¿å†…å­˜è¢«åˆ’åˆ†ä¸ºå¤šä¸ªåˆ†åŒºäº¦æ˜¯å¦‚æ­¤</p>
<p></p><div style="text-align: center">
<img src="images/C5/29.png" width="40%"/>
</div>
</li>
<li>
<p>æŸäº›å¤šæ ¸å¤„ç†å™¨å¯¹æœ€å¤–å±‚é«˜é€Ÿç¼“å­˜çš„è®¿é—®æ˜¯éå‡åŒ€çš„ï¼Œè¿™ç§ç»“æ„è¢«ç§°ä¸º<strong>éå‡åŒ€é«˜é€Ÿç¼“å­˜è®¿é—®</strong>(nonuniform cache access, NUCA)ï¼Œå› æ­¤å³ä¾¿å®ƒä»¬æ‹¥æœ‰å•ä¸€ä¸»å†…å­˜ï¼Œä¹Ÿå¹¶éçœŸæ­£çš„<span><span class="heti-spacing"> </span>SMP</span></p>
</li>
<li>
<p>ä¸‹å›¾å±•ç¤ºäº†é›†ä¸­å¼å…±äº«å†…å­˜å¤šå¤„ç†å™¨çš„åŸºæœ¬ç»“æ„ï¼š</p>
<p></p><div style="text-align: center">
<img src="images/C5/1.png" width="70%"/>
</div>
</li>
</ul>
</li>
<li>
<p><strong>åˆ†å¸ƒå¼å…±äº«å†…å­˜</strong>(distributed shared memory, <strong>DSM</strong>)</p>
<ul>
<li>åœ¨ç”±<strong>å¤šä¸ªå¤šæ ¸èŠ¯ç‰‡</strong>æ„æˆçš„å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œæ¯ä¸ªå¤šæ ¸èŠ¯ç‰‡é€šå¸¸é…å¤‡<strong>ç‹¬ç«‹çš„å†…å­˜å•å…ƒ</strong>ï¼Œå› æ­¤è¿™ç±»ç³»ç»Ÿçš„å†…å­˜é‡‡ç”¨<strong>åˆ†å¸ƒå¼</strong>ç»„ç»‡è€Œéé›†ä¸­å¼ç»„ç»‡</li>
<li>è®¸å¤šåˆ†å¸ƒå¼å†…å­˜è®¾è®¡èƒ½å®ç°å¯¹<strong>æœ¬åœ°</strong>å†…å­˜çš„å¿«é€Ÿè®¿é—®ï¼Œè€Œ<strong>è¿œç¨‹</strong>å†…å­˜è®¿é—®é€Ÿåº¦åˆ™æ˜¾è‘—ä¸‹é™</li>
<li>åœ¨æ­¤ç±»æ¶æ„ä¸­ï¼Œç¨‹åºå‘˜å’Œè½¯ä»¶ç³»ç»Ÿéœ€æ˜ç¡®åŒºåˆ†æœ¬åœ°ä¸è¿œç¨‹å†…å­˜è®¿é—®æ“ä½œï¼Œä½†é€šå¸¸æ— éœ€å…³æ³¨å„è¿œç¨‹å­˜å‚¨èŠ‚ç‚¹é—´çš„å…·ä½“åˆ†å¸ƒæƒ…å†µ</li>
<li>ä¸ºæ”¯æŒæ›´å¤šçš„å¤„ç†å™¨æ•°é‡ï¼Œå†…å­˜å¿…é¡»æ˜¯åˆ†å¸ƒç»„ç»‡è€Œéé›†ä¸­ç»„ç»‡ï¼›å¦åˆ™å†…å­˜ç³»ç»Ÿå°†ä»¥å¢å¤§è®¿é—®å»¶è¿Ÿçš„ä»£ä»·æ¥æ»¡è¶³æ›´å¤šå¤„ç†å™¨çš„å¸¦å®½éœ€æ±‚</li>
<li>ç”±äºä¸Šè¿°é—®é¢˜ï¼Œ<span>SMP<span class="heti-spacing"> </span></span>éšå¤„ç†å™¨æ•°é‡çš„å¢åŠ ä¼šé€æ¸ä¸§å¤±ä¼˜åŠ¿ï¼Œå› æ­¤ç»å¤§å¤šæ•°è¶…å¤§è§„æ¨¡å¤šå¤„ç†å™¨ç³»ç»Ÿéƒ½é‡‡ç”¨äº†åˆ†å¸ƒå¼å†…å­˜ç»„ç»‡</li>
<li>
<p>ä¸‹å›¾å±•ç¤ºäº†åˆ†å¸ƒå¼å…±äº«å†…å­˜å¤šå¤„ç†å™¨çš„åŸºæœ¬ç»“æ„ï¼š</p>
<p></p><div style="text-align: center">
<img src="images/C5/2.png" width="80%"/>
</div>
</li>
<li>
<p><span>DSM<span class="heti-spacing"> </span></span>å¤šå¤„ç†å™¨ä¹Ÿè¢«ç§°ä¸º<strong>éå‡åŒ€å†…å­˜è®¿é—®æ¶æ„</strong>(nonuniform memeory access, NUMA)ï¼Œå› ä¸ºæ•°æ®è®¿é—®æ—¶é—´å–å†³äºæ•°æ®å­—åœ¨å†…å­˜ä¸­çš„ç‰©ç†ä½ç½®</p>
<p></p><div style="text-align: center">
<img src="images/C5/30.png" width="40%"/>
</div>
</li>
<li>
<p><span>DSM<span class="heti-spacing"> </span></span>çš„ä¸»è¦ç¼ºç‚¹æ˜¯å¤„ç†å™¨é—´çš„æ•°æ®é€šä¿¡æœºåˆ¶å˜å¾—æ›´ä¸ºå¤æ‚ï¼Œä¸”éœ€è¦è½¯ä»¶å±‚é¢ä»˜å‡ºæ›´å¤šåŠªåŠ›æ‰èƒ½å……åˆ†åˆ©ç”¨æ‰€å¢åŠ çš„å†…å­˜å¸¦å®½ä¼˜åŠ¿</p>
</li>
</ul>
</li>
</ul>
<p>æ— è®ºæ˜¯<span class="heti-skip"><span class="heti-spacing"> </span>SMP<span class="heti-spacing"> </span></span>è¿˜æ˜¯<span class="heti-skip"><span class="heti-spacing"> </span>DSM<span class="heti-spacing"> </span></span>æ¶æ„ï¼Œçº¿ç¨‹é—´çš„é€šä¿¡å‡é€šè¿‡ä¸€ä¸ªå…±äº«çš„åœ°å€ç©ºé—´æ¥å®ç°ã€‚è¿™æ„å‘³ç€åªè¦å…·å¤‡ç›¸åº”çš„è®¿é—®æƒé™ï¼Œä»»ä½•å¤„ç†å™¨å‡å¯å¯¹ä»»æ„å†…å­˜ä½ç½®è¿›è¡Œå¯»å€æ“ä½œã€‚<span>SMP<span class="heti-spacing"> </span></span>ä¸<span class="heti-skip"><span class="heti-spacing"> </span>DSM<span class="heti-spacing"> </span></span>çš„<strong>å…±äº«å†…å­˜</strong><span>(shared memory)<span class="heti-spacing"> </span></span>æœ¬è´¨ä¸ŠæŒ‡ä»£çš„æ˜¯<strong>åœ°å€ç©ºé—´</strong><span>(address space)<span class="heti-spacing"> </span></span>çš„å…±äº«æ€§ã€‚</p>
<h3 id="challenges-of-parallel-processing">Challenges of Parallel Processing<a class="headerlink" href="#challenges-of-parallel-processing" title="Permanent link">âš“ï¸</a></h3>
<p>å¤šå¤„ç†å™¨çš„åº”ç”¨èŒƒå›´å¹¿æ³›ï¼ŒåŒ…æ‹¬ï¼šè¿è¡Œå‡ ä¹æ— éœ€é€šä¿¡çš„ç‹¬ç«‹ä»»åŠ¡ï¼Œæˆ–è€…æ‰§è¡Œéœ€è¦çº¿ç¨‹é—´åä½œæ‰èƒ½å®Œæˆçš„å¹¶è¡Œç¨‹åºã€‚è¦åº”å¯¹è¿™äº›ä»»åŠ¡å¸¦æ¥çš„æŒ‘æˆ˜ï¼Œé€šå¸¸éœ€è¦é‡‡å–ä»¥ä¸‹ç»¼åˆæ–¹æ¡ˆï¼š</p>
<ul>
<li>ç²¾å¿ƒé€‰æ‹©<strong>ç®—æ³•</strong>å¹¶ä¼˜åŒ–å®ç°</li>
<li>é€‚é…åº•å±‚<strong>ç¼–ç¨‹è¯­è¨€</strong>ä¸ç³»ç»Ÿ</li>
<li>åè°ƒ<strong>æ“ä½œç³»ç»Ÿ</strong>åŠå…¶æ”¯æŒåŠŸèƒ½</li>
<li>è°ƒæ•´<strong>ä½“ç³»ç»“æ„ä¸ç¡¬ä»¶</strong>å®æ–½æ–¹æ¡ˆ</li>
</ul>
<p>å°½ç®¡å¾ˆå¤šæ—¶å€™å…¶ä¸­æŸä¸€ä¸ªç¯èŠ‚å¯èƒ½ä¼šæˆä¸ºä¸»è¦ç“¶é¢ˆï¼Œä½†å½“å¤„ç†å™¨è§„æ¨¡å˜å¾—å¾ˆå¤§çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦åŒæ­¥ä¼˜åŒ–è½¯ä»¶å’Œç¡¬ä»¶çš„æ‰€æœ‰å±‚é¢ã€‚å…·ä½“æ¥è¯´ï¼Œæˆ‘ä»¬ä¸»è¦ä¼šé‡åˆ°ä»¥ä¸‹ä¸¤ç§æŒ‘æˆ˜ï¼š</p>
<ul>
<li>ç¨‹åºä¸­æœ‰é™çš„<strong>å¹¶è¡Œ</strong>èƒ½åŠ›</li>
<li>ç›¸å¯¹é«˜æ˜‚çš„<strong>é€šä¿¡</strong>å¼€é”€ï¼Œæˆ–è€…è¯´å¹¶è¡Œå¤„ç†å™¨ä¸­è¿œç¨‹è®¿é—®çš„é«˜å»¶è¿Ÿé—®é¢˜<ul>
<li>å…·ä½“æ—¶é•¿å–å†³äºé€šä¿¡æœºåˆ¶ã€äº’è¿ç½‘ç»œç±»å‹ä»¥åŠå¤šå¤„ç†å™¨çš„è§„æ¨¡</li>
</ul>
</li>
</ul>
<p>å®ƒä»¬å¯¹åº”çš„è§£å†³æ–¹æ¡ˆä¸ºï¼š</p>
<ul>
<li>
<p>å¯¹äºåº”ç”¨ç¨‹åºå¹¶è¡Œèƒ½åŠ›ä¸è¶³çš„é—®é¢˜ï¼Œä¸»è¦éœ€ä»<strong>è½¯ä»¶</strong>å±‚é¢ç€æ‰‹ï¼š</p>
<ul>
<li>ä¸€æ–¹é¢é‡‡ç”¨èƒ½æä¾›æ›´ä¼˜å¹¶è¡Œæ€§èƒ½çš„æ–°ç®—æ³•</li>
<li>å¦ä¸€æ–¹é¢ä¾é è½¯ä»¶ç³»ç»Ÿï¼Œæœ€å¤§åŒ–å¤„ç†å™¨åœ¨å®Œæ•´é…ç½®ä¸‹çš„æœ‰æ•ˆæ‰§è¡Œæ—¶é—´</li>
</ul>
</li>
<li>
<p>å¯¹äºé™ä½è¿œè·ç¦»å»¶è¿Ÿçš„å½±å“ï¼Œåˆ™éœ€è¦<strong>æ¶æ„å¸ˆ</strong>ä¸<strong>ç¨‹åºå‘˜</strong>çš„å…±åŒåŠªåŠ›ï¼š</p>
<ul>
<li>ä¾‹å¦‚é€šè¿‡ç¡¬ä»¶æœºåˆ¶ï¼ˆå¦‚ç¼“å­˜å…±äº«æ•°æ®ï¼‰æˆ–è½¯ä»¶æ‰‹æ®µï¼ˆå¦‚é‡æ„æ•°æ®ç»“æ„ä½¿è®¿é—®æœ¬åœ°åŒ–ï¼‰æ¥å‡å°‘è¿œç¨‹è®¿é—®æ¬¡æ•°</li>
<li>ä¹Ÿå¯ä»¥å€ŸåŠ©<strong>å¤šçº¿ç¨‹</strong>æŠ€æœ¯æˆ–<a href="2.html#hardware-prefetching-of-instructions-and-data"><strong>é¢„å–</strong></a>ç­–ç•¥æ¥å°è¯•æ©ç›–å»¶è¿Ÿ</li>
</ul>
</li>
</ul>
<p>æœ¬ç« åç»­å†…å®¹ç€é‡ç ”ç©¶å¦‚ä½•åº”å¯¹ç¬¬äºŒä¸ªæŒ‘æˆ˜ã€‚</p>
<h2 id="centralized-shared-memory-architectures">Centralized Shared-Memory Architectures<a class="headerlink" href="#centralized-shared-memory-architectures" title="Permanent link">âš“ï¸</a></h2>
<p>ä½¿ç”¨å¤§å‹çš„å¤šçº§é«˜é€Ÿç¼“å­˜èƒ½æ˜¾è‘—é™ä½å¤„ç†å™¨å¯¹å†…å­˜å¸¦å®½çš„éœ€æ±‚ï¼Œè¿™ä¸€å‘ç°æ¨åŠ¨äº†<strong>é›†ä¸­å¼å†…å­˜å¤šå¤„ç†å™¨</strong>çš„å‘å±•ã€‚</p>
<ul>
<li>æœ€åˆçš„å¤„ç†å™¨å‡ä¸ºå•æ ¸è®¾è®¡ï¼Œé€šå¸¸ä¼šå æ®æ•´ä¸ªä¸»æ¿ï¼›å†…å­˜åˆ™ä½äºå…±äº«æ€»çº¿ä¸Š</li>
<li>éšç€é«˜æ€§èƒ½å¤„ç†å™¨çš„å‡ºç°ï¼Œå¤„ç†å™¨çš„å†…å­˜éœ€æ±‚å·²è¶…å‡ºäº†å¸¸è§„æ€»çº¿çš„æ‰¿è½½èƒ½åŠ›ï¼Œå› æ­¤ç°ä»£çš„å¾®å¤„ç†å™¨ç›´æ¥å°†å†…å­˜è¿æ¥è‡³å•ä¸€èŠ¯ç‰‡ï¼ˆæœ‰æ—¶ç§°ä¸º<strong>åç«¯</strong><span>(backside)<span class="heti-spacing"> </span></span>æˆ–<strong>å†…å­˜æ€»çº¿</strong>(memory bus)ï¼Œä»¥åŒºåˆ«äºè¿æ¥<span class="heti-skip"><span class="heti-spacing"> </span>I/O<span class="heti-spacing"> </span></span>çš„æ€»çº¿ï¼‰<ul>
<li>æ— è®ºæ˜¯æ‰§è¡Œ<span class="heti-skip"><span class="heti-spacing"> </span>I/O<span class="heti-spacing"> </span></span>æ“ä½œè¿˜æ˜¯æ¥è‡ªå…¶ä»–èŠ¯ç‰‡çš„è®¿é—®ï¼Œè®¿é—®èŠ¯ç‰‡æœ¬åœ°å­˜å‚¨å™¨æ—¶éƒ½å¿…é¡»ç»è¿‡â€œæ‹¥æœ‰â€è¯¥å†…å­˜çš„èŠ¯ç‰‡å¤„ç†</li>
<li>å› æ­¤è¿™ç§å†…å­˜è®¿é—®å…·æœ‰ä¸å¯¹ç§°æ€§ï¼šæœ¬åœ°å†…å­˜è®¿é—®é€Ÿåº¦è¾ƒå¿«ï¼Œè€Œè¿œç¨‹å†…å­˜è¾ƒæ…¢</li>
<li>åœ¨å¤šæ ¸æ¶æ„ä¸­ï¼Œå•ä¸ªèŠ¯ç‰‡ä¸Šçš„æ‰€æœ‰æ ¸å¿ƒå…±äº«è¯¥å­˜å‚¨å™¨ï¼Œä½†ä¸åŒçš„æ ¸ä¹‹é—´é€šè¿‡å„è‡ªå†…å­˜è¿›è¡Œçš„ä¸å¯¹ç§°è®¿é—®æ¨¡å¼é€šå¸¸å­˜åœ¨</li>
</ul>
</li>
</ul>
<p><strong>å¯¹ç§°çš„å…±äº«å†…å­˜æœºå™¨</strong>é€šå¸¸æ”¯æŒå¯¹å…±äº«æ•°æ®å’Œç§æœ‰æ•°æ®çš„<strong>ç¼“å­˜</strong>ï¼Œå…¶ä¸­ï¼š</p>
<ul>
<li><strong>ç§æœ‰æ•°æ®</strong><span>(private data)<span class="heti-spacing"> </span></span>ä»…è¢«ä¸€ä¸ªå¤„ç†å™¨ä½¿ç”¨<ul>
<li>å½“ç§æœ‰æ•°æ®è¢«ç¼“å­˜æ—¶ï¼Œå…¶å­˜å‚¨ä½ç½®ä¼šè¿ç§»è‡³é«˜é€Ÿç¼“å­˜ä¸­ï¼Œä»è€Œé™ä½å¹³å‡è®¿é—®æ—¶é—´ä»¥åŠæ‰€éœ€çš„å†…å­˜å¸¦å®½ã€‚</li>
</ul>
</li>
<li><strong>å…±äº«æ•°æ®</strong><span>(shared data)<span class="heti-spacing"> </span></span>åˆ™èƒ½è¢«å¤šä¸ªå¤„ç†å™¨å…±åŒè®¿é—®<ul>
<li>å¯¹äºå…±äº«æ•°æ®çš„ç¼“å­˜å¤„ç†ï¼Œå…¶å€¼å¯èƒ½è¢«å¤åˆ¶åˆ°å¤šä¸ªé«˜é€Ÿç¼“å­˜ä¸­ã€‚é™¤äº†ç¼©çŸ­è®¿é—®å»¶è¿Ÿå’Œå‡å°‘å†…å­˜å¸¦å®½éœ€æ±‚å¤–ï¼Œè¿™ç§å¤åˆ¶è¿˜èƒ½ç¼“è§£å¤šå¤„ç†å™¨åŒæ—¶è¯»å–åŒä¸€å…±äº«æ•°æ®é¡¹æ—¶å¯èƒ½äº§ç”Ÿçš„ç«äº‰é—®é¢˜ã€‚</li>
<li>ç„¶è€Œï¼Œå…±äº«æ•°æ®çš„ç¼“å­˜ä¹Ÿå¸¦æ¥äº†æ–°çš„æŒ‘æˆ˜â€”â€”é«˜é€Ÿç¼“å­˜çš„<strong>ä¸€è‡´æ€§</strong><span>(coherence)<span class="heti-spacing"> </span></span>é—®é¢˜ï¼Œä¸‹é¢é©¬ä¸Šä»‹ç»ï¼</li>
</ul>
</li>
</ul>
<h3 id="multiprocessor-cache-coherence">Multiprocessor Cache Coherence<a class="headerlink" href="#multiprocessor-cache-coherence" title="Permanent link">âš“ï¸</a></h3>
<p><strong>é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§é—®é¢˜</strong>(cache coherence problem)ï¼šç”±äºä¸¤ä¸ªä¸åŒçš„å¤„ç†å™¨å¯¹å†…å­˜çš„è§†å›¾æ˜¯é€šè¿‡å„è‡ªçš„é«˜é€Ÿç¼“å­˜å»ºç«‹çš„ï¼Œå› æ­¤è¿™äº›å¤„ç†å™¨æœ€ç»ˆå¯èƒ½çœ‹åˆ°åŒä¸€å†…å­˜ä½ç½®ä¸‹çš„ä¸åŒå€¼ã€‚è¿™ä¸€é—®é¢˜æ¥æºäºæˆ‘ä»¬åŒæ—¶æ‹¥æœ‰ç”±ä¸»å­˜å®šä¹‰çš„<strong>å…¨å±€çŠ¶æ€</strong>å’Œç”±å„å¤„ç†å™¨æ ¸å¿ƒç§æœ‰çš„ç‹¬ç«‹ç¼“å­˜æ‰€å®šä¹‰çš„<strong>å±€éƒ¨çŠ¶æ€</strong>ã€‚</p>
<p>ä¸€ç§ä¸å¤ªæ­£å¼çš„è¯´æ³•æ˜¯ï¼šå¦‚æœä¸€ä¸ªå†…å­˜ç³»ç»Ÿå¯¹ä»»ä½•æ•°æ®é¡¹çš„è¯»å–éƒ½èƒ½è¿”å›è¯¥æ•°æ®é¡¹æœ€è¿‘è¢«å†™å…¥çš„å€¼ï¼Œæˆ‘ä»¬å°±å¯ä»¥è¯´è¿™ä¸ªå†…å­˜ç³»ç»Ÿæ˜¯<strong>ä¸€è‡´çš„</strong>ã€‚è¿™ä¸ªå®šä¹‰è™½ç„¶ç›´è§‚æ˜“æ‡‚ï¼Œå´æ˜¾å¾—æ¨¡ç³Šä¸”è¿‡äºç®€å•â€”â€”å®é™…æƒ…å†µè¦æ¯”è¿™å¤æ‚å¾—å¤šï¼›è€Œä¸”è¿™ä¸€ç®€å•çš„å®šä¹‰å®é™…åŒ…æ‹¬äº†å†…å­˜ç³»ç»Ÿè¡Œä¸ºçš„ä¸¤ä¸ªæ–¹é¢ï¼š</p>
<ul>
<li><strong>ä¸€è‡´æ€§</strong>(coherence)ï¼šè§„å®šäº†è¯»æ“ä½œå¯ä»¥è¿”å›å“ªäº›å€¼</li>
<li><strong>è¿è´¯æ€§</strong>(consistency)ï¼šå†³å®šäº†å†™æ“ä½œçš„å€¼ä½•æ—¶èƒ½è¢«è¯»æ“ä½œè¿”å›</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">æ³¨æ„</p>
<p>å®é™…ä¸Šï¼Œä¸­æ–‡ç¿»è¯‘æ²¡èƒ½å¾ˆå¥½åœ°å°†<span class="heti-skip"><span class="heti-spacing"> </span>coherence<span class="heti-spacing"> </span></span>å’Œ<span class="heti-skip"><span class="heti-spacing"> </span>consistency<span class="heti-spacing"> </span></span>åŒºåˆ†å¼€æ¥ï¼Œæ‰€ä»¥ä½ å¯èƒ½ä¼šåœ¨ç½‘ä¸Šçœ‹åˆ°æŠŠ<span class="heti-skip"><span class="heti-spacing"> </span>consistency<span class="heti-spacing"> </span></span>ç¿»è¯‘æˆâ€œä¸€è‡´æ€§â€çš„æƒ…å†µã€‚ä¸è¿‡åœ¨è¿™ä»½ç¬”è®°ä¸­ï¼Œç¬”è€…è¿˜æ˜¯é€‰æ‹©å°†<span class="heti-skip"><span class="heti-spacing"> </span>consistency<span class="heti-spacing"> </span></span>ç¿»è¯‘æˆâ€œè¿è´¯æ€§â€ã€‚</p>
</div>
<p>å¯¹<strong>ä¸€è‡´æ€§</strong><span>(coherence)<span class="heti-spacing"> </span></span>çš„ä¸¥æ ¼å®šä¹‰ä¸ºï¼šå½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œæˆ‘ä»¬ç§°å†…å­˜ç³»ç»Ÿå…·æœ‰ä¸€è‡´æ€§ï¼š</p>
<ul>
<li>å¤„ç†å™¨<span class="heti-skip"><span class="heti-spacing"> </span>P<span class="heti-spacing"> </span></span>å¯¹ä½ç½®<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„å†™å…¥æ“ä½œåç´§è·Ÿç€<span class="heti-skip"><span class="heti-spacing"> </span>P<span class="heti-spacing"> </span></span>å¯¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„è¯»å–æ“ä½œï¼Œä¸”åœ¨è¯¥å†™å…¥ä¸è¯»å–ä¹‹é—´æ²¡æœ‰å…¶ä»–å¤„ç†å™¨å¯¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>è¿›è¡Œå†™å…¥æ—¶ï¼Œè¯¥è¯»å–æ€»æ˜¯è¿”å›ç”±<span class="heti-skip"><span class="heti-spacing"> </span>P<span class="heti-spacing"> </span></span>æ‰€å†™å…¥çš„å€¼ã€‚<ul>
<li>è¯¥æ€§è´¨ä¿ç•™äº†<strong>ç¨‹åºé¡ºåº</strong>ï¼Œè€Œä¸”è¯¥æ€§è´¨å³ä½¿åœ¨å•å¤„ç†å™¨ä¸­ä¹Ÿä¾ç„¶æˆç«‹ã€‚</li>
</ul>
</li>
<li>å½“ä¸€ä¸ªå¤„ç†å™¨å¯¹ä½ç½®<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„è¯»å–æ“ä½œå‘ç”Ÿåœ¨å¦ä¸€ä¸ªå¤„ç†å™¨å¯¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„å†™å…¥æ“ä½œä¹‹åï¼Œåªè¦è¯»å†™ä¹‹é—´æœ‰è¶³å¤Ÿçš„æ—¶é—´é—´éš”<span class="heti-skip"><span class="heti-spacing"> </span>,<span class="heti-spacing"> </span></span>ä¸”åœ¨ä¸¤æ¬¡è®¿é—®ä¹‹é—´æ²¡æœ‰å…¶ä»–å¯¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„å†™å…¥å‘ç”Ÿï¼Œè¯¥è¯»å–å°†è¿”å›è¢«å†™å…¥çš„å€¼ã€‚<ul>
<li>è¯¥æ€§è´¨å®šä¹‰äº†å†…å­˜ä¸€è‡´æ€§çš„æ ¸å¿ƒå«ä¹‰ï¼šè‹¥æŸä¸ªå¤„ç†å™¨èƒ½æŒç»­è¯»å–åˆ°è¿‡æ—¶çš„æ•°æ®å€¼ï¼Œé‚£ä¹ˆæ˜¾ç„¶å¯ä»¥åˆ¤å®šè¯¥å†…å­˜å¤„åœ¨ä¸ä¸€è‡´çš„çŠ¶æ€ã€‚</li>
</ul>
</li>
<li><strong>å†™ä¸²è¡ŒåŒ–</strong>(write serialization)ï¼šé’ˆå¯¹åŒä¸€ä½ç½®çš„å†™æ“ä½œæ˜¯<strong>å¯ä¸²è¡Œçš„</strong>(serialized)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»»ä½•ä¸¤ä¸ªå¤„ç†å™¨å¯¹è¯¥ä½ç½®çš„ä¸¤æ¬¡å†™æ“ä½œï¼Œåœ¨æ‰€æœ‰å¤„ç†å™¨çœ‹æ¥ï¼Œéƒ½éµå¾ªç›¸åŒçš„é¡ºåºã€‚ä¾‹å¦‚ï¼Œè‹¥å…ˆåå‘æŸä½ç½®å†™å…¥å€¼<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>å’Œ<span><span class="heti-spacing"> </span>2</span>ï¼Œæ‰€æœ‰å¤„ç†å™¨éƒ½ä¸å¯èƒ½å…ˆè¯»åˆ°<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span>å†è¯»åˆ°<span><span class="heti-spacing"> </span>1</span>ã€‚</li>
</ul>
<p>å°½ç®¡ä¸Šè¿°ä¸‰ä¸ªæ€§è´¨å·²è¶³ä»¥ç¡®ä¿ä¸€è‡´æ€§ï¼Œä½†è¿è´¯æ€§åŒæ ·è‡³å…³é‡è¦ï¼Œæ¯”å¦‚ï¼šæˆ‘ä»¬æ— æ³•è¦æ±‚å¯¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„è¯»å–æ“ä½œèƒ½ç«‹å³è·å–å…¶ä»–å¤„ç†å™¨å¯¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>æ‰€å†™å…¥çš„ï¼ˆæœ€æ–°ï¼‰å€¼ï¼Œå› ä¸ºæ­¤æ—¶å†™å…¥çš„æ•°æ®ç”šè‡³å¯èƒ½å°šæœªç¦»å¼€åŸæ¥çš„å¤„ç†å™¨ã€‚è¿è´¯æ€§æ˜¯ç”±<a href="#models-of-memory-consistency"><strong>å†…å­˜è¿è´¯æ€§æ¨¡å‹</strong></a><span>(memory consistency model)<span class="heti-spacing"> </span></span>å®šä¹‰çš„ï¼Œè¿™å—å†…å®¹å°†æ”¾åœ¨åé¢ä»‹ç»ã€‚</p>
<p>ä¸€è‡´æ€§ä¸è¿è´¯æ€§äº’ä¸ºè¡¥å……ï¼š</p>
<ul>
<li><strong>ä¸€è‡´æ€§</strong>è§„å®šäº†é’ˆå¯¹<strong>åŒä¸€å†…å­˜</strong>åœ°å€è¯»å†™æ“ä½œçš„è¡Œä¸º</li>
<li>è€Œ<strong>è¿è´¯æ€§</strong>åˆ™å®šä¹‰äº†æ¶‰åŠ<strong>ä¸åŒå†…å­˜</strong>åœ°å€è®¿é—®æ—¶çš„è¯»å†™è¡Œä¸º</li>
</ul>
<p>ç›®å‰ï¼Œæˆ‘ä»¬ä½œå‡ºä»¥ä¸‹ä¸¤ç‚¹åŸºæœ¬å‡è®¾ï¼š</p>
<ul>
<li>å¿…é¡»ç­‰åˆ°æ‰€æœ‰å¤„ç†å™¨éƒ½çŸ¥é“åˆ°å†™æ“ä½œçš„ç»“æœåï¼Œè¯¥å†™æ“ä½œæ‰è¢«è§†ä¸ºå®Œæˆä»»åŠ¡ï¼ˆå¹¶å…è®¸åç»­å†™æ“ä½œæ‰§è¡Œï¼‰</li>
<li>å¤„ç†å™¨ä¸å¾—è°ƒæ•´ä»»ä½•å†™æ“ä½œç›¸å¯¹äºå…¶ä»–å†…å­˜è®¿é—®çš„æ‰§è¡Œé¡ºåº<ul>
<li>è¿™æ„å‘³ç€è‹¥æŸå¤„ç†å™¨å…ˆåå†™å…¥åœ°å€<span class="heti-skip"><span class="heti-spacing"> </span>A<span class="heti-spacing"> </span></span>å’Œåœ°å€<span><span class="heti-spacing"> </span>B</span> ï¼Œä»»ä½•è§‚æµ‹åˆ°<span class="heti-skip"><span class="heti-spacing"> </span>B<span class="heti-spacing"> </span></span>æ–°å€¼çš„å¤„ç†å™¨å¿…ç„¶ä¹Ÿå·²è·å–<span class="heti-skip"><span class="heti-spacing"> </span>A<span class="heti-spacing"> </span></span>çš„æ–°å€¼</li>
</ul>
</li>
</ul>
<p>è¿™äº›å‡è®¾å…è®¸å¤„ç†å™¨é‡æ’è¯»æ“ä½œé¡ºåºï¼Œä½†å¼ºåˆ¶å…¶æŒ‰ç…§ç¨‹åºé¡ºåºæ¥å®Œæˆå†™æ“ä½œã€‚å¹¶ä¸”è¿™äº›å‡è®¾å°†ä¸€ç›´æ²¿ç”¨è‡³ä»‹ç»â€œå†…å­˜è¿è´¯æ€§æ¨¡å‹â€æ—¶ä¸ºæ­¢ã€‚</p>
<h3 id="basic-schemes-for-enforcing-coherence">Basic Schemes for Enforcing Coherence<a class="headerlink" href="#basic-schemes-for-enforcing-coherence" title="Permanent link">âš“ï¸</a></h3>
<p>åœ¨å¤šå¤„ç†å™¨å†…è¿è¡Œçš„ç¨‹åºä¸­ï¼ŒåŒä¸€æ•°æ®çš„å¤šä»½æ‹·è´é€šå¸¸ä¼šåŒæ—¶å­˜åœ¨äºå„çº§é«˜é€Ÿç¼“å­˜ä¸­ã€‚åœ¨ä¸€è‡´æ€§çš„å¤šå¤„ç†å™¨ä¸­ï¼Œé«˜é€Ÿç¼“å­˜æä¾›äº†å…±äº«æ•°æ®çš„<strong>è¿ç§»</strong><span>(migration)<span class="heti-spacing"> </span></span>ä¸<strong>å¤åˆ¶</strong><span>(replication)<span class="heti-spacing"> </span></span>çš„åŒé‡åŠŸèƒ½ã€‚</p>
<ul>
<li><strong>è¿ç§»</strong>ï¼šæ•°æ®é¡¹å¯é€æ˜åœ°è½¬ç§»è‡³æœ¬åœ°é«˜é€Ÿç¼“å­˜å¹¶è¢«ä½¿ç”¨ã€‚è¿™æ—¢é™ä½äº†è®¿é—®è¿œç¨‹åˆ†é…çš„å…±äº«æ•°æ®çš„å»¶è¿Ÿï¼Œåˆç¼“è§£äº†å…±äº«å†…å­˜çš„å¸¦å®½å‹åŠ›ã€‚</li>
<li><strong>å¤åˆ¶</strong>ï¼šæœ‰æ•ˆå‡å°‘äº†è¯»å–å…±äº«æ•°æ®æ—¶çš„è®¿é—®å»¶è¿Ÿå’Œèµ„æºäº‰ç”¨ã€‚</li>
</ul>
<p>ç”±æ­¤å¯è§ï¼Œå®ç°é«˜æ•ˆçš„è¿ç§»ä¸å¤åˆ¶å¯¹æå‡å…±äº«æ•°æ®è®¿é—®çš„æ€§èƒ½è€Œè¨€è‡³å…³é‡è¦ã€‚å› æ­¤ï¼Œå¤šå¤„ç†å™¨å¼•å…¥ç¡¬ä»¶çº§åè®®æ¥ç»´æŠ¤é«˜é€Ÿç¼“å­˜çš„ä¸€è‡´æ€§ã€‚è¿™ä¸ªåè®®è¢«ç§°ä¸º<strong>é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§åè®®</strong>(cache coherence protocols)ï¼Œå…¶å®ç°æ ¸å¿ƒåœ¨äºè¿½è¸ªæ•°æ®å—çš„å…±äº«çŠ¶æ€ã€‚æ¯ä¸ªç¼“å­˜å—çš„çŠ¶æ€é€šè¿‡ä¸ä¹‹å…³è”çš„<strong>çŠ¶æ€ä½</strong>æ¥ç»´æŠ¤ï¼ˆç±»ä¼¼äºå•å¤„ç†å™¨é«˜é€Ÿç¼“å­˜ä¸­çš„æœ‰æ•ˆä½å’Œè„ä½<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚æ ¹æ®å…·ä½“å®ç°æŠ€æœ¯çš„ä¸åŒï¼Œå¯ä»¥å°†åè®®åˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š</p>
<ul>
<li><strong>åŸºäºç›®å½•</strong>(directory based)ï¼š<ul>
<li>ç‰¹å®šç‰©ç†å†…å­˜å—çš„å…±äº«çŠ¶æ€è¢«ä¿å­˜åœ¨ä¸€ä¸ªç§°ä¸º<strong>ç›®å½•</strong><span>(directory)<span class="heti-spacing"> </span></span>çš„ä½ç½®ã€‚</li>
<li>å­˜åœ¨ä¸¤ç§æˆªç„¶ä¸åŒçš„åŸºäºç›®å½•çš„ç¼“å­˜ä¸€è‡´æ€§æ–¹æ¡ˆï¼š<ul>
<li>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>SMP<span class="heti-spacing"> </span></span>ä¸­ï¼Œå¯é‡‡ç”¨ä¸å†…å­˜æˆ–å…¶ä»–å•ä¸€ä¸²è¡ŒåŒ–ç‚¹ï¼ˆå¦‚å¤šæ ¸èŠ¯ç‰‡çš„æœ€å¤–å±‚é«˜é€Ÿç¼“å­˜ï¼‰å…³è”çš„<strong>é›†ä¸­å¼ç›®å½•</strong></li>
<li>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>DSM<span class="heti-spacing"> </span></span>ä¸­ï¼Œç”±äºå•ä¸ªç›®å½•ä¼šé˜»ç¢æ€§èƒ½ï¼Œä¸”éš¾ä»¥æ»¡è¶³å¤šæ ¸æ¶æ„çš„å†…å­˜æ‰©å±•éœ€æ±‚ï¼Œå› æ­¤éœ€é‡‡ç”¨<strong>åˆ†å¸ƒå¼ç›®å½•</strong>ï¼Œä½†å®ç°èµ·æ¥ç›¸å¯¹æ›´å¤æ‚</li>
</ul>
</li>
</ul>
</li>
<li><strong>ç›‘å¬</strong>(snooping)ï¼š<ul>
<li>æ¯ä¸ªæŒæœ‰ç‰©ç†å†…å­˜å—æ•°æ®æ‹·è´çš„é«˜é€Ÿç¼“å­˜å‡å¯è¿½è¸ªè¯¥å—çš„å…±äº«çŠ¶æ€</li>
<li>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>SMP<span class="heti-spacing"> </span></span>ä¸­ï¼Œå„ä¸ªæ ¸å¿ƒçš„é«˜é€Ÿç¼“å­˜é€šå¸¸é€šè¿‡å¹¿æ’­ä»‹è´¨ï¼ˆå¦‚æ ¸å¿ƒè‡ªå¸¦çš„é«˜é€Ÿç¼“å­˜ä¸å…±äº«é«˜é€Ÿç¼“å­˜<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>å†…å­˜ä¹‹é—´çš„æ€»çº¿ï¼‰å®ç°äº’é€šï¼Œå¹¶ä¸”æ‰€æœ‰çš„é«˜é€Ÿç¼“å­˜æ§åˆ¶å™¨é€šè¿‡æŒç»­ç›‘æ§æˆ–<strong>ç›‘å¬</strong><span>(snoop)<span class="heti-spacing"> </span></span>ä»‹è´¨ï¼Œä»¥ç¡®è®¤è‡ªèº«æ˜¯å¦æ‹¥æœ‰åœ¨æ€»çº¿ä¸Šï¼Œæˆ–äº¤æ¢è®¿é—®ä¸­è¯·æ±‚çš„ç›®æ ‡æ•°æ®å—æ‹·è´</li>
<li>
<p>ä¾¦å¬æŠ€æœ¯åŒæ ·é€‚ç”¨äºå¤šèŠ¯ç‰‡å¤šå¤„ç†å™¨çš„ä¸€è‡´æ€§åè®®</p>
<p></p><div style="text-align: center">
<img src="images/C5/31.png" width="70%"/>
</div>
</li>
</ul>
</li>
</ul>
<p><strong>ç›‘å¬åè®®</strong>åœ¨é‡‡ç”¨å¾®å¤„ç†å™¨ï¼ˆå•æ ¸<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œå¹¶é€šè¿‡æ€»çº¿è¿æ¥è‡³å•ä¸€å…±äº«å†…å­˜çš„å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­å¹¿å—æ¬¢è¿ã€‚å…¶ä¸­ï¼Œ<strong>æ€»çº¿</strong>ä¸ºå®ç°ç›‘å¬åè®®æä¾›äº†ä¾¿æ·çš„å¹¿æ’­åª’ä»‹ã€‚ä½†å¤šæ ¸æ¶æ„æ”¹å˜äº†è¿™ä¸€å±€é¢ï¼Œå› ä¸ºæ‰€æœ‰å¤šæ ¸èŠ¯ç‰‡ä¸Šçš„æ ¸éƒ½å…±äº«äº†ä¸€å®šçº§åˆ«çš„é«˜é€Ÿç¼“å­˜ã€‚å› æ­¤ï¼Œéƒ¨åˆ†è®¾è®¡è½¬è€Œé‡‡ç”¨<strong>ç›®å½•åè®®</strong>ï¼Œå› å…¶å¼€é”€è¾ƒå°ã€‚</p>
<p>æˆ‘ä»¬æ¥ä¸‹æ¥å…ˆé‡ç‚¹æ¢è®¨ç›‘å¬åè®®ï¼Œç­‰åˆ°è®¨è®º<span class="heti-skip"><span class="heti-spacing"> </span>DSM<span class="heti-spacing"> </span></span>æ¶æ„æ—¶å†è¯¦ç»†ä»‹ç»ç›®å½•åè®®ã€‚</p>
<h3 id="snooping-coherence-protocols">Snooping Coherence Protocols<a class="headerlink" href="#snooping-coherence-protocols" title="Permanent link">âš“ï¸</a></h3>
<p>è¦ç»´æŒé«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§è¦æ±‚ï¼Œæœ‰ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ï¼š</p>
<ul>
<li>
<p><strong>å†™æ— æ•ˆåè®®</strong>(write invalidate protocol)ï¼šç¡®ä¿å¤„ç†å™¨åœ¨å†™å…¥æ•°æ®é¡¹å‰æ‹¥æœ‰å¯¹è¯¥é¡¹çš„<strong>ç‹¬å è®¿é—®æƒ</strong></p>
<ul>
<li>ç‹¬å è®¿é—®èƒ½ä¿è¯åœ¨å¯¹ä¸€ä¸ªå…±äº«ç¼“å­˜è¡Œæ‰§è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œå…¶ä»–æ‰€æœ‰é«˜é€Ÿç¼“å­˜ä¸­è¯¥ç¼“å­˜è¡Œçš„å‰¯æœ¬å‡è¢«æ— æ•ˆåŒ–ã€‚</li>
<li>å…¶ä»–å¤„ç†å™¨åç»­è¯»å–æ—¶ä¼šå‘ç”Ÿé«˜é€Ÿç¼“å­˜å¤±æ•ˆï¼Œéœ€è¦ä»å†…å­˜æˆ–æŒæœ‰æœ‰æ•ˆå‰¯æœ¬çš„é«˜é€Ÿç¼“å­˜ä¸­è·å–æ›´æ–°çš„æ•°æ®ï¼ˆå› æ­¤è¯»å–æ—¶å»¶æ›´é•¿<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œä»è€Œå‡å°‘æ€»çº¿ä¸Šé‡å¤å†™å…¥çš„å¸¦å®½æ¶ˆè€—ã€‚</li>
<li>è‹¥å­˜åœ¨ä¸¤ä¸ªå¤„ç†å™¨è¯•å›¾åŒæ—¶å†™å…¥åŒä¸€æ•°æ®çš„æƒ…å†µï¼Œå…¶ä¸­ä¸€æ–¹å°†è·èƒœï¼Œå¯¼è‡´å¦ä¸€æ–¹çš„æ•°æ®æ‹·è´å¤±æ•ˆï¼›å¦ä¸€æ–¹è‹¥è¦å®Œæˆå…¶å†™å…¥æ“ä½œï¼Œå°±å¿…é¡»è·å–åŒ…å«æœ€æ–°æ›´æ–°å€¼çš„æ•°æ®æ–°æ‹·è´ã€‚</li>
<li>ç”±æ­¤å¯è§ï¼Œæ­¤åè®®ç¡®ä¿äº†<strong>å†™ä¸²è¡ŒåŒ–</strong>ã€‚</li>
<li>è¿™æ˜¯ç›®å‰æœ€ä¸»æµçš„åè®®ã€‚</li>
</ul>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/C5/3.png" width="80%"/>
</div>
</details>
</li>
<li>
<p><strong>å†™æ›´æ–°</strong>(write update)/<strong>å†™å¹¿æ’­</strong>(write broadcast)<strong>åè®®</strong>ï¼šæ¯å½“å¤„ç†å™¨å†™å…¥ä¸€ä¸ªå…±äº«ç¼“å­˜è¡Œæ—¶ï¼Œéƒ½è¦å¹¿æ’­æ–°çš„å€¼æ¥æ›´æ–°å…¶ä»–æ‰€æœ‰é«˜é€Ÿç¼“å­˜ä¸­è¯¥ç¼“å­˜è¡Œçš„å‰¯æœ¬ã€‚</p>
<ul>
<li>ç”±äºå†™æ›´æ–°åè®®å¿…é¡»å‘æ‰€æœ‰å…±äº«ç¼“å­˜è¡Œå¹¿æ’­å†™å…¥æ“ä½œï¼Œå› è€Œä¼šæ¶ˆè€—æ›´å¤šçš„å¸¦å®½ã€‚</li>
</ul>
</li>
</ul>
<p>æ‰€ä»¥ï¼Œå‡ ä¹æ‰€æœ‰ç°åœ¨çš„å¤šå¤„ç†å™¨ç³»ç»Ÿéƒ½é€‰æ‹©å®ç°<strong>å†™æ— æ•ˆåè®®</strong>ï¼Œåé¢æˆ‘ä»¬ä¹Ÿåªå…³æ³¨è¿™ä¸ªåè®®ã€‚</p>
<h4 id="basic-implementation-techniques">Basic Implementation Techniques<a class="headerlink" href="#basic-implementation-techniques" title="Permanent link">âš“ï¸</a></h4>
<ul>
<li>åœ¨å¤šæ ¸å¤„ç†å™¨ä¸­ï¼Œå®ç°æ— æ•ˆåè®®çš„å…³é”®åœ¨äºåˆ©ç”¨<strong>æ€»çº¿æˆ–å…¶ä»–å¹¿æ’­åª’ä»‹</strong>æ¥æ‰§è¡Œæ— æ•ˆæ“ä½œã€‚</li>
<li>åœ¨æ—©æœŸçš„å¤šèŠ¯ç‰‡å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ï¼Œç”¨äºä¸€è‡´æ€§çš„æ€»çº¿å°±æ˜¯å…±äº«å†…å­˜è®¿é—®æ€»çº¿ï¼›è€Œåœ¨å•èŠ¯ç‰‡å¤šæ ¸æ¶æ„é‡Œï¼Œè¯¥æ€»çº¿å¯ä»¥æ˜¯ç§æœ‰é«˜é€Ÿç¼“å­˜ä¸å…±äº«å¤–éƒ¨é«˜é€Ÿç¼“å­˜ä¹‹é—´çš„è¿æ¥é€šé“ã€‚</li>
<li>æ‰§è¡Œæ— æ•ˆæŒ‡ä»¤æ—¶ï¼Œå¤„ç†å™¨åªéœ€è·å–æ€»çº¿æ§åˆ¶æƒï¼Œå¹¶å°†å¾…å¤±æ•ˆçš„åœ°å€é€šè¿‡æ€»çº¿å¹¿æ’­å‡ºå»ã€‚</li>
<li>æ‰€æœ‰å¤„ç†å™¨æŒç»­ç›‘å¬æ€»çº¿ä¸Šçš„åœ°å€ä¿¡å·ï¼šè‹¥å‘ç°æ€»çº¿ä¸Šå‡ºç°çš„åœ°å€å‡ºç°åœ¨è‡ªå·±çš„é«˜é€Ÿç¼“å­˜ä¸­ï¼Œåˆ™ç«‹å³å°†å¯¹åº”çš„é«˜é€Ÿç¼“å­˜æ•°æ®æ ‡è®°ä¸ºæ— æ•ˆã€‚</li>
<li>å½“å¯¹å…±äº«å—è¿›è¡Œå†™å…¥æ“ä½œæ—¶ï¼Œæ‰§è¡Œå†™å…¥çš„å¤„ç†å™¨å¿…é¡»è·å–æ€»çº¿è®¿é—®æƒé™ï¼Œä»¥å¹¿æ’­å…¶æ— æ•ˆåŒ–è¯·æ±‚ã€‚</li>
<li>è‹¥ä¸¤ä¸ªå¤„ç†å™¨åŒæ—¶å°è¯•å†™å…¥å…±äº«å—ï¼Œå®ƒä»¬å¹¿æ’­æ— æ•ˆåŒ–æ“ä½œçš„è¯·æ±‚å°†åœ¨æ€»çº¿ä»²è£è¿‡ç¨‹ä¸­è¢«<strong>ä¸²è¡ŒåŒ–</strong>å¤„ç†ï¼›é¦–å…ˆè·å¾—æ€»çº¿è®¿é—®æƒçš„å¤„ç†å™¨å°†ä½¿å…¶æ­£åœ¨å†™å…¥çš„å—çš„æ‰€æœ‰å…¶ä»–æ‹·è´å¤±æ•ˆã€‚<ul>
<li>è¯¥æœºåˆ¶çš„ä¸€ä¸ªé‡è¦å«ä¹‰æ˜¯ï¼šåœ¨è·å¾—æ€»çº¿è®¿é—®æƒä¹‹å‰ï¼Œå¯¹å…±äº«æ•°æ®é¡¹çš„å†™æ“ä½œå®é™…ä¸Šæ— æ³•å®Œæˆã€‚</li>
</ul>
</li>
<li>æ‰€æœ‰ä¸€è‡´æ€§æ–¹æ¡ˆéƒ½éœ€è¦æŸç§æ–¹æ³•æ¥<strong>ä¸²è¡ŒåŒ–</strong>å¯¹åŒä¸€ç¼“å­˜å—çš„è®¿é—®ï¼Œæ— è®ºæ˜¯é€šè¿‡ä¸²è¡ŒåŒ–é€šä¿¡ä»‹è´¨çš„è®¿é—®é€”å¾„ï¼Œè¿˜æ˜¯é€šè¿‡å¯¹å¦ä¸€ä¸ªå…±äº«ç»“æ„çš„æ§åˆ¶æ¥å®ç°ã€‚</li>
<li>æˆ‘ä»¬è¿˜éœ€åœ¨å‘ç”Ÿé«˜é€Ÿç¼“å­˜å¤±æ•ˆæ—¶å®šä½æ•°æ®é¡¹ã€‚<ul>
<li>åœ¨<strong>å†™ç©¿å¼</strong><span>(write-through)<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜ä¸­ï¼ŒæŸ¥æ‰¾æ•°æ®é¡¹çš„å½“å‰å€¼è¾ƒä¸ºç®€å•ï¼Œå› ä¸ºæ‰€æœ‰å·²å†™å…¥çš„æ•°æ®éƒ½ä¼šç«‹å³å‘é€è‡³å†…å­˜ï¼Œä»ä¸­æ€»èƒ½è·å–åˆ°æ•°æ®é¡¹çš„æœ€æ–°å€¼ã€‚</li>
<li>å¯¹äº<strong>å†™å›å¼</strong><span>(write-back)<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜è€Œè¨€ï¼Œç¡®å®šæœ€æ–°æ•°æ®å€¼çš„éš¾åº¦æ›´å¤§ï¼Œå› ä¸ºæ•°æ®é¡¹çš„æœ€æ–°å€¼å¯èƒ½å­˜åœ¨äºç§æœ‰é«˜é€Ÿç¼“å­˜è€Œéå…±äº«é«˜é€Ÿç¼“å­˜æˆ–ä¸»å­˜ä¸­ã€‚<ul>
<li>ä¸è¿‡æˆ‘ä»¬å¯ä»¥å¯¹é«˜é€Ÿç¼“å­˜å¤±æ•ˆå’Œå†™å…¥æ“ä½œé‡‡ç”¨ç›¸åŒçš„<strong>ç›‘å¬</strong>æœºåˆ¶ï¼š<ul>
<li>æ¯ä¸ªå¤„ç†å™¨éƒ½ä¼šç›‘å¬å…±äº«æ€»çº¿ä¸Šä¼ è¾“çš„æ‰€æœ‰åœ°å€ã€‚</li>
<li>å½“æŸå¤„ç†å™¨å‘ç°è‡ªå·±æŒæœ‰ç›®æ ‡ç¼“å­˜å—çš„è„æ‹·è´æ—¶ï¼Œä¼šå°†è¯¥ç¼“å­˜å—ä½œä¸ºè¯»è¯·æ±‚çš„å“åº”å†…å®¹è¿”å›ï¼Œå¹¶ç»ˆæ­¢å¯¹ä¸»å­˜ï¼ˆæˆ–ä¸‰çº§é«˜é€Ÿç¼“å­˜ï¼‰çš„è®¿é—®ã€‚</li>
<li>è¯¥æ–¹æ³•çš„å¤æ‚æ€§åœ¨äºéœ€è¦ä»å…¶ä»–å¤„ç†å™¨çš„ç§æœ‰é«˜é€Ÿç¼“å­˜ï¼ˆ<span>L1<span class="heti-spacing"> </span></span>æˆ–<span><span class="heti-spacing"> </span>L2</span>ï¼‰ä¸­è·å–ç›®æ ‡å—ï¼Œè¿™é€šå¸¸æ¯”è®¿é—®ä¸‰çº§é«˜çº§ç¼“å­˜è€—æ—¶æ›´é•¿ã€‚</li>
</ul>
</li>
<li>ç”±äºå†™å›å¼ç¼“å­˜çš„<strong>å†…å­˜å¸¦å®½éœ€æ±‚è¾ƒä½</strong>ï¼Œå› æ­¤èƒ½æ”¯æŒæ›´å¤šé«˜é€Ÿå¤„ç†å™¨çš„ååŒå·¥ä½œã€‚æ­£å› å¦‚æ­¤ï¼Œæ‰€æœ‰å¤šæ ¸å¤„ç†å™¨éƒ½åœ¨æœ€å¤–å±‚ç¼“å­˜é‡‡ç”¨å†™å›ç­–ç•¥ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬å°†æ¢è®¨åŸºäºå†™å›å¼ç¼“å­˜çš„ä¸€è‡´æ€§å®ç°æ–¹æ¡ˆã€‚</p>
<ul>
<li>å¸¸è§„é«˜é€Ÿç¼“å­˜çš„<strong>æ ‡ç­¾ä½</strong><span>(tags)<span class="heti-spacing"> </span></span>å¯ç”¨äºå®ç°ç›‘å¬æœºåˆ¶ï¼Œæ¯ä¸ªå—çš„<strong>æœ‰æ•ˆä½</strong><span>(valid bit)<span class="heti-spacing"> </span></span>ä½¿å¾—å¤±æ•ˆæ“ä½œæ˜“äºå®æ–½ã€‚</li>
<li>å¯¹äºç”±å¤±æ•ˆæˆ–è€…å…¶ä»–äº‹ä»¶è§¦å‘çš„<strong>è¯»å¤±æ•ˆ</strong>é—®é¢˜ï¼Œå¤„ç†èµ·æ¥åŒæ ·ç›´æ¥ï¼Œå› ä¸ºå®ƒä»¬ä»…ä¾èµ–äºç›‘å¬åŠŸèƒ½ã€‚</li>
<li>å¯¹äº<strong>å†™æ“ä½œ</strong>ï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“è¯¥å—æ˜¯å¦å­˜åœ¨å…¶ä»–ç¼“å­˜æ‹·è´ã€‚å¦‚æœæ²¡æœ‰çš„è¯ï¼Œåœ¨å†™å›å¼é«˜é€Ÿç¼“å­˜ä¸­ä¾¿æ— éœ€å°†æ­¤æ¬¡å†™æ“ä½œç½®äºæ€»çº¿ä¸Šã€‚ä¸å‘é€å†™è¯·æ±‚æ—¢èƒ½ç¼©çŸ­å†™å…¥æ—¶é—´ï¼Œåˆå¯èŠ‚çœæ‰€éœ€å¸¦å®½ã€‚</li>
<li>ä¸ºäº†è¿½è¸ªä¸€ä¸ªé«˜é€Ÿç¼“å­˜å—æ˜¯å¦è¢«å…±äº«ï¼Œæˆ‘ä»¬å¯ä»¥ä¸ºæ¯ä¸ªç¼“å­˜å—é¢å¤–æ·»åŠ ä¸€ä¸ª<strong>çŠ¶æ€ä½</strong>(state bit)ï¼Œä»è€Œèƒ½å¤Ÿåˆ¤æ–­å†™å…¥æ“ä½œæ˜¯å¦éœ€è¦äº§ç”Ÿæ— æ•ˆåŒ–ä¿¡å·ã€‚</li>
<li>å½“å¯¹å¤„äºå…±äº«çŠ¶æ€çš„å—æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œè¯¥ç¼“å­˜ä¼šåœ¨æ€»çº¿ä¸Šç”Ÿæˆæ— æ•ˆåŒ–å‘½ä»¤å¹¶å°†è¯¥å—æ ‡è®°ä¸º<strong>ç‹¬å </strong><span>(exclusive)<span class="heti-spacing"> </span></span>çŠ¶æ€ï¼Œæ­¤åè¯¥æ ¸ä¸å†é’ˆå¯¹æ­¤å—å‘é€ä»»ä½•æ— æ•ˆåŒ–è¯·æ±‚ã€‚</li>
<li>æ‹¥æœ‰ç¼“å­˜å—å”¯ä¸€æ‹·è´çš„æ ¸é€šå¸¸è¢«ç§°ä¸ºè¯¥ç¼“å­˜å—çš„<strong>æ‰€æœ‰è€…</strong>(owner)ã€‚</li>
<li>å½“å‘é€ä¸€æ¡æ— æ•ˆåŒ–æŒ‡ä»¤æ—¶ï¼Œæ‰€æœ‰è€…çš„é«˜é€Ÿç¼“å­˜å—çŠ¶æ€ä¼šä»å…±äº«çŠ¶æ€è½¬å˜ä¸ºéå…±äº«ï¼ˆæˆ–ç‹¬å ï¼‰çŠ¶æ€ã€‚è‹¥åç»­æœ‰å…¶ä»–å¤„ç†å™¨è¯·æ±‚è¯¥ç¼“å­˜å—ï¼Œåˆ™å¿…é¡»å°†å…¶çŠ¶æ€é‡æ–°ç½®ä¸ºå…±äº«ã€‚</li>
<li>ç”±äºæˆ‘ä»¬çš„ç›‘å¬å¼é«˜é€Ÿç¼“å­˜ä¹Ÿèƒ½å‘ç°ä»»ä½•å¤±æ•ˆæƒ…å†µï¼Œå› æ­¤å®ƒèƒ½çŸ¥é“ç‹¬å é«˜é€Ÿç¼“å­˜å—ä½•æ—¶è¢«å…¶ä»–å¤„ç†å™¨è¯·æ±‚ï¼Œå¹¶ä¸”å°†çŠ¶æ€æ¢å¤ä¸ºå…±äº«ã€‚</li>
<li>æ¯ä¸ªæ€»çº¿äº‹åŠ¡éƒ½å¿…é¡»æ£€æŸ¥é«˜é€Ÿç¼“å­˜åœ°å€çš„æ ‡ç­¾ï¼Œè¿™å¯èƒ½ä¼šå¹²æ‰°å¤„ç†å™¨çš„é«˜é€Ÿç¼“å­˜è®¿é—®ã€‚ä¸ºäº†å‡å°‘è¿™ç§å¹²æ‰°ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹æªæ–½ï¼š<ul>
<li><strong>å¤åˆ¶</strong>æ ‡ç­¾ï¼Œå¹¶å°†ç›‘å¬è®¿é—®å®šå‘åˆ°æ ‡ç­¾æ‹·è´ä¸Šã€‚</li>
<li>åœ¨å…±äº«çš„<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜å¤„ä½¿ç”¨<strong>ç›®å½•</strong>ã€‚è¯¥ç›®å½•èƒ½å¤Ÿåæ˜ ç»™å®šå—æ˜¯å¦è¢«å…±äº«ï¼Œä»¥åŠå¯èƒ½å“ªäº›æ ¸æ‹¥æœ‰æ‹·è´ã€‚æœ‰äº†ç›®å½•ä¿¡æ¯ï¼Œæ— æ•ˆæ“ä½œå¯ä»¥ä»…é’ˆå¯¹é‚£äº›æ‹¥æœ‰è¯¥ç¼“å­˜å—æ‹·è´çš„é«˜é€Ÿç¼“å­˜è¿›è¡Œã€‚è¿™å°±è¦æ±‚<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>å¿…é¡»å§‹ç»ˆä¿ç•™<span class="heti-skip"><span class="heti-spacing"> </span>L1<span class="heti-spacing"> </span></span>æˆ–<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>ä¸­ä»»ä½•æ•°æ®é¡¹çš„æ‹·è´ï¼Œè¿™ä¸€ç‰¹æ€§ç§°ä¸º<strong>åŒ…å«æ€§</strong>(inclusion)ã€‚</li>
</ul>
</li>
</ul>
<h4 id="a-simple-protocol">A Simple Protocol<a class="headerlink" href="#a-simple-protocol" title="Permanent link">âš“ï¸</a></h4>
<p>æˆ‘ä»¬ä¸€èˆ¬é€šè¿‡ä¸ºæ¯ä¸ªæ ¸ä¸­é›†æˆä¸€ä¸ª<strong>æœ‰é™çŠ¶æ€æ§åˆ¶å™¨</strong>æ¥å®ç°ç›‘å¬å¼ä¸€è‡´æ€§åè®®ã€‚è¯¥æ§åˆ¶å™¨å“åº”æ¥è‡ªæ ¸å†…å¤„ç†å™¨åŠæ€»çº¿ï¼ˆæˆ–å…¶ä»–å¹¿æ’­åª’ä»‹ï¼‰çš„è¯·æ±‚ï¼Œæ”¹å˜é€‰å®šé«˜é€Ÿç¼“å­˜å—çš„çŠ¶æ€ï¼ŒåŒæ—¶åˆ©ç”¨æ€»çº¿è®¿é—®æ•°æ®æˆ–ä½¿å…¶å¤±æ•ˆã€‚ä»é€»è¾‘ä¸Šçœ‹ï¼Œå¯ä»¥è®¤ä¸ºæ¯ä¸ªé«˜é€Ÿç¼“å­˜å—éƒ½å…³è”ç€ä¸€ä¸ªç‹¬ç«‹çš„æ§åˆ¶å™¨ï¼›è¿™æ„å‘³ç€é’ˆå¯¹ä¸åŒç¼“å­˜å—çš„ç›‘å¬æ“ä½œæˆ–ç¼“å­˜è¯·æ±‚èƒ½å¤Ÿç‹¬ç«‹å¤„ç†ã€‚å®é™…å®ç°ä¸­ï¼Œå•ä¸ªæ§åˆ¶å™¨å…è®¸å¤šä¸ªé’ˆå¯¹ä¸åŒç¼“å­˜å—çš„æ“ä½œä»¥äº¤é”™æ–¹å¼æ‰§è¡Œã€‚</p>
<p>æˆ‘ä»¬è§„å®šåè®®åŒ…å«ä¸‰ç§çŠ¶æ€ï¼š</p>
<ul>
<li><strong>æ— æ•ˆ</strong>(invalid)</li>
<li><strong>å…±äº«</strong>(shared)ï¼šè¡¨ç¤ºç§æœ‰é«˜é€Ÿç¼“å­˜ä¸­çš„å—å¯èƒ½è¢«å¤šä¸ªæ ¸å…±äº«</li>
<li><strong>ä¿®æ”¹</strong>(modified)ï¼šè¡¨æ˜æŸä¸ªå—å·²åœ¨ç§æœ‰é«˜é€Ÿç¼“å­˜ä¸­è¢«æ›´æ–°ï¼›å¹¶ä¸”è¯¥çŠ¶æ€æ„å‘³ç€è¯¥å—å…·æœ‰ç‹¬å æ€§ã€‚</li>
</ul>
<p>ä¸‹è¡¨å±•ç¤ºäº†ç”±æ ¸äº§ç”Ÿçš„è¯·æ±‚ï¼ˆä¸ŠåŠéƒ¨åˆ†ï¼‰ä»¥åŠæ¥è‡ªæ€»çº¿çš„è¯·æ±‚ï¼ˆä¸‹åŠéƒ¨åˆ†ï¼‰ä¸é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§çš„å…³ç³»ï¼š</p>
<div style="text-align: center">
<img src="images/C5/4.png" width="90%"/>
</div>
<p>å½“æ€»çº¿ä¸Šå‡ºç°æ— æ•ˆè¯·æ±‚æˆ–å†™æ— æ•ˆæ—¶ï¼Œæ‰€æœ‰ç§æœ‰é«˜é€Ÿç¼“å­˜ä¸­å­˜æœ‰è¯¥ç¼“å­˜å—æ‹·è´çš„æ ¸éƒ½ä¼šå°†å…¶ç½®ä¸ºæ— æ•ˆã€‚å¯¹äºå†™å›å¼é«˜é€Ÿç¼“å­˜çš„å†™æ— æ•ˆæƒ…å†µï¼Œè‹¥è¯¥å—ä»…å­˜åœ¨äºä¸€ä¸ª<strong>ç§æœ‰é«˜é€Ÿç¼“å­˜</strong>ï¼Œä¸”å¤„äºç‹¬å çŠ¶æ€ï¼Œé‚£ä¹ˆè¯¥ç¼“å­˜è¿˜éœ€æ‰§è¡Œ<strong>å†™å›</strong>æ“ä½œï¼›å¦åˆ™å¯ç›´æ¥ä»å…±äº«é«˜é€Ÿç¼“å­˜æˆ–ä¸»å­˜è¯»å–æ•°æ®ã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºäº†é‡‡ç”¨å†™æ— æ•ˆåè®®å’Œå†™å›å¼é«˜é€Ÿç¼“å­˜çš„å•ä¸ªç§æœ‰é«˜é€Ÿç¼“å­˜å—çš„æœ‰é™çŠ¶æ€è½¬æ¢å›¾ï¼ˆå·¦å›¾æ˜¯<span class="heti-skip"><span class="heti-spacing"> </span>CPU<span class="heti-spacing"> </span></span>è¯·æ±‚ï¼Œå³å›¾æ˜¯æ€»çº¿è¯·æ±‚<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼š</p>
<div style="text-align: center">
<img src="images/C5/5.png" width="100%"/>
</div>
<p>å°†ä¸¤ä¸ªçŠ¶æ€è½¬æ¢å›¾åˆå¹¶åœ¨ä¸€èµ·ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹çŠ¶æ€å›¾ï¼š</p>
<div style="text-align: center">
<img src="images/C5/6.png" width="60%"/>
</div>
<ul>
<li>ä»»ä½•æœ‰æ•ˆçš„é«˜é€Ÿç¼“å­˜å—è¦ä¹ˆå¤„äºä¸€ä¸ªæˆ–å¤šä¸ªç§æœ‰é«˜é€Ÿç¼“å­˜çš„å…±äº«çŠ¶æ€ï¼Œè¦ä¹ˆä¸¥æ ¼ä½äºå•ä¸€é«˜é€Ÿç¼“å­˜çš„ç‹¬å çŠ¶æ€ã€‚</li>
<li>ä»»ä½•å‘ç‹¬å çŠ¶æ€çš„è½¬æ¢ï¼ˆè¿™æ˜¯å¤„ç†å™¨å†™å…¥å—çš„å¿…è¦æ¡ä»¶ï¼‰éƒ½è¦æ±‚åœ¨æ€»çº¿ä¸Šå‘å‡ºæ— æ•ˆæˆ–å†™æ— æ•ˆä¿¡å·ï¼Œè¿™å°†å¯¼è‡´æ‰€æœ‰æœ¬åœ°é«˜é€Ÿç¼“å­˜å°†è¯¥å—ç½®ä¸ºæ— æ•ˆçŠ¶æ€ã€‚</li>
<li>æ­¤å¤–ï¼Œè‹¥å…¶ä»–æœ¬åœ°é«˜é€Ÿç¼“å­˜æ›¾ä»¥ç‹¬å çŠ¶æ€æŒæœ‰è¯¥å—ï¼ˆå˜è„äº†<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œåˆ™è¯¥é«˜é€Ÿç¼“å­˜ä¼šæ‰§è¡Œå†™å›æ“ä½œï¼Œä»è€Œæä¾›åŒ…å«ç›®æ ‡åœ°å€çš„æ•°æ®å—ã€‚</li>
<li>æœ€åï¼Œå½“æ€»çº¿å‡ºç°é’ˆå¯¹ç‹¬å çŠ¶æ€å—çš„è¯»å¤±æ•ˆæ—¶ï¼ŒæŒæœ‰è¯¥ç‹¬å æ‹·è´çš„æœ¬åœ°é«˜é€Ÿç¼“å­˜ä¼šå°†å…¶çŠ¶æ€å˜æ›´ä¸ºå…±äº«çŠ¶æ€ã€‚</li>
</ul>
<p>æœ¬åè®®çš„å¦ä¸€ç‰¹æ€§æ˜¯ï¼šå¤„äºå…±äº«çŠ¶æ€çš„å†…å­˜å—åœ¨å¤–éƒ¨å…±äº«é«˜é€Ÿç¼“å­˜ï¼ˆ<span>L2<span class="heti-spacing"> </span></span>æˆ–<span><span class="heti-spacing"> </span>L3</span>ï¼Œè‹¥æ— å…±äº«é«˜é€Ÿç¼“å­˜åˆ™ä¸ºå†…å­˜ï¼‰ä¸­å§‹ç»ˆä¿æŒæœ€æ–°çŠ¶æ€ã€‚è¿™ä¸€ç‰¹æ€§æ˜¾è‘—ç®€åŒ–äº†å®ç°æ–¹æ¡ˆã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="1:6"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio"/><input id="__tabbed_1_2" name="__tabbed_1" type="radio"/><input id="__tabbed_1_3" name="__tabbed_1" type="radio"/><input id="__tabbed_1_4" name="__tabbed_1" type="radio"/><input id="__tabbed_1_5" name="__tabbed_1" type="radio"/><input id="__tabbed_1_6" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="__tabbed_1_1">åˆå§‹çŠ¶æ€</label><label for="__tabbed_1_2"><span><span class="heti-spacing"> </span>Step 1</span></label><label for="__tabbed_1_3"><span><span class="heti-spacing"> </span>Step 2</span></label><label for="__tabbed_1_4"><span><span class="heti-spacing"> </span>Step 3</span></label><label for="__tabbed_1_5"><span><span class="heti-spacing"> </span>Step 4</span></label><label for="__tabbed_1_6"><span><span class="heti-spacing"> </span>Step 5</span></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/32.png" width="70%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/33.png" width="70%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/34.png" width="70%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/35.png" width="70%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/36.png" width="70%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/37.png" width="70%"/>
</div>
</div>
</div>
</div>
</details>
<p>å°½ç®¡è¿™ä¸ªç®€å•çš„ç¼“å­˜åè®®èƒ½æ­£ç¡®æ‰§è¡Œï¼Œä½†æ˜¯å®ƒå¿½ç•¥äº†è®¸å¤šå¤æ‚æƒ…å†µã€‚å…¶ä¸­æœ€é‡è¦çš„æ˜¯è¯¥åè®®å‡è®¾æ‰€æœ‰æ“ä½œéƒ½æ˜¯<strong>åŸå­æ€§çš„</strong>ï¼Œå³ä»»ä¸€æ“ä½œèƒ½å¤Ÿä»¥ä¸å—å…¶ä»–æ“ä½œå¹²æ‰°çš„æ–¹å¼å®Œæˆï¼Œç„¶è€Œç°å®ä¸­å¹¶éå¦‚æ­¤ã€‚éåŸå­æ€§æ“ä½œä¼šå¼•å…¥åè®®<strong>æ­»é”</strong><span>(deadlock)<span class="heti-spacing"> </span></span>çš„å¯èƒ½æ€§ï¼Œå³è¿›å…¥æ— æ³•ç»§ç»­æ‰§è¡Œçš„çŠ¶æ€ã€‚åœ¨åé¢æˆ‘ä»¬ä¼šè®¨è®ºè¿™äº›æƒ…å†µã€‚</p>
<h3 id="extensions-to-the-basic-coherence-protols">Extensions to the Basic Coherence Protols<a class="headerlink" href="#extensions-to-the-basic-coherence-protols" title="Permanent link">âš“ï¸</a></h3>
<p>å…ˆå‰æè¿°çš„ä¸€è‡´æ€§åè®®æ˜¯ä¸€ç§ç®€å•çš„ä¸‰çŠ¶æ€åè®®ï¼Œé€šå¸¸ä»¥å…¶çŠ¶æ€çš„é¦–å­—æ¯æ¥æŒ‡ä»£ï¼Œå› æ­¤è¢«ç§°ä¸º <strong>MSI</strong>ï¼ˆModifiedï¼ˆä¿®æ”¹<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼ŒSharedï¼ˆå…±äº«<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼ŒInvalidï¼ˆæ— æ•ˆ<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼‰åè®®ã€‚æˆ‘ä»¬å¯ä»¥åŸºäºè¿™ä¸€åŸºç¡€åè®®è¿›è¡Œæ‰©å±•ï¼Œé€šè¿‡å¢åŠ é¢å¤–çŠ¶æ€å’Œäº‹åŠ¡æ¥ä¼˜åŒ–ç‰¹å®šè¡Œä¸ºï¼Œä»è€Œï¼ˆå¯èƒ½ä¼šï¼‰æå‡æ€§èƒ½è¡¨ç°ã€‚å…¶ä¸­ï¼Œæœ€å¸¸è§çš„ä¸¤ç§æ‰©å±•æ˜¯ï¼š</p>
<ul>
<li>
<p><strong>MESI</strong> åè®®ï¼šå¢åŠ äº†<strong>ç‹¬å </strong><span>(exclusive)<span class="heti-spacing"> </span></span>çŠ¶æ€ï¼Œå½¢æˆå››ç§çŠ¶æ€ï¼šä¿®æ”¹<span><span class="heti-spacing"> </span>(modified)</span>ã€ç‹¬å <span><span class="heti-spacing"> </span>(exclusive)</span>ã€å…±äº«<span class="heti-skip"><span class="heti-spacing"> </span>(shared)<span class="heti-spacing"> </span></span>å’Œæ— æ•ˆ<span><span class="heti-spacing"> </span>(invalid)</span>ã€‚</p>
<ul>
<li>ç‹¬å çŠ¶æ€è¡¨ç¤ºç¼“å­˜å—ä»…å­˜åœ¨äºå•ä¸€é«˜é€Ÿç¼“å­˜ä¸­ï¼Œä¸”æœªè¢«ä¿®æ”¹ã€‚</li>
<li>è‹¥æŸä¸ªå—å¤„äºç‹¬å çŠ¶æ€ï¼Œå¯¹å…¶è¿›è¡Œå†™å…¥æ—¶æ— éœ€äº§ç”Ÿå¤±æ•ˆä¿¡å·ï¼Œä»è€Œä¼˜åŒ–äº†åŒä¸€é«˜é€Ÿç¼“å­˜å…ˆè¯»å–åå†™å…¥è¯¥æ•°æ®å—çš„åœºæ™¯ã€‚</li>
<li>å½“ç„¶ï¼Œå½“å¯¹å¤„äºç‹¬å çŠ¶æ€çš„å—çš„è¯»å¤±æ•ˆå‘ç”Ÿæ—¶ï¼Œå¿…é¡»å°†è¯¥å—è½¬ä¸ºå…±äº«çŠ¶æ€ä»¥ç»´æŒä¸€è‡´æ€§ã€‚</li>
<li>æ·»åŠ ç‹¬å çŠ¶æ€çš„å¥½å¤„åœ¨äºï¼šå½“åŒä¸€ä¸ªæ ¸å†æ¬¡å†™å…¥å¤„äºç‹¬å çŠ¶æ€çš„æ•°æ®å—æ—¶ï¼Œæ—¢ä¸éœ€è¦è·å–æ€»çº¿è®¿é—®æƒï¼Œä¹Ÿä¸éœ€ç”Ÿæˆå¤±æ•ˆä¿¡å·ï¼Œå› ä¸ºç³»ç»Ÿæ˜ç¡®çŸ¥æ™“è¯¥æ•°æ®å—ä»…å­˜åœ¨äºæœ¬åœ°çš„è¿™ä¸ªé«˜é€Ÿç¼“å­˜ä¸­ï¼›å¤„ç†å™¨åªéœ€å°†å…¶çŠ¶æ€æ”¹ä¸ºå·²ä¿®æ”¹å³å¯å®ç°æ›´æ–°ã€‚</li>
<li>
<p>é€šè¿‡å°†ä¸€è‡´æ€§çŠ¶æ€ä½ç¼–ç ä¸ºç‹¬å çŠ¶æ€ä½ã€å¹¶ç”¨è„ä½æ ‡è¯†ä¿®æ”¹æƒ…å†µå³å¯è½»æ¾å®ç°è¯¥çŠ¶æ€çš„æ‰©å±•åº”ç”¨ã€‚</p>
<p></p><div style="text-align: center">
<img src="images/C5/38.png" width="80%"/>
</div>
</li>
</ul>
</li>
<li>
<p><strong>MOESI</strong>åè®®ï¼šåœ¨<span class="heti-skip"><span class="heti-spacing"> </span>MESI<span class="heti-spacing"> </span></span>åè®®çš„åŸºç¡€ä¸Šå¢åŠ äº†<strong>æ‹¥æœ‰</strong><span>(owned)<span class="heti-spacing"> </span></span>çŠ¶æ€ï¼Œç”¨äºè¡¨ç¤ºç›¸å…³ç¼“å­˜å—ç”±è¯¥é«˜é€Ÿç¼“å­˜æŒæœ‰ï¼Œä¸”ä¸»å­˜ä¸­çš„æ‹·è´å·²è¿‡æ—¶ã€‚</p>
<ul>
<li>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>MSI<span class="heti-spacing"> </span></span>å’Œ<span class="heti-skip"><span class="heti-spacing"> </span>MESI<span class="heti-spacing"> </span></span>åè®®ä¸­ï¼Œå½“å°è¯•å…±äº«å¤„äºä¿®æ”¹çŠ¶æ€çš„ç¼“å­˜å—æ—¶ï¼Œåœ¨åŸé«˜é€Ÿç¼“å­˜å’Œæ–°çš„å…±äº«é«˜é€Ÿç¼“å­˜ä¸­ï¼Œè¯¥å—çš„çŠ¶æ€éƒ½ä¼šè½¬å˜ä¸ºå…±äº«çŠ¶æ€ï¼Œä¸”å¿…é¡»å°†å…¶å†™å›ä¸»å­˜ã€‚</li>
<li>è€Œåœ¨<span class="heti-skip"><span class="heti-spacing"> </span>MOESI<span class="heti-spacing"> </span></span>åè®®ä¸­ï¼ŒåŸé«˜é€Ÿç¼“å­˜çš„ä¿®æ”¹çŠ¶æ€å¯ä»¥ç›´æ¥è½¬æ¢ä¸ºæ‹¥æœ‰çŠ¶æ€è€Œæ— éœ€ç«‹å³å†™å…¥å†…å­˜ã€‚å…¶ä»–æ–°çš„å…±äº«è¯¥å—çš„é«˜é€Ÿç¼“å­˜åˆ™ä¿æŒå…±äº«çŠ¶æ€ï¼›è€Œä»…ç”±åŸé«˜é€Ÿç¼“å­˜æŒæœ‰çš„æ‹¥æœ‰çŠ¶æ€è¡¨æ˜ä¸»å­˜æ‹·è´å·²å¤±æ•ˆï¼Œä¸”æŒ‡å®šé«˜é€Ÿç¼“å­˜æ˜¯æ‰€æœ‰è€…ã€‚</li>
<li>å½“å‘ç”Ÿå¤±æ•ˆæ—¶ï¼Œæ‰€æœ‰è€…å¿…é¡»æä¾›è¯¥æ•°æ®å—ï¼ˆå› ä¸ºä¸»å­˜æœªæ›´æ–°<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼›è‹¥è¢«æ›¿æ¢ï¼Œåˆ™éœ€å°†å…¶å†™å›ä¸»å­˜ã€‚</li>
</ul>
</li>
</ul>
<h3 id="limitations-in-smps-and-snooping-protocols">Limitations in SMPs and Snooping Protocols<a class="headerlink" href="#limitations-in-smps-and-snooping-protocols" title="Permanent link">âš“ï¸</a></h3>
<p>éšç€å¤šå¤„ç†å™¨ä¸­å¤„ç†å™¨æ•°é‡çš„å¢åŠ ï¼Œæˆ–æ¯ä¸ªå¤„ç†å™¨çš„å†…å­˜éœ€æ±‚å¢é•¿ï¼Œç³»ç»Ÿä¸­ä»»ä½•<strong>é›†ä¸­å¼èµ„æº</strong><span>(centralized resource)<span class="heti-spacing"> </span></span>éƒ½å¯èƒ½æˆä¸ºç“¶é¢ˆã€‚å¯¹äºå¤šæ ¸å¤„ç†å™¨è€Œè¨€ï¼Œä»…éœ€å°‘é‡æ ¸å¿ƒï¼Œå°±èƒ½ä½¿å•ä¸ªå…±äº«æ€»çº¿å½¢æˆæ€§èƒ½ç“¶é¢ˆã€‚å› æ­¤ï¼Œå¤šæ ¸è®¾è®¡è½¬å‘äº†æ›´é«˜å¸¦å®½çš„äº’è¿æ–¹æ¡ˆï¼Œä»¥åŠé‡‡ç”¨å¤šä¸ªç‹¬ç«‹å†…å­˜ä»¥æ”¯æŒæ›´å¤šæ ¸å¿ƒæ•°é‡ã€‚</p>
<p>ç›‘å¬å¼é«˜é€Ÿç¼“å­˜çš„å¸¦å®½ä¹Ÿå¯èƒ½æ˜¯ä¸€ä¸ªé™åˆ¶ï¼Œå› ä¸ºæ¯ä¸ªé«˜é€Ÿç¼“å­˜éƒ½å¿…é¡»æ£€æŸ¥æ¯ä¸€æ¬¡çš„å¤±æ•ˆæƒ…å†µï¼Œè€Œå¢åŠ äº’è¿å¸¦å®½åªä¼šå°†é—®é¢˜è½¬å«ç»™é«˜é€Ÿç¼“å­˜ã€‚ä¸‹é¢ç»™å‡ºä¸€äº›å¢åŠ ç›‘å¬å¸¦å®½çš„æŠ€æœ¯ï¼š</p>
<ul>
<li><strong>å¤åˆ¶æ ‡ç­¾ä½</strong>(tags)ï¼Œå®ç°å¸¦å®½å€å¢</li>
<li>å¦‚æœå¤šæ ¸å¤„ç†å™¨å…±äº«æœ€å¤–å±‚çš„é«˜é€Ÿç¼“å­˜ï¼Œé‚£ä¹ˆå¯é‡‡ç”¨<strong>åˆ†å¸ƒå¼</strong>çš„é«˜é€Ÿç¼“å­˜â€”â€”æ¯ä¸ªå¤„ç†å™¨åˆ†ç®¡éƒ¨åˆ†å†…å­˜åŒºåŸŸï¼Œå¹¶å¤„ç†å¯¹åº”åœ°å€ç©ºé—´çš„ç›‘å¬è¯·æ±‚ã€‚<ul>
<li>é‰´äº<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>æ‰¿æ‹…ç€è¿‡æ»¤ç›‘å¬è¯·æ±‚çš„åŠŸèƒ½ï¼Œ<span>L3<span class="heti-spacing"> </span></span>å¿…é¡»å…·å¤‡åŒ…å®¹æ€§<span><span class="heti-spacing"> </span>(inclusive)</span></li>
</ul>
</li>
<li>å¯åœ¨æœ€å¤–å±‚çš„å…±äº«é«˜é€Ÿç¼“å­˜å±‚ï¼ˆå¦‚<span><span class="heti-spacing"> </span>L3</span>ï¼‰è®¾ç½®ä¸€ä¸ª<strong>ç›®å½•</strong>ã€‚<ul>
<li>åŒæ ·åœ°ï¼Œ<span>L3<span class="heti-spacing"> </span></span>å¿…é¡»ä¿æŒåŒ…å®¹æ€§ã€‚</li>
<li>å¼•å…¥ç›®å½•ç»“æ„åï¼Œæ— éœ€å¹¿æ’­è‡³æ‰€æœ‰<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>ç¼“å­˜ï¼Œä»…éœ€æŸ¥è¯¢ç›®å½•æŒ‡å‘çš„å¯èƒ½æŒæœ‰æ•°æ®å—æ‹·è´çš„ç‰¹å®š<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>å³å¯ã€‚</li>
<li>ä¸å‰ä¸€ç§æ–¹æ³•ç±»ä¼¼ï¼Œå…¶å…³è”çš„ç›®å½•æ¡ç›®äº¦å¯ä»¥åˆ†å¸ƒå¼å­˜å‚¨ã€‚</li>
</ul>
</li>
</ul>
<p>ä¸‹å›¾å±•ç¤ºçš„å°±æ˜¯ä¸€ä¸ªé‡‡ç”¨åˆ†å¸ƒå¼é«˜é€Ÿç¼“å­˜ç³»ç»Ÿçš„å¤šæ ¸å¤„ç†å™¨ï¼š</p>
<div style="text-align: center">
<img src="images/C5/7.png" width="70%"/>
</div>
<h3 id="implementing-snooping-cache-coherence">Implementing Snooping Cache Coherence<a class="headerlink" href="#implementing-snooping-cache-coherence" title="Permanent link">âš“ï¸</a></h3>
<p>åœ¨å•æ€»çº¿çš„å¤šæ ¸å¤„ç†å™¨ä¸­ï¼Œé€šè¿‡ä»¥ä¸‹æ–¹å¼å¯ä½¿è¿™äº›æ­¥éª¤å…·å¤‡å®è´¨åŸå­æ€§ï¼š</p>
<ul>
<li>é¦–å…ˆï¼ˆåœ¨æ›´æ”¹ç¼“å­˜çŠ¶æ€å‰<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œå¯¹é€šå¾€å…±äº«é«˜é€Ÿç¼“å­˜æˆ–å†…å­˜çš„æ€»çº¿è¿›è¡Œä»²è£ï¼Œå¹¶åœ¨æ‰€æœ‰æ“ä½œå®Œæˆå‰ä¸é‡Šæ”¾æ€»çº¿ã€‚</li>
<li>ä½¿ç”¨å•æ¡çº¿è·¯æ¥è¡¨ç¤ºæ‰€æœ‰å¿…è¦çš„æ— æ•ˆåŒ–è¯·æ±‚éƒ½å·²æ¥æ”¶å¹¶æ­£åœ¨å¤„ç†ã€‚</li>
<li>æ”¶åˆ°è¯¥ä¿¡å·åï¼Œç”Ÿæˆå¤±æ•ˆä¿¡å·çš„å¤„ç†å™¨ä¾¿å¯é‡Šæ”¾æ€»çº¿ï¼Œå› ä¸ºå®ƒçŸ¥é“å¤„ç†å’Œä¸‹ä¸€ä¸ªå¤±æ•ˆç›¸å…³çš„ä»»ä½•æ´»åŠ¨ä¹‹å‰ï¼Œæ‰€æœ‰å¿…éœ€çš„æ“ä½œéƒ½å°†å®Œæˆã€‚</li>
</ul>
<p>è€Œåœ¨ä¸€ä¸ªæ²¡æœ‰å•ä¸€é›†ä¸­æ€»çº¿çš„ç³»ç»Ÿä¸­ï¼Œåˆ™ç”¨å…¶ä»–æ–¹æ³•æ¥å®ç°é«˜é€Ÿç¼“å­˜å¤±æ•ˆæ“ä½œçš„åŸå­æ€§ã€‚å…·ä½“è€Œè¨€ï¼Œå¿…é¡»ç¡®ä¿ä¸¤ä¸ªå¤„ç†å™¨åŒæ—¶å°è¯•å†™å…¥åŒä¸€æ•°æ®å—ï¼ˆè¿™ç§æƒ…å†µç§°ä¸º<strong>ç«äº‰</strong>(race)ï¼‰æ—¶éµå¾ªä¸¥æ ¼é¡ºåºï¼šä¸€ä¸ªå†™æ“ä½œè¢«å®Œæ•´å¤„ç†å¹¶å…ˆè¡Œå®Œæˆåï¼Œå¦ä¸€ä¸ªå†™æ“ä½œæ‰èƒ½å¼€å§‹æ‰§è¡Œã€‚ç«äº‰ä¸­ä¸¤ä¸ªå†™æ“ä½œçš„èƒœè´Ÿå¹¶ä¸é‡è¦ï¼Œå…³é”®åœ¨äºåªå­˜åœ¨å”¯ä¸€èƒœå‡ºè€…ï¼Œå…¶ä¸€è‡´æ€§æ“ä½œèƒ½ç‡å…ˆå®Œæˆã€‚</p>
<p>åœ¨å¤šæ ¸æ¶æ„ä¸­é‡‡ç”¨å¤šæ€»çº¿è®¾è®¡æ—¶ï¼Œåªè¦ç¡®ä¿æ¯ä¸ªå†…å­˜å—ä»…å…³è”ä¸€æ¡ç‹¬ç«‹æ€»çº¿ï¼Œå°±èƒ½é€šè¿‡è¯¥å…±äº«æ€»çº¿å¯¹åŒä¸€æ•°æ®å—çš„è®¿é—®è¯·æ±‚è¿›è¡Œä¸²è¡ŒåŒ–å¤„ç†ï¼Œä»è€Œæ¶ˆé™¤ç«äº‰ç°è±¡ã€‚è¿™ä¸€ç‰¹æ€§ä¸é‡å¯ç«äº‰å¤±è´¥æ–¹çš„é«˜é€Ÿç¼“å­˜å¤±æ•ˆå¤„ç†çš„èƒ½åŠ›ç›¸ç»“åˆï¼Œæ„æˆäº†æ— éœ€æ€»çº¿ä¹Ÿèƒ½å®ç°çš„ç›‘å¬å¼é«˜é€Ÿç¼“å­˜ä¸€è‡´æ€§çš„å…³é”®è¦ç´ ã€‚</p>
<p>å®é™…è®¾è®¡ä¸­å¯æ··åˆä½¿ç”¨ä¾¦å¬åè®®å’Œç›®å½•åè®®ã€‚</p>
<h2 id="performance-of-symmetric-shared-memory-multiprocessors">Performance of Symmetric Shared-Memory Multiprocessors<a class="headerlink" href="#performance-of-symmetric-shared-memory-multiprocessors" title="Permanent link">âš“ï¸</a></h2>
<div class="admonition warning">
<p class="admonition-title">æ³¨æ„</p>
<p>è¿™å—å†…å®¹åº”è¯¥ä¸è€ƒï¼</p>
</div>
<p>åœ¨ä½¿ç”¨ç›‘å¬ä¸€è‡´æ€§åè®®çš„å¤šæ ¸å¤„ç†å™¨ä¸­ï¼Œå¤šç§ä¸åŒçš„ç°è±¡å…±åŒå½±å“ç€æ€§èƒ½è¡¨ç°ã€‚å…·ä½“è€Œè¨€ï¼Œæ•´ä½“çš„é«˜é€Ÿç¼“å­˜æ€§èƒ½ç”±å•å¤„ç†å™¨çš„<strong>ç¼“å­˜å¤±æ•ˆæµé‡</strong>å’Œ<strong>é€šä¿¡æµé‡</strong>ï¼ˆå¯¼è‡´æ— æ•ˆåŒ–ä»¥åŠåç»­ç¼“å­˜å¤±æ•ˆï¼‰å…±åŒå†³å®šã€‚æ”¹å˜å¤„ç†å™¨çš„æ•°é‡ã€é«˜é€Ÿç¼“å­˜çš„å®¹é‡å’Œå—çš„å¤§å°éƒ½ä¼šå½±å“å¸¦è¿™ä¸¤ç±»å…³äºå¤±æ•ˆç‡çš„è¦ç´ ã€‚</p>
<p>è€Œä¹‹å‰åœ¨è®¡ç»„è¯¾ç¨‹ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“<strong>å•å¤„ç†å™¨</strong>çš„å¤±æ•ˆç‡å¯ä»¥è¢«åˆ†è§£ä¸ºä¸‰ä¸ª<span><span class="heti-spacing"> </span>C</span>ï¼š<strong>å®¹é‡</strong>(capacity)ã€<strong>å¼ºåˆ¶</strong><span>(compulsory)<span class="heti-spacing"> </span></span>å’Œ<strong>å†²çª</strong>(conflict)ã€‚å®ƒä»¬æ—¢æ­ç¤ºäº†åº”ç”¨ç¨‹åºè¡Œä¸ºç‰¹å¾ï¼Œä¹Ÿä¸ºé«˜é€Ÿç¼“å­˜çš„è®¾è®¡ä¼˜åŒ–æä¾›äº†æ–¹å‘ã€‚åŒç†ï¼Œç”±<strong>å¤„ç†å™¨é—´é€šä¿¡</strong>å¼•å‘çš„å¤±æ•ˆï¼ˆé€šå¸¸ç§°ä¸º<strong>ä¸€è‡´æ€§å¤±æ•ˆ</strong>(coherence misses)ï¼‰ä¹Ÿå¯å½’å› äºä¸¤ä¸ªå› ç´ ï¼š</p>
<ul>
<li><strong>çœŸå…±äº«å¤±æ•ˆ</strong>(true sharing misses)ï¼š<ul>
<li>åœ¨åŸºäºæ— æ•ˆçš„åè®®ä¸­ï¼Œå¤„ç†å™¨é¦–æ¬¡å†™å…¥å…±äº«ç¼“å­˜å—æ—¶ä¼šè§¦å‘æ— æ•ˆæ“ä½œï¼Œä»¥ç¡®ç«‹å¯¹è¯¥å—çš„æ‰€æœ‰æƒ</li>
<li>æ­¤å¤–ï¼Œå½“å…¶ä»–å¤„ç†å™¨å°è¯•è¯»å–è¯¥ç¼“å­˜å—ä¸­è¢«ä¿®æ”¹çš„æ•°æ®å­—æ—¶ï¼Œä¼šå‘ç”Ÿå¤±æ•ˆå¹¶å¯¼è‡´ç›¸åº”å—çš„ä¼ è¾“</li>
<li>ä¸Šè¿°ä¸¤ç±»å¤±æ•ˆå‡è¢«å½’ç±»ä¸ºçœŸå…±äº«ç¼ºå¤±ï¼Œå› ä¸ºå®ƒä»¬ç›´æ¥æºäºå¤„ç†å™¨é—´çš„æ•°æ®å…±äº«è¡Œä¸º</li>
</ul>
</li>
<li><strong>ä¼ªå…±äº«å¤±æ•ˆ</strong>(false sharing misses)ï¼š<ul>
<li>åœ¨åŸºäºæ— æ•ˆçš„ä¸€è‡´æ€§ç®—æ³•ä¸­ï¼Œæ¯ä¸ªç¼“å­˜å—ä»…æœ‰ä¸€ä¸ªæœ‰æ•ˆä½ï¼›å½“æŸä¸ªå—å› å…¶ä¸­æŸäº›æ•°æ®å­—è¢«å†™å…¥è€Œè¢«æ— æ•ˆåŒ–ï¼ˆéšåä½¿ç”¨ä¾¿å¼•å‘å¤±æ•ˆï¼‰æ—¶ï¼Œä¾¿ä¼šå‡ºç°äº†ä¼ªå…±äº«</li>
<li>è‹¥æ¥æ”¶æ— æ•ˆåŒ–çš„å¤„ç†å™¨å®é™…ä½¿ç”¨äº†è¢«å†™å…¥çš„å­—ï¼Œåˆ™è¯¥å¼•ç”¨å±äº<strong>çœŸå…±äº«å¼•ç”¨</strong>ï¼Œæ­¤æ—¶æ— è®ºå—æœ‰å¤šå¤§éƒ½ä¼šå¼•å‘å¤±æ•ˆ</li>
<li>ç„¶è€Œï¼Œè‹¥è¢«å†™å…¥å­—ä¸è¯»å–å­—ä¸åŒï¼Œä¸”æ— æ•ˆåŒ–å¹¶æœªä¼ é€’æ–°å€¼ï¼Œä»…é€ æˆé¢å¤–ç¼“å­˜å¤±æ•ˆæ—¶ï¼Œå³ä¸º<strong>ä¼ªå…±äº«å¤±æ•ˆ</strong>ã€‚</li>
<li>æ­¤æ—¶è™½ç„¶å—æ˜¯è¢«å…±äº«çš„ï¼Œä½†é«˜é€Ÿç¼“å­˜ä¸­å¹¶æ— å®é™…å…±äº«çš„æ•°æ®å­—ï¼›è‹¥å—å¤§å°ä¸ºå•ä¸ªå­—æ•°æ®ï¼Œåˆ™æ­¤å¤±æ•ˆä¸ä¼šå‘ç”Ÿã€‚</li>
</ul>
</li>
</ul>
<details class="example">
<summary>ä¾‹å­</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio"/><input id="__tabbed_2_2" name="__tabbed_2" type="radio"/><div class="tabbed-labels"><label for="__tabbed_2_1">é¢˜ç›®</label><label for="__tabbed_2_2">ç­”æ¡ˆ</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/8.png" width="80%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/9.png" width="80%"/>
</div>
</div>
</div>
</div>
</details>
<h3 id="commercial-workload">Commercial Workload<a class="headerlink" href="#commercial-workload" title="Permanent link">âš“ï¸</a></h3>
<p>æœ¬èŠ‚å°†æ¢ç©¶ä¸€å°å››å¤„ç†å™¨å…±äº«å†…å­˜å¤šå¤„ç†æœºä¸Šè¿è¡Œåœ¨çº¿äº‹åŠ¡å¤„ç†<span class="heti-skip"><span class="heti-spacing"> </span>(<span class="heti-spacing"> </span></span><a href="https://en.wikipedia.org/wiki/Online_transaction_processing"><span class="heti-skip"><span class="heti-spacing"> </span>OLTP<span class="heti-spacing"> </span></span></a><span class="heti-skip"><span class="heti-spacing"> </span>)<span class="heti-spacing"> </span></span>å·¥ä½œè´Ÿè½½æ—¶çš„å†…å­˜ç³»ç»Ÿè¡Œä¸ºï¼Œå¹¶é‡ç‚¹åˆ†æå…¶ä¸­é«˜é€Ÿç¼“å­˜çš„æ´»åŠ¨ï¼Œå°¤å…¶æ˜¯<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜çš„è¡Œä¸ºï¼ˆå…¶ä¸­å­˜åœ¨å¤§é‡ä¸ä¸€è‡´æ€§æœºåˆ¶ç›¸å…³çš„æµé‡<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</p>
<p>åœ¨ç ”ç©¶çš„å•†ä¸šåº”ç”¨ä¸­ï¼Œ<span>OLTP<span class="heti-spacing"> </span></span>åº”ç”¨å¯¹å†…å­˜ç³»ç»Ÿçš„å‹åŠ›æœ€å¤§ï¼Œå³ä½¿åœ¨è¯„ä¼°æ—¶ä½¿ç”¨æ›´å¤§çš„<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜ï¼Œä¹Ÿè¡¨ç°å‡ºå¾ˆå¤§çš„æŒ‘æˆ˜ã€‚</p>
<p>é¦–å…ˆæ¥æ¢ç©¶ <strong><span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜å®¹é‡</strong>å˜åŒ–çš„å½±å“ï¼šæ¯ä¸ªå¤„ç†å™¨çš„<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜å®¹é‡ä»<span class="heti-skip"><span class="heti-spacing"> </span>1MiB<span class="heti-spacing"> </span></span>åˆ°<span class="heti-skip"><span class="heti-spacing"> </span>8MiB<span class="heti-spacing"> </span></span>ä¸ç­‰ã€‚ä¸‹å›¾å±•ç¤ºäº†é‡‡ç”¨ä¸¤è·¯ç»„ç›¸è”é«˜é€Ÿç¼“å­˜æ—¶å¢å¤§å®¹é‡çš„æ”¶ç›Šæ•ˆæœï¼š</p>
<div style="text-align: center">
<img src="images/C5/10.png" width="50%"/>
</div>
<p>å¯ä»¥çœ‹åˆ°ï¼Œéšç€å®¹é‡å¢åŠ ï¼Œå¤±æ•ˆç‡é™ä½ï¼Œå› è€Œç¨‹åºæ‰§è¡Œæ—¶é—´ä¹Ÿä¸æ–­å‡å°ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œæ€§èƒ½æå‡å‡ ä¹å…¨éƒ¨é›†ä¸­åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>1MiB -&gt; 2MiB<span class="heti-spacing"> </span></span>çš„é˜¶æ®µï¼Œç»§ç»­æ‰©å®¹ä¸‹å»çš„è¯å´æ”¶æ•ˆç”šå¾®ã€‚ä¸ºäº†ææ¸…æ¥šèƒŒåçš„åŸå› ï¼Œæˆ‘ä»¬éœ€è¦æ˜ç¡®å“ªäº›å› ç´ ä¼šå½±å“<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜çš„å¤±æ•ˆç‡ï¼Œä»¥åŠè¿™äº›å› ç´ å¦‚ä½•éšç€<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜çš„å¢å¤§è€Œå˜åŒ–ã€‚ä¸‹å›¾å‘ˆç°äº†æ¥è‡ªäº”ä¸ªæ¥æºçš„æ¯æ¡æŒ‡ä»¤æ‰€è´¡çŒ®çš„å†…å­˜è®¿é—®å‘¨æœŸæ•°ï¼š</p>
<div style="text-align: center">
<img src="images/C5/11.png" width="50%"/>
</div>
<ul>
<li>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>1MiB<span class="heti-spacing"> </span></span>çš„<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜ä¸‹ï¼Œå½±å“å†…å­˜è®¿é—®å‘¨æœŸçš„ä¸¤å¤§ä¸»è¦å› ç´ æ˜¯æŒ‡ä»¤å¤±æ•ˆå’Œå®¹é‡<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>å†²çªå¤±æ•ˆï¼›è€Œå½“ç¼“å­˜å®¹é‡å¢å¤§æ—¶ï¼Œè¿™ä¸¤ä¸ªå› ç´ çš„å½±å“ä¼šå˜å¾—å¾®ä¸è¶³é“</li>
<li>è€Œå¼ºåˆ¶å¤±æ•ˆã€ä¼ªå…±äº«å¤±æ•ˆåŠçœŸå…±äº«å¤±æ•ˆå‡ ä¹ä¸å—ç¼“å­˜å®¹é‡çš„å½±å“ã€‚å› æ­¤å½“å®¹é‡è¾ƒå¤§æ—¶ï¼Œ<strong>çœŸå…±äº«å¤±æ•ˆ</strong>æ„æˆäº†é«˜é€Ÿç¼“å­˜å¤±æ•ˆçš„ä¸»è¦éƒ¨åˆ†ï¼›ç”±äºçœŸå…±äº«å¤±æ•ˆæ•°é‡ä¿æŒä¸å˜ï¼Œæ‰€ä»¥å½“<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜å®¹é‡çš„æå‡è¶…è¿‡<span class="heti-skip"><span class="heti-spacing"> </span>2MiB<span class="heti-spacing"> </span></span>åï¼Œæ•´ä½“å¤±æ•ˆç‡çš„é™ä½å¹…åº¦æœ‰é™ã€‚</li>
</ul>
<p>ç»¼ä¸Šï¼Œè™½ç„¶å¢å¤§é«˜é€Ÿç¼“å­˜å®¹é‡å¯æ¶ˆé™¤å¤§éƒ¨åˆ†å•å¤„ç†å™¨çš„å¤±æ•ˆï¼Œä½†æ˜¯å¯¹å¤šå¤„ç†å™¨çš„å¤±æ•ˆåˆ™æ²¡æœ‰å¤ªå¤§å½±å“ã€‚</p>
<hr/>
<p>æ¥ä¸‹æ¥å±•ç¤ºçš„æ˜¯<strong>å¢åŠ å¤„ç†å™¨æ•°é‡</strong>å¯¹ä¸åŒç±»å‹å¤±æ•ˆçš„å½±å“ï¼š</p>
<div style="text-align: center">
<img src="images/C5/12.png" width="50%"/>
</div>
<p>ä¸éš¾å‘ç°ï¼ŒçœŸå…±äº«å¤±æ•ˆç‡çš„ä¸Šå‡å¹¶æœªå› å•å¤„ç†å™¨å¤±æ•ˆç‡ä¸‹é™è€Œå¾—åˆ°æŠµæ¶ˆï¼Œæ‰€ä»¥å¯¼è‡´æ¯æ¡æŒ‡ä»¤çš„å†…å­˜è®¿é—®å‘¨æœŸæ•´ä½“å¢åŠ ã€‚</p>
<hr/>
<p>æœ€åè¦æ¢è®¨çš„æ˜¯<strong>å¢åŠ å—å¤§å°</strong>æ˜¯å¦æœ‰åŠ©äºæ”¹å–„æ­¤ç±»å·¥ä½œè´Ÿè½½çš„æ€§èƒ½ã€‚è¿™ä¸€åšæ³•ç†åº”èƒ½é™ä½æŒ‡ä»¤å¤±æ•ˆç‡å’Œå†·å¯åŠ¨å¤±æ•ˆç‡ï¼Œå¹¶åœ¨ä¸€å®šèŒƒå›´å†…å‡å°‘å®¹é‡<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>å†²çªå¤±æ•ˆç‡ï¼Œç”šè‡³å¯èƒ½é™ä½çœŸå®å…±äº«å¤±æ•ˆç‡ã€‚ä¸‹å›¾å±•ç¤ºäº†å½“å—å¤§å°ä»<span class="heti-skip"><span class="heti-spacing"> </span>32B<span class="heti-spacing"> </span></span>å¢è‡³<span class="heti-skip"><span class="heti-spacing"> </span>256B<span class="heti-spacing"> </span></span>æ—¶ï¼Œæ¯åƒæ¡æŒ‡ä»¤çš„å¤±æ•ˆæ¬¡æ•°å˜åŒ–æƒ…å†µï¼š</p>
<div style="text-align: center">
<img src="images/C5/13.png" width="50%"/>
</div>
<ul>
<li>çœŸå…±äº«å¤±æ•ˆç‡é™ä½è‡³åŸæ¥çš„<span class="heti-skip"><span class="heti-spacing"> </span>1/2<span class="heti-spacing"> </span></span>ä»¥ä¸‹ï¼Œè¡¨æ˜çœŸå…±äº«å¤±æ•ˆèƒ½å¤Ÿåˆ©ç”¨å±€éƒ¨æ€§åŸåˆ™å¾—åˆ°ç¼“è§£</li>
<li>å¼ºåˆ¶å¤±æ•ˆç‡ä¹Ÿæ˜¾è‘—ä¸‹é™ï¼Œç¬¦åˆæˆ‘ä»¬çš„é¢„æœŸ</li>
<li>å†²çª<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>å®¹é‡å¤±æ•ˆå‘ˆç°å°å¹…ä¸‹é™ï¼Œè¿™è¡¨æ˜åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œç©ºé—´å±€éƒ¨æ€§çš„ç¨‹åº¦å¹¶ä¸é«˜</li>
<li>ä¼ªå…±äº«å¤±æ•ˆç‡çš„å æ¯”è™½ç„¶è¾ƒå°ï¼Œä½†å‡ ä¹ç¿»äº†ä¸€å€</li>
<li>ä½†æŒ‡ä»¤å¤±æ•ˆç‡æœªå—åˆ°æ˜¾è‘—å½±å“ï¼Œè¿™ä¸€ç»“æœè¶…å‡ºæˆ‘ä»¬çš„é¢„æœŸã€‚<ul>
<li>è‹¥æ˜¯åœ¨æŒ‡ä»¤ç¼“å­˜ä¸­æœ‰å¦‚æ­¤è¡¨ç°ï¼Œæˆ‘ä»¬å¯ä»¥å¾—å‡ºç©ºé—´å±€éƒ¨æ€§ç¨‹åº¦å¾ˆä½çš„ç»“è®º</li>
<li>ä½†åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>ä¸<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>æ··åˆé«˜é€Ÿç¼“å­˜çš„åœºæ™¯ä¸‹ï¼Œè¯¸å¦‚æŒ‡ä»¤<span class="heti-skip"><span class="heti-spacing"> </span>-<span class="heti-spacing"> </span></span>æ•°æ®å†²çªç­‰å…¶ä»–å› ç´ ä¹Ÿå¯èƒ½å¯¼è‡´å¤§å®¹é‡å—æ—¶æŒ‡ä»¤ç¼“å­˜çš„é«˜å¤±æ•ˆç‡</li>
<li>å·²æœ‰ç ”ç©¶è¯å®ï¼Œå¤§å‹æ•°æ®åº“å’Œ<span class="heti-skip"><span class="heti-spacing"> </span>OLTP<span class="heti-spacing"> </span></span>è´Ÿè½½çš„æŒ‡ä»¤æµä¸­å­˜åœ¨è¾ƒä½çš„ç©ºé—´å±€éƒ¨æ€§ç‰¹å¾â€”â€”è¿™ç±»å·¥ä½œè´Ÿè½½åŒ…å«å¤§é‡çŸ­åŸºæœ¬å—å’Œä¸“ç”¨ä»£ç åºåˆ—</li>
<li>
<p>æ ¹æ®è¿™äº›æ•°æ®ï¼Œè¦ä½¿æ›´å¤§å—å¤§å°çš„<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>çš„æ€§èƒ½ä¸<span class="heti-skip"><span class="heti-spacing"> </span>32B<span class="heti-spacing"> </span></span>å¤§å°çš„å—ç›¸å½“ï¼Œå…¶å¤±æ•ˆæŸå¤±å¯è¡¨ç¤ºä¸º<span class="heti-skip"><span class="heti-spacing"> </span>32B<span class="heti-spacing"> </span></span>å—å¤§å°å¤±æ•ˆå€¼çš„å€æ•°</p>
<p></p><div style="text-align: center">
<img src="images/C5/14.png" width="50%"/>
</div>
</li>
</ul>
</li>
</ul>
<h3 id="multiprogramming-and-os-workload">Multiprogramming and OS Workload<a class="headerlink" href="#multiprogramming-and-os-workload" title="Permanent link">âš“ï¸</a></h3>
<p>æ¥ä¸‹æ¥ç ”ç©¶çš„æ˜¯ä¸€ä¸ª<strong>å¤šç¨‹åºåŒ–çš„</strong>å·¥ä½œè´Ÿè½½<span><span class="heti-spacing"> </span>(multiprogrammed workload)</span>ï¼ŒåŒ…å«äº†ç”¨æˆ·æ´»åŠ¨ä¸æ“ä½œç³»ç»Ÿæ´»åŠ¨ã€‚è¿™ç±»å·¥ä½œè´Ÿè½½å‘ˆç°å‡ºä¸‰ä¸ªç‰¹å¾é²œæ˜çš„é˜¶æ®µï¼šé¦–å…ˆæ˜¯åŸºå‡†ç¨‹åºçš„ç¼–è¯‘ï¼ˆæ¶‰åŠå¤§é‡è®¡ç®—æ“ä½œ<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œæ¥ç€æ˜¯å°†ç›®æ ‡æ–‡ä»¶å®‰è£…åˆ°åº“ä¸­ï¼Œæœ€åæ˜¯åˆ é™¤ç›®æ ‡æ–‡ä»¶ã€‚æœ€ç»ˆé˜¶æ®µå®Œå…¨ç”±<span class="heti-skip"><span class="heti-spacing"> </span>I/O<span class="heti-spacing"> </span></span>æ“ä½œä¸»å¯¼ï¼Œä»…æœ‰ä¸¤ä¸ªè¿›ç¨‹ä¿æŒæ´»è·ƒçŠ¶æ€ï¼ˆæ¯ä¸ªè¿è¡Œå®ä¾‹å„ä¸€ä¸ª<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚ä¸­é—´é˜¶æ®µåŒæ ·ä»¥<span class="heti-skip"><span class="heti-spacing"> </span>I/O<span class="heti-spacing"> </span></span>ä¸ºä¸»å¯¼ï¼Œå¤„ç†å™¨åŸºæœ¬å¤„äºç©ºé—²çŠ¶æ€ã€‚æ•´ä½“è€Œè¨€ï¼Œè¯¥å·¥ä½œè´Ÿè½½ç›¸æ¯”<span class="heti-skip"><span class="heti-spacing"> </span>OLTP<span class="heti-spacing"> </span></span>å…·æœ‰æ›´æ˜¾è‘—çš„<strong>ç³»ç»Ÿ</strong>å¯†é›†å‹å’Œ <strong>I/O</strong> å¯†é›†å‹ç‰¹æ€§ã€‚</p>
<p>åç»­å·¥ä½œè´Ÿè½½çš„æµ‹é‡ä¸­ï¼Œæˆ‘ä»¬å‡è®¾é‡‡ç”¨ä»¥ä¸‹å†…å­˜ä¸<span class="heti-skip"><span class="heti-spacing"> </span>I/O<span class="heti-spacing"> </span></span>ç³»ç»Ÿçš„é…ç½®ï¼š</p>
<ul>
<li><span>L1<span class="heti-spacing"> </span></span>æŒ‡ä»¤é«˜é€Ÿç¼“å­˜ï¼š<span>32KB<span class="heti-spacing"> </span></span>å®¹é‡ï¼Œ<span>64B<span class="heti-spacing"> </span></span>å—å¤§å°çš„äºŒè·¯ç»„ç›¸è”ç»“æ„ï¼Œå‘½ä¸­å‘¨æœŸä¸º<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚</li>
<li><span>L1<span class="heti-spacing"> </span></span>æ•°æ®é«˜é€Ÿç¼“å­˜ï¼š<span>32KB<span class="heti-spacing"> </span></span>å®¹é‡ï¼Œ<span>32B<span class="heti-spacing"> </span></span>å—å¤§å°çš„äºŒè·¯ç»„ç›¸è”ç»“æ„ï¼Œå‘½ä¸­å‘¨æœŸä¸º<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚</li>
</ul>
<blockquote>
<p>æ³¨ï¼šä¸ä¾§é‡<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜çš„<span class="heti-skip"><span class="heti-spacing"> </span>OLTP<span class="heti-spacing"> </span></span>è´Ÿè½½ä¸åŒï¼Œæœ¬æ¬¡é‡ç‚¹è€ƒå¯Ÿ<span class="heti-skip"><span class="heti-spacing"> </span>L1<span class="heti-spacing"> </span></span>æ•°æ®é«˜é€Ÿç¼“å­˜çš„è¡Œä¸ºç‰¹å¾ã€‚</p>
</blockquote>
<ul>
<li><span>L2<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜ï¼š<span>1MB<span class="heti-spacing"> </span></span>ç»Ÿä¸€å¼è®¾è®¡ï¼Œ<span>128B<span class="heti-spacing"> </span></span>å—å¤§å°çš„äºŒè·¯ç»„ç›¸è”ç»“æ„ï¼Œå‘½ä¸­éœ€<span class="heti-skip"><span class="heti-spacing"> </span>10<span class="heti-spacing"> </span></span>ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚</li>
<li>ä¸»å­˜ç³»ç»Ÿï¼šå•é€šé“æ€»çº¿æ¶æ„çš„å­˜å‚¨å™¨ï¼Œè®¿é—®æ—¶å»¶ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>100<span class="heti-spacing"> </span></span>ä¸ªæ—¶é’Ÿå‘¨æœŸã€‚</li>
<li>ç¡¬ç›˜ç³»ç»Ÿï¼šå›ºå®šè®¿é—®å»¶è¿Ÿ<span><span class="heti-spacing"> </span>3ms</span>ï¼ˆä½äºå¸¸è§„å€¼ï¼Œä»¥å‡å°‘ç©ºé—²ç­‰å¾…æ—¶é—´<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
</ul>
<p>ä¸‹è¡¨å±•ç¤ºäº†å…«ä¸ªå¤„ç†å™¨åœ¨ä¸Šè¿°å‚æ•°é…ç½®ä¸‹çš„æ‰§è¡Œæ—¶é—´åˆ†å¸ƒæƒ…å†µã€‚</p>
<div style="text-align: center">
<img src="images/C5/15.png" width="70%"/>
</div>
<p>æ‰§è¡Œæ—¶é—´è¢«åˆ†è§£ä¸ºä»¥ä¸‹éƒ¨åˆ†ï¼š</p>
<ul>
<li><strong>ç©ºé—²</strong>(idle)ï¼šåœ¨å†…æ ¸æ¨¡å¼ä¸‹ç©ºé—²å¾ªç¯ä¸­æ‰§è¡Œçš„æ—¶é•¿</li>
<li><strong>ç”¨æˆ·</strong>(user)ï¼šæ‰§è¡Œç”¨æˆ·ä»£ç çš„æ—¶é•¿</li>
<li><strong>åŒæ­¥</strong>(synchronization)ï¼šç”¨äºåŒæ­¥å˜é‡æ“ä½œæˆ–ç­‰å¾…çš„æ—¶é•¿</li>
<li><strong>å†…æ ¸</strong>(kernel)ï¼šåœ¨<span class="heti-skip"><span class="heti-spacing"> </span>OS<span class="heti-spacing"> </span></span>å†…æ—¢éç©ºé—²ä¹ŸéåŒæ­¥è®¿é—®çš„æ‰§è¡Œæ—¶é•¿</li>
</ul>
<h4 id="performance">Performance<a class="headerlink" href="#performance" title="Permanent link">âš“ï¸</a></h4>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬è€ƒå¯Ÿå¤šé“ç¨‹åºçš„å·¥ä½œè´Ÿè½½åœ¨é«˜é€Ÿç¼“å­˜å¤§å°å’Œå—å¤§å°å˜åŒ–æ—¶çš„æ€§èƒ½è¡¨ç°ã€‚ç”±äºå†…æ ¸è¡Œä¸ºä¸ç”¨æˆ·è¿›ç¨‹å­˜åœ¨å·®å¼‚ï¼Œæ‰€ä»¥å°†è¿™ä¸¤éƒ¨åˆ†åˆ†å¼€æ¥åˆ†æã€‚å°½ç®¡ç”¨æˆ·ä»£ç æ‰§è¡Œæ›´å¤šçš„æŒ‡ä»¤ï¼Œä½†æ“ä½œç³»ç»Ÿçš„è¡Œä¸ºå¯èƒ½äº§ç”Ÿæ›´å¤šçš„é«˜é€Ÿç¼“å­˜å¤±æ•ˆï¼Œé™¤äº†ä»£ç ä½“é‡æ›´å¤§ä»¥åŠå±€éƒ¨æ€§ç¼ºä¹å¤–ï¼Œè¿˜æœ‰ä¸¤ä¸ªåŸå› ï¼š</p>
<ul>
<li>å†…æ ¸åœ¨å‘ç”¨æˆ·åˆ†é…å†…å­˜é¡µå‰ä¼šåˆå§‹åŒ–æ‰€æœ‰çš„é¡µï¼Œè¿™æ˜¾è‘—å¢åŠ äº†å…¶å¼ºåˆ¶æ€§å¤±æ•ˆçš„æ¯”ä¾‹ã€‚</li>
<li>å†…æ ¸å®é™…å­˜åœ¨æ•°æ®å…±äº«çš„ç°è±¡ï¼Œå› è€Œä¼šäº§ç”Ÿå¯è§‚çš„ä¸€è‡´æ€§å¤±æ•ˆï¼›ç›¸æ¯”ä¹‹ä¸‹ï¼Œç”¨æˆ·è¿›ç¨‹ä»…åœ¨è¢«è°ƒåº¦åˆ°ä¸åŒå¤„ç†å™¨æ—¶æ‰ä¼šå¼•å‘ä¸€è‡´æ€§å¤±æ•ˆé—®é¢˜ï¼Œä¸”æ¯”ä¾‹æä½ã€‚</li>
</ul>
<p>ä¸‹é¢ä¸¤å¼ å›¾åˆ†åˆ«å±•ç¤ºäº†å†…æ ¸ä¸ç”¨æˆ·çš„æ•°æ®å¤±æ•ˆç‡éšæ•°æ®é«˜é€Ÿç¼“å­˜å®¹é‡åŠå—å¤§å°çš„å˜åŒ–å…³ç³»ï¼š</p>
<div style="text-align: center">
<img src="images/C5/16.png" width="80%"/>
</div>
<ul>
<li>å¯ä»¥çœ‹åˆ°ï¼Œå¢å¤§æ•°æ®é«˜é€Ÿç¼“å­˜å®¹é‡å¯¹ç”¨æˆ·å¤±æ•ˆç‡çš„å½±å“æ˜¾è‘—é«˜äºå¯¹å†…æ ¸å¤±æ•ˆç‡çš„å½±å“</li>
<li>è€Œå¢åŠ å—å¤§å°åˆ™èƒ½åŒæ—¶æ”¹å–„ä¸¤è€…çš„å¤±æ•ˆé—®é¢˜</li>
<li>è¿™æ˜¯å› ä¸ºè¾ƒå¤§æ¯”ä¾‹çš„å¤±æ•ˆæºè‡ªå¼ºåˆ¶æ€§å¤±æ•ˆå’Œå®¹é‡æ€§å¤±æ•ˆâ€”â€”è¿™ä¸¤ç±»é—®é¢˜å‡å¯é€šè¿‡é‡‡ç”¨æ›´å¤§çš„å—æ¥ç¼“è§£</li>
<li>ç”±äºä¸€è‡´æ€§å¤±æ•ˆç›¸å¯¹ç½•è§ï¼Œå¢å¤§å—å°ºå¯¸å¸¦æ¥çš„è´Ÿé¢å½±å“è¾ƒå°ã€‚</li>
</ul>
<p>ä¸ºäº†ç†è§£å†…æ ¸è¿›ç¨‹ä¸ç”¨æˆ·è¿›ç¨‹è¡¨ç°å·®å¼‚çš„åŸå› ï¼Œæˆ‘ä»¬éœ€è¦è¿›ä¸€æ­¥åˆ†æå†…æ ¸å¤±æ•ˆçš„è¡Œä¸ºç‰¹å¾ã€‚ä¸‹å›¾å±•ç¤ºäº†å†…æ ¸å¤±æ•ˆç‡éšé«˜é€Ÿç¼“å­˜å®¹é‡å’Œå—å¤§å°å¢åŠ çš„å˜åŒ–æƒ…å†µï¼š</p>
<div style="text-align: center">
<img src="images/C5/17.png" width="70%"/>
</div>
<ul>
<li>
<p>å›¾è¡¨å°†å¤±æ•ˆé—®é¢˜åˆ’åˆ†æˆä¸‰ç±»ï¼š</p>
<ul>
<li>å¼ºåˆ¶æ€§å¤±æ•ˆ</li>
<li>ä¸€è‡´æ€§å¤±æ•ˆï¼šåŒ…æ‹¬çœŸå…±äº«ä¸ä¼ªå…±äº«</li>
<li>å®¹é‡<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>å†²çªæ€§å¤±æ•ˆï¼šå«æ“ä½œç³»ç»Ÿä¸ç”¨æˆ·è¿›ç¨‹é—´ã€å¤šç”¨æˆ·è¿›ç¨‹é—´å¹²æ‰°å¼•å‘çš„å¤±æ•ˆ</li>
</ul>
</li>
<li>
<p>å¢å¤§é«˜é€Ÿç¼“å­˜å®¹é‡ä»…èƒ½é™ä½å•å¤„ç†å™¨ç¯å¢ƒä¸‹çš„å®¹é‡<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>å†²çªæ€§å¤±æ•ˆç‡</p>
</li>
<li>è€Œå¢å¤§å—å°ºå¯¸åˆ™æœ‰æ•ˆå‡å°‘äº†å¼ºåˆ¶æ€§å¤±æ•ˆç‡</li>
<li>éšç€å—å°ºå¯¸çš„å¢åŠ ï¼Œä¸€è‡´æ€§ç¼ºå¤±ç‡å¹¶æœªå‡ºç°æ˜¾è‘—ä¸Šå‡ï¼Œè¿™è¡¨æ˜ä¼ªå…±äº«çš„å½±å“å¯èƒ½å¾®ä¹å…¶å¾®</li>
</ul>
<hr/>
<ul>
<li>å¯¹äºå¤šé“ç¨‹åºçš„å·¥ä½œè´Ÿè½½è€Œè¨€ï¼Œ<strong>æ“ä½œç³»ç»Ÿ</strong>å¯¹å†…å­˜ç³»ç»Ÿçš„éœ€æ±‚æ›´ä¸ºä¸¥è‹›ã€‚</li>
<li>è‹¥å·¥ä½œè´Ÿè½½ä¸­åŒ…å«æ›´å¤šæ“ä½œç³»ç»Ÿæˆ–ç±»æ“ä½œç³»ç»Ÿçš„æ´»åŠ¨ï¼Œä¸”å…¶è¡Œä¸ºç‰¹å¾ä¸æœ¬ç ”ç©¶æ‰€æµ‹çš„æƒ…å½¢ç›¸ä¼¼ï¼Œé‚£ä¹ˆæ„å»ºæ€§èƒ½è¶³å¤Ÿå¼ºå¤§çš„å†…å­˜ç³»ç»Ÿå°†å˜å¾—å¼‚å¸¸å›°éš¾ã€‚</li>
<li>æå‡æ€§èƒ½çš„æ½œåœ¨é€”å¾„ä¹‹ä¸€æ˜¯é€šè¿‡æ”¹è¿›<strong>ç¼–ç¨‹ç¯å¢ƒ</strong>æˆ–å€ŸåŠ©<strong>ç¨‹åºå‘˜</strong>è¾…åŠ©æ‰‹æ®µï¼Œä½¿æ“ä½œç³»ç»Ÿæ›´å…·é«˜é€Ÿç¼“å­˜æ„ŸçŸ¥èƒ½åŠ›ã€‚<ul>
<li>ä¾‹å¦‚ï¼Œæ“ä½œç³»ç»Ÿä¼šä¸ºä¸åŒç³»ç»Ÿè°ƒç”¨äº§ç”Ÿçš„è¯·æ±‚å¤ç”¨ç›¸åŒçš„å†…å­˜åŒºåŸŸã€‚å°½ç®¡è¿™äº›è¢«å¤ç”¨çš„å†…å­˜å°†è¢«å®Œå…¨è¦†å†™ï¼Œä½†ç¡¬ä»¶å› æ— æ³•è¯†åˆ«è¿™ä¸€ç‰¹æ€§ä»ä¼šç»´æŒç¼“å­˜ä¸€è‡´æ€§æœºåˆ¶è¿è¡Œï¼Œç”šè‡³å¯èƒ½å°è¯•è¯»å–å·²å¤±æ•ˆçš„é«˜é€Ÿç¼“å­˜å—æ•°æ®æ®µã€‚</li>
</ul>
</li>
</ul>
<h2 id="distributed-shared-memory-and-directory-based-coherence">Distributed Shared-Memory and Directory-Based Coherence<a class="headerlink" href="#distributed-shared-memory-and-directory-based-coherence" title="Permanent link">âš“ï¸</a></h2>
<p>å‰é¢ä»‹ç»çš„ç›‘å¬åè®®è¦æ±‚æ¯æ¬¡é«˜é€Ÿç¼“å­˜å¤±æ•ˆæ—¶ï¼Œè¦å’Œå…¶ä»–æ‰€æœ‰çš„é«˜é€Ÿç¼“å­˜è¿›è¡Œé€šä¿¡ã€‚è¿™ç§ä¸ç”¨é›†ä¸­å¼çš„æ•°æ®ç»“æ„æ¥è¿½è¸ªé«˜é€Ÿç¼“å­˜çŠ¶æ€çš„ç‰¹æ€§ï¼Œæ—¢æ˜¯ç›‘å¬æ–¹æ¡ˆçš„ä¼˜åŠ¿ï¼ˆå®ç°æˆæœ¬ä½å»‰<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œä¹Ÿæ˜¯å®ƒçš„è‡´å‘½å¼±ç‚¹ï¼Œå› ä¸ºè¿™ä½¿å¾—å®ƒçš„å¯æ‰©å±•æ€§<span class="heti-skip"><span class="heti-spacing"> </span>(scalability)<span class="heti-spacing"> </span></span>å¾ˆå·®ã€‚</p>
<p>è¿‘å¹´æ¥ï¼Œå¤šæ ¸å¤„ç†å™¨çš„å‘å±•è¿«ä½¿æ‰€æœ‰è®¾è®¡è€…è½¬å‘<strong>åˆ†å¸ƒå¼å†…å­˜</strong>(distributed memory)ï¼Œä»¥æ»¡è¶³å„å¤„ç†å™¨å¯¹å¸¦å®½çš„éœ€æ±‚ã€‚è¿™ç§å†…å­˜ç»„ç»‡èƒ½å¤Ÿæå‡å†…å­˜å¸¦å®½å’Œäº’è¿å¸¦å®½ï¼Œå› ä¸ºå®ƒèƒ½å°†æœ¬åœ°å†…å­˜æµé‡ä¸è¿œç¨‹å†…å­˜æµé‡åˆ†ç¦»ï¼Œä»è€Œé™ä½äº†å¯¹å†…å­˜ç³»ç»Ÿå’Œäº’è¿ç½‘ç»œçš„å¸¦å®½éœ€æ±‚ã€‚ç„¶è€Œï¼Œè‹¥æ— æ³•æ¶ˆé™¤é«˜é€Ÿç¼“å­˜å¤±æ•ˆæ—¶æ‰§è¡Œä¸€è‡´æ€§åè®®çš„å¹¿æ’­æ“ä½œï¼Œé‚£ä¹ˆåˆ†å¸ƒå¼å†…å­˜æ‰€å¸¦æ¥çš„æ”¶ç›Šå°†æä¸ºæœ‰é™ã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬è¿˜æåˆ°è¿‡ç›‘å¬åè®®çš„æ›¿ä»£æ–¹æ¡ˆâ€”â€”<strong>ç›®å½•åè®®</strong>(directory protocol)ã€‚</p>
<ul>
<li>ç›®å½•ä¼šè®°å½•æ¯ä¸ªå¯èƒ½è¢«ç¼“å­˜çš„å—çš„çŠ¶æ€ä¿¡æ¯ï¼ŒåŒ…æ‹¬å“ªäº›é«˜é€Ÿç¼“å­˜ï¼ˆæˆ–é«˜é€Ÿç¼“å­˜ç»„ï¼‰æ‹¥æœ‰è¯¥å—çš„å‰¯æœ¬ã€æ•°æ®æ˜¯å¦æ˜¯è„çš„ï¼ˆå·²è¢«ä¿®æ”¹ï¼‰ç­‰</li>
<li>åœ¨å…±äº«æœ€å¤–å±‚ç¼“å­˜ï¼ˆL3ï¼‰çš„å¤šæ ¸å¤„ç†å™¨ä¸­ï¼Œå®ç°ç›®å½•æœºåˆ¶éå¸¸ç®€å•ï¼šåªéœ€ä¸ºæ¯ä¸ª<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜å—ç»´æŠ¤ä¸€ä¸ªä¸æ ¸å¿ƒæ•°é‡ç­‰é•¿çš„<strong>ä½å‘é‡</strong>å³å¯<ul>
<li>è¯¥ä½å‘é‡èƒ½æ ‡è¯†å‡ºå“ªäº›ç§æœ‰<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜å¯èƒ½æŒæœ‰<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜ä¸­çš„å¯¹åº”å—å‰¯æœ¬ï¼Œè¿™æ ·å¤±æ•ˆè¯·æ±‚ä»…éœ€å‘é€è‡³è¿™äº›ç‰¹å®šçš„é«˜é€Ÿç¼“å­˜å³å¯</li>
<li>å½“<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é‡‡ç”¨åŒ…å®¹æ€§è®¾è®¡æ—¶ï¼Œè¿™ç§æœºåˆ¶åœ¨å•ä¸ªå¤šæ ¸èŠ¯ç‰‡ä¸Šèƒ½å®Œç¾è¿ä½œ</li>
</ul>
</li>
<li>
<p>å¤šæ ¸ç³»ç»Ÿä¸­ï¼Œé‡‡ç”¨å•ä¸ªç›®å½•çš„è§£å†³æ–¹æ¡ˆä¸å…·å¤‡å¯æ‰©å±•æ€§ï¼Œå³ä¾¿è¿™é¿å…äº†å¹¿æ’­æ“ä½œã€‚æ‰€ä»¥æˆ‘ä»¬å¿…é¡»è®¾ç½®<strong>åˆ†å¸ƒå¼çš„ç›®å½•</strong>ï¼Œä½†åˆ†å¸ƒæ–¹å¼éœ€ç¡®ä¿ä¸€è‡´æ€§åè®®èƒ½å®šä½åˆ°ä»»æ„ç¼“å­˜å†…å­˜å—çš„ç›®å½•ä¿¡æ¯ã€‚</p>
<ul>
<li>å®¹æ˜“æƒ³åˆ°çš„ä¸€ç§è§£å†³æ–¹æ³•æ˜¯è®©ç›®å½•éšå†…å­˜å•å…ƒåˆ†å¸ƒâ€”â€”æ­£å¦‚ä¸åŒå†…å­˜è¯·æ±‚æŒ‡å‘ä¸åŒå†…å­˜é‚£æ ·ï¼Œä¸åŒçš„ä¸€è‡´æ€§è¯·æ±‚ä¹Ÿèƒ½è®¿é—®åˆ°ä¸åŒçš„åˆ†å¸ƒå¼ç›®å½•ã€‚</li>
<li>è‹¥å°†ä¿¡æ¯ç»´æŠ¤åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>L3<span class="heti-spacing"> </span></span>é«˜é€Ÿç¼“å­˜ç­‰å¤šåˆ†åŒºçš„å¤–å±‚é«˜é€Ÿç¼“å­˜ä¸­ï¼Œåˆ™å¯å°†ç›®å½•ä¿¡æ¯åˆ†æ•£åˆ°å„ä¸ªé«˜é€Ÿç¼“å­˜åˆ†åŒºé—´ï¼Œä»è€Œæœ‰æ•ˆæå‡å¸¦å®½åˆ©ç”¨ç‡ã€‚</li>
</ul>
</li>
<li>
<p>åˆ†å¸ƒå¼ç›®å½•å…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼šä¸€ä¸ªå—çš„å…±äº«çŠ¶æ€å§‹ç»ˆä½äºå•ä¸ªçš„å·²çŸ¥ä½ç½®ã€‚è¿™ä¸€æ€§è´¨ç»“åˆäº†ç»´æŠ¤èŠ‚ç‚¹ç¼“å­˜å—çš„ä¿¡æ¯ï¼Œä½¿å¾—ä¸€è‡´æ€§åè®®èƒ½å¤Ÿé¿å…å¹¿æ’­æ“ä½œã€‚</p>
</li>
<li>
<p>ä¸‹å›¾å±•ç¤ºäº†æ·»åŠ ç›®å½•è‡³æ¯ä¸ª<strong>èŠ‚ç‚¹</strong>ï¼ˆå•ä¸ªå¤šæ ¸å¤„ç†å™¨ï¼Œæˆ–åœ¨å†…éƒ¨å®ç°ä¸€è‡´æ€§çš„å°å‹å¤„ç†å™¨é›†åˆï¼‰åï¼Œåˆ†å¸ƒå¼å†…å­˜å¤šå¤„ç†å™¨ç»“æ„çš„ç¤ºæ„å›¾ï¼š</p>
<p></p><div style="text-align: center">
<img src="images/C5/18.png" width="80%"/>
</div>
</li>
<li>
<p>æœ€ç®€å•çš„ç›®å½•å®ç°æ–¹å¼æ˜¯ï¼šä¸ºæ¯ä¸ªå†…å­˜å—åœ¨ç›®å½•ä¸­å…³è”ä¸€ä¸ªæ¡ç›®ã€‚</p>
<ul>
<li>æ­¤æ—¶ä¿¡æ¯æ€»é‡ä¸â€œå†…å­˜å—çš„æ•°é‡<span class="heti-skip"><span class="heti-spacing"> </span>*<span class="heti-spacing"> </span></span>èŠ‚ç‚¹æ•°é‡â€çš„ç»“æœæˆæ­£æ¯”</li>
<li>å¯¹äºä¸è¶…è¿‡æ•°ç™¾ä¸ªå¤„ç†å™¨ï¼ˆæ¯ä¸ªå¯èƒ½æ˜¯å¤šæ ¸ï¼‰çš„å¤šå¤„ç†å™¨è€Œè¨€ï¼Œè¿™ç§å¼€é”€åœ¨åˆç†å—å¤§å°è®¾ç½®ä¸‹æ˜¯å¯æ¥å—çš„</li>
<li>è€Œå¯¹äºæ›´å¤§è§„æ¨¡çš„å¤šå¤„ç†å™¨ç³»ç»Ÿï¼Œåˆ™éœ€è¦é‡‡ç”¨èƒ½é«˜æ•ˆæ‰©å±•ç›®å½•ç»“æ„çš„æ–¹æ³•ï¼Œä¸è¿‡æˆ‘ä»¬æ— éœ€è€ƒè™‘è¿™ç§æƒ…å†µ</li>
</ul>
</li>
</ul>
<h3 id="directory-based-cache-coherence-protocols">Directory-Based Cache Coherence Protocols<a class="headerlink" href="#directory-based-cache-coherence-protocols" title="Permanent link">âš“ï¸</a></h3>
<p>ç›®å½•åè®®å¿…é¡»å®ç°ä¸¤ä¸ªæ ¸å¿ƒæ“ä½œï¼šå¤„ç†<strong>è¯»å¤±æ•ˆ</strong>å’Œå¤„ç†å¯¹å…±äº«ä¸”å¹²å‡€çš„é«˜é€Ÿç¼“å­˜å—çš„<strong>å†™å…¥</strong>ã€‚</p>
<p>ä¸ºå®ç°è¿™äº›åŠŸèƒ½ï¼Œç›®å½•éœ€è¦è¿½è¸ªæ¯ä¸ªé«˜é€Ÿç¼“å­˜å—çš„çŠ¶æ€ã€‚å…·ä½“æœ‰ä»¥ä¸‹å‡ ç±»çŠ¶æ€ï¼š</p>
<ul>
<li><strong>å…±äº«</strong>ï¼šä¸€ä¸ªæˆ–å¤šä¸ªèŠ‚ç‚¹ç¼“å­˜äº†è¯¥æ•°æ®å—ï¼Œä¸”å†…å­˜ä¸­çš„æ•°å€¼ä¸æ‰€æœ‰ç¼“å­˜å‰¯æœ¬ä¿æŒåŒæ­¥æ›´æ–°</li>
<li><strong>æœªç¼“å­˜</strong>(uncached)ï¼šæ²¡æœ‰ä»»ä½•èŠ‚ç‚¹æŒæœ‰è¯¥ç¼“å­˜å—çš„å‰¯æœ¬</li>
<li><strong>å·²ä¿®æ”¹</strong>(modified)ï¼šåªæœ‰ä¸€ä¸ªèŠ‚ç‚¹æŒæœ‰è¯¥æ•°æ®å—å‰¯æœ¬ï¼Œä¸”å·²æ‰§è¡Œè¿‡å†™æ“ä½œï¼Œå› æ­¤å†…å­˜ä¸­çš„å¯¹åº”å‰¯æœ¬å¤±æ•ˆï¼›æ­¤æ—¶è¯¥å¤„ç†å™¨è¢«ç§°ä¸ºæ­¤æ•°æ®å—çš„<strong>æ‰€æœ‰è€…</strong>(owner)</li>
</ul>
<p>é™¤äº†è·Ÿè¸ªçŠ¶æ€å¤–ï¼Œè¿˜éœ€è¦è®°å½•å“ªäº›èŠ‚ç‚¹æ‹¥æœ‰<strong>å†…å­˜å—çš„å‰¯æœ¬</strong>ï¼Œå› ä¸ºåœ¨å†™å…¥æ—¶éœ€è¦ä½¿è¿™äº›å‰¯æœ¬å¤±æ•ˆã€‚å®ç°è¿™ä¸€åŠŸèƒ½çš„æœ€ç®€å•æ–¹æ³•æ˜¯ä¸ºæ¯ä¸ªå†…å­˜å—ç»´æŠ¤ä¸€ä¸ª<strong>ä½å‘é‡</strong>ã€‚å½“å†…å­˜å—å¤„äºå…±äº«çŠ¶æ€æ—¶ï¼Œå‘é‡çš„æ¯ä¸€ä½è¡¨ç¤ºå¯¹åº”çš„å¤„ç†å™¨èŠ¯ç‰‡æ˜¯å¦æŒæœ‰è¯¥å—çš„å‰¯æœ¬ã€‚å½“å†…å­˜å—å¤„äºç‹¬å çŠ¶æ€æ—¶ï¼Œæˆ‘ä»¬åŒæ ·å¯ä»¥åˆ©ç”¨è¿™ä¸ªä½å‘é‡æ¥è¿½è¸ªå…¶æ‰€æœ‰è€…ã€‚</p>
<p>å‡ºäºæ•ˆç‡è€ƒè™‘ï¼Œè¿˜ä¼šåœ¨å„çº§é«˜é€Ÿç¼“å­˜ä¸­å•ç‹¬è®°å½•æ¯ä¸ªé«˜é€Ÿç¼“å­˜å—çš„çŠ¶æ€ã€‚</p>
<p>å°½ç®¡çŠ¶æ€è½¬æ¢æ—¶çš„å…·ä½“æ“ä½œç•¥æœ‰å·®å¼‚ï¼Œä½†å„é«˜é€Ÿç¼“å­˜ä¸­<strong>çŠ¶æ€æœº</strong>çš„çŠ¶æ€ä¸è½¬æ¢æœºåˆ¶ä¸ä¹‹å‰é‡‡ç”¨çš„ç›‘å¬å¼é«˜é€Ÿç¼“å­˜æ–¹æ¡ˆå®Œå…¨ä¸€è‡´ã€‚</p>
<p>è€Œæ•°æ®é¡¹çš„<strong>æ— æ•ˆåŒ–</strong>å¤„ç†åŠ<strong>ç‹¬å å‰¯æœ¬çš„å®šä½</strong>æ“ä½œåˆ™å­˜åœ¨æ˜¾è‘—åŒºåˆ«ï¼šè¿™ä¸¤ç§æ“ä½œéƒ½éœ€è¦è¯·æ±‚èŠ‚ç‚¹ä¸ç›®å½•ä¹‹é—´ã€ç›®å½•ä¸ä¸€ä¸ªæˆ–å¤šä¸ªè¿œç¨‹èŠ‚ç‚¹ä¹‹é—´è¿›è¡Œé€šä¿¡ï¼›è€Œåœ¨ç›‘å¬åè®®ä¸­ï¼Œè¿™ä¸¤ä¸ªæ­¥éª¤æ˜¯é€šè¿‡å‘æ‰€æœ‰èŠ‚ç‚¹å¹¿æ’­ä¸€èµ·å®Œæˆçš„ã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºäº†èŠ‚ç‚¹é—´ä¼ é€’çš„å„ç±»æ¶ˆæ¯ï¼š</p>
<div style="text-align: center">
<img src="images/C5/19.png" width="90%"/>
</div>
<ul>
<li><strong>æœ¬åœ°èŠ‚ç‚¹</strong><span>(local node)<span class="heti-spacing"> </span></span>æ˜¯å‘èµ·è¯·æ±‚çš„èŠ‚ç‚¹ï¼Œ<strong>å®¶èŠ‚ç‚¹</strong><span>(home node)<span class="heti-spacing"> </span></span>åˆ™æ˜¯å­˜å‚¨ç€ç›®æ ‡åœ°å€å¯¹åº”å†…å­˜ä½ç½®åŠç›®å½•æ¡ç›®çš„èŠ‚ç‚¹ã€‚</li>
<li>ç‰©ç†åœ°å€ç©ºé—´é‡‡ç”¨é™æ€åˆ†å¸ƒæ–¹å¼ï¼Œå› æ­¤æ€»èƒ½ç¡®å®šå“ªä¸ªèŠ‚ç‚¹å­˜æœ‰ç‰¹å®šçš„ç‰©ç†åœ°å€çš„å†…å­˜å’Œç›®å½•ä¿¡æ¯ï¼ˆä¾‹å¦‚é«˜ä½æ¯”ç‰¹å¯è¡¨ç¤ºèŠ‚ç‚¹ç¼–å·ï¼Œä½ä½æ¯”ç‰¹åˆ™è¡¨ç¤ºè¯¥èŠ‚ç‚¹å†…å­˜ä¸­çš„åç§»é‡<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
<li>å½“å®¶èŠ‚ç‚¹åŒæ—¶ä½œä¸ºæœ¬åœ°èŠ‚ç‚¹æ—¶ä»éœ€è®¿é—®ç›®å½•ï¼Œå› ä¸ºæ•°æ®å‰¯æœ¬å¯èƒ½å­˜åœ¨äºè¢«ç§°ä¸º<strong>è¿œç¨‹èŠ‚ç‚¹</strong><span>(remote node)<span class="heti-spacing"> </span></span>çš„ç¬¬ä¸‰æ–¹èŠ‚ç‚¹ä¸­ã€‚<ul>
<li><strong>è¿œç¨‹èŠ‚ç‚¹</strong>æ˜¯æ‹¥æœ‰é«˜é€Ÿç¼“å­˜å—å‰¯æœ¬çš„èŠ‚ç‚¹ï¼ˆæ— è®ºè¯¥å‰¯æœ¬å¤„åœ¨ç‹¬å çŠ¶æ€è¿˜æ˜¯å…±äº«çŠ¶æ€<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
<li>è¿œç¨‹èŠ‚ç‚¹å¯èƒ½ä¸æœ¬åœ°èŠ‚ç‚¹æˆ–å®¶èŠ‚ç‚¹ç›¸åŒï¼Œæ­¤æ—¶å¤„ç†å™¨é—´æ¶ˆæ¯å¯æ›¿æ¢ä¸ºå¤„ç†å™¨å†…æ¶ˆæ¯ï¼Œå…¶ä»–æœºåˆ¶ä¿æŒä¸å˜</li>
</ul>
</li>
</ul>
<h3 id="an-example-directory-protocol">An Example Directory Protocol<a class="headerlink" href="#an-example-directory-protocol" title="Permanent link">âš“ï¸</a></h3>
<p>ä¸‹å›¾å±•ç¤ºäº†åœ¨åŸºäºç›®å½•çš„ç³»ç»Ÿä¸­ï¼Œå•ä¸ªé«˜é€Ÿç¼“å­˜çš„çŠ¶æ€è½¬æ¢å›¾ï¼š</p>
<div style="text-align: center">
<img src="images/C5/20.png" width="70%"/>
</div>
<ul>
<li>è¿™å¼ çŠ¶æ€è½¬æ¢å›¾æ“ä½œä¸ç›‘å¬æ–¹æ¡ˆåŸºæœ¬ä¸€è‡´ï¼šçŠ¶æ€å’Œè§¦å‘æ¡ä»¶è¿‘ä¹ç›¸åŒã€‚</li>
<li>ä¸åŒä¹‹å¤„æ˜¯ï¼šç›‘å¬æœºåˆ¶é€šè¿‡æ€»çº¿ï¼ˆæˆ–å…¶ä»–ç½‘ç»œï¼‰å¹¿æ’­å†™æ— æ•ˆæ“ä½œï¼Œè€Œåœ¨è¿™é‡Œæˆ‘ä»¬é€šè¿‡ç›®å½•æ§åˆ¶å™¨ï¼Œé€‰æ‹©æ€§åœ°å‘é€æ•°æ®è·å–ä¸æ— æ•ˆåŒ–æ“ä½œã€‚</li>
<li>ä»»ä½•é«˜é€Ÿç¼“å­˜å—åœ¨å†™å…¥æ—¶å¿…é¡»å¤„äºç‹¬å çŠ¶æ€ï¼Œä¸”æ‰€æœ‰å…±äº«å—å¿…é¡»åœ¨å†…å­˜ä¸­ä¿æŒæœ€æ–°å€¼ã€‚</li>
<li>å¤§å¤šæ•°å¤šæ ¸å¤„ç†å™¨ä¸­ï¼Œæœ€å¤–å±‚çš„é«˜é€Ÿç¼“å­˜ç”±å„æ ¸å¿ƒå…±äº«ï¼Œé€šè¿‡å†…éƒ¨ç›®å½•æˆ–ç›‘å¬æœºåˆ¶æ¥ç»´æŠ¤åŒä¸€èŠ¯ç‰‡ä¸Šå„æ ¸å¿ƒç§æœ‰é«˜é€Ÿç¼“å­˜çš„ä¸€è‡´æ€§ã€‚å› æ­¤åªéœ€æ¥å…¥æœ€å¤–å±‚çš„å…±äº«é«˜é€Ÿç¼“å­˜ï¼Œä¾¿å¯åˆ©ç”¨èŠ¯ç‰‡ä¸Šå¤šæ ¸ä¸€è‡´æ€§æœºåˆ¶æ‰©å±•è‡³æ›´åºå¤§çš„å¤„ç†å™¨ï¼›è€Œä¸”æ­¤æ—¶å¤„ç†å™¨ä¸ä¸€è‡´æ€§è¯·æ±‚çš„ç«äº‰é—®é¢˜å¾—ä»¥ç¼“è§£ï¼ŒåŒæ—¶å¯é¿å…æ ‡ç­¾ä½çš„é‡å¤ã€‚</li>
</ul>
<p>åœ¨åŸºäºç›®å½•çš„åè®®ä¸­ï¼Œå‘é€è‡³ç›®å½•çš„æ¶ˆæ¯ä¼šè§¦å‘ä¸¤ç§ä¸åŒç±»å‹çš„æ“ä½œï¼š<strong>æ›´æ–°ç›®å½•çŠ¶æ€</strong>ï¼Œä»¥åŠ<strong>å‘é€é™„åŠ æ¶ˆæ¯ä»¥æ»¡è¶³è¯·æ±‚</strong>ã€‚ç›®å½•ä¸­çš„çŠ¶æ€è¡¨ç¤ºçš„æ˜¯å†…å­˜å—ä¸­ä¸‰ç§æ ‡å‡†çŠ¶æ€ï¼›ä½†å’Œç›‘å¬å¼æ–¹æ¡ˆä¸åŒçš„æ˜¯ï¼Œè¿™é‡Œçš„ç›®å½•çŠ¶æ€åæ˜ çš„æ˜¯æ‰€æœ‰é«˜é€Ÿç¼“å­˜å‰¯æœ¬çš„æ•´ä½“çŠ¶å†µï¼Œè€Œéå•ä¸ªå—çš„çŠ¶æ€ã€‚</p>
<p>ä¸ºäº†è¿½è¸ªæŒæœ‰é«˜é€Ÿç¼“å­˜å—å‰¯æœ¬çš„èŠ‚ç‚¹é›†åˆï¼Œæˆ‘ä»¬ä½¿ç”¨åä¸º<strong>å…±äº«è€…</strong><span>(Sharers)<span class="heti-spacing"> </span></span>çš„ä½å‘é‡æ¥å®ç°è¿™ä¸€åŠŸèƒ½ã€‚ç›®å½•è¯·æ±‚éœ€è¦æ›´æ–°å…±äº«è€…ï¼Œå¹¶é€šè¿‡è¯»å–è¯¥é›†åˆæ‰§è¡Œæ— æ•ˆåŒ–æ“ä½œã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºäº†ç›®å½•èŠ‚ç‚¹åœ¨æ¥æ”¶æ¶ˆæ¯åé‡‡å–çš„æ“ä½œï¼ˆçŠ¶æ€å›¾ç»“æ„å’Œä¸Šå›¾ä¸€è‡´<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼š</p>
<div style="text-align: center">
<img src="images/C5/21.png" width="70%"/>
</div>
<p>è¯¥ç›®å½•ä¼šå¤„ç†ä¸‰ç§ä¸åŒç±»å‹çš„è¯·æ±‚ï¼š<strong>è¯»å¤±æ•ˆ</strong>(read miss)ã€<strong>å†™æ— æ•ˆ</strong><span>(write miss)<span class="heti-spacing"> </span></span>ä»¥åŠ<strong>æ•°æ®å†™å›</strong>(data write-back)ã€‚</p>
<p>ä¸ºäº†ç†è§£è¿™äº›ç›®å½•æ“ä½œçš„æœºåˆ¶ï¼Œä¸‹é¢æˆ‘ä»¬é€æ­¥åˆ†æå„çŠ¶æ€ä¸‹æ”¶åˆ°çš„è¯·æ±‚åŠæ‰§è¡Œçš„æ“ä½œã€‚</p>
<ul>
<li>
<p>å½“æŸä¸ªå—å¤„äº<strong>æœªç¼“å­˜</strong>çŠ¶æ€æ—¶ï¼Œå†…å­˜ä¸­çš„å‰¯æœ¬å³ä¸ºå½“å‰æœ‰æ•ˆå€¼ï¼Œå› æ­¤å¯èƒ½å‡ºç°ä»¥ä¸‹è¯·æ±‚ç±»å‹ï¼š</p>
<ul>
<li><strong>è¯»å¤±æ•ˆ</strong>ï¼šè¯·æ±‚èŠ‚ç‚¹ä»å†…å­˜ä¸­è·å–æ‰€è¯·æ±‚çš„æ•°æ®ï¼Œä¸”è¯¥è¯·æ±‚è€…æˆä¸ºå”¯ä¸€çš„å…±äº«èŠ‚ç‚¹ï¼›æ­¤æ—¶è¯¥æ•°æ®å—çš„çŠ¶æ€è¢«è®¾ä¸ºå…±äº«çŠ¶æ€ã€‚</li>
<li><strong>å†™æ— æ•ˆ</strong>ï¼šè¯·æ±‚èŠ‚ç‚¹æ¥æ”¶å€¼ï¼Œå¹¶æˆä¸ºå…±äº«èŠ‚ç‚¹ï¼›è¯¥æ•°æ®å—è¢«ç½®ä¸ºç‹¬å çŠ¶æ€ï¼Œä»¥è¡¨æ˜å…¶å”¯ä¸€çš„æœ‰æ•ˆå‰¯æœ¬å·²ç¼“å­˜ï¼›å…±äº«è€…<span class="heti-skip"><span class="heti-spacing"> </span>(Sharers)<span class="heti-spacing"> </span></span>å­—æ®µæ ‡è¯†å…¶æ‰€æœ‰è€…èº«ä»½ã€‚</li>
</ul>
</li>
<li>
<p>å½“å—å¤„äº<strong>å…±äº«</strong>çŠ¶æ€æ—¶ï¼Œå†…å­˜å€¼æ˜¯æœ€æ–°çš„ï¼Œå› æ­¤å¯èƒ½å‘ç”Ÿä»¥ä¸‹è¯·æ±‚ï¼š</p>
<ul>
<li><strong>è¯»å¤±æ•ˆ</strong>ï¼šä»å†…å­˜ä¸­å‘è¯·æ±‚èŠ‚ç‚¹å‘é€æ‰€è¯·æ±‚çš„æ•°æ®ï¼Œå¹¶å°†è¯¥è¯·æ±‚èŠ‚ç‚¹åŠ å…¥å…±äº«è€…<span class="heti-skip"><span class="heti-spacing"> </span>(Sharers)<span class="heti-spacing"> </span></span>ä¸­ã€‚</li>
<li><strong>å†™æ— æ•ˆ</strong>ï¼šå‘è¯·æ±‚èŠ‚ç‚¹å‘é€å€¼ï¼›å‘å…±äº«è€…ä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å‘é€å¤±æ•ˆæ¶ˆæ¯ï¼Œä¸”å…±äº«è€…å°†æ›´æ–°ä¸ºä»…åŒ…å«è¯¥è¯·æ±‚èŠ‚ç‚¹çš„æ ‡è¯†ï¼›æ­¤æ—¶è¯¥å—çš„çŠ¶æ€è¢«è®¾ä¸ºç‹¬å çŠ¶æ€ã€‚</li>
</ul>
</li>
<li>
<p>å½“å—å¤„äº<strong>ç‹¬å </strong>çŠ¶æ€æ—¶ï¼Œå—çš„å½“å‰å€¼ç”±å…±äº«è€…ï¼ˆæ‰€æœ‰è€…ï¼‰æ ‡è¯†çš„èŠ‚ç‚¹ä¸Šçš„ç¼“å­˜æŒæœ‰ï¼Œå› æ­¤å­˜åœ¨ä»¥ä¸‹ç›®å½•è¯·æ±‚ï¼š</p>
<ul>
<li><strong>è¯»å¤±æ•ˆ</strong>ï¼š<ul>
<li>å‘æ‰€æœ‰è€…å‘é€æ•°æ®è·å–æ¶ˆæ¯ï¼Œè¿™ä½¿å¾—æ‰€æœ‰è€…çš„é«˜é€Ÿç¼“å­˜ä¸­çš„å—çŠ¶æ€è½¬å˜ä¸ºå…±äº«çŠ¶æ€ï¼Œå¹¶ä¿ƒä½¿æ‰€æœ‰è€…å°†æ•°æ®å‘é€è‡³ç›®å½•ã€‚</li>
<li>æ•°æ®åœ¨ç›®å½•å¤„è¢«å†™å…¥å†…å­˜åå›ä¼ ç»™è¯·æ±‚å¤„ç†å™¨ã€‚</li>
<li>è¯·æ±‚èŠ‚ç‚¹çš„èº«ä»½ä¼šè¢«æ·»åŠ è‡³ä»åŒ…å«åŸæ‰€æœ‰è€…å¤„ç†å™¨çš„èº«ä»½ï¼ˆå› å®ƒä»ç„¶æŒæœ‰å¯è¯»å‰¯æœ¬ï¼‰çš„å…±äº«è€…ä¸­ã€‚</li>
</ul>
</li>
<li><strong>æ•°æ®å†™å›</strong>ï¼š<ul>
<li>ç”±äºæ‰€æœ‰è€…æ­£åœ¨æ›¿æ¢è¯¥å—ï¼Œå¿…é¡»å°†å…¶å†™å›ã€‚</li>
<li>æ­¤æ“ä½œä½¿å†…å­˜å‰¯æœ¬æ›´æ–°ä¸ºæœ€æ–°çŠ¶æ€ï¼ˆä¸»ç›®å½•å®è´¨ä¸Šæˆä¸ºæ–°çš„æ‰€æœ‰è€…<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œæ­¤æ—¶è¯¥å—è½¬ä¸ºæœªç¼“å­˜çŠ¶æ€ï¼Œä¸”æ¸…ç©ºå…±äº«è€…ã€‚</li>
</ul>
</li>
<li><strong>å†™æ— æ•ˆ</strong>ï¼š<ul>
<li>è¯¥å—å°†å½’å±æ–°çš„æ‰€æœ‰è€…ã€‚</li>
<li>ç³»ç»Ÿä¼šå‘åŸæ‰€æœ‰è€…å‘é€æ¶ˆæ¯ï¼Œä½¿å…¶ç¼“å­˜ä¸­çš„å—æ— æ•ˆåŒ–ï¼Œå¹¶å°†å€¼ä¼ é€è‡³ç›®å½•ï¼›éšåç›®å½•å°†è¯¥å€¼è½¬å‘ç»™è¯·æ±‚èŠ‚ç‚¹ä½¿å…¶æˆä¸ºæ–°çš„æ‰€æœ‰è€…ã€‚</li>
<li>å…±äº«è€…æ›´æ–°ä¸ºæ–°æ‰€æœ‰è€…çš„ä¿¡æ¯ï¼Œè€Œè¯¥å—çš„ç‹¬å çŠ¶æ€ä¿æŒä¸å˜ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
<div class="admonition example">
<p class="admonition-title"><span>jxh<span class="heti-spacing"> </span></span>è¯¾ä»¶æœ‰ä¸€ä¸ªæ¯”è¾ƒå®Œæ•´çš„ä¾‹å­ï¼Œå»ºè®®é˜…è¯»å’Œç†è§£ï¼ˆ<del>ç”±äºå†…å®¹å¤ªå¤šä¸å¤ªå¥½æ¬è¿‡æ¥</del>ï¼‰</p>
</div>
<details class="example">
<summary>ä¾‹å­</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="__tabbed_3_1" name="__tabbed_3" type="radio"/><input id="__tabbed_3_2" name="__tabbed_3" type="radio"/><div class="tabbed-labels"><label for="__tabbed_3_1">é¢˜ç›®</label><label for="__tabbed_3_2">è§£ç­”</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/44.png" width="80%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/45.png" width="70%"/>
</div>
</div>
</div>
</div>
</details>
<h2 id="synchronization">Synchronization<a class="headerlink" href="#synchronization" title="Permanent link">âš“ï¸</a></h2>
<details class="question" open="open">
<summary>ä¸ºä»€ä¹ˆéœ€è¦åŒæ­¥ï¼Ÿ</summary>
<p>éœ€è¦çŸ¥é“ä½•æ—¶ä¸åŒè¿›ç¨‹ä½¿ç”¨å…±äº«æ•°æ®æ˜¯å®‰å…¨çš„ã€‚</p>
</details>
<p><strong>åŒæ­¥</strong><span>(synchronization)<span class="heti-spacing"> </span></span>æœºåˆ¶é€šå¸¸ç”±ç”¨æˆ·çº§çš„è½¯ä»¶ä¾‹ç¨‹æ„å»ºï¼Œè¿™äº›ä¾‹ç¨‹ä¾èµ–äºç¡¬ä»¶æä¾›çš„åŒæ­¥æŒ‡ä»¤ã€‚å¯¹äºè¾ƒå°è§„æ¨¡çš„å¤šå¤„ç†å™¨ç³»ç»Ÿæˆ–ä½ç«äº‰åœºæ™¯ï¼Œå…³é”®çš„ç¡¬ä»¶èƒ½åŠ›åœ¨äºæä¾›ä¸€æ¡ä¸å¯ä¸­æ–­çš„æŒ‡ä»¤æˆ–æŒ‡ä»¤åºåˆ—ï¼Œè¯¥æŒ‡ä»¤èƒ½å¤Ÿä»¥<strong>åŸå­æ–¹å¼</strong>æ£€ç´¢å¹¶ä¿®æ”¹æ•°å€¼ã€‚åŸºäºè¿™ä¸€èƒ½åŠ›ï¼Œä¾¿å¯æ„å»ºå‡ºè½¯ä»¶åŒæ­¥æœºåˆ¶ã€‚æœ¬èŠ‚é‡ç‚¹æ¢è®¨<strong>åŠ é”</strong>ä¸<strong>è§£é”</strong>è¿™ä¸¤ç±»åŒæ­¥æ“ä½œçš„å®ç°åŸç†ï¼›é€šè¿‡è¿™ä¸¤ä¸ªæ“ä½œï¼Œæ—¢èƒ½å®ç°äº’æ–¥è®¿é—®æ§åˆ¶ï¼Œä¹Ÿå¯ä¸ºæ›´å¤æ‚çš„åŒæ­¥æœºåˆ¶å¥ å®šåŸºç¡€ã€‚</p>
<h3 id="basic-hardware-primitives">Basic Hardware Primitives<a class="headerlink" href="#basic-hardware-primitives" title="Permanent link">âš“ï¸</a></h3>
<p>åœ¨å¤šå¤„ç†å™¨ç³»ç»Ÿä¸­ã€‚å®ç°åŒæ­¥æ‰€éœ€çš„å…³é”®èƒ½åŠ›æ˜¯ä¸€ç»„èƒ½å¤Ÿå®ç°<strong>åŸå­åŒ–</strong>è¯»å–å¹¶ä¿®æ”¹å†…å­˜ä½ç½®çš„<strong>ç¡¬ä»¶åŸè¯­</strong>(hardware primitives)ã€‚è‹¥ç¼ºä¹è¿™ç§èƒ½åŠ›ï¼Œæ„å»ºåŸºæœ¬åŒæ­¥åŸè¯­çš„æˆæœ¬å°†æä¸ºé«˜æ˜‚ï¼Œä¸”ä¼šéšç€å¤„ç†å™¨æ•°é‡çš„å¢åŠ è€Œé€’å¢ã€‚å®é™…ä¸Šå­˜åœ¨å¤šç§åŸºç¡€ç¡¬ä»¶åŸè¯­çš„æ›¿ä»£æ–¹æ¡ˆï¼Œå®ƒä»¬å‡æä¾›å¯¹æŸä¸€ä½ç½®è¿›è¡ŒåŸå­åŒ–è¯»å†™çš„èƒ½åŠ›ã€‚ä½†é€šå¸¸è€Œè¨€ï¼Œæ¶æ„å¸ˆå¹¶ä¸æœŸæœ›ç”¨æˆ·ç›´æ¥ä½¿ç”¨è¿™äº›åŸºç¡€ç¡¬ä»¶åŸè¯­ï¼Œè€Œæ˜¯å¸Œæœ›<strong>ç³»ç»Ÿç¨‹åºå‘˜</strong>åˆ©ç”¨å®ƒä»¬æ¥æ„å»ºåŒæ­¥åº“ã€‚ä¸‹é¢è®©æˆ‘ä»¬ä»å…¶ä¸­çš„ä¸€ä¸ªç¡¬ä»¶åŸè¯­å‡ºå‘ï¼Œå±•ç¤ºå¦‚ä½•åˆ©ç”¨å®ƒæ¥æ„å»ºä¸€äº›åŸºæœ¬çš„åŒæ­¥æ“ä½œã€‚</p>
<p>æˆ‘ä»¬è¦ä»‹ç»çš„ç¡¬ä»¶åŸè¯­æ˜¯<strong>åŸå­äº¤æ¢</strong>(atomic exchange)ï¼Œç”¨äºå°†å¯„å­˜å™¨ä¸­çš„å€¼ä¸å†…å­˜ä¸­çš„å€¼è¿›è¡Œäº’æ¢ã€‚</p>
<ul>
<li>å‡è®¾æˆ‘ä»¬éœ€è¦æ„å»ºä¸€ä¸ªç®€å•é”ï¼šç”¨<span class="heti-skip"><span class="heti-spacing"> </span>0<span class="heti-spacing"> </span></span>è¡¨ç¤ºé”å¤„äºç©ºé—²çŠ¶æ€ï¼Œç”¨<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>ä»£è¡¨é”å·²è¢«å ç”¨ã€‚</li>
<li>
<p>å¤„ç†å™¨å°è¯•é€šè¿‡æ‰§è¡Œäº¤æ¢æŒ‡ä»¤æ¥è·å–é”ï¼š</p>
<ul>
<li>å°†å¯„å­˜å™¨ä¸­çš„<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>è¿›è¡Œäº¤æ¢ï¼›å¯„å­˜å™¨çš„å†…å­˜åœ°å€å’Œé”å¯¹åº”</li>
<li>è‹¥å…¶ä»–å¤„ç†å™¨å·²æŒæœ‰è¯¥é”ï¼Œåˆ™äº¤æ¢æŒ‡ä»¤è¿”å›å€¼ä¸º<span><span class="heti-spacing"> </span>1</span>ï¼›åä¹‹è¿”å›<span class="heti-skip"><span class="heti-spacing"> </span>0<span class="heti-spacing"> </span></span>æ—¶ï¼Œè¯¥å†…å­˜ä½ç½®çš„å€¼ä¹Ÿä¼šè¢«åŒæ—¶æ›´æ–°ä¸º<span><span class="heti-spacing"> </span>1</span>ï¼Œä»è€Œé˜»æ­¢å…¶ä»–ç«äº‰æ€§äº¤æ¢æ“ä½œåŒæ ·è·å¾—<span><span class="heti-spacing"> </span>0</span>ã€‚</li>
</ul>
</li>
<li>
<p>ä¾‹å¦‚ï¼šä¸¤ä¸ªå¤„ç†å™¨åŒæ—¶å°è¯•æ‰§è¡Œäº¤æ¢æŒ‡ä»¤æ—¶ï¼Œè¿™ç§ç«äº‰ä¼šè¢«æ‰“ç ´ï¼šå…¶ä¸­ä¸€ä¸ªå¤„ç†å™¨å¿…å®šä¼šç‡å…ˆå®Œæˆäº¤æ¢å¹¶è¿”å›<span><span class="heti-spacing"> </span>0</span>ï¼Œè€Œç¬¬äºŒä¸ªå¤„ç†å™¨çš„äº¤æ¢æ“ä½œå°†è¿”å›<span><span class="heti-spacing"> </span>1</span>ã€‚</p>
</li>
<li>ä½¿ç”¨äº¤æ¢åŸè¯­å®ç°åŒæ­¥çš„å…³é”®åœ¨äºå…¶<strong>åŸå­æ€§</strong>ï¼šæ•´ä¸ªäº¤æ¢è¿‡ç¨‹ä¸å¯åˆ†å‰²ï¼Œä¸”ä¸¤ä¸ªå¹¶å‘æ‰§è¡Œçš„äº¤æ¢ä¼šé€šè¿‡<strong>å†™ä¸²è¡ŒåŒ–</strong>æœºåˆ¶ç¡®å®šå…ˆåé¡ºåºã€‚</li>
</ul>
<p>æ­¤å¤–è¿˜æœ‰å…¶ä»–ç”¨äºå®ç°åŒæ­¥çš„åŸå­åŸè¯­ï¼Œä½†å®ƒä»¬éƒ½å…·å¤‡ä¸€ä¸ªå…³é”®ç‰¹æ€§ï¼šä»¥å¯åˆ¤æ–­ä¸¤é¡¹æ“ä½œæ˜¯å¦åŸå­æ‰§è¡Œçš„æ–¹å¼è¯»å–å¹¶æ›´æ–°å†…å­˜å€¼ã€‚ä¸‹é¢ä»‹ç»å…¶ä¸­ä¸€äº›åŸå­åŸè¯­ï¼š</p>
<ul>
<li><strong>æµ‹è¯•å¹¶ç½®ä½</strong>(test-and-set)ï¼šå¯¹å€¼è¿›è¡Œæ£€æµ‹ï¼Œè‹¥é€šè¿‡æ£€æµ‹åˆ™è®¾ç½®æ–°å€¼ã€‚<ul>
<li>æˆ‘ä»¬å¯ä»¥å®šä¹‰ä¸€ä¸ªæ£€æµ‹æ•°å€¼æ˜¯å¦ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>0<span class="heti-spacing"> </span></span>å¹¶å°†å…¶ç½®<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>çš„æ“ä½œï¼Œå…¶ä½¿ç”¨æ–¹å¼ç±»ä¼¼äºåŸå­äº¤æ¢æ“ä½œã€‚</li>
</ul>
</li>
<li><strong>è·å–å¹¶é€’å¢</strong>(fetch-and-increment)ï¼šè¿”å›å†…å­˜ä½ç½®çš„å€¼ï¼Œå¹¶ä»¥åŸå­æ–¹å¼å°†å…¶é€’å¢ã€‚<ul>
<li>é€šè¿‡ç”¨<span class="heti-skip"><span class="heti-spacing"> </span>0<span class="heti-spacing"> </span></span>è¡¨ç¤ºåŒæ­¥å˜é‡æœªè¢«å ç”¨ï¼Œæˆ‘ä»¬å¯ä»¥åƒè¿ç”¨äº¤æ¢æ“ä½œé‚£æ ·ä½¿ç”¨è¿™ç§æŒ‡ä»¤ã€‚</li>
</ul>
</li>
</ul>
<p>å®ç°å•ä¸€åŸå­å†…å­˜æ“ä½œä¼šå¸¦æ¥ä¸€äº›æŒ‘æˆ˜ï¼Œå› ä¸ºè¿™éœ€è¦åœ¨ä¸€ä¸ªä¸å¯ä¸­æ–­çš„æŒ‡ä»¤ä¸­åŒæ—¶å®Œæˆå†…å­˜è¯»å–å’Œå†™å…¥ã€‚è¿™ä¸€è¦æ±‚ä½¿å¾—ä¸€è‡´æ€§çš„å®ç°å¤æ‚åŒ–â€”â€”ç¡¬ä»¶æ—¢ä¸å…è®¸åœ¨è¯»å†™ä¹‹é—´æ’å…¥ä»»ä½•å…¶ä»–æ“ä½œï¼Œåˆå¿…é¡»é¿å…æ­»é”æƒ…å†µçš„å‘ç”Ÿã€‚</p>
<p>å¦ä¸€ç§ç±»å‹çš„ç¡¬ä»¶åŸè¯­æ˜¯ä½¿ç”¨<strong>ä¸€å¯¹æŒ‡ä»¤</strong>ï¼Œå…¶ä¸­é€šè¿‡ç¬¬äºŒæ¡æŒ‡ä»¤çš„è¿”å›å€¼æ¥æ¨æ–­è¿™å¯¹æŒ‡ä»¤æ˜¯å¦ä»¥åŸå­æ–¹å¼æ‰§è¡Œã€‚å¦‚æœè¿™å¯¹æŒ‡ä»¤çœ‹èµ·æ¥åƒæ˜¯æ‰€æœ‰å…¶ä»–å¤„ç†å™¨æ‰§è¡Œçš„æ“ä½œéƒ½å‘ç”Ÿåœ¨å®ƒä»¬ä¹‹å‰æˆ–ä¹‹åçš„è¯ï¼Œé‚£ä¹ˆè¿™å¯¹æŒ‡ä»¤å®é™…ä¸Šå°±å…·å¤‡åŸå­æ€§ã€‚è¿™æ­£æ˜¯<span class="heti-skip"><span class="heti-spacing"> </span>MIPS<span class="heti-spacing"> </span></span>å’Œ<span class="heti-skip"><span class="heti-spacing"> </span>RISC-V<span class="heti-spacing"> </span></span>æ¶æ„æ‰€é‡‡ç”¨çš„æ–¹æ³•ã€‚</p>
<p>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>RISC-V<span class="heti-spacing"> </span></span>ä¸­ï¼Œè¿™å¯¹æŒ‡ä»¤åŒ…æ‹¬ä¸€ç§ç‰¹æ®Šçš„åŠ è½½æ“ä½œï¼ˆç§°ä¸º<strong>ä¿ç•™åŠ è½½</strong>(load reserved)ï¼‰<code>lr</code> å’Œä¸€ç§ç‰¹æ®Šçš„å­˜å‚¨æ“ä½œï¼ˆç§°ä¸º<strong>æ¡ä»¶å­˜å‚¨</strong>(store conditional)<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent><code>sc</code>ã€‚</p>
<ul>
<li>ä¿ç•™åŠ è½½å°† <code>rs1</code> æŒ‡å®šçš„å†…å­˜å†…å®¹åŠ è½½åˆ° <code>rd</code> å¯„å­˜å™¨ä¸­ï¼Œå¹¶åœ¨è¯¥å†…å­˜åœ°å€ä¸Šåˆ›å»ºä¸€ä¸ªä¿ç•™æ ‡è®°</li>
<li>æ¡ä»¶å­˜å‚¨åˆ™å°† <code>rs2</code> ä¸­çš„å€¼å­˜å…¥ <code>rs1</code> æŒ‡å®šçš„å†…å­˜åœ°å€ä¸Š</li>
<li>è‹¥åœ¨æ­¤æœŸé—´æœ‰å…¶ä»–å†™å…¥æ“ä½œç ´åäº†è¯¥å†…å­˜ä½ç½®çš„ä¿ç•™çŠ¶æ€ï¼Œåˆ™æ¡ä»¶å­˜å‚¨å¤±è´¥ï¼Œå¹¶å‘ <code>rd</code> å†™å…¥éé›¶å€¼</li>
<li>è‹¥æˆåŠŸæ‰§è¡Œåˆ™å‘ <code>rd</code> å†™å…¥<span><span class="heti-spacing"> </span>0</span></li>
<li>å¦‚æœåœ¨ä¸¤æ¡æŒ‡ä»¤ä¹‹é—´ï¼Œå¤„ç†å™¨è¿›è¡Œäº†ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Œé‚£ä¹ˆæ¡ä»¶å­˜å‚¨ä¹Ÿä¼šå¤±è´¥</li>
<li>æˆ‘ä»¬å¯ä»¥ç”¨è¿™å¯¹æŒ‡ä»¤æ¥æ„å»ºå…¶ä»–åŒæ­¥åŸè¯­</li>
<li>ç”¨<strong>ä¿ç•™å¯„å­˜å™¨</strong><span>(reversed register)<span class="heti-spacing"> </span></span>ä¸­è·Ÿè¸ª <code>lr</code> æŒ‡ä»¤æŒ‡å®šçš„åœ°å€</li>
<li>è‹¥å‘ç”Ÿä¸­æ–­ï¼Œæˆ–é“¾æ¥å¯„å­˜å™¨ä¸­çš„åœ°å€å¯¹åº”çš„ç¼“å­˜å—å¤±æ•ˆï¼ˆä¾‹å¦‚ç”±å¦ä¸€æ¡ <code>sc</code> æŒ‡ä»¤å¯¼è‡´<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œåˆ™é“¾æ¥å¯„å­˜å™¨ä¼šè¢«æ¸…é›¶</li>
<li><code>sc</code> æŒ‡ä»¤ä»…æ£€æŸ¥å…¶åœ°å€æ˜¯å¦ä¸ä¿ç•™å¯„å­˜å™¨çš„åœ°å€åŒ¹é…ï¼šåŒ¹é…åˆ™æˆåŠŸæ‰§è¡Œï¼Œå¦åˆ™å¤±è´¥</li>
<li>ç”±äºåœ¨å‡ºç°å¯¹åŠ è½½ä¿ç•™åœ°å€çš„é‡å¤å­˜å‚¨å°è¯•æˆ–ä»»ä½•å¼‚å¸¸åï¼Œå­˜å‚¨æ¡ä»¶æ“ä½œéƒ½å°†å¤±è´¥ï¼Œå› æ­¤å¿…é¡»è°¨æ…é€‰æ‹©æ’å…¥è¿™ä¸¤æ¡æŒ‡ä»¤ä¹‹é—´çš„å…¶ä»–æŒ‡ä»¤ï¼Œå› æ­¤æˆ‘ä»¬åªåº”å®‰å…¨åœ°å…è®¸<strong>å¯„å­˜å™¨<span class="heti-skip"><span class="heti-spacing"> </span>-<span class="heti-spacing"> </span></span>å¯„å­˜å™¨å‹æ“ä½œ</strong>ï¼Œå¦åˆ™å¯èƒ½å¼•å‘æ­»é”</li>
<li>æ­¤å¤–ï¼Œä¸ºé™ä½æ— å…³äº‹ä»¶æˆ–ç«äº‰å¤„ç†å™¨é¢‘ç¹å¯¼è‡´å­˜å‚¨æ¡ä»¶å¤±è´¥çš„æ¦‚ç‡ï¼ŒåŠ è½½ä¿ç•™ä¸å­˜å‚¨æ¡ä»¶ä¹‹é—´çš„æŒ‡ä»¤æ•°é‡åº”å½“<strong>å°½å¯èƒ½å°‘</strong></li>
</ul>
<details class="example" open="open">
<summary>ä¾‹å­</summary>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-0-1"><a href="#__codelineno-0-1" id="__codelineno-0-1" name="__codelineno-0-1"></a><span class="nl">try:</span><span class="w"> </span>
</span><span id="__span-0-2"><a href="#__codelineno-0-2" id="__codelineno-0-2" name="__codelineno-0-2"></a><span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">x3</span><span class="p">,</span><span class="w"> </span><span class="no">x4</span><span class="w">        </span><span class="c1">; mov exchange value</span>
</span><span id="__span-0-3"><a href="#__codelineno-0-3" id="__codelineno-0-3" name="__codelineno-0-3"></a><span class="w">    </span><span class="nf">lr</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="w"> </span><span class="no">x1</span><span class="w">         </span><span class="c1">; load reserved from</span>
</span><span id="__span-0-4"><a href="#__codelineno-0-4" id="__codelineno-0-4" name="__codelineno-0-4"></a><span class="w">    </span><span class="nf">sc</span><span class="w"> </span><span class="no">x3</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">(</span><span class="no">x1</span><span class="p">)</span><span class="w">      </span><span class="c1">; store conditional</span>
</span><span id="__span-0-5"><a href="#__codelineno-0-5" id="__codelineno-0-5" name="__codelineno-0-5"></a><span class="w">    </span><span class="nf">bnez</span><span class="w"> </span><span class="no">x3</span><span class="p">,</span><span class="w"> </span><span class="no">try</span><span class="w">      </span><span class="c1">; branch store fails</span>
</span><span id="__span-0-6"><a href="#__codelineno-0-6" id="__codelineno-0-6" name="__codelineno-0-6"></a><span class="w">    </span><span class="nf">mov</span><span class="w"> </span><span class="no">x4</span><span class="p">,</span><span class="w"> </span><span class="no">x2</span><span class="w">        </span><span class="c1">; put load value in x4</span>
</span></code></pre></div>
</details>
<h3 id="implementing-locks-using-coherence">Implementing Locks Using Coherence<a class="headerlink" href="#implementing-locks-using-coherence" title="Permanent link">âš“ï¸</a></h3>
<p>ä¸€æ—¦æœ‰äº†åŸå­æ“ä½œåï¼Œä¾¿å¯ä»¥åˆ©ç”¨å¤šå¤„ç†å™¨çš„ä¸€è‡´æ€§æœºåˆ¶æ¥å®ç°<strong>è‡ªæ—‹é”</strong>(spin lock)ã€‚å¤„ç†å™¨ä¼šæŒç»­å°è¯•è·å–è¿™ç±»é”ï¼Œå¾ªç¯ç­‰å¾…ç›´è‡³æˆåŠŸã€‚å½“ç¨‹åºå‘˜é¢„ä¼°æŒæœ‰é”çš„æ—¶é—´å¾ˆçŸ­ï¼Œä¸”å¸Œæœ›åŠ é”è¿‡ç¨‹åœ¨é”å¯ç”¨æ—¶å…·å¤‡ä½å»¶è¿Ÿç‰¹æ€§æ—¶ï¼Œä¼šé‡‡ç”¨è‡ªæ—‹é”ã€‚ä¸è¿‡ï¼Œè‡ªæ—‹é”ä¼šè®©å¤„ç†å™¨é™·å…¥ç­‰å¾…é‡Šæ”¾çš„å¾ªç¯ä¸­å ç”¨èµ„æºï¼Œå› æ­¤åœ¨æŸäº›åœºæ™¯ä¸‹å¹¶ä¸é€‚ç”¨ã€‚</p>
<p>è‹¥æ²¡æœ‰ç¼“å­˜ä¸€è‡´æ€§æœºåˆ¶ï¼Œæœ€ç®€å•çš„å®ç°æ–¹å¼æ˜¯å°†é”å­˜å‚¨äºå†…å­˜ä¸­ã€‚</p>
<ul>
<li>å¤„ç†å™¨å¯é€šè¿‡åŸå­æ“ä½œä¸æ–­å°è¯•è·å–é”ï¼Œå¹¶æ£€æµ‹äº¤æ¢æ“ä½œæ˜¯å¦è¿”å›äº†ç©ºé—²çŠ¶æ€çš„é”</li>
<li>é‡Šæ”¾é”æ—¶ï¼Œå¤„ç†å™¨ä»…éœ€å‘è¯¥åœ°å€å­˜å…¥æ•°å€¼<span class="heti-skip"><span class="heti-spacing"> </span>0<span class="heti-spacing"> </span></span>å³å¯è§£é”</li>
</ul>
<p>è‡ªæ—‹é”çš„ç›¸å…³ä»£ç åºåˆ—å¦‚ä¸‹ï¼š</p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-1-1"><a href="#__codelineno-1-1" id="__codelineno-1-1" name="__codelineno-1-1"></a><span class="w">        </span><span class="nf">addi</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="no">R0</span><span class="p">,</span><span class="mi">#1</span>
</span><span id="__span-1-2"><a href="#__codelineno-1-2" id="__codelineno-1-2" name="__codelineno-1-2"></a><span class="nl">lockit:</span><span class="w"> </span><span class="nf">EXCH</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="mi">0</span><span class="p">(</span><span class="no">x1</span><span class="p">)</span><span class="w">    </span><span class="c1">; atomic exchange</span>
</span><span id="__span-1-3"><a href="#__codelineno-1-3" id="__codelineno-1-3" name="__codelineno-1-3"></a><span class="w">        </span><span class="nf">bnez</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="no">lockit</span><span class="w">   </span><span class="c1">; already locked?</span>
</span></code></pre></div>
<p>è‹¥å¤šå¤„ç†å™¨æ”¯æŒç¼“å­˜ä¸€è‡´æ€§ï¼Œä¾¿å¯é€šè¿‡è¯¥æœºåˆ¶å¯¹é”è¿›è¡Œç¼“å­˜ï¼Œä»¥ç»´æŒé”çš„ä¸€è‡´æ€§ã€‚<strong>ç¼“å­˜é”</strong><span>(caching lock)<span class="heti-spacing"> </span></span>å…·æœ‰ä»¥ä¸‹ä¼˜åŠ¿ï¼š</p>
<ul>
<li>
<p>å®ƒä½¿å¾—<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>è‡ªæ—‹<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>è¿‡ç¨‹ï¼ˆå³åœ¨ç´§å‡‘çš„å¾ªç¯ä¸­åå¤æµ‹è¯•å¹¶è·å–é”ï¼‰å¯åœ¨æœ¬åœ°ç¼“å­˜å‰¯æœ¬ä¸Šå®Œæˆï¼Œæ— éœ€åœ¨æ¯æ¬¡å°è¯•è·å–é”æ—¶éƒ½å»è®¿é—®å…¨å±€å†…å­˜ã€‚</p>
<ul>
<li>éœ€è¦ä¿®æ”¹å‰é¢çš„è‡ªæ—‹é”è¿‡ç¨‹ï¼Œä½¿å…¶é€šè¿‡åœ¨æœ¬åœ°é”çš„å‰¯æœ¬ä¸Šæ‰§è¡Œè¯»å–æ“ä½œæ¥è‡ªæ—‹ï¼Œç›´åˆ°æˆåŠŸçœ‹åˆ°é”å¯ç”¨ã€‚</li>
<li>è¯¥è¿‡ç¨‹å°è¯•é€šè¿‡æ‰§è¡Œäº¤æ¢æ“ä½œæ¥è·å–é”ï¼›å¤„ç†å™¨é¦–å…ˆè¯»å–é”ï¼Œä»¥æµ‹è¯•å…¶çŠ¶æ€ã€‚</li>
<li>å¤„ç†å™¨æŒç»­è¯»å–å’Œæµ‹è¯•ï¼Œç›´åˆ°è¯»å–çš„å€¼è¡¨æ˜å·²ç»è§£é”ã€‚</li>
<li>ç„¶åå¤„ç†å™¨ä¸å…¶ä»–æ‰€æœ‰ç±»ä¼¼â€œè‡ªæ—‹ç­‰å¾…â€çš„è¿‡ç¨‹ç«äº‰ï¼Œçœ‹å“ªä¸ªå¯ä»¥é¦–å…ˆä¸ºå˜é‡åŠ é”ã€‚</li>
<li>æ‰€æœ‰è¿›ç¨‹éƒ½ä½¿ç”¨ä¸€ä¸ªäº¤æ¢æŒ‡ä»¤ï¼šè¯¥æŒ‡ä»¤è¯»å–æ—§å€¼ï¼Œå¹¶å°†<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span>å­˜å‚¨åˆ°é”å˜é‡ä¸­ï¼›å”¯ä¸€çš„èƒœè€…ä¼šçœ‹åˆ°<span><span class="heti-spacing"> </span>0</span>ï¼Œè€Œå¤±è´¥è€…ä¼šçœ‹åˆ°èƒœè€…æ”¾ç½®çš„<span><span class="heti-spacing"> </span>1</span>ã€‚</li>
<li>è·èƒœçš„å¤„ç†å™¨æ‰§è¡Œé”ä¹‹åçš„ä»£ç ï¼Œå®Œæˆåï¼Œå°†<span class="heti-skip"><span class="heti-spacing"> </span>0<span class="heti-spacing"> </span></span>å­˜å‚¨åˆ°é”å˜é‡ä¸­ä»¥é‡Šæ”¾é”ï¼Œç„¶åé‡æ–°å¼€å§‹äº†æ–°çš„ç«äº‰ã€‚</li>
<li>
<p>ä»¥ä¸‹æ˜¯æ‰§è¡Œæ­¤è‡ªæ—‹é”çš„ä»£ç ï¼ˆæ³¨æ„ï¼š<span>0<span class="heti-spacing"> </span></span>è¡¨ç¤ºæœªé”å®šï¼Œ<span>1<span class="heti-spacing"> </span></span>è¡¨ç¤ºé”å®š<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼š</p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-2-1"><a href="#__codelineno-2-1" id="__codelineno-2-1" name="__codelineno-2-1"></a><span class="nl">lockit:</span><span class="w"> </span><span class="nf">ld</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="mi">0</span><span class="p">(</span><span class="no">x1</span><span class="p">)</span><span class="w">         </span><span class="c1">; load of lock</span>
</span><span id="__span-2-2"><a href="#__codelineno-2-2" id="__codelineno-2-2" name="__codelineno-2-2"></a><span class="w">        </span><span class="nf">bnez</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="no">lockit</span><span class="w">      </span><span class="c1">; not available-spin</span>
</span><span id="__span-2-3"><a href="#__codelineno-2-3" id="__codelineno-2-3" name="__codelineno-2-3"></a><span class="w">        </span><span class="nf">addi</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="no">R0</span><span class="p">,</span><span class="mi">#1</span><span class="w">       </span><span class="c1">; load locked value</span>
</span><span id="__span-2-4"><a href="#__codelineno-2-4" id="__codelineno-2-4" name="__codelineno-2-4"></a><span class="w">        </span><span class="nf">EXCH</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="mi">0</span><span class="p">(</span><span class="no">x1</span><span class="p">)</span><span class="w">       </span><span class="c1">; swap</span>
</span><span id="__span-2-5"><a href="#__codelineno-2-5" id="__codelineno-2-5" name="__codelineno-2-5"></a><span class="w">        </span><span class="nf">bnez</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="no">lockit</span><span class="w">      </span><span class="c1">; branch if lock wasnâ€™t 0</span>
</span></code></pre></div>
</li>
</ul>
</li>
<li>
<p>æœ€è¿‘ä½¿ç”¨è¿‡è¯¥é”çš„å¤„ç†å™¨å¾ˆå¯èƒ½åœ¨çŸ­æœŸå†…å†æ¬¡ä½¿ç”¨ã€‚æ­¤æ—¶é”å¯èƒ½ä»ç•™åœ¨è¯¥å¤„ç†å™¨çš„ç¼“å­˜ä¸­ï¼Œä»è€Œå¤§å¹…ç¼©çŸ­è·å–é”çš„æ—¶é—´ã€‚</p>
</li>
</ul>
<p>ä¸‹è¡¨å±•ç¤ºäº†å¤šä¸ªè¿›ç¨‹é€šè¿‡åŸå­äº¤æ¢æŒ‡ä»¤äº‰ç€ä¸ºå˜é‡åŠ é”æ—¶ï¼Œå¤„ç†å™¨ä¸æ€»çº¿<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>ç›®å½•çš„äº¤äº’è¿‡ç¨‹ï¼š</p>
<div style="text-align: center">
<img src="images/C5/22.png" width="90%"/>
</div>
<ul>
<li>å½“æŒæœ‰é”çš„å¤„ç†å™¨å‘é”å†™å…¥<span class="heti-skip"><span class="heti-spacing"> </span>0<span class="heti-spacing"> </span></span>æ—¶ï¼Œæ‰€æœ‰å…¶ä»–é«˜é€Ÿç¼“å­˜ä¸­çš„å‰¯æœ¬éƒ½ä¼šæ— æ•ˆåŒ–ï¼Œå¿…é¡»é‡æ–°è·å–æ–°å€¼ä»¥æ›´æ–°æœ¬åœ°å‰¯æœ¬ã€‚</li>
<li>å…¶ä¸­æŸä¸ªé«˜é€Ÿç¼“å­˜ä¼šç‡å…ˆè·å¾—è§£é”çŠ¶æ€çš„å€¼ï¼ˆ0<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œå¹¶æ‰§è¡Œäº¤æ¢æ“ä½œæˆåŠŸä¸Šé”ï¼›é‚£ä¹ˆå½“å…¶ä»–å¤„ç†å™¨çš„é«˜é€Ÿç¼“å­˜å¤±æ•ˆè¯·æ±‚å¾—åˆ°å“åº”æ—¶ï¼Œä¼šå‘ç°è¯¥å˜é‡å·²è¢«é”å®šï¼Œäºæ˜¯åªèƒ½ç»§ç»­è¿›å…¥æµ‹è¯•å¹¶ä¿æŒè‡ªæ—‹çŠ¶æ€</li>
</ul>
<p>ä¸Šè¿°ä¾‹å­è¿˜æ­ç¤ºäº†ä¿ç•™åŠ è½½<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>æ¡ä»¶å­˜å‚¨åŸè¯­çš„å¦ä¸€ä¼˜åŠ¿ï¼šè¯»æ“ä½œä¸å†™æ“ä½œè¢«æ˜¾å¼åˆ†ç¦»ã€‚è¿™ä¸€ç‰¹æ€§ä½¿å¾—ä»¥ä¸‹ä»£ç åºåˆ—èƒ½å¤Ÿå®ç°ä¸ä¸Šè¿°ä¼˜åŒ–ç‰ˆäº¤æ¢æŒ‡ä»¤ç›¸åŒçš„æ€§èƒ½è¡¨ç°ï¼š</p>
<div class="language-asm highlight"><pre><span></span><code><span id="__span-3-1"><a href="#__codelineno-3-1" id="__codelineno-3-1" name="__codelineno-3-1"></a><span class="nl">lockit:</span><span class="w"> </span><span class="nf">lr</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="mi">0</span><span class="p">(</span><span class="no">x1</span><span class="p">)</span><span class="w">         </span><span class="c1">; load reserved</span>
</span><span id="__span-3-2"><a href="#__codelineno-3-2" id="__codelineno-3-2" name="__codelineno-3-2"></a><span class="w">        </span><span class="nf">bnez</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="no">lockit</span><span class="w">      </span><span class="c1">; not available-spin</span>
</span><span id="__span-3-3"><a href="#__codelineno-3-3" id="__codelineno-3-3" name="__codelineno-3-3"></a><span class="w">        </span><span class="nf">addi</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="no">R0</span><span class="p">,</span><span class="mi">#1</span><span class="w">       </span><span class="c1">; locked value</span>
</span><span id="__span-3-4"><a href="#__codelineno-3-4" id="__codelineno-3-4" name="__codelineno-3-4"></a><span class="w">        </span><span class="nf">sc</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="mi">0</span><span class="p">(</span><span class="no">x1</span><span class="p">)</span><span class="w">         </span><span class="c1">; store</span>
</span><span id="__span-3-5"><a href="#__codelineno-3-5" id="__codelineno-3-5" name="__codelineno-3-5"></a><span class="w">        </span><span class="nf">bnez</span><span class="w"> </span><span class="no">x2</span><span class="p">,</span><span class="no">lockit</span><span class="w">      </span><span class="c1">; branch if store fails</span>
</span></code></pre></div>
<div class="admonition note">
<p class="admonition-title">è‡ªæ—‹é”çš„æ€§èƒ½åˆ†æ</p>
<p></p><div style="text-align: center">
<img src="images/C5/39.png" width="80%"/>
</div>
</div>
<h3 id="barrier-synchronization">Barrier Synchronization<a class="headerlink" href="#barrier-synchronization" title="Permanent link">âš“ï¸</a></h3>
<p><strong>å±éšœ</strong><span>(barrier)<span class="heti-spacing"> </span></span>è¿«ä½¿è¿›ç¨‹ç­‰å¾…ï¼Œç›´åˆ°æ‰€æœ‰è¿›ç¨‹éƒ½æŠµè¾¾å±éšœåæ‰é‡Šæ”¾è¿™äº›è¿›ç¨‹ï¼Œä½¿å…¶ç»§ç»­è¿è¡Œã€‚å…¶å®ç°ä¸»è¦åŸºäºï¼š</p>
<ul>
<li>å…±äº«è®¡æ•°å™¨<span><span class="heti-spacing"> </span>(shared counter)</span></li>
<li>è‡ªæ—‹ç­‰å¾…<span class="heti-skip"><span class="heti-spacing"> </span>(spin waiting)<span class="heti-spacing"> </span></span>é‡Šæ”¾ä¿¡å·</li>
</ul>
<p>ä¸‹é¢æ˜¯ä¸€æ®µæœ‰å…³å±éšœå®ç°çš„ä»£ç ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-4-1"><a href="#__codelineno-4-1" id="__codelineno-4-1" name="__codelineno-4-1"></a><span class="p">{</span>
</span><span id="__span-4-2"><a href="#__codelineno-4-2" id="__codelineno-4-2" name="__codelineno-4-2"></a><span class="w">    </span><span class="n">lock</span><span class="p">(</span><span class="n">counterlock</span><span class="p">);</span><span class="w">                    </span><span class="c1">// ensure update atomic</span>
</span><span id="__span-4-3"><a href="#__codelineno-4-3" id="__codelineno-4-3" name="__codelineno-4-3"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">release</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">          </span><span class="c1">// first--&gt;reset release</span>
</span><span id="__span-4-4"><a href="#__codelineno-4-4" id="__codelineno-4-4" name="__codelineno-4-4"></a><span class="w">        </span><span class="o">++</span><span class="n">count</span><span class="p">;</span><span class="w">                          </span><span class="c1">// count arrivals</span>
</span><span id="__span-4-5"><a href="#__codelineno-4-5" id="__codelineno-4-5" name="__codelineno-4-5"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">total</span><span class="p">){</span><span class="w">                  </span><span class="c1">// all arrived</span>
</span><span id="__span-4-6"><a href="#__codelineno-4-6" id="__codelineno-4-6" name="__codelineno-4-6"></a><span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">                        </span><span class="c1">// reset counter</span>
</span><span id="__span-4-7"><a href="#__codelineno-4-7" id="__codelineno-4-7" name="__codelineno-4-7"></a><span class="w">        </span><span class="n">release</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">                      </span><span class="c1">// release processes</span>
</span><span id="__span-4-8"><a href="#__codelineno-4-8" id="__codelineno-4-8" name="__codelineno-4-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-4-9"><a href="#__codelineno-4-9" id="__codelineno-4-9" name="__codelineno-4-9"></a><span class="w">    </span><span class="n">unlock</span><span class="p">(</span><span class="n">counterlock</span><span class="p">);</span><span class="w">                  </span><span class="c1">// release lock</span>
</span><span id="__span-4-10"><a href="#__codelineno-4-10" id="__codelineno-4-10" name="__codelineno-4-10"></a><span class="w">    </span><span class="n">spin</span><span class="p">(</span><span class="n">release</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">                  </span><span class="c1">// wait for arrivals</span>
</span><span id="__span-4-11"><a href="#__codelineno-4-11" id="__codelineno-4-11" name="__codelineno-4-11"></a><span class="p">}</span>
</span></code></pre></div>
<p>è¿™æ®µä»£ç æœ‰ä¸€ä¸ªé—®é¢˜ï¼šåœ¨å±éšœä¸­ï¼Œè¾ƒæ…¢çš„è¿›ç¨‹å¯èƒ½è¢«æœ€å¿«çš„è¿›ç¨‹æ‰€å›°ã€‚æ‰€ä»¥æœ‰äº†ä»¥ä¸‹æ”¹è¿›æªæ–½ï¼š</p>
<ul>
<li>ç¦»å¼€å±éšœåè®¡æ•°<ul>
<li>ç”¨é¢å¤–çš„å…±äº«è®¡æ•°å™¨ä¸ºåœ¨å±éšœä¸­çš„è¿›ç¨‹è®¡æ•°</li>
<li>ç¦æ­¢ä»»ä½•è¿›ç¨‹åœ¨æ‰€æœ‰è¿›ç¨‹ç¦»å¼€å‰ä¸€ä¸ªå®ä¾‹å‰é‡æ–°è¿›å…¥å±éšœ</li>
<li>ä½†è¿™ç§æ–¹æ³•ä¼šå¸¦æ¥é¢å¤–çš„æ—¶å»¶ï¼Œå› æ­¤ä¸å»ºè®®é‡‡ç”¨</li>
</ul>
</li>
<li>
<p><strong>æ„ŸçŸ¥åè½¬å±éšœ</strong>(sense-reversing barrier)</p>
<ul>
<li>
<p>å®ç°ä»£ç å¦‚ä¸‹ï¼š</p>
<div class="language-c highlight"><pre><span></span><code><span id="__span-5-1"><a href="#__codelineno-5-1" id="__codelineno-5-1" name="__codelineno-5-1"></a><span class="p">{</span>
</span><span id="__span-5-2"><a href="#__codelineno-5-2" id="__codelineno-5-2" name="__codelineno-5-2"></a><span class="w">    </span><span class="n">Lock_sense</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">!</span><span class="n">Lock_sense</span><span class="p">;</span><span class="w">             </span><span class="c1">// toggle Local_sense</span>
</span><span id="__span-5-3"><a href="#__codelineno-5-3" id="__codelineno-5-3" name="__codelineno-5-3"></a><span class="w">    </span><span class="n">lock</span><span class="p">(</span><span class="n">counterlock</span><span class="p">);</span><span class="w">                    </span><span class="c1">// ensure update atomic</span>
</span><span id="__span-5-4"><a href="#__codelineno-5-4" id="__codelineno-5-4" name="__codelineno-5-4"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">release</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">          </span><span class="c1">// first--&gt;reset release</span>
</span><span id="__span-5-5"><a href="#__codelineno-5-5" id="__codelineno-5-5" name="__codelineno-5-5"></a><span class="w">        </span><span class="o">++</span><span class="n">count</span><span class="p">;</span><span class="w">                          </span><span class="c1">// count arrivals</span>
</span><span id="__span-5-6"><a href="#__codelineno-5-6" id="__codelineno-5-6" name="__codelineno-5-6"></a><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">count</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">total</span><span class="p">){</span><span class="w">                  </span><span class="c1">// all arrived</span>
</span><span id="__span-5-7"><a href="#__codelineno-5-7" id="__codelineno-5-7" name="__codelineno-5-7"></a><span class="w">        </span><span class="n">count</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">                        </span><span class="c1">// reset counter</span>
</span><span id="__span-5-8"><a href="#__codelineno-5-8" id="__codelineno-5-8" name="__codelineno-5-8"></a><span class="w">        </span><span class="n">release</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Lock_sense</span><span class="p">;</span><span class="w">             </span><span class="c1">// release processes</span>
</span><span id="__span-5-9"><a href="#__codelineno-5-9" id="__codelineno-5-9" name="__codelineno-5-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-5-10"><a href="#__codelineno-5-10" id="__codelineno-5-10" name="__codelineno-5-10"></a><span class="w">    </span><span class="n">unlock</span><span class="p">(</span><span class="n">counterlock</span><span class="p">);</span><span class="w">                  </span><span class="c1">// release lock</span>
</span><span id="__span-5-11"><a href="#__codelineno-5-11" id="__codelineno-5-11" name="__codelineno-5-11"></a><span class="w">    </span><span class="n">spin</span><span class="p">(</span><span class="n">release</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">Lock_sense</span><span class="p">)</span><span class="w"> </span><span class="p">;</span><span class="w">         </span><span class="c1">// wait for signal</span>
</span><span id="__span-5-12"><a href="#__codelineno-5-12" id="__codelineno-5-12" name="__codelineno-5-12"></a><span class="p">}</span>
</span></code></pre></div>
</li>
<li>
<p>è¯¥æ–¹æ³•è§£å†³äº†è¿›ç¨‹è¢«å›°çš„é—®é¢˜ï¼Œä½†æ€§èƒ½è¿˜æ˜¯ä¸é«˜</p>
</li>
</ul>
</li>
</ul>
<details class="note" open="open">
<summary>å±éšœåŒæ­¥çš„æ€§èƒ½åˆ†æ</summary>
<p></p><div style="text-align: center">
<img src="images/C5/40.png" width="70%"/>
</div>
<p></p><div style="text-align: center">
<img src="images/C5/41.png" width="70%"/>
</div>
</details>
<p>ä¸ºäº†æå‡å±éšœæ€§èƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é‡‡å–ä¸€ç§è½¯ä»¶ä¼˜åŒ–â€”â€”ç»„åˆæ ‘å½¢å±éšœ<span><span class="heti-spacing"> </span>(combining tree barrier)</span>ï¼šä½¿ç”¨é¢„å…ˆç¡®å®šçš„<span class="heti-skip"><span class="heti-spacing"> </span>n<span class="heti-spacing"> </span></span>å‰æ ‘ç»“æ„ï¼Œè¿›ç¨‹åœ¨å­èŠ‚ç‚¹å¤„åŒæ­¥ï¼Œç„¶åå‘çˆ¶èŠ‚ç‚¹æŠ¥å‘Šï¼Œç›´åˆ°æ ¹èŠ‚ç‚¹é‡Šæ”¾æ‰€æœ‰è¿›ç¨‹ã€‚è¿™å‡å°‘äº†å•ä¸ªåŒæ­¥ç‚¹çš„ç«äº‰ã€‚</p>
<div class="admonition code">
<p class="admonition-title">ä»£ç å®ç°</p>
<p></p><div style="text-align: center">
<img src="images/C5/42.png" width="80%"/>
</div>
</div>
<h2 id="models-of-memory-consistency">Models of Memory Consistency<a class="headerlink" href="#models-of-memory-consistency" title="Permanent link">âš“ï¸</a></h2>
<p>ç¡®å®šå†…å­˜è¿è´¯ç¨‹åº¦è¿™ä¸€é—®é¢˜ç›¸å½“å¤æ‚ã€‚å…ˆæ¥çœ‹ä¸ªç®€å•çš„ä¾‹å­ï¼š</p>
<details class="example" open="open">
<summary>ä¾‹å­</summary>
<div class="grid" markdown="">
<div class="language-c highlight"><pre><span></span><code><span id="__span-6-1"><a href="#__codelineno-6-1" id="__codelineno-6-1" name="__codelineno-6-1"></a><span class="nl">P1</span><span class="p">:</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-6-2"><a href="#__codelineno-6-2" id="__codelineno-6-2" name="__codelineno-6-2"></a><span class="w">    </span><span class="p">......</span>
</span><span id="__span-6-3"><a href="#__codelineno-6-3" id="__codelineno-6-3" name="__codelineno-6-3"></a><span class="w">    </span><span class="n">A</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-6-4"><a href="#__codelineno-6-4" id="__codelineno-6-4" name="__codelineno-6-4"></a><span class="nl">L1</span><span class="p">:</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">B</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
</span></code></pre></div>
<div class="language-c highlight"><pre><span></span><code><span id="__span-7-1"><a href="#__codelineno-7-1" id="__codelineno-7-1" name="__codelineno-7-1"></a><span class="nl">P2</span><span class="p">:</span><span class="w"> </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
</span><span id="__span-7-2"><a href="#__codelineno-7-2" id="__codelineno-7-2" name="__codelineno-7-2"></a><span class="w">    </span><span class="p">......</span>
</span><span id="__span-7-3"><a href="#__codelineno-7-3" id="__codelineno-7-3" name="__codelineno-7-3"></a><span class="w">    </span><span class="n">B</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</span><span id="__span-7-4"><a href="#__codelineno-7-4" id="__codelineno-7-4" name="__codelineno-7-4"></a><span class="nl">L2</span><span class="p">:</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">A</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="p">...</span>
</span></code></pre></div>
</div>
<p>å‡è®¾è¿›ç¨‹è¿è¡Œåœ¨ä¸åŒçš„å¤„ç†å™¨ä¸Šï¼Œä¸”å†…å­˜ä½ç½® <code>A</code> å’Œ <code>B</code> æœ€åˆéƒ½è¢«ä¸¤ä¸ªå¤„ç†å™¨ç¼“å­˜ï¼Œåˆå§‹å€¼ä¸º<span><span class="heti-spacing"> </span>0</span>ã€‚å¦‚æœå†™æ“ä½œæ€»æ˜¯ç«‹å³ç”Ÿæ•ˆï¼Œå¹¶èƒ½è¢«å…¶ä»–å¤„ç†å™¨å³æ—¶çœ‹åˆ°ï¼Œé‚£ä¹ˆä¸¤ä¸ª<span class="heti-skip"><span class="heti-spacing"> </span>IF<span class="heti-spacing"> </span></span>è¯­å¥ï¼ˆæ ‡è®°ä¸º <code>L1</code> å’Œ <code>L2</code>ï¼‰çš„æ¡ä»¶ä¸å¯èƒ½åŒæ—¶è¯„ä¼°ä¸ºçœŸï¼Œå› ä¸ºæ‰§è¡Œåˆ°<span class="heti-skip"><span class="heti-spacing"> </span>IF<span class="heti-spacing"> </span></span>è¯­å¥æ„å‘³ç€<span class="heti-skip"><span class="heti-spacing"> </span>A<span class="heti-spacing"> </span></span>æˆ–<span class="heti-skip"><span class="heti-spacing"> </span>B<span class="heti-spacing"> </span></span>ä¸­è‡³å°‘æœ‰ä¸€ä¸ªå·²è¢«èµ‹å€¼ä¸º<span><span class="heti-spacing"> </span>1</span>ã€‚ä½†å‡è®¾å†™æ— æ•ˆæ“ä½œè¢«å»¶è¿Ÿï¼Œå¹¶ä¸”å…è®¸å¤„ç†å™¨åœ¨æ­¤å»¶è¿ŸæœŸé—´ç»§ç»­æ‰§è¡Œã€‚é‚£ä¹ˆå¯èƒ½å‡ºç°<span class="heti-skip"><span class="heti-spacing"> </span>P1<span class="heti-spacing"> </span></span>å’Œ<span class="heti-skip"><span class="heti-spacing"> </span>P2<span class="heti-spacing"> </span></span>åœ¨å°è¯•è¯»å–å€¼ä¹‹å‰å°šæœªåˆ†åˆ«æ¥æ”¶åˆ°å…³äº<span class="heti-skip"><span class="heti-spacing"> </span>B<span class="heti-spacing"> </span></span>å’Œ<span class="heti-skip"><span class="heti-spacing"> </span>A<span class="heti-spacing"> </span></span>çš„å¤±æ•ˆé€šçŸ¥çš„æƒ…å†µã€‚</p>
<p>ç°åœ¨çš„é—®é¢˜æ˜¯ï¼šæ˜¯å¦åº”å…è®¸è¿™ç§è¡Œä¸ºï¼Ÿè‹¥å…è®¸ï¼Œåº”åœ¨ä½•ç§æ¡ä»¶ä¸‹ï¼Ÿ</p>
</details>
<p>å†…å­˜è¿è´¯æ€§ä¸­æœ€ç›´è§‚çš„æ¨¡å‹ç§°ä¸º<strong>é¡ºåºè¿è´¯æ€§</strong>(sequential consistency)ã€‚å®ƒè¦æ±‚ä»»ä½•æ‰§è¡Œç»“æœæ˜¯ç›¸åŒçš„ï¼Œå°±å¥½åƒæ¯ä¸ªå¤„ç†å™¨å‘å‡ºçš„å†…å­˜è®¿é—®æ“ä½œä¿æŒå…¶ç¨‹åºé¡ºåºï¼Œä¸”ä¸åŒå¤„ç†å™¨ä¹‹é—´çš„è®¿é—®æ“ä½œå¯ä»¥ä»»æ„äº¤é”™æ‰§è¡Œã€‚è¯¥æ¨¡å‹æ¶ˆé™¤äº†å‰ä¾‹ä¸­æŸäº›éæ˜¾æ€§æ‰§è¡Œçš„å¯èƒ½æ€§ï¼Œå› ä¸ºæ‰€æœ‰èµ‹å€¼æ“ä½œå¿…é¡»åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>IF<span class="heti-spacing"> </span></span>è¯­å¥å¼€å§‹æ‰§è¡Œå‰å®Œæˆã€‚</p>
<div style="text-align: center">
<img src="images/C5/43.png" width="60%"/>
</div>
<p>å®ç°é¡ºåºè¿è´¯æ€§çš„æœ€ç®€å•æ–¹æ³•æ˜¯è¦æ±‚å¤„ç†å™¨å»¶è¿Ÿä»»ä½•å†…å­˜è®¿é—®çš„å®Œæˆï¼Œç›´åˆ°ç”±è¯¥è®¿é—®å¼•å‘çš„æ‰€æœ‰æ— æ•ˆåŒ–æ“ä½œå®Œæˆä¸ºæ­¢ã€‚å½“ç„¶ï¼ŒåŒæ ·æœ‰æ•ˆçš„æ–¹æ³•æ˜¯å»¶è¿Ÿä¸‹ä¸€æ¬¡å†…å­˜è®¿é—®ï¼Œç›´è‡³å‰ä¸€æ¬¡è®¿é—®å®Œæˆã€‚éœ€è°¨è®°çš„æ˜¯ï¼Œå†…å­˜è¿è´¯æ€§æ¶‰åŠä¸åŒå˜é‡é—´çš„æ“ä½œï¼šå¿…é¡»æŒ‰åºæ‰§è¡Œçš„ä¸¤ä¸ªè®¿é—®å®é™…ä¸Šé’ˆå¯¹çš„æ˜¯ä¸åŒçš„å†…å­˜ä½ç½®ã€‚å°±æ‹¿ä¸Šä¾‹æ¥è¯´ï¼Œå¿…é¡»å°† <code>A</code> æˆ– <code>B</code> çš„è¯»å–ï¼ˆ<code>A == 0</code> æˆ– <code>B == 0</code>ï¼‰å»¶è¿Ÿè‡³å‰ä¸€ä¸ªå†™å…¥æ“ä½œå®Œæˆï¼ˆ<code>B = 1</code> æˆ– <code>A = 1</code><heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚åœ¨é¡ºåºè¿è´¯æ€§æ¨¡å‹ä¸‹ï¼Œä¸èƒ½ç®€å•åœ°å°†å†™å…¥æ“ä½œç½®äºå†™ç¼“å†²åŒºåå°±ç«‹å³æ‰§è¡Œè¯»å–ã€‚</p>
<p>å°½ç®¡é¡ºåºä¸€è‡´æ€§æä¾›äº†ç®€æ´çš„ç¼–ç¨‹èŒƒå¼ï¼Œä½†å®ƒä¼šé™ä½å¯èƒ½çš„æ€§èƒ½è¡¨ç°ï¼Œå°¤å…¶åœ¨å¤„ç†å™¨æ•°é‡ä¼—å¤šã€‚äº’è¿å»¶è¿Ÿè¾ƒé«˜çš„å¤šæ ¸ç³»ç»Ÿä¸­ï¼ˆæ¯”å¦‚ä¸‹é¢çš„ä¾‹å­<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="__tabbed_4_1" name="__tabbed_4" type="radio"/><input id="__tabbed_4_2" name="__tabbed_4" type="radio"/><div class="tabbed-labels"><label for="__tabbed_4_1">é¢˜ç›®</label><label for="__tabbed_4_2">è§£ç­”</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/23.png" width="80%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/24.png" width="80%"/>
</div>
</div>
</div>
</div>
</details>
<p>ä¸ºäº†æä¾›æ›´å¥½çš„æ€§èƒ½ï¼Œæœ‰ä¸¤ç§è§£å†³è·¯å¾„ï¼š</p>
<ul>
<li>ä¿ç•™é¡ºåºè¿è´¯æ€§ï¼Œä½†é‡‡ç”¨å»¶è¿Ÿéšè—æŠ€æœ¯</li>
<li>ä½¿ç”¨é™åˆ¶æ›´å°‘ã€å…è®¸ç¡¬ä»¶åŠ é€Ÿè¿è¡Œçš„å†…å­˜è¿è´¯æ€§æ¨¡å‹<ul>
<li>å®ƒå¯èƒ½æ”¹å˜ç¨‹åºå‘˜å¯¹å¤šå¤„ç†å™¨çš„è®¤çŸ¥æ–¹å¼ï¼Œå› æ­¤åœ¨æ¢è®¨è¿™äº›æ¾å¼›æ¨¡å‹ä¹‹å‰ï¼Œæˆ‘ä»¬éœ€è¦å…ˆäº†è§£ç¨‹åºå‘˜çš„é¢„æœŸéœ€æ±‚</li>
</ul>
</li>
</ul>
<h3 id="the-programmers-view">The Programmer's View<a class="headerlink" href="#the-programmers-view" title="Permanent link">âš“ï¸</a></h3>
<p>å°½ç®¡é¡ºåºä¸€è‡´æ€§æ¨¡å‹åœ¨æ€§èƒ½ä¸Šå­˜åœ¨åŠ£åŠ¿ï¼Œä½†ä»ç¨‹åºå‘˜çš„è§’åº¦æ¥çœ‹ï¼Œå®ƒå…·æœ‰ç®€æ´çš„ä¼˜åŠ¿ã€‚æˆ‘ä»¬å¸Œæœ›èƒ½<span class="heti-skip"><span class="heti-spacing"> </span>*<span class="heti-spacing"> </span></span>å¤Ÿå¼€å‘ä¸€ç§æ—¢æ˜“äºè§£é‡Šï¼Œåˆå…è®¸é«˜æ€§èƒ½å®ç°çš„ç¼–ç¨‹æ¨¡å‹ã€‚</p>
<p>å…¶ä¸­ä¸€ç§å®ç°é«˜æ•ˆæ‰§è¡Œçš„ç¼–ç¨‹æ¨¡å‹æ˜¯å‡è®¾ç¨‹åºæ˜¯<strong>åŒæ­¥çš„</strong>(synchronized)</p>
<ul>
<li>è‹¥å¯¹å…±äº«æ•°æ®çš„æ‰€æœ‰è®¿é—®éƒ½é€šè¿‡åŒæ­¥æ“ä½œè¿›è¡Œæ’åºï¼Œåˆ™è¯¥ç¨‹åºè¢«è§†ä¸ºåŒæ­¥çš„ã€‚</li>
<li>å½“ä¸”ä»…å½“åœ¨æ‰€æœ‰å¯èƒ½çš„æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸€ä¸ªå¤„ç†å™¨å¯¹å˜é‡çš„å†™æ“ä½œä¸å¦ä¸€å¤„ç†å™¨å¯¹è¯¥å˜é‡çš„è®¿é—®ï¼ˆè¯»æˆ–å†™ï¼‰ä¹‹é—´è¢«ä¸€å¯¹åŒæ­¥æ“ä½œåˆ†éš”â€”â€”å‰è€…ç”±å†™å…¥å¤„ç†å™¨åœ¨å†™æ“ä½œåæ‰§è¡Œï¼Œåè€…ç”±ç¬¬äºŒå¤„ç†å™¨åœ¨è®¿é—®å‰æ‰§è¡Œâ€”â€”è¯¥æ•°æ®å¼•ç”¨æ‰è¢«ç§°ä¸ºå—åŒæ­¥æ“ä½œæ’åºã€‚</li>
<li>å¯èƒ½æœªç»åŒæ­¥æ’åºå°±æ›´æ–°å˜é‡çš„æƒ…å†µç§°ä¸º<strong>æ•°æ®ç«äº‰</strong>(data race)ï¼Œå› ä¸ºæ‰§è¡Œç»“æœå–å†³äºå¤„ç†å™¨çš„ç›¸å¯¹é€Ÿåº¦ï¼›å¦‚åŒç¡¬ä»¶è®¾è®¡ä¸­çš„ç«äº‰ï¼Œå…¶ç»“æœä¸å¯é¢„æµ‹ã€‚è¿™ä¹Ÿä½¿å¾—åŒæ­¥ç¨‹åºè·å¾—äº†å¦ä¸€ä¸ªåç§°ï¼š<strong>æ— æ•°æ®ç«äº‰</strong>(data-race-free)ã€‚</li>
</ul>
<details class="example" open="open">
<summary>ä¾‹å­</summary>
<ul>
<li>è€ƒè™‘ç”±ä¸¤ä¸ªä¸åŒå¤„ç†å™¨è¯»å†™æ›´æ–°çš„å˜é‡ã€‚</li>
<li>æ¯ä¸ªå¤„ç†å™¨éƒ½ä¼šç”¨<strong>åŠ é”</strong>å’Œ<strong>è§£é”</strong>æ“ä½œåŒ…è£¹è¯»å†™è¿‡ç¨‹ï¼Œè¿™æ—¢æ˜¯ä¸ºäº†ç¡®ä¿æ›´æ–°æ“ä½œçš„äº’æ–¥æ€§ï¼Œä¹Ÿæ˜¯ä¸ºäº†ä¿è¯è¯»å–æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li>
<li>æ˜¾ç„¶ï¼Œç°åœ¨æ¯æ¬¡å†™å…¥æ“ä½œä¸å¦ä¸€å¤„ç†å™¨çš„è¯»å–æ“ä½œä¹‹é—´éƒ½é€šè¿‡ä¸€å¯¹<strong>åŒæ­¥æ“ä½œ</strong>éš”ç¦»ï¼šä¸€æ¬¡è§£é”ï¼ˆåœ¨å†™å…¥åæ‰§è¡Œï¼‰å’Œä¸€æ¬¡åŠ é”ï¼ˆåœ¨è¯»å–å‰æ‰§è¡Œ<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
<li>å¦‚æœä¸¤ä¸ªå¤„ç†å™¨è¿ç»­å¯¹å˜é‡è¿›è¡Œå†™å…¥è€Œä¸­é—´æ²¡æœ‰è¯»å–æ“ä½œæ—¶ï¼Œè¿™äº›å†™å…¥åŒæ ·éœ€è¦é€šè¿‡åŒæ­¥æ“ä½œå®ç°éš”ç¦»ã€‚</li>
</ul>
</details>
<p>æ™®éè®¤ä¸ºå¤§å¤šæ•°ç¨‹åºéƒ½æ˜¯å¯åŒæ­¥çš„ã€‚è¿™æ˜¯å› ä¸ºè‹¥è®¿é—®æœªç»åŒæ­¥å¤„ç†ï¼Œç¨‹åºçš„è¿è¡Œè¡Œä¸ºå°†å˜å¾—éš¾ä»¥é¢„æµ‹â€”â€”æ‰§è¡Œé€Ÿåº¦çš„å·®å¼‚ä¼šå†³å®šå“ªä¸ªå¤„ç†å™¨èƒ½åœ¨æ•°æ®ç«äº‰ä¸­èƒœå‡ºï¼Œä»è€Œå½±å“ç¨‹åºæœ€ç»ˆç»“æœã€‚å³ä¾¿åœ¨é¡ºåºè¿è´¯æ€§çš„æ¡ä»¶ä¸‹ï¼Œå¯¹æ­¤ç±»ç¨‹åºè¿›è¡Œé€»è¾‘æ¨æ¼”ä¹Ÿæä¸ºå›°éš¾ã€‚</p>
<p>ç¨‹åºå‘˜å¯ä»¥å°è¯•é€šè¿‡æ„å»ºè‡ªå·±çš„åŒæ­¥æœºåˆ¶æ¥ç¡®ä¿é¡ºåºæ€§ï¼Œä½†è¿™æå…¶å¤æ‚ï¼Œå®¹æ˜“å¯¼è‡´ç¨‹åºå‡ºé”™ï¼Œä¸”å¯èƒ½åœ¨æ¶æ„å±‚é¢ç¼ºä¹æ”¯æŒâ€”â€”æ„å‘³ç€è¿™äº›æœºåˆ¶åœ¨æœªæ¥çš„å¤šå¤„ç†å™¨è¿­ä»£ä¸­å¯èƒ½å¤±æ•ˆã€‚å› æ­¤ï¼Œç»å¤§å¤šæ•°ç¨‹åºå‘˜ä¼šé€‰æ‹©ä½¿ç”¨ç»è¿‡éªŒè¯ã€é’ˆå¯¹å¤šå¤„ç†å™¨åŠåŒæ­¥ç±»å‹ä¼˜åŒ–è¿‡çš„<strong>åŒæ­¥åº“</strong>ã€‚</p>
<p>å¦å¤–ï¼Œé‡‡ç”¨<strong>æ ‡å‡†åŒæ­¥åŸè¯­</strong>èƒ½ç¡®ä¿å³ä¾¿åº•å±‚æ¶æ„å®ç°äº†æ¯”é¡ºåºè¿è´¯æ€§æ›´å®½æ¾çš„å­˜å‚¨ä¸€è‡´æ€§æ¨¡å‹ï¼Œç»è¿‡æ­£ç¡®åŒæ­¥çš„ç¨‹åºä»ä¼šè¡¨ç°å¾—å¦‚åŒç¡¬ä»¶å®ç°äº†é¡ºåºè¿è´¯æ€§ä¸€èˆ¬ã€‚</p>
<h3 id="relaxed-consistency-models">Relaxed Consistency Models<a class="headerlink" href="#relaxed-consistency-models" title="Permanent link">âš“ï¸</a></h3>
<p><strong>æ¾å¼›è¿è´¯æ€§æ¨¡å‹</strong>çš„æ ¸å¿ƒæ€æƒ³æ˜¯å…è®¸è¯»å†™æ“ä½œ<strong>ä¹±åº</strong>å®Œæˆï¼Œä½†é€šè¿‡<strong>åŒæ­¥</strong>æ“ä½œå¼ºåˆ¶æ’åºï¼Œä½¿å¾—åŒæ­¥ç¨‹åºçš„è¡Œä¸ºå¦‚åŒå¤„ç†å™¨å…·æœ‰é¡ºåºä¸€è‡´æ€§ã€‚æ ¹æ®æ‰€æ¾å¼›çš„è¯»å†™é¡ºåºä¸åŒï¼Œå­˜åœ¨å¤šç§æ¾å¼›æ¨¡å‹åˆ†ç±»ã€‚æˆ‘ä»¬é€šè¿‡ä¸€ç»„<span class="heti-skip"><span class="heti-spacing"> </span>X -&gt; Y<span class="heti-spacing"> </span></span>å½¢å¼çš„è§„åˆ™æ¥è§„å®šé¡ºåºå…³ç³»ï¼šè¡¨ç¤ºæ“ä½œ<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>å¿…é¡»åœ¨æ“ä½œ<span class="heti-skip"><span class="heti-spacing"> </span>Y<span class="heti-spacing"> </span></span>å®Œæˆå‰ç»“æŸã€‚é¡ºåºè¿è´¯æ€§è¦æ±‚ç»´æŒæ‰€æœ‰å››ç§å¯èƒ½çš„é¡ºåºï¼šR -&gt; W, R -&gt; R, W -&gt; R, W -&gt; Wã€‚è€Œæ¾å¼›æ¨¡å‹åˆ™é€šè¿‡æ¾å¼›è¿™å››ç§é¡ºåºçš„å­é›†æ¥å®šä¹‰ï¼š</p>
<ul>
<li>ä»…æ¾å¼›<span class="heti-skip"><span class="heti-spacing"> </span>W -&gt; R<span class="heti-spacing"> </span></span>æ’åºä¼šå¾—åˆ°ä¸€ä¸ªç§°ä¸º<strong>å…¨å­˜å‚¨é¡ºåº</strong><span>(total store ordering)<span class="heti-spacing"> </span></span>æˆ–<strong>å¤„ç†å™¨è¿è´¯æ€§</strong><span>(processor consistency)<span class="heti-spacing"> </span></span>çš„æ¨¡å‹ã€‚å› ä¸ºè¯¥æ¨¡å‹ä¿ç•™äº†å†™æ“ä½œçš„é¡ºåºï¼Œå› æ­¤å¾ˆå¤šéµå¾ªé¡ºåºè¿è´¯æ€§çš„ç¨‹åºä¼šé‡‡ç”¨è¿™ä¸€æ¨¡å‹ï¼Œæ— éœ€é¢å¤–çš„åŒæ­¥æ“ä½œã€‚</li>
<li>åŒæ—¶æ¾å¼›<span class="heti-skip"><span class="heti-spacing"> </span>W -&gt; R<span class="heti-spacing"> </span></span>å’Œ<span class="heti-skip"><span class="heti-spacing"> </span>W -&gt; W<span class="heti-spacing"> </span></span>çš„é¡ºåºä¼šå¾—åˆ°ä¸€ä¸ªç§°ä¸º<strong>åå­˜å‚¨é¡ºåº</strong><span>(partial store order)<span class="heti-spacing"> </span></span>çš„æ¨¡å‹ã€‚</li>
<li>æ¾å¼›å…¨éƒ¨å››ç§é¡ºåºä¼šå¾—åˆ°ä¸€ç³»åˆ—çš„æ¨¡å‹ï¼ŒåŒ…æ‹¬<strong>å¼±é¡ºåº</strong>(weak ordering)ã€<span>PowerPC<span class="heti-spacing"> </span></span>è¿è´¯æ€§æ¨¡å‹ã€<strong>é‡Šæ”¾è¿è´¯æ€§</strong>(release consistency)ã€<span>RISC-V<span class="heti-spacing"> </span></span>è¿è´¯æ€§æ¨¡å‹<span><span class="heti-spacing"> </span>...</span></li>
</ul>
<p>é€šè¿‡æ¾å¼›è¿™äº›é¡ºåºçº¦æŸï¼Œå¤„ç†å™¨å¯è·å¾—æ˜¾è‘—çš„æ€§èƒ½ä¼˜åŠ¿ï¼Œè¿™æ­£æ˜¯<span><span class="heti-spacing"> </span>RISC-V</span>ã€<span>ARMv8<span class="heti-spacing"> </span></span>ä»¥åŠ<span class="heti-skip"><span class="heti-spacing"> </span>C++/C<span class="heti-spacing"> </span></span>è¯­è¨€æ ‡å‡†é€‰æ‹©æ¾å¼›è¿è´¯æ€§ä½œä¸ºå†…å­˜æ¨¡å‹çš„åŸå› ã€‚</p>
<p><strong>é‡Šæ”¾è¿è´¯æ€§</strong>åŒºåˆ†äº†ä¸¤ç§åŒæ­¥æ“ä½œï¼š</p>
<ul>
<li>ç”¨äºè·å–å…±äº«å˜é‡è®¿é—®æƒé™çš„<strong>è·å–</strong><span>(acquire)<span class="heti-spacing"> </span></span>æ“ä½œï¼ˆæ ‡è®°ä¸º<span><span class="heti-spacing"> </span><span class="arithmatex">\(S_A\)</span></span>ï¼‰</li>
<li>é‡Šæ”¾å¯¹è±¡ä»¥å…è®¸å…¶ä»–å¤„ç†å™¨è·å¾—è®¿é—®æƒé™çš„<strong>é‡Šæ”¾</strong><span>(release)<span class="heti-spacing"> </span></span>æ“ä½œï¼ˆæ ‡è®°ä¸º<span><span class="heti-spacing"> </span><span class="arithmatex">\(S_R\)</span></span><heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
</ul>
<p>åœ¨åŒæ­¥ç¨‹åºä¸­ï¼Œè·å–æ“ä½œå¿…é¡»å…ˆäºå…±äº«æ•°æ®çš„ä½¿ç”¨æ‰§è¡Œï¼Œè€Œé‡Šæ”¾æ“ä½œå¿…é¡»ä½äºæ‰€æœ‰å…±äº«æ•°æ®æ›´æ–°ä¹‹åã€ä¸”åœ¨ä¸‹ä¸€æ¬¡è·å–æ“ä½œä¹‹å‰å®Œæˆã€‚è¿™ä¸€ç‰¹æ€§ä½¿æˆ‘ä»¬èƒ½å¤Ÿé€‚åº¦æ¾å¼›é¡ºåºè¦æ±‚â€”â€”åªè¦ç¡®ä¿å‘ç”Ÿåœ¨è·å–ä¹‹å‰çš„è¯»å†™æ“ä½œä¸å¿…åœ¨è¯¥è·å–å‰å®Œæˆï¼Œå‘ç”Ÿåœ¨é‡Šæ”¾ä¹‹åçš„è¯»å†™ä¹Ÿæ— é¡»ç­‰å¾…è¯¥é‡Šæ”¾å®Œæˆå³å¯ã€‚</p>
<p>ä¸‹å›¾å±•ç¤ºäº†å„ç±»è¿è´¯æ€§æ¨¡å‹å¯¹ä¸€èˆ¬è®¿é—®å’ŒåŒæ­¥è®¿é—®é¡ºåºçš„çº¦æŸï¼š</p>
<div style="text-align: center">
<img src="images/C5/25.png" width="90%"/>
</div>
<div style="text-align: center">
<img src="images/C5/26.png" width="90%"/>
</div>
<p>é‡Šæ”¾è¿è´¯æ€§æä¾›äº†æœ€å®½æ¾ä¸”æ˜“äºéªŒè¯çš„æ¨¡å‹ä¹‹ä¸€ï¼Œå®ƒèƒ½ç¡®ä¿åŒæ­¥ç¨‹åºè§‚å¯Ÿåˆ°é¡ºåºä¸€è‡´çš„æ‰§è¡Œç»“æœã€‚è™½ç„¶å¤§å¤šæ•°åŒæ­¥æ“ä½œè¦ä¹ˆæ˜¯è·å–è¦ä¹ˆæ˜¯é‡Šæ”¾ï¼Œä½†æŸäº›æ“ä½œå…¼å…·è·å–å’Œé‡Šæ”¾åŠŸèƒ½ï¼Œä¼šå¯¼è‡´æ’åºæ•ˆæœç­‰åŒäºå¼±é¡ºåºã€‚å°½ç®¡åŒæ­¥æ“ä½œæ€»èƒ½ä¿è¯å…ˆå‰çš„å†™æ“ä½œå·²å®Œæˆï¼Œä½†æˆ‘ä»¬æœ‰æ—¶éœ€è¦åœ¨ä¸ä¾èµ–ç‰¹å®šåŒæ­¥æ“ä½œçš„æƒ…å†µä¸‹ç¡®ä¿å†™æ“ä½œçš„å®Œæˆã€‚æ­¤æ—¶å°±éœ€è¦ä½¿ç”¨æ˜¾å¼æŒ‡ä»¤â€”â€”åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>RISC-V<span class="heti-spacing"> </span></span>ä¸­ç§°ä¸º<span><span class="heti-spacing"> </span>FENCE</span>â€”â€”æ¥ç¡®ä¿è¯¥çº¿ç¨‹ä¸­æ‰€æœ‰å…ˆå‰æŒ‡ä»¤å‡å·²å®Œæˆæ‰§è¡Œï¼ŒåŒ…æ‹¬æ‰€æœ‰å†…å­˜å†™å…¥åŠç›¸å…³å¤±æ•ˆæ“ä½œçš„å®Œæˆã€‚</p>
<h2 id="cross-cutting-issues">Cross-Cutting Issues<a class="headerlink" href="#cross-cutting-issues" title="Permanent link">âš“ï¸</a></h2>
<p>ç”±äºå¤šå¤„ç†å™¨é‡æ–°å®šä¹‰äº†è®¸å¤šç³»ç»Ÿç‰¹æ€§ï¼ˆå¦‚æ€§èƒ½è¯„ä¼°ã€å†…å­˜å»¶è¿ŸåŠå¯æ‰©å±•æ€§çš„é‡è¦æ€§<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œå®ƒä»¬å¼•å…¥äº†è·¨è¶Šæ•´ä¸ªæŠ€æœ¯é¢†åŸŸçš„è®¾è®¡é—®é¢˜ï¼Œè¿™äº›é—®é¢˜åŒæ—¶å½±å“ç€ç¡¬ä»¶å’Œè½¯ä»¶ã€‚æœ¬èŠ‚å°†å›´ç»•<strong>å†…å­˜è¿è´¯æ€§</strong>é—®é¢˜ç»™å‡ºè‹¥å¹²ç¤ºä¾‹ã€‚</p>
<h3 id="compiler-optimization-and-the-consistency-model">Compiler Optimization and the Consistency Model<a class="headerlink" href="#compiler-optimization-and-the-consistency-model" title="Permanent link">âš“ï¸</a></h3>
<p>å®šä¹‰å†…å­˜ä¸€è‡´æ€§æ¨¡å‹çš„å¦ä¸€ä¸ªåŸå› æ˜¯ä¸ºäº†æ˜ç¡®å¯¹å…±äº«æ•°æ®å¯æ‰§è¡Œçš„åˆæ³•<strong>ç¼–è¯‘å™¨</strong>ä¼˜åŒ–èŒƒå›´ã€‚</p>
<ul>
<li>åœ¨<strong>æ˜¾å¼</strong>å¹¶è¡Œç¨‹åºä¸­ï¼Œé™¤éåŒæ­¥ç‚¹è¢«æ˜ç¡®å®šä¹‰ä¸”ç¨‹åºå·²åŒæ­¥ï¼Œå¦åˆ™ç¼–è¯‘å™¨ä¸èƒ½äº¤æ¢ä¸¤ä¸ªä¸åŒå…±äº«æ•°æ®é¡¹çš„è¯»å†™æ“ä½œï¼Œå› ä¸ºæ­¤ç±»è½¬æ¢å¯èƒ½ä¼šå½±å“ç¨‹åºè¯­ä¹‰ã€‚<ul>
<li>è¿™ç§é™åˆ¶ç”šè‡³é˜»ç¢äº†ç›¸å¯¹ç®€å•çš„ä¼˜åŒ–ï¼ˆä¾‹å¦‚å…±äº«æ•°æ®çš„å¯„å­˜å™¨åˆ†é…<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œå› ä¸ºè¯¥è¿‡ç¨‹é€šå¸¸æ¶‰åŠè¯»å†™äº¤æ¢ã€‚</li>
</ul>
</li>
<li>è€Œåœ¨<strong>éšå¼</strong>å¹¶è¡ŒåŒ–ç¨‹åºä¸­ï¼ˆæ¯”å¦‚ç”¨é«˜æ€§èƒ½<span><span class="heti-spacing"> </span>Fortran</span>ï¼ˆHPFï¼‰ç¼–å†™çš„ä»£ç <heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œç”±äºç¨‹åºå¿…é¡»åŒæ­¥ä¸”åŒæ­¥ç‚¹å·²çŸ¥ï¼Œå› æ­¤ä¸ä¼šå‡ºç°æ­¤é—®é¢˜ã€‚</li>
</ul>
<p>ä»ç ”ç©¶å’Œå®è·µè§†è§’æ¥çœ‹ï¼Œæ›´æ¾å¼›çš„è¿è´¯æ€§æ¨¡å‹èƒ½å¦ä¸ºç¼–è¯‘å™¨å¸¦æ¥æ˜¾è‘—ä¼˜åŠ¿ä»æ˜¯æ‚¬è€Œæœªå†³çš„é—®é¢˜ï¼Œå…¶ä¸­ç¼ºä¹ç»Ÿä¸€æ¨¡å‹å¾ˆå¯èƒ½ä¼šå»¶ç¼“ç¼–è¯‘å™¨çš„éƒ¨ç½²è¿›ç¨‹ã€‚</p>
<h3 id="using-speculation-to-hide-latency-in-strict-consistency-model">Using Speculation to Hide Latency in Strict Consistency Model<a class="headerlink" href="#using-speculation-to-hide-latency-in-strict-consistency-model" title="Permanent link">âš“ï¸</a></h3>
<p>ç¬¬<span class="heti-skip"><span class="heti-spacing"> </span>3<span class="heti-spacing"> </span></span>ç« è®²åˆ°è¿‡çš„<a href="3.html#hardware-based-speculation">æ¨æµ‹</a>æŠ€æœ¯å¯ç”¨äºéšè—å†…å­˜æ—¶å»¶ã€‚å®ƒåŒæ ·èƒ½ç”¨æ¥æ©ç›–ç”±<strong>ä¸¥æ ¼è¿è´¯æ€§æ¨¡å‹</strong>å¼•å‘çš„æ—¶å»¶ï¼Œä»è€Œè·å¾—è¿‘ä¼¼æ¾å¼›å†…å­˜æ¨¡å‹çš„ä¼˜åŠ¿ã€‚å…¶æ ¸å¿ƒæ€æƒ³æ˜¯å¤„ç†å™¨é€šè¿‡<strong>åŠ¨æ€è°ƒåº¦</strong>é‡æ–°æ’åˆ—å†…å­˜è®¿é—®é¡ºåºï¼Œå…è®¸æŒ‡ä»¤<strong>ä¹±åºæ‰§è¡Œ</strong>ã€‚è¿™ç§ä¹±åºçš„å†…å­˜è®¿é—®å¯èƒ½è¿åé¡ºåºè¿è´¯æ€§åŸåˆ™ï¼Œè¿›è€Œå½±å“ç¨‹åºæ‰§è¡Œç»“æœã€‚å€ŸåŠ©æ”¯æŒæ¨æµ‹æ‰§è¡Œçš„å¤„ç†å™¨æ‰€å…·å¤‡çš„<strong>å»¶è¿Ÿæäº¤</strong>ç‰¹æ€§å¯è§„é¿æ­¤é—®é¢˜ï¼šå‡è®¾ç¼“å­˜ä¸€è‡´æ€§åè®®åŸºäºå¤±æ•ˆæœºåˆ¶è¿ä½œï¼Œè‹¥å¤„ç†å™¨åœ¨æŸä¸ªå†…å­˜å¼•ç”¨æ“ä½œæäº¤å‰æ¥æ”¶åˆ°è¯¥åœ°å€çš„å¤±æ•ˆé€šçŸ¥ï¼Œä¾¿ä¼šè§¦å‘æ¨æµ‹æ¢å¤æœºåˆ¶å›æ»šè®¡ç®—æµç¨‹ï¼Œå¹¶ä»è¢«å¤±æ•ˆçš„å†…å­˜å¼•ç”¨å¤„é‡æ–°å¼€å§‹æ‰§è¡Œã€‚</p>
<p>è‹¥å¤„ç†å™¨å¯¹å†…å­˜è¯·æ±‚çš„é‡æ–°æ’åºå¯¼è‡´æ‰§è¡Œé¡ºåºå¯èƒ½äº§ç”Ÿä¸é¡ºåºè¿è´¯æ€§ä¸‹æ‰€è§ç»“æœä¸åŒçš„æƒ…å†µï¼Œé‚£ä¹ˆè¯¥å¤„ç†å™¨å°†é‡æ–°æ‰§è¡Œã€‚æ­¤æ–¹æ³•çš„å…³é”®åœ¨äºï¼šå¤„ç†å™¨åªéœ€ä¿è¯æœ€ç»ˆç»“æœä¸æ‰€æœ‰è®¿é—®æŒ‰åºå®Œæˆæ—¶ç›¸åŒï¼Œé€šè¿‡æ£€æµ‹å¯èƒ½äº§ç”Ÿå·®å¼‚çš„æƒ…å†µå³å¯å®ç°ç›®æ ‡ã€‚è¯¥æ–¹æ¡ˆçš„ä¼˜è¶Šæ€§åœ¨äºæ¨æµ‹æ€§é‡å¯æå°‘è¢«è§¦å‘ï¼Œä»…å½“æœªåŒæ­¥çš„è®¿é—®çœŸæ­£å¼•å‘ç«äº‰æ—¶æ‰ä¼šå¯åŠ¨é‡å¯æœºåˆ¶ã€‚</p>
<p>æœ‰äººä¸»å¼ å°†é¡ºåºæˆ–å¤„ç†å™¨è¿è´¯æ€§ä¸æ¨æµ‹æ‰§è¡Œç›¸ç»“åˆï¼Œä½œä¸ºä¼˜é€‰çš„è¿è´¯æ€§æ¨¡å‹ã€‚ä¾æ®å¦‚ä¸‹ï¼š</p>
<ul>
<li>å¯¹é¡ºåºè¿è´¯æ€§æˆ–å¤„ç†å™¨è¿è´¯æ€§é‡‡å–æ¿€è¿›å®ç°æ–¹æ¡ˆï¼Œèƒ½è·å¾—æ¯”æ¾å¼›æ¨¡å‹æ›´æ˜¾è‘—çš„ä¼˜åŠ¿</li>
<li>ä»…éœ€åœ¨æ”¯æŒæ¨æµ‹æ‰§è¡Œçš„å¤„ç†å™¨ä¸Šå¢åŠ æä½æˆæœ¬</li>
<li>å…è®¸ç¨‹åºå‘˜åŸºäºæ›´ç®€å•çš„é¡ºåºæˆ–å¤„ç†å™¨è¿è´¯æ€§ç¼–ç¨‹æ¨¡å‹è¿›è¡Œé€»è¾‘æ¨ç†</li>
</ul>
<h3 id="inclusion-and-its-implementation">Inclusion and Its Implementation<a class="headerlink" href="#inclusion-and-its-implementation" title="Permanent link">âš“ï¸</a></h3>
<p>æ‰€æœ‰å¤šå¤„ç†å™¨éƒ½ä¼šç”¨å¤šçº§é«˜é€Ÿç¼“å­˜å±‚çº§æ¥å‡å°‘å¯¹å…¨å±€äº’è¿çš„éœ€æ±‚ä»¥åŠé«˜é€Ÿç¼“å­˜å¤±æ•ˆå¸¦æ¥çš„å»¶è¿Ÿã€‚å¦‚æœé«˜é€Ÿç¼“å­˜å…·å¤‡<strong>å¤šçº§åŒ…å«</strong><span>(multilevel inclusion)<span class="heti-spacing"> </span></span>æ€§è´¨ï¼ˆå³é«˜é€Ÿç¼“å­˜å±‚çº§çš„æ¯ä¸€çº§éƒ½æ˜¯è¿œç¦»å¤„ç†å™¨çš„çº§åˆ«çš„å­é›†<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šçº§ç»“æ„ã€‚è¿™æ ·çš„è¯ï¼Œå½“ç›‘å¬å’Œå¤„ç†å™¨å¿…é¡»ä¸ºé«˜é€Ÿç¼“å­˜ç«äº‰æ—¶ï¼Œå¯ä»¥å‡å°‘ä¸€è‡´æ€§æµé‡å’Œå¤„ç†å™¨æµé‡çš„ç«äº‰ã€‚è®¸å¤šå…·æœ‰å¤šçº§é«˜é€Ÿç¼“å­˜çš„å¤„ç†å™¨å¼ºåˆ¶å…·å¤‡åŒ…å«å±æ€§ã€‚è¿™ç§é™åˆ¶ä¹Ÿç§°ä¸º<strong>å­é›†å±æ€§</strong>(subset property)ï¼Œå› ä¸ºæ¯ä¸ªé«˜é€Ÿç¼“å­˜éƒ½æ˜¯å…¶å±‚æ¬¡ç»“æ„ä¸­ä½äºå…¶ä¸‹æ–¹çš„é«˜é€Ÿç¼“å­˜çš„å­é›†ã€‚</p>
<p>è€ƒè™‘ä¸€ä¸ªä¸¤çº§ç¤ºä¾‹ï¼š<span>L1<span class="heti-spacing"> </span></span>ä¸­çš„ä»»ä½•å¤±æ•ˆè¦ä¹ˆåœ¨<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>ä¸­å‘½ä¸­ï¼Œè¦ä¹ˆåœ¨<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>ä¸­äº§ç”Ÿå¤±æ•ˆï¼Œå¯¼è‡´æ•°æ®è¢«å¸¦å…¥<span class="heti-skip"><span class="heti-spacing"> </span>L1<span class="heti-spacing"> </span></span>å’Œ<span><span class="heti-spacing"> </span>L2</span>ã€‚åŒæ ·ï¼Œä»»ä½•åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>ä¸­å‘½ä¸­çš„æ— æ•ˆåŒ–éƒ½å¿…é¡»å‘é€åˆ°<span><span class="heti-spacing"> </span>L1</span>ã€‚é—®é¢˜æ˜¯å½“<span class="heti-skip"><span class="heti-spacing"> </span>L1<span class="heti-spacing"> </span></span>å’Œ<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>çš„å—å¤§å°ä¸åŒæ—¶ä¼šå‘ç”Ÿä»€ä¹ˆï¼Ÿ</p>
<p><strong>é€‰æ‹©ä¸åŒçš„å—å¤§å°</strong>æ˜¯ç›¸å½“åˆç†çš„ï¼Œå› ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>å°†å¤§å¾—å¤šï¼Œå…¶æ—¶å»¶åœ¨å¤±æ•ˆæŸå¤±ä¸­çš„å æ¯”æ›´å¤§ï¼Œå› æ­¤ä½¿ç”¨æ›´å¤§çš„å—å¤§å°â€”â€”<span>L2<span class="heti-spacing"> </span></span>ä¸­çš„ä¸€ä¸ªå—ä»£è¡¨<span class="heti-skip"><span class="heti-spacing"> </span>L1<span class="heti-spacing"> </span></span>ä¸­çš„å¤šä¸ªå—ï¼Œ<span>L2<span class="heti-spacing"> </span></span>ä¸­çš„å¤±æ•ˆä¼šå¯¼è‡´ç›¸å½“äºå¤šä¸ª<span class="heti-skip"><span class="heti-spacing"> </span>L1<span class="heti-spacing"> </span></span>å—çš„æ•°æ®æ›¿æ¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æœ<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>çš„å—å¤§å°æ˜¯<span class="heti-skip"><span class="heti-spacing"> </span>L1<span class="heti-spacing"> </span></span>çš„<span class="heti-skip"><span class="heti-spacing"> </span>4<span class="heti-spacing"> </span></span>å€ï¼Œé‚£ä¹ˆ<span class="heti-skip"><span class="heti-spacing"> </span>L2<span class="heti-spacing"> </span></span>ä¸­çš„å¤±æ•ˆå°†æ›¿æ¢ç›¸å½“äº<span class="heti-skip"><span class="heti-spacing"> </span>4<span class="heti-spacing"> </span></span>ä¸ª<span class="heti-skip"><span class="heti-spacing"> </span>L1<span class="heti-spacing"> </span></span>å—çš„æ•°æ®ã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="__tabbed_5_1" name="__tabbed_5" type="radio"/><input id="__tabbed_5_2" name="__tabbed_5" type="radio"/><div class="tabbed-labels"><label for="__tabbed_5_1">é¢˜ç›®</label><label for="__tabbed_5_2">è§£ç­”</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/27.png" width="80%"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/C5/28.png" width="80%"/>
</div>
</div>
</div>
</div>
</details>
<p>ä¸ºäº†åœ¨å¤šç§å—å¤§å°ä¸‹ä¿æŒåŒ…å«æ€§ï¼Œå½“è¾ƒä½å±‚çº§å‘ç”Ÿæ›¿æ¢æ“ä½œæ—¶ï¼Œæˆ‘ä»¬å¿…é¡»æ¢æŸ¥å±‚çº§çš„æ›´é«˜å±‚çº§ï¼Œä»¥ç¡®ä¿è¢«æ›¿æ¢å‡ºçš„æ•°æ®åœ¨é«˜å±‚çº§ç¼“å­˜ä¸­å‡ä¸ºå¤±æ•ˆï¼›ä¸åŒç›¸è”ç¨‹åº¦çš„è®¾ç½®ä¼šå¸¦æ¥é—®é¢˜ã€‚</p>
<h2 id="fallacies-and-pitfalls">Fallacies and Pitfalls<a class="headerlink" href="#fallacies-and-pitfalls" title="Permanent link">âš“ï¸</a></h2>
<div class="admonition bug">
<p class="admonition-title">é™·é˜±</p>
<ul>
<li>ä½¿ç”¨<strong>çº¿æ€§åŠ é€Ÿæ¯”</strong><span>(linear speedup)<span class="heti-spacing"> </span></span>æ¥è¡¡é‡å¤šå¤„ç†å™¨æ€§èƒ½<ul>
<li>ç†æƒ³æƒ…å†µä¸‹ï¼Œæ€§èƒ½æå‡åº”è¯¥ä¸å¤„ç†å™¨æ•°é‡æˆçº¿æ€§å…³ç³»ï¼Œä½†å®é™…ä¸­ï¼Œé¢å¤–çš„å¤„ç†å™¨å¯èƒ½ä¼šå¸¦æ¥é¢å¤–çš„å¼€é”€ã€‚</li>
<li>ä½†åœ¨å®é™…æƒ…å†µä¸­ï¼Œéšç€å¤„ç†å™¨æ•°é‡çš„å¢åŠ ï¼Œæ€§èƒ½æå‡é€šå¸¸ä¼šå—åˆ°å„ç§å› ç´ çš„é™åˆ¶ï¼Œä¾‹å¦‚é€šä¿¡å¼€é”€ã€åŒæ­¥å¼€é”€ä»¥åŠè´Ÿè½½ä¸å‡è¡¡ã€‚</li>
</ul>
</li>
<li>æœªå¼€å‘æˆ–ä¼˜åŒ–<strong>è½¯ä»¶</strong>ä»¥å……åˆ†åˆ©ç”¨å¤šå¤„ç†å™¨<ul>
<li>è½¯ä»¶å¼€å‘é€šå¸¸æ»åäºç¡¬ä»¶çš„å‘å±•ï¼Œè®¸å¤šç¨‹åºæœªé’ˆå¯¹å¤šå¤„ç†å™¨ç¯å¢ƒè¿›è¡Œä¼˜åŒ–ã€‚</li>
<li>æˆ‘ä»¬åœ¨è®¾è®¡è½¯ä»¶æ—¶ï¼Œéœ€è¦å……åˆ†è€ƒè™‘å¤šå¤„ç†å™¨ç¯å¢ƒçš„ç‰¹ç‚¹ï¼Œé¿å…è®¾è®¡ä¸Šçš„ç“¶é¢ˆã€‚</li>
</ul>
</li>
<li>å¿½è§†<strong>æ€§èƒ½</strong>æˆæœ¬<ul>
<li>éšç€å¤„ç†å™¨æ•°é‡å¢åŠ ï¼Œæ€§èƒ½æˆæœ¬å¯èƒ½ä¼šæ˜¾è‘—ä¸Šå‡ï¼Œç”šè‡³å¯¼è‡´æ€§èƒ½ä¸‹é™ã€‚</li>
<li>æ€§èƒ½æˆæœ¬åŒ…æ‹¬é€šä¿¡å¼€é”€ã€åŒæ­¥å¼€é”€ä»¥åŠèµ„æºç«äº‰ç­‰ã€‚</li>
</ul>
</li>
</ul>
</div>
<div class="admonition failure">
<p class="admonition-title">è°¬è¯¯</p>
<ul>
<li>é˜¿å§†è¾¾å°”å®šå¾‹ä¸é€‚ç”¨äºå¹¶è¡Œè®¡ç®—<ul>
<li>é˜¿å§†è¾¾å°”å®šå¾‹æŒ‡å‡ºï¼Œå³ä½¿å¤„ç†å™¨æ•°é‡æ— é™å¢åŠ ï¼Œç¨‹åºçš„åŠ é€Ÿæ¯”ä¹Ÿä¼šå—åˆ°<strong>ä¸²è¡Œ</strong>éƒ¨åˆ†çš„é™åˆ¶ã€‚</li>
</ul>
</li>
</ul>
</div>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="æœ€åæ›´æ–°">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025å¹´6æœˆ1æ—¥ 12:04:23">2025å¹´6æœˆ1æ—¥ 12:04:23</span>
</span>
<span class="md-source-file__fact">
<span class="md-icon" title="åˆ›å»ºæ—¥æœŸ">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025å¹´3æœˆ2æ—¥ 21:04:42">2025å¹´3æœˆ2æ—¥ 21:04:42</span>
</span>
</aside>
<p style="font-size: 30px; font-weight: 600">è¯„è®ºåŒº</p>
<div>
    å¦‚æœå¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–æƒ³æ³•ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹ç•™è¨€~
  </div>
<!-- Insert generated snippet here -->
<script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOMAb9Zs4CfmpP" data-emit-metadata="0" data-input-position="bottom" data-lang="zh-CN" data-mapping="pathname" data-reactions-enabled="1" data-repo="noughtq/notebook" data-repo-id="R_kgDOMAb9Zg" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js">
</script>
<!-- Synchronize Giscus theme with palette -->
<script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>
<!-- æ ‡é¢˜è®¡æ•°å™¨ -->
<link href="/css/counter.css" rel="stylesheet"/>
<!-- ä¸»é¡µä¸ªæ€§åŒ– -->
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  å›åˆ°é¡µé¢é¡¶éƒ¨
</button>
</main>
<footer class="md-footer">
<nav aria-label="é¡µè„š" class="md-footer__inner md-grid">
<a aria-label="ä¸Šä¸€é¡µ: Chap 4: Data-Level Parallelism" class="md-footer__link md-footer__link--prev" href="4.html">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M41.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L109.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
<div class="md-ellipsis">
                Chap 4: Data-Level Parallelism
              </div>
</div>
</a>
<a aria-label="ä¸‹ä¸€é¡µ: æ•°æ®åº“ç³»ç»Ÿ" class="md-footer__link md-footer__link--next" href="../db/index.html">
<div class="md-footer__title">
<span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
<div class="md-ellipsis">
                æ•°æ®åº“ç³»ç»Ÿ
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 320 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M278.6 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L210.7 256 73.4 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright" style="margin-left: 33.5%">
<div class="md-copyright__highlight" style="text-align: center">
        Copyright Â© 2024-2025 <a href="https://github.com/NoughtQ">NoughtQ</a>
</div>
    
    
      Powered by
      <a href="https://www.mkdocs.org/" rel="noopener" target="_blank">
        MkDocs
      </a>
      with theme
      <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
        Material
      </a>
      modified by
      <a href="https://github.com/NoughtQ" rel="noopener" target="_blank">
        NoughtQ
      </a>
<!-- <br> -->
<div style="text-align: center;">
<a href="https://icp.gov.moe/?keyword=20252357" target="_blank">èŒICPå¤‡20252357å·</a>
</div>
</div>
<div class="md-social">
<a class="md-social__link" href="https://github.com/noughtq" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 496 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"></path></svg>
</a>
<a class="md-social__link" href="https://blog.noughtq.top" rel="noopener" target="_blank" title="blog.noughtq.top">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M192 32c0 17.7 14.3 32 32 32 123.7 0 224 100.3 224 224 0 17.7 14.3 32 32 32s32-14.3 32-32C512 128.9 383.1 0 224 0c-17.7 0-32 14.3-32 32m0 96c0 17.7 14.3 32 32 32 70.7 0 128 57.3 128 128 0 17.7 14.3 32 32 32s32-14.3 32-32c0-106-86-192-192-192-17.7 0-32 14.3-32 32m-96 16c0-26.5-21.5-48-48-48S0 117.5 0 144v224c0 79.5 64.5 144 144 144s144-64.5 144-144-64.5-144-144-144h-16v96h16c26.5 0 48 21.5 48 48s-21.5 48-48 48-48-21.5-48-48z"></path></svg>
</a>
<a class="md-social__link" href="mailto:noughtq666@gmail.com" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.code.annotate", "content.footnote.tooltips", "header.autohide", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.indexes", "navigation.tracking", "navigation.prune", "search.share"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.13a4f30d.min.js"></script>
<script src="../../js/anchor.js"></script>
<script src="../../js/katex.js"></script>
<script src="../../js/toc.js"></script>
<script src="../../js/typed.js"></script>
<script src="../../js/custom.js"></script>
<script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
<script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
</body>
</html>