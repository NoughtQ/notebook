<!DOCTYPE html>
<html class="no-js" lang="zh">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<meta content="NoughtQçš„ç¬”è®°æœ¬ï¼Œä¸»è¦è®°å½•ä¸€äº› CS ç›¸å…³çš„ç¬”è®°" name="description"/>
<meta content="NoughtQ" name="author"/>
<link href="https://notebook.noughtq.top/system/db/15.html" rel="canonical"/>
<link href="14.html" rel="prev"/>
<link href="../../web/index.html" rel="next"/>
<link href="../../feed_rss_created.xml" rel="alternate" title="RSS è®¢é˜…" type="application/rss+xml"/>
<link href="../../feed_rss_updated.xml" rel="alternate" title="å·²æ›´æ–°å†…å®¹çš„ RSS è®¢é˜…" type="application/rss+xml"/>
<link href="../../assets/favicon.png" rel="icon"/>
<meta content="mkdocs-1.6.1, mkdocs-material-9.6.18" name="generator"/>
<title>Lec 15: Recovery System - NoughtQçš„ç¬”è®°æœ¬</title>
<link href="../../assets/stylesheets/main.7e37652d.min.css" rel="stylesheet"/>
<link href="../../assets/stylesheets/palette.06af60db.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=JetBrains+Mono,+LXGW+WenKai+Screen+GB+Screen:300,300i,400,400i,700,700i%7CJetBrains+Mono,+Consolas:400,400i,700,700i&amp;display=fallback" rel="stylesheet"/>
<style>:root{--md-text-font:"JetBrains Mono, LXGW WenKai Screen GB Screen";--md-code-font:"JetBrains Mono, Consolas"}</style>
<link href="../../css/heti.css" rel="stylesheet"/>
<link href="../../css/toc_extra.css" rel="stylesheet"/>
<link href="../../css/timeline.css" rel="stylesheet"/>
<link href="../../css/card.css" rel="stylesheet"/>
<link href="../../css/custom.css" rel="stylesheet"/>
<link href="../../css/extra_changelog.css" rel="stylesheet"/>
<link href="../../css/header.css" rel="stylesheet"/>
<link href="../../css/sidebar.css" rel="stylesheet"/>
<link href="https://unpkg.com/katex@0/dist/katex.min.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-screen-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://gcore.jsdelivr.net/npm/lxgw-wenkai-webfont@1.1.0/style.css" rel="stylesheet"/>
<link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&amp;display=swap" rel="stylesheet"/>
<script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
<script id="__analytics">function __md_analytics(){function e(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],e("js",new Date),e("config","G-43NH8CVRCJ"),document.addEventListener("DOMContentLoaded",(function(){document.forms.search&&document.forms.search.query.addEventListener("blur",(function(){this.value&&e("event","search",{search_term:this.value})}));document$.subscribe((function(){var t=document.forms.feedback;if(void 0!==t)for(var a of t.querySelectorAll("[type=submit]"))a.addEventListener("click",(function(a){a.preventDefault();var n=document.location.pathname,d=this.getAttribute("data-md-value");e("event","feedback",{page:n,data:d}),t.firstElementChild.disabled=!0;var r=t.querySelector(".md-feedback__note [data-md-value='"+d+"']");r&&(r.hidden=!1)})),t.hidden=!1})),location$.subscribe((function(t){e("config","G-43NH8CVRCJ",{page_path:t.pathname})}))}));var t=document.createElement("script");t.async=!0,t.src="https://www.googletagmanager.com/gtag/js?id=G-43NH8CVRCJ",document.getElementById("__analytics").insertAdjacentElement("afterEnd",t)}</script>
<script>"undefined"!=typeof __md_analytics&&__md_analytics()</script>
</head>
<body data-md-color-accent="indigo" data-md-color-primary="indigo" data-md-color-scheme="slate" dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#lec-15-recovery-system">
          è·³è½¬è‡³
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="é¡µçœ‰" class="md-header__inner md-grid">
<a aria-label="NoughtQçš„ç¬”è®°æœ¬" class="md-header__button md-logo" data-md-component="logo" href="../.." title="NoughtQçš„ç¬”è®°æœ¬">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.05 9H7.06V6h1.99V4.03H7.06v-1c0-1.11.89-1.99 1.99-1.99h5.98V8l2.47-1.5L20 8V1.04h1c1.05 0 2 .96 2 1.99V17c0 1.03-.95 2-2 2H9.05c-1.05 0-1.99-.95-1.99-2v-1h1.99v-2H7.06v-3h1.99zM1 18h2v-3H1v-2h2v-3H1V8h2V5h2v3H3v2h2v3H3v2h2v3H3v2h2v1h16v2H5a2 2 0 0 1-2-2v-1H1z"></path></svg>
</a>
<label class="md-header__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"></path></svg>
</label>
<div class="md-header__title" data-md-component="header-title">
<div class="md-header__ellipsis">
<div class="md-header__topic">
<span class="md-ellipsis">
            NoughtQçš„ç¬”è®°æœ¬
          </span>
</div>
<div class="md-header__topic" data-md-component="header-topic">
<span class="md-ellipsis">
            
              Lec 15: Recovery System
            
          </span>
</div>
</div>
</div>
<form class="md-header__option" data-md-component="palette">
<input aria-label="Dark Mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefer-color-scheme: dark)" data-md-color-primary="indigo" data-md-color-scheme="slate" id="__palette_0" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_1" hidden="" title="Dark Mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"></path></svg>
</label>
<input aria-label="Light Mode" class="md-option" data-md-color-accent="indigo" data-md-color-media="(prefer-color-scheme: light)" data-md-color-primary="indigo" data-md-color-scheme="default" id="__palette_1" name="__palette" type="radio"/>
<label class="md-header__button md-icon" for="__palette_0" hidden="" title="Light Mode">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"></path></svg>
</label>
</form>
<script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
<label class="md-header__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="æœç´¢" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" name="query" placeholder="æœç´¢" required="" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"></path></svg>
<svg viewbox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z" fill="currentColor"></path></svg>
</label>
<nav aria-label="æŸ¥æ‰¾" class="md-search__options">
<a aria-label="åˆ†äº«" class="md-search__icon md-icon" data-clipboard="" data-clipboard-text="" data-md-component="search-share" href="javascript:void(0)" tabindex="-1" title="åˆ†äº«">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"></path></svg>
</a>
<button aria-label="æ¸…ç©ºå½“å‰å†…å®¹" class="md-search__icon md-icon" tabindex="-1" title="æ¸…ç©ºå½“å‰å†…å®¹" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"></path></svg>
</button>
</nav>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="" tabindex="0">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
<ol class="md-search-result__list" role="presentation"></ol>
</div>
</div>
</div>
</div>
</div>
<div class="md-header__source">
<a class="md-source" data-md-component="source" href="https://github.com/noughtq/notebook" title="å‰å¾€ä»“åº“">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    NoughtQ/Notebook
  </div>
</a>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<nav aria-label="æ ‡ç­¾" class="md-tabs" data-md-component="tabs">
<div class="md-grid">
<ul class="md-tabs__list">
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../index.html">
          
  
  
    
  
  ğŸ«ä¸»é¡µ

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../lang/index.html">
          
  
  
    
  
  ğŸ”¡è¯­è¨€

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../math/index.html">
          
  
  
    
  
  ğŸ“Šæ•°å­¦ç›¸å…³

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../algorithms/index.html">
          
  
  
    
  
  ğŸ§®ç®—æ³•ç›¸å…³

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../software/index.html">
          
  
  
    
  
  ğŸ’¾è½¯ä»¶ç›¸å…³

        </a>
</li>
<li class="md-tabs__item md-tabs__item--active">
<a class="md-tabs__link" href="../index.html">
          
  
  
    
  
  ğŸ’»ç³»ç»Ÿç›¸å…³

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../web/index.html">
          
  
  
    
  
  ğŸŒWebç›¸å…³

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../sec/ctf-101/index.html">
          
  
  
    
  
  ğŸ›¡ï¸ä¿¡æ¯å®‰å…¨

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../ai/index.html">
          
  
  
    
  
  ğŸ¤–äººå·¥æ™ºèƒ½

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../misc/index.html">
          
  
  
    
  
  ğŸ—ƒï¸æ‚é¡¹

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../tools/index.html">
          
  
  
    
  
  ğŸ› ï¸å·¥å…·

        </a>
</li>
<li class="md-tabs__item">
<a class="md-tabs__link" href="../../papers/index.html">
          
  
  
    
  
  ğŸ“‘è®ºæ–‡é˜…è¯»

        </a>
</li>
</ul>
</div>
</nav>
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="å¯¼èˆªæ " class="md-nav md-nav--primary md-nav--lifted" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="NoughtQçš„ç¬”è®°æœ¬" class="md-nav__button md-logo" data-md-component="logo" href="../.." title="NoughtQçš„ç¬”è®°æœ¬">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.05 9H7.06V6h1.99V4.03H7.06v-1c0-1.11.89-1.99 1.99-1.99h5.98V8l2.47-1.5L20 8V1.04h1c1.05 0 2 .96 2 1.99V17c0 1.03-.95 2-2 2H9.05c-1.05 0-1.99-.95-1.99-2v-1h1.99v-2H7.06v-3h1.99zM1 18h2v-3H1v-2h2v-3H1V8h2V5h2v3H3v2h2v3H3v2h2v3H3v2h2v1h16v2H5a2 2 0 0 1-2-2v-1H1z"></path></svg>
</a>
    NoughtQçš„ç¬”è®°æœ¬
  </label>
<div class="md-nav__source">
<a class="md-source" data-md-component="source" href="https://github.com/noughtq/notebook" title="å‰å¾€ä»“åº“">
<div class="md-source__icon md-icon">
<svg viewbox="0 0 448 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4" fill="currentColor"></path></svg>
</div>
<div class="md-source__repository">
    NoughtQ/Notebook
  </div>
</a>
</div>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../index.html">
<span class="md-ellipsis">
    ğŸ«ä¸»é¡µ
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../lang/index.html">
<span class="md-ellipsis">
    ğŸ”¡è¯­è¨€
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../math/index.html">
<span class="md-ellipsis">
    ğŸ“Šæ•°å­¦ç›¸å…³
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../algorithms/index.html">
<span class="md-ellipsis">
    ğŸ§®ç®—æ³•ç›¸å…³
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../software/index.html">
<span class="md-ellipsis">
    ğŸ’¾è½¯ä»¶ç›¸å…³
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="../index.html">
<span class="md-ellipsis">
    ğŸ’»ç³»ç»Ÿç›¸å…³
    
  </span>
</a>
<label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_6_label" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="__nav_6">
<span class="md-nav__icon md-icon"></span>
            ğŸ’»ç³»ç»Ÿç›¸å…³
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../csapp/index.html">
<span class="md-ellipsis">
    CSAPP
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../dld/index.html">
<span class="md-ellipsis">
    æ•°å­—é€»è¾‘è®¾è®¡
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../co/index.html">
<span class="md-ellipsis">
    è®¡ç®—æœºç»„æˆ
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../ca/index.html">
<span class="md-ellipsis">
    è®¡ç®—æœºä½“ç³»ç»“æ„
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" id="__nav_6_6" type="checkbox"/>
<div class="md-nav__link md-nav__container">
<a class="md-nav__link" href="index.html">
<span class="md-ellipsis">
    æ•°æ®åº“ç³»ç»Ÿ
    
  </span>
</a>
<label class="md-nav__link" for="__nav_6_6" id="__nav_6_6_label" tabindex="0">
<span class="md-nav__icon md-icon"></span>
</label>
</div>
<nav aria-expanded="true" aria-labelledby="__nav_6_6_label" class="md-nav" data-md-level="2">
<label class="md-nav__title" for="__nav_6_6">
<span class="md-nav__icon md-icon"></span>
            æ•°æ®åº“ç³»ç»Ÿ
          </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="1.html">
<span class="md-ellipsis">
    Lec 1: Introduction
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="2.html">
<span class="md-ellipsis">
    Lec 2: Relational Model
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="3.html">
<span class="md-ellipsis">
    Lec 3: Introduction to SQL
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="4.html">
<span class="md-ellipsis">
    Lec 4: Intermediate SQL
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="5.html">
<span class="md-ellipsis">
    Lec 5: Advanced SQL
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="6.html">
<span class="md-ellipsis">
    Lec 6: Database Design Using the E-R Model
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="7.html">
<span class="md-ellipsis">
    Lec 7: Relational Database Design
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="8.html">
<span class="md-ellipsis">
    Lec 8: Physical Storage Systems
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="9.html">
<span class="md-ellipsis">
    Lec 9: Database Storage Structures
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="10.html">
<span class="md-ellipsis">
    Lec 10: Indexing
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="11.html">
<span class="md-ellipsis">
    Lec 11: Query Processing
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="12.html">
<span class="md-ellipsis">
    Lec 12: Query Optimization
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="13.html">
<span class="md-ellipsis">
    Lec 13: Transactions
    
  </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="14.html">
<span class="md-ellipsis">
    Lec 14: Concurrency Control
    
  </span>
</a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
<span class="md-ellipsis">
    Lec 15: Recovery System
    
  </span>
<span class="md-nav__icon md-icon"></span>
</label>
<a class="md-nav__link md-nav__link--active" href="15.html">
<span class="md-ellipsis">
    Lec 15: Recovery System
    
  </span>
</a>
<nav aria-label="ç›®å½•" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
        ç›®å½•
      </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#failure-classification">
<span class="md-ellipsis">
      Failure Classification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#storage">
<span class="md-ellipsis">
      Storage
    </span>
</a>
<nav aria-label="Storage" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#stable-storage-implementation">
<span class="md-ellipsis">
      Stable-Storage Implementation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-access">
<span class="md-ellipsis">
      Data Access
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log-based-recovery">
<span class="md-ellipsis">
      Log-Based Recovery
    </span>
</a>
<nav aria-label="Log-Based Recovery" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#log-records">
<span class="md-ellipsis">
      Log Records
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#database-modification">
<span class="md-ellipsis">
      Database Modification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#concurrency-control-and-recovery">
<span class="md-ellipsis">
      Concurrency Control and Recovery
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#transaction-commit">
<span class="md-ellipsis">
      Transaction Commit
    </span>
</a>
<nav aria-label="Transaction Commit" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#group-commit">
<span class="md-ellipsis">
      Group Commit
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-the-log-to-redo-and-undo-transactions">
<span class="md-ellipsis">
      Using the Log to Redo and Undo Transactions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#transaction-rollback">
<span class="md-ellipsis">
      Transaction Rollback
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#checkpoints">
<span class="md-ellipsis">
      Checkpoints
    </span>
</a>
<nav aria-label="Checkpoints" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fuzzy-checkpointing">
<span class="md-ellipsis">
      Fuzzy Checkpointing
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recovery-after-a-system-crash">
<span class="md-ellipsis">
      Recovery After a System Crash
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#buffer-management">
<span class="md-ellipsis">
      Buffer Management
    </span>
</a>
<nav aria-label="Buffer Management" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#log-record-buffering">
<span class="md-ellipsis">
      Log-Record Buffering
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#buffer-pool-management-policies">
<span class="md-ellipsis">
      Buffer Pool Management Policies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#operating-system-role-in-buffer-management">
<span class="md-ellipsis">
      Operating System Role in Buffer Management
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#early-lock-release-and-logical-undo-operations">
<span class="md-ellipsis">
      Early Lock Release and Logical Undo Operations
    </span>
</a>
<nav aria-label="Early Lock Release and Logical Undo Operations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#logical-operations">
<span class="md-ellipsis">
      Logical Operations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#logical-undo-log-records">
<span class="md-ellipsis">
      Logical Undo Log Records
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#transaction-rollback-with-logical-undo">
<span class="md-ellipsis">
      Transaction Rollback with Logical Undo
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aries">
<span class="md-ellipsis">
      ARIES
    </span>
</a>
<nav aria-label="ARIES" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#data-structures">
<span class="md-ellipsis">
      Data Structures
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recovery-algorithm">
<span class="md-ellipsis">
      Recovery Algorithm
    </span>
</a>
<nav aria-label="Recovery Algorithm" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#analysis-pass">
<span class="md-ellipsis">
      Analysis Pass
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#redo-pass">
<span class="md-ellipsis">
      Redo Pass
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#undo-pass">
<span class="md-ellipsis">
      Undo Pass
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#other-features">
<span class="md-ellipsis">
      Other Features
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#supplements">
<span class="md-ellipsis">
      Supplements
    </span>
</a>
<nav aria-label="Supplements" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#failure-with-loss-of-non-volatile-storage">
<span class="md-ellipsis">
      Failure with Loss of Non-Volatile Storage
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#high-availability-of-using-remote-backup-system">
<span class="md-ellipsis">
      High Availability of Using Remote Backup System
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../web/index.html">
<span class="md-ellipsis">
    ğŸŒWebç›¸å…³
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../sec/ctf-101/index.html">
<span class="md-ellipsis">
    ğŸ›¡ï¸ä¿¡æ¯å®‰å…¨
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../ai/index.html">
<span class="md-ellipsis">
    ğŸ¤–äººå·¥æ™ºèƒ½
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../misc/index.html">
<span class="md-ellipsis">
    ğŸ—ƒï¸æ‚é¡¹
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../tools/index.html">
<span class="md-ellipsis">
    ğŸ› ï¸å·¥å…·
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
<li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
<a class="md-nav__link" href="../../papers/index.html">
<span class="md-ellipsis">
    ğŸ“‘è®ºæ–‡é˜…è¯»
    
  </span>
<span class="md-nav__icon md-icon"></span>
</a>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="ç›®å½•" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon"></span>
        ç›®å½•
      </label>
<ul class="md-nav__list" data-md-component="toc" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#failure-classification">
<span class="md-ellipsis">
      Failure Classification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#storage">
<span class="md-ellipsis">
      Storage
    </span>
</a>
<nav aria-label="Storage" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#stable-storage-implementation">
<span class="md-ellipsis">
      Stable-Storage Implementation
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#data-access">
<span class="md-ellipsis">
      Data Access
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#log-based-recovery">
<span class="md-ellipsis">
      Log-Based Recovery
    </span>
</a>
<nav aria-label="Log-Based Recovery" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#log-records">
<span class="md-ellipsis">
      Log Records
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#database-modification">
<span class="md-ellipsis">
      Database Modification
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#concurrency-control-and-recovery">
<span class="md-ellipsis">
      Concurrency Control and Recovery
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#transaction-commit">
<span class="md-ellipsis">
      Transaction Commit
    </span>
</a>
<nav aria-label="Transaction Commit" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#group-commit">
<span class="md-ellipsis">
      Group Commit
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#using-the-log-to-redo-and-undo-transactions">
<span class="md-ellipsis">
      Using the Log to Redo and Undo Transactions
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#transaction-rollback">
<span class="md-ellipsis">
      Transaction Rollback
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#checkpoints">
<span class="md-ellipsis">
      Checkpoints
    </span>
</a>
<nav aria-label="Checkpoints" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#fuzzy-checkpointing">
<span class="md-ellipsis">
      Fuzzy Checkpointing
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recovery-after-a-system-crash">
<span class="md-ellipsis">
      Recovery After a System Crash
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#buffer-management">
<span class="md-ellipsis">
      Buffer Management
    </span>
</a>
<nav aria-label="Buffer Management" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#log-record-buffering">
<span class="md-ellipsis">
      Log-Record Buffering
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#buffer-pool-management-policies">
<span class="md-ellipsis">
      Buffer Pool Management Policies
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#operating-system-role-in-buffer-management">
<span class="md-ellipsis">
      Operating System Role in Buffer Management
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#early-lock-release-and-logical-undo-operations">
<span class="md-ellipsis">
      Early Lock Release and Logical Undo Operations
    </span>
</a>
<nav aria-label="Early Lock Release and Logical Undo Operations" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#logical-operations">
<span class="md-ellipsis">
      Logical Operations
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#logical-undo-log-records">
<span class="md-ellipsis">
      Logical Undo Log Records
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#transaction-rollback-with-logical-undo">
<span class="md-ellipsis">
      Transaction Rollback with Logical Undo
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#aries">
<span class="md-ellipsis">
      ARIES
    </span>
</a>
<nav aria-label="ARIES" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#data-structures">
<span class="md-ellipsis">
      Data Structures
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#recovery-algorithm">
<span class="md-ellipsis">
      Recovery Algorithm
    </span>
</a>
<nav aria-label="Recovery Algorithm" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#analysis-pass">
<span class="md-ellipsis">
      Analysis Pass
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#redo-pass">
<span class="md-ellipsis">
      Redo Pass
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#undo-pass">
<span class="md-ellipsis">
      Undo Pass
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#other-features">
<span class="md-ellipsis">
      Other Features
    </span>
</a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#supplements">
<span class="md-ellipsis">
      Supplements
    </span>
</a>
<nav aria-label="Supplements" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#failure-with-loss-of-non-volatile-storage">
<span class="md-ellipsis">
      Failure with Loss of Non-Volatile Storage
    </span>
</a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#high-availability-of-using-remote-backup-system">
<span class="md-ellipsis">
      High Availability of Using Remote Backup System
    </span>
</a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content" data-md-component="content">
<article class="md-content__inner md-typeset">
<a class="md-content__button md-icon" href="https://github.com/noughtq/notebook/edit/master/docs/system/db/15.md" rel="edit" title="ç¼–è¾‘æ­¤é¡µ">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"></path></svg>
</a>
<a class="md-content__button md-icon" href="https://github.com/noughtq/notebook/raw/master/docs/system/db/15.md" title="æŸ¥çœ‹æœ¬é¡µçš„æºä»£ç ">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M17 18c.56 0 1 .44 1 1s-.44 1-1 1-1-.44-1-1 .44-1 1-1m0-3c-2.73 0-5.06 1.66-6 4 .94 2.34 3.27 4 6 4s5.06-1.66 6-4c-.94-2.34-3.27-4-6-4m0 6.5a2.5 2.5 0 0 1-2.5-2.5 2.5 2.5 0 0 1 2.5-2.5 2.5 2.5 0 0 1 2.5 2.5 2.5 2.5 0 0 1-2.5 2.5M9.27 20H6V4h7v5h5v4.07c.7.08 1.36.25 2 .49V8l-6-6H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h4.5a8.2 8.2 0 0 1-1.23-2"></path></svg>
</a>
<div><h1 id="lec-15-recovery-system">Lec 15: Recovery System<a class="headerlink" href="#lec-15-recovery-system" title="Permanent link">âš“ï¸</a></h1>
<div style="margin-top: -30px; font-size: 0.9em; opacity: 0.7;">
<p><span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 2A10 10 0 0 0 2 12a10 10 0 0 0 10 10 10 10 0 0 0 10-10h-2a8 8 0 0 1-8 8 8 8 0 0 1-8-8 8 8 0 0 1 8-8zm6.78 1a.7.7 0 0 0-.48.2l-1.22 1.21 2.5 2.5L20.8 5.7c.26-.26.26-.7 0-.95L19.25 3.2c-.13-.13-.3-.2-.47-.2m-2.41 2.12L9 12.5V15h2.5l7.37-7.38z"></path></svg></span> çº¦<span class="heti-skip"><span class="heti-spacing"> </span>17986<span class="heti-spacing"> </span></span>ä¸ªå­— <span class="twemoji"><svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12 20c4.42 0 8-3.58 8-8s-3.58-8-8-8-8 3.58-8 8 3.58 8 8 8m0-18c5.5 0 10 4.5 10 10s-4.5 10-10 10C6.47 22 2 17.5 2 12S6.5 2 12 2m.5 11H11V7h1.5v4.26l3.7-2.13.75 1.3z"></path></svg></span> é¢„è®¡é˜…è¯»æ—¶é—´<span class="heti-skip"><span class="heti-spacing"> </span>90<span class="heti-spacing"> </span></span>åˆ†é’Ÿ</p>
</div>
<details class="abstract">
<summary>æ ¸å¿ƒçŸ¥è¯†</summary>
<ul>
<li>åŸºäºæ—¥å¿—çš„æ¢å¤<ul>
<li>æ—¥å¿—è®°å½•</li>
<li>æäº¤<ul>
<li>ç»„æäº¤</li>
</ul>
</li>
<li>å›æ»šï¼š<ul>
<li>æ’¤é”€</li>
<li>é‡åš</li>
</ul>
</li>
<li>æ£€æŸ¥ç‚¹<ul>
<li>æ¨¡ç³Šæ£€æŸ¥ç‚¹</li>
</ul>
</li>
<li>ç¼“å­˜ç®¡ç†ï¼šçªƒå–<span class="heti-skip"><span class="heti-spacing"> </span>+<span class="heti-spacing"> </span></span>éå¼ºåˆ¶ç­–ç•¥</li>
</ul>
</li>
<li>æ¢å¤<span class="heti-skip"><span class="heti-spacing"> </span>+<span class="heti-spacing"> </span></span>å¹¶å‘æ§åˆ¶<ul>
<li>é”çš„æ—©é‡Šæ”¾</li>
<li>é€»è¾‘è¿ç®—çš„æ’¤é”€</li>
</ul>
</li>
<li>ARIES<ul>
<li>æ•°æ®ç»“æ„ï¼šLSNã€ç”Ÿç†æ—¥å¿—ã€è„é¡µè¡¨ã€æ¨¡ç³Šæ£€æŸ¥ç‚¹</li>
<li>ç®—æ³•ï¼šåˆ†æ<span class="heti-skip"><span class="heti-spacing"> </span>-&gt;<span class="heti-spacing"> </span></span>é‡åš<span class="heti-skip"><span class="heti-spacing"> </span>-&gt;<span class="heti-spacing"> </span></span>æ’¤é”€</li>
</ul>
</li>
</ul>
</details>
<p><strong>æ¢å¤ç®—æ³•</strong><span>(recovery algorithms)<span class="heti-spacing"> </span></span>æ˜¯æŒ‡ä¸€äº›ç¡®ä¿æ•°æ®åº“ä¸€è‡´æ€§ã€äº‹åŠ¡åŸå­æ€§å’ŒæŒä¹…æ€§çš„æŠ€æœ¯ï¼Œå³ä½¿åœ¨å‘ç”Ÿæ•…éšœæ—¶ä¹Ÿèƒ½ä¿éšœæ•°æ®å®‰å…¨ã€‚å½“ç³»ç»Ÿå´©æºƒæ—¶ï¼Œæ‰€æœ‰å·²æäº¤çš„ä½†å°šæœªå†™å…¥ç£ç›˜çš„å†…å­˜æ•°æ®éƒ½é¢ä¸´ç€ä¸¢å¤±çš„é£é™©ï¼Œè¿™æ˜¾ç„¶å’Œç”¨æˆ·çš„é¢„æœŸç›¸æ‚–â€”â€”ä»–ä»¬è®¤ä¸ºæˆåŠŸæäº¤çš„æ•°æ®å˜æ›´åº”å½“æ°¸ä¹…è¢«ä¿å­˜ã€‚æ¢å¤ç®—æ³•çš„æ ¸å¿ƒä½œç”¨æ­£æ˜¯é˜²æ­¢å´©æºƒåå‡ºç°ä¿¡æ¯ä¸¢å¤±çš„æƒ…å†µã€‚æ¯ä¸€ç§æ¢å¤ç®—æ³•éƒ½åŒ…å«ä»¥ä¸‹ä¸¤éƒ¨åˆ†ï¼š</p>
<ul>
<li>åœ¨æ­£å¸¸äº‹åŠ¡å¤„ç†è¿‡ç¨‹ä¸­é‡‡å–çš„è¡ŒåŠ¨ï¼Œç¡®ä¿æœ‰è¶³å¤Ÿç”¨äºæ¢å¤çš„ä¿¡æ¯</li>
<li>åœ¨æ•…éšœåé‡‡å–çš„è¡ŒåŠ¨ï¼Œä»¥æ¢å¤æ•°æ®åº“çš„å†…å®¹ï¼Œç¡®ä¿æ•°æ®åº“çš„ä¸€è‡´æ€§ã€åŸå­æ€§ä»¥åŠæŒä¹…æ€§</li>
</ul>
<h2 id="failure-classification">Failure Classification<a class="headerlink" href="#failure-classification" title="Permanent link">âš“ï¸</a></h2>
<p>å…ˆæ¥è®¤è¯†ä¸€äº›å¸¸è§çš„æ•…éšœç§ç±»ï¼š</p>
<ul>
<li><strong>äº‹åŠ¡æ•…éšœ</strong>(transaction failure)ï¼šåˆ†ä¸ºä»¥ä¸‹ä¸¤ç±»ï¼š<ul>
<li><strong>é€»è¾‘</strong>é”™è¯¯<span><span class="heti-spacing"> </span>(logical error)</span>ï¼šäº‹åŠ¡å› ä¸€äº›å†…éƒ¨æ¡ä»¶ï¼ˆæ¯”å¦‚ä¸è‰¯è¾“å…¥ã€æ•°æ®æ‰¾ä¸åˆ°ã€æº¢å‡ºã€èµ„æºè¶…è¿‡é™åˆ¶ç­‰ï¼‰è€Œæ— æ³•ç»§ç»­æ­£å¸¸æ‰§è¡Œ</li>
<li><strong>ç³»ç»Ÿ</strong>é”™è¯¯<span><span class="heti-spacing"> </span>(system error)</span>ï¼šç³»ç»Ÿè¿›å…¥äº†éé¢„æœŸçš„çŠ¶æ€ï¼ˆæ¯”å¦‚æ­»é”<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œå› æ­¤äº‹åŠ¡æ— æ³•ç»§ç»­æ­£å¸¸æ‰§è¡Œï¼›ä½†ç¨åå¯ä»¥é‡æ–°æ‰§è¡Œè¯¥äº‹åŠ¡</li>
</ul>
</li>
<li><strong>ç³»ç»Ÿå´©æºƒ</strong>(system crash)ï¼šç¡¬ä»¶<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>æ•°æ®åº“è½¯ä»¶<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>æ“ä½œç³»ç»Ÿçš„é—®é¢˜å¯¼è‡´æ˜“å¤±æ€§å­˜å‚¨å™¨å†…å®¹çš„æŸå¤±ï¼Œå¹¶ä½¿å¾—äº‹åŠ¡è¿›ç¨‹åœæ­¢ï¼›è€Œéæ˜“å¤±æ€§å­˜å‚¨å™¨çš„å†…å®¹ä¸å—å½±å“ï¼ˆè¿™æ ·çš„å‡è®¾ç§°ä¸ºæ•…éšœ<span class="heti-skip"><span class="heti-spacing"> </span>-<span class="heti-spacing"> </span></span>åœæ­¢å‡è®¾<span><span class="heti-spacing"> </span>(fail-stop assumption)</span><heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
<li><strong>ç£ç›˜æ•…éšœ</strong>(disk failure)ï¼šå› ç£ç›˜å¤´å´©æºƒæˆ–åœ¨æ•°æ®ä¼ è¾“æ—¶çš„æ•…éšœï¼Œç£ç›˜å—çš„å†…å®¹ä¸¢å¤±äº†ï¼›æ­¤æ—¶å°±è¦ç”¨å…¶ä»–ç£ç›˜æˆ–è€…ç¬¬ä¸‰æ–¹åª’ä»‹çš„å½’æ¡£å¤‡ä»½æ¥æ¢å¤å†…å®¹ã€‚</li>
</ul>
<h2 id="storage">Storage<a class="headerlink" href="#storage" title="Permanent link">âš“ï¸</a></h2>
<h3 id="stable-storage-implementation">Stable-Storage Implementation<a class="headerlink" href="#stable-storage-implementation" title="Permanent link">âš“ï¸</a></h3>
<p>ä¸ºå®ç°ç¨³å®šçš„å­˜å‚¨å™¨ï¼Œæˆ‘ä»¬è¦å¤åˆ¶å¤šä»½æ‰€éœ€çš„ä¿¡æ¯ï¼Œä»¥ç‹¬ç«‹çš„æ•…éšœæ¨¡å¼å­˜æ”¾åˆ°ä¸åŒçš„éæ˜“å¤±æ€§å­˜å‚¨åª’ä»‹ä¸­ï¼›å¹¶ä»¥ä¸€ç§å—æ§çš„æ–¹å¼æ›´æ–°ä¿¡æ¯ï¼Œç¡®ä¿æ•°æ®ä¼ è¾“ä¸­çš„å‘ç”Ÿçš„æ•…éšœä¸ä¼šç ´åæ‰€éœ€çš„ä¿¡æ¯ã€‚</p>
<p>å‰é¢æåˆ°è¿‡çš„<a href="8.html#raid"><span class="heti-skip"><span class="heti-spacing"> </span>RAID<span class="heti-spacing"> </span></span></a>ç³»ç»Ÿçœ‹ä¼¼å¾ˆé€‚åˆå¹²è¿™ä¸ªæ´»ï¼Œä½†å®ƒä¸æ˜¯å®Œç¾çš„è§£å†³æ–¹æ¡ˆâ€”â€”å®ƒæ— æ³•æŠµæŠ—å¤–ç•Œçš„ç¾å®³æ¯”å¦‚ç«ç¾ã€æ´ªæ°´ç­‰ç­‰ã€‚å› æ­¤ï¼Œå¾ˆå¤šç³»ç»Ÿä¼šé‡‡å–æ¡£æ¡ˆå¤‡ä»½çš„æªæ–½ï¼ˆæ¯”å¦‚å°†æ•°æ®å­˜åœ¨ç£å¸¦è¿™ç§ä»‹è´¨ä¸­<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚ä½†è¿™ç§æ–¹æ³•æ— æ³•è¿ç»­å¤‡ä»½æ•°æ®ï¼Œå› æ­¤æœ€æ–°çš„æ•°æ®è¿˜æ˜¯ä¼šåœ¨ç¾å®³å‘ç”Ÿæ—¶ä¸¢å¤±ã€‚æ‰€ä»¥å°±æœ‰äº†å¦ä¸€ç§æ–¹æ³•â€”â€”<strong>è¿œç¨‹å¤‡ä»½</strong>(remote backup)ï¼Œå³é€šè¿‡è®¡ç®—æœºç½‘ç»œå°†ç¨³å®šå­˜å‚¨å™¨ä¸­çš„æ•°æ®æ‹·è´ä¿å­˜åˆ°å¦ä¸€ä¸ªè¿œä¸€ç‚¹çš„åœ°æ–¹ã€‚</p>
<p>åœ¨å†…å­˜å’Œç£ç›˜ä¹‹é—´ä¼ è¾“æ•°æ®æ—¶ä¼šå¾—åˆ°ä»¥ä¸‹ç»“æœä¹‹ä¸€ï¼š</p>
<ul>
<li><strong>æˆåŠŸå®Œæˆ</strong>(successful completion)ï¼šè¢«ä¼ è¾“çš„ä¿¡æ¯æˆåŠŸæŠµè¾¾ç›®çš„åœ°</li>
<li><strong>éƒ¨åˆ†æ•…éšœ</strong>(partial failure)ï¼šåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿæ•…éšœï¼Œå› è€Œç›®æ ‡å—çš„ä¿¡æ¯ä¸æ­£ç¡®</li>
<li><strong>å®Œå…¨æ•…éšœ</strong>(total failure)ï¼šåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­ï¼Œæ•…éšœå‘ç”Ÿå¾—è¶³å¤Ÿæ—©ï¼Œå› æ­¤ç›®æ ‡å—çš„å†…å®¹ä¿æŒå®Œå¥½</li>
</ul>
<p>å½“<strong>æ•°æ®ä¼ è¾“æ•…éšœ</strong><span>(data-transfer failure)<span class="heti-spacing"> </span></span>å‘ç”Ÿæ—¶ï¼Œç³»ç»Ÿåº”è¯¥èƒ½å¤Ÿæ£€æµ‹åˆ°æ•…éšœï¼Œå¹¶ä¸”è°ƒç”¨æ¢å¤è¿‡ç¨‹æ¥æ¢å¤æ•°æ®å—è‡³ä¸€è‡´çŠ¶æ€ã€‚è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œç³»ç»Ÿå¿…é¡»ä¸ºæ¯ä¸ªé€»è¾‘æ•°æ®åº“å—ä¿ç•™ä¸¤ä»½ç‰©ç†å—ã€‚</p>
<ul>
<li>åœ¨é•œåƒç£ç›˜æ–¹æ¡ˆä¸­ï¼Œä¸¤ä¸ªå—åœ¨ç›¸åŒåœ°ç‚¹</li>
<li>åœ¨è¿œç¨‹å¤‡ä»½æ–¹æ¡ˆä¸­ï¼Œä¸€ä¸ªå—åœ¨æœ¬åœ°ï¼Œå¦ä¸€ä¸ªå—åœ¨è¿œç¨‹ç«™ç‚¹</li>
</ul>
<p>è¾“å‡ºæ“ä½œçš„æ‰§è¡Œæ­¥éª¤ä¸ºï¼š</p>
<ol>
<li>å°†ä¿¡æ¯å†™åˆ°ç¬¬ä¸€ä¸ªç‰©ç†å—ä¸Š</li>
<li>å½“ç¬¬ä¸€ä¸ªå†™æ“ä½œæˆåŠŸå®Œæˆæ—¶ï¼Œå°†ç›¸åŒçš„ä¿¡æ¯å†™åˆ°ç¬¬äºŒä¸ªç‰©ç†å—ä¸Š</li>
<li>åªæœ‰å½“ç¬¬äºŒä¸ªå†™æ“ä½œæˆåŠŸå®Œæˆæ—¶ï¼Œè¾“å‡ºæ‰ç®—å®Œæˆ</li>
</ol>
<p>è‹¥ç³»ç»Ÿåœ¨å†™å…¥æ•°æ®å—æ—¶å‘ç”Ÿæ•…éšœï¼Œä¸¤ä¸ªæ‹·è´ä¹‹é—´å¯èƒ½å‡ºç°ä¸ä¸€è‡´çš„æƒ…å†µã€‚åœ¨æ¢å¤çš„æ—¶å€™ï¼Œç³»ç»Ÿéœ€é€ä¸€æ£€æŸ¥æ¯ä¸ªæ•°æ®å—çš„ä¸¤ä¸ªæ‹·è´ï¼š</p>
<ul>
<li>è‹¥ä¸¤è€…å†…å®¹ä¸€è‡´ä¸”æ²¡æœ‰æ£€æµ‹åˆ°é”™è¯¯ï¼Œåˆ™æ— éœ€è¿›ä¸€æ­¥æ“ä½œ</li>
<li>è‹¥å‘ç°æŸä¸€æ‹·è´å­˜åœ¨é”™è¯¯ï¼Œç³»ç»Ÿå°†ç”¨å¦ä¸€æ‹·è´çš„å†…å®¹æ›¿æ¢è¯¥æŸåå—</li>
<li>è‹¥ä¸¤æ‹·è´å‡æ²¡æœ‰æ£€æµ‹åˆ°çš„é”™è¯¯ä½†å†…å®¹å­˜åœ¨å·®å¼‚ï¼Œç³»ç»Ÿå¯ä»»æ„é€‰æ‹©ä¸€ä¸ªæ‹·è´ï¼Œæ¥æ›¿æ¢å¦ä¸€ä¸ªæ‹·è´çš„å†…å®¹</li>
</ul>
<p>æ— è®ºé‡‡ç”¨å“ªç§æ–¹å¼ï¼Œæ¢å¤è¿‡ç¨‹éƒ½èƒ½ç¡®ä¿ç¨³å®šå­˜å‚¨çš„å†™å…¥æ“ä½œè¦ä¹ˆå®Œå…¨æˆåŠŸï¼ˆå³æ›´æ–°æ‰€æœ‰æ‹·è´<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œè¦ä¹ˆä¿æŒåŸçŠ¶ï¼Œä¸å‘ç”Ÿä»»ä½•æ”¹å˜ã€‚</p>
<p>æ¢å¤è¿‡ç¨‹ä¸­éœ€å¯¹æ¯”æ¯ä¸€å¯¹å¯¹åº”å—çš„è¦æ±‚æˆæœ¬è¾ƒå¤§ï¼Œå› æ­¤é€šè¿‡åˆ©ç”¨å°‘é‡éæ˜“å¤±æ€§<span class="heti-skip"><span class="heti-spacing"> </span>RAM<span class="heti-spacing"> </span></span>æ¥è·Ÿè¸ªæ­£åœ¨è¿›è¡Œçš„å—å†™å…¥æ“ä½œï¼Œå¯ä»¥å¤§å¹…é™ä½è¿™ä¸€å¼€é”€â€”â€”åœ¨æ¢å¤æ—¶ï¼Œä»…éœ€æ¯”è¾ƒé‚£äº›å†™å…¥æœªå®Œæˆçš„åŒºå—å³å¯ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥æ‰©å±•ä¸Šè¿°æ¢å¤è¿‡ç¨‹ï¼Œä½¿ç”¨ä»»æ„æ•°é‡çš„ç¨³å®šå­˜å‚¨å—æ‹·è´ã€‚å°½ç®¡è¿™æ ·åšèƒ½å°†æ•…éšœæ¦‚ç‡é™è‡³æ¯”<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span>ä¸ªæ‹·è´æ›´ä½çš„æ°´å¹³ï¼Œä½†é€šå¸¸ç”¨<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span>ä¸ªæ‹·è´å°±è¶³å¤Ÿäº†ã€‚</p>
<h3 id="data-access">Data Access<a class="headerlink" href="#data-access" title="Permanent link">âš“ï¸</a></h3>
<p>ç£ç›˜å’Œä¸»å­˜é—´çš„æ•°æ®å—ç§»åŠ¨å¯é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ“ä½œå‘èµ·ï¼š</p>
<ul>
<li><code>input(B)</code>ï¼šå°†ç‰©ç†å—<span class="heti-skip"><span class="heti-spacing"> </span>B<span class="heti-spacing"> </span></span>ä¼ è¾“åˆ°ä¸»å­˜</li>
<li><code>output(B)</code>ï¼šå°†ç¼“å­˜å—<span class="heti-skip"><span class="heti-spacing"> </span>B<span class="heti-spacing"> </span></span>ä¼ è¾“åˆ°ç£ç›˜ï¼Œå¹¶æ›¿æ¢æ‰åˆé€‚çš„ç£ç›˜å—</li>
</ul>
<div style="text-align: center">
<img src="images/lec15/1.png" width="50%/"/>
</div>
<p>ä¸Šä¸€è®²æåˆ°è¿‡ï¼Œæ¯ä¸ªäº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>éƒ½æœ‰ä¸€ä¸ªç§æœ‰å·¥ä½œåŒºï¼Œç”¨äºå­˜æ”¾<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>è®¿é—®å’Œæ›´æ–°çš„æ•°æ®é¡¹æ‹·è´ã€‚</p>
<ul>
<li>ç³»ç»Ÿåœ¨äº‹åŠ¡å¯åŠ¨æ—¶åˆ›å»ºä¸€ä¸ªå·¥ä½œåŒº</li>
<li>å½“äº‹åŠ¡æäº¤æˆ–ä¸­æ­¢æ—¶ï¼Œç³»ç»Ÿä¼šå°†å…¶ç§»é™¤</li>
</ul>
<p>å­˜æ”¾åœ¨äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>å·¥ä½œåŒºçš„æ¯ä¸ªæ•°æ®é¡¹<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(X\)</span><span class="heti-spacing"> </span></span>éƒ½è®°ä½œ<span><span class="heti-spacing"> </span><span class="arithmatex">\(x_i\)</span></span>ã€‚äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>é€šè¿‡åœ¨å…¶å·¥ä½œåŒºä¸ç³»ç»Ÿç¼“å†²åŒºä¹‹é—´ä¼ è¾“æ•°æ®æ¥ä¸æ•°æ®åº“ç³»ç»Ÿäº¤äº’ã€‚æˆ‘ä»¬é€šè¿‡ä»¥ä¸‹ä¸¤ä¸ªæ“ä½œå®ç°æ•°æ®ä¼ è¾“ï¼š</p>
<ul>
<li><code>read(X)</code>ï¼šå°†æ•°æ®é¡¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„å€¼åˆ†é…ç»™å±€éƒ¨å˜é‡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(x_i\)</span><span class="heti-spacing"> </span></span>ä¸Šï¼Œè¯¥è¿‡ç¨‹å¯åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š<ul>
<li>å¦‚æœ<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>æ‰€åœ¨çš„æ•°æ®å—<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_X\)</span><span class="heti-spacing"> </span></span>ä¸åœ¨ä¸»å­˜ä¸­ï¼Œé‚£ä¹ˆå‘èµ· <code>input(B_X)</code></li>
<li>å°†ç¼“å­˜å—ä¸­çš„<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„å€¼åˆ†é…ç»™<span><span class="heti-spacing"> </span><span class="arithmatex">\(x_i\)</span></span></li>
</ul>
</li>
<li><code>write(X)</code>ï¼šå°†å±€éƒ¨å˜é‡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(x_i\)</span><span class="heti-spacing"> </span></span>çš„å€¼åˆ†é…ç»™åœ¨ç¼“å­˜å—ä¸­çš„æ•°æ®é¡¹<span><span class="heti-spacing"> </span>X</span>ï¼Œè¯¥è¿‡ç¨‹å¯åˆ†ä¸ºä»¥ä¸‹æ­¥éª¤ï¼š<ul>
<li>å¦‚æœ<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>æ‰€åœ¨çš„æ•°æ®å—<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_X\)</span><span class="heti-spacing"> </span></span>ä¸åœ¨ä¸»å­˜ä¸­ï¼Œé‚£ä¹ˆå‘èµ· <code>input(B_X)</code></li>
<li>å°†<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(x_i\)</span><span class="heti-spacing"> </span></span>çš„å€¼åˆ†é…ç»™ç¼“å­˜å—<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_X\)</span><span class="heti-spacing"> </span></span>ä¸­çš„<span><span class="heti-spacing"> </span>X</span></li>
</ul>
</li>
</ul>
<p>ç¼“å­˜å—æœ€ç»ˆä¼šè¢«å†™å…¥ç£ç›˜ä¸­ï¼Œå› ä¸ºç¼“å†²åŒºç®¡ç†å™¨éœ€è¦å°†å†…å­˜ç©ºé—´ç”¨äºå…¶ä»–åœ°æ–¹ï¼Œæˆ–è€…æ•°æ®åº“ç³»ç»Ÿå¸Œæœ›å°†ç¼“å­˜å—çš„å˜æ›´åŒæ­¥åˆ°ç£ç›˜ä¸Šã€‚å½“æ•°æ®åº“ç³»ç»Ÿå‘å‡º <code>output(B)</code> æŒ‡ä»¤æ—¶ï¼Œæˆ‘ä»¬ç§°å…¶å¯¹ç¼“å†²åŒº<span class="heti-skip"><span class="heti-spacing"> </span>B<span class="heti-spacing"> </span></span>æ‰§è¡Œäº†<strong>å¼ºåˆ¶å†™</strong><span>(force-output)<span class="heti-spacing"> </span></span>æ“ä½œã€‚</p>
<p>å½“äº‹åŠ¡é¦–æ¬¡éœ€è¦è®¿é—®æ•°æ®é¡¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>æ—¶ï¼Œå¿…é¡»æ‰§è¡Œ <code>read(X)</code> æ“ä½œï¼Œéšåè¯¥äº‹åŠ¡å¯¹<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„æ‰€æœ‰æ›´æ–°éƒ½åœ¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(x_i\)</span><span class="heti-spacing"> </span></span>ä¸Šå®Œæˆã€‚åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä»»æ„æ—¶åˆ»ï¼Œäº‹åŠ¡éƒ½å¯ä»¥æ‰§è¡Œ <code>write(X)</code>ï¼Œå°†å˜æ›´åæ˜ åˆ°æ•°æ®åº“ä¸­çš„ <code>X</code> ä¸­ï¼›è€Œæœ€ç»ˆå¯¹<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(x_i\)</span><span class="heti-spacing"> </span></span>çš„å†™å…¥å®Œæˆååˆ™å¿…é¡»æ‰§è¡Œ <code>write(X)</code>ã€‚</p>
<p>å¯¹äºå­˜å‚¨<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„ç¼“å†²åŒºå—<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_X\)</span><span class="heti-spacing"> </span></span>è€Œè¨€ï¼Œå…¶è¾“å‡ºæ“ä½œ <code>output(B_X)</code> æ— éœ€åœ¨ <code>write(X)</code> æ‰§è¡Œåç«‹å³ç”Ÿæ•ˆï¼Œå› ä¸ºè¯¥å—å¯èƒ½è¿˜åŒ…å«å…¶ä»–æ­£åœ¨è¢«è®¿é—®çš„æ•°æ®é¡¹ï¼Œå› æ­¤å®é™…è¾“å‡ºå¯ä»¥å»¶åè¿›è¡Œã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼šè‹¥ç³»ç»Ÿåœ¨ <code>write(X)</code> æ‰§è¡Œåã€<code>output(B_X)</code> æ‰§è¡Œå‰å‘ç”Ÿå´©æºƒï¼Œåˆ™<span class="heti-skip"><span class="heti-spacing"> </span>X<span class="heti-spacing"> </span></span>çš„æ–°å€¼æ°¸è¿œä¸ä¼šå†™å…¥ç£ç›˜ä»è€Œå¯¼è‡´ä¸¢å¤±ã€‚ä½†å®é™…ä¸Šæ•°æ®åº“ç³»ç»Ÿä¼šé‡‡å–é¢å¤–æªæ–½ï¼Œç¡®ä¿å·²æäº¤äº‹åŠ¡æ‰€æ‰§è¡Œçš„æ›´æ–°å³ä½¿é­é‡ç³»ç»Ÿå´©æºƒä¹Ÿä¸ä¼šä¸¢å¤±ã€‚</p>
<h2 id="log-based-recovery">Log-Based Recovery<a class="headerlink" href="#log-based-recovery" title="Permanent link">âš“ï¸</a></h2>
<p>ä¸ºç¡®ä¿äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„<strong>åŸå­æ€§</strong>ï¼Œæˆ‘ä»¬å¸Œæœ›è¦ä¹ˆå°†<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>ä¸­æ‰€æœ‰å¯¹æ•°æ®åº“çš„ä¿®æ”¹ä½œç”¨åœ¨æ•°æ®åº“ä¸­ï¼Œè¦ä¹ˆä¸ä½œä»»ä½•æ”¹åŠ¨ã€‚ä¸ºå®ç°è¿™ä¸€ç›®æ ‡ï¼Œ</p>
<ul>
<li>é¦–å…ˆéœ€å°†æè¿°ä¿®æ”¹çš„ä¿¡æ¯è¾“å‡ºè‡³ç¨³å®šçš„å­˜å‚¨ä»‹è´¨ï¼Œè€Œä¸è¦ç›´æ¥ä¿®æ”¹æ•°æ®åº“æœ¬èº«ã€‚è¿™äº›ä¿¡æ¯èƒ½å¸®åŠ©æˆ‘ä»¬ç¡®ä¿å·²æäº¤äº‹åŠ¡æ‰§è¡Œçš„æ‰€æœ‰ä¿®æ”¹éƒ½ä½“ç°åœ¨æ•°æ®åº“ä¸­ã€‚</li>
<li>æ­¤å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦ä¿å­˜å’Œè¢«ä¿®æ”¹æ•°æ®é¡¹çš„æ—§å€¼ç›¸å…³çš„ä¿¡æ¯ï¼Œå› ä¸ºå½“æ‰§è¡Œè¯¥ä¿®æ”¹çš„äº‹åŠ¡å¤±è´¥ï¼ˆä¸­æ­¢ï¼‰æ—¶ï¼Œè¯¥ä¿¡æ¯å¯å¸®åŠ©æˆ‘ä»¬æ’¤é”€å¤±è´¥äº‹åŠ¡æ‰€é€ æˆçš„æ›´æ”¹ã€‚</li>
</ul>
<p>æœ€å¸¸ç”¨çš„æ‰‹æ®µæ˜¯ä½¿ç”¨<strong>æ—¥å¿—</strong>æ¥è®°å½•è¿™ç±»ä¿¡æ¯ï¼Œåˆ©ç”¨è¿™ç§æ–¹å¼çš„æ¢å¤æ–¹æ¡ˆè¢«ç§°ä¸º<strong>åŸºäºæ—¥å¿—çš„æ¢å¤</strong>(log-based recovery)ã€‚</p>
<h3 id="log-records">Log Records<a class="headerlink" href="#log-records" title="Permanent link">âš“ï¸</a></h3>
<p><strong>æ—¥å¿—</strong><span>(logs)<span class="heti-spacing"> </span></span>æ˜¯ç”±ä¸€ç³»åˆ—çš„<strong>æ—¥å¿—è®°å½•</strong><span>(log records)<span class="heti-spacing"> </span></span>æ„æˆçš„ï¼Œè®°å½•æ‰€æœ‰æ•°æ®åº“çš„æ›´æ–°æ´»åŠ¨ã€‚å­˜åœ¨å¤šç§æ—¥å¿—è®°å½•ï¼Œå…¶ä¸­<strong>æ›´æ–°æ—¥å¿—è®°å½•</strong><span>(update log record)<span class="heti-spacing"> </span></span>æè¿°äº†å•ä¸ªçš„æ•°æ®åº“å†™æ“ä½œï¼Œå¹¶ä¸”åŒ…å«ä»¥ä¸‹å­—æ®µï¼š</p>
<ul>
<li><strong>äº‹åŠ¡æ ‡è¯†ç¬¦</strong>(transcation identifier)ï¼šæ‰§è¡Œå†™æ“ä½œäº‹åŠ¡çš„å”¯ä¸€æ ‡è¯†ç¬¦</li>
<li><strong>æ•°æ®é¡¹æ ‡è¯†ç¬¦</strong>(data-item identifier)ï¼šè¢«å†™å…¥æ•°æ®é¡¹çš„å”¯ä¸€æ ‡è¯†ç¬¦ï¼Œé€šå¸¸æ˜¯æ•°æ®é¡¹åœ¨ç£ç›˜ä¸­çš„ä½ç½®ï¼ŒåŒ…æ‹¬æ•°æ®é¡¹æ‰€åœ¨å—çš„æ ‡è¯†ç¬¦ï¼Œä»¥åŠå—å†…çš„åç§»é‡</li>
<li><strong>æ—§å€¼</strong>(old value)ï¼šåœ¨å†™æ“ä½œä¹‹å‰æ•°æ®é¡¹çš„å€¼</li>
<li><strong>æ–°å€¼</strong>(new value)ï¼šåœ¨å†™æ“ä½œä¹‹åæ•°æ®é¡¹çš„å€¼</li>
</ul>
<p>æˆ‘ä»¬ç”¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, X_j, V_1, V_2&gt;\)</span><span class="heti-spacing"> </span></span>æ¥è¡¨ç¤ºä¸€æ¡æ›´æ–°æ—¥å¿—è®°å½•ï¼Œè¿™<span class="heti-skip"><span class="heti-spacing"> </span>4<span class="heti-spacing"> </span></span>ä¸ªå­—æ¯åˆ†åˆ«å¯¹åº”ä¸Šè¿°<span class="heti-skip"><span class="heti-spacing"> </span>4<span class="heti-spacing"> </span></span>ä¸ªå­—æ®µã€‚è¿˜æœ‰ä»¥ä¸‹è®°å½•äº‹åŠ¡å¤„ç†ä¸­çš„â€œé‡å¤§â€äº‹ä»¶çš„ç‰¹æ®Šæ—¥å¿—è®°å½•ï¼š</p>
<ul>
<li><span class="arithmatex">\(&lt;T_i \text{ start}&gt;\)</span>ï¼šäº‹åŠ¡<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span></span> <strong>å¼€å§‹</strong></li>
<li><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span>ï¼šäº‹åŠ¡<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span></span> <strong>æäº¤</strong></li>
<li><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span>ï¼šäº‹åŠ¡<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span></span> <strong>ä¸­æ­¢</strong></li>
</ul>
<p>æ¯å½“äº‹åŠ¡æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œåœ¨ä¿®æ”¹æ•°æ®åº“ä¹‹å‰ï¼Œå¿…é¡»ä¸ºè¯¥å†™æ“ä½œåˆ›å»ºæ—¥å¿—è®°å½•ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ°æ—¥å¿—ä¸­ã€‚ä¸€æ—¦å­˜åœ¨æ—¥å¿—è®°å½•ï¼Œè‹¥æ¡ä»¶å…è®¸çš„è¯ï¼Œå°±å¯ä»¥å°†ä¿®æ”¹è¾“å‡ºåˆ°æ•°æ®åº“ä¸­ã€‚æ­¤å¤–ï¼Œç³»ç»Ÿè¿˜éœ€å…·å¤‡<strong>æ’¤é”€</strong><span>(undo)<span class="heti-spacing"> </span></span>å·²è¾“å‡ºè‡³æ•°æ®åº“çš„ä¿®æ”¹çš„èƒ½åŠ›ï¼Œè¿™å¯åˆ©ç”¨æ—¥å¿—è®°å½•ä¸­çš„æ—§å€¼å­—æ®µå®ç°çš„å›æ»šæ“ä½œæ¥å®Œæˆã€‚</p>
<p>ç”±äºæ—¥å¿—å¯¹äºç³»ç»Ÿå’Œç£ç›˜æ•…éšœçš„æ¢å¤ç›¸å½“é‡è¦ï¼Œå®ƒä»¬å¿…é¡»è¢«æ”¾åœ¨ç¨³å®šå­˜å‚¨å™¨ä¸­ã€‚ç°åœ¨æˆ‘ä»¬å°±å‡è®¾æ¯ä¸ªæ—¥å¿—è®°å½•åœ¨åˆ›å»ºåï¼Œå°±é©¬ä¸Šè¢«æ”¾åœ¨ä½äºç¨³å®šå­˜å‚¨å™¨ä¸­çš„æ—¥å¿—çš„æœ«å°¾ã€‚ä¹‹åæˆ‘ä»¬å°†æ¢è®¨ä½•æ—¶å¯ä»¥å®‰å…¨åœ°æ¾å¼›è¿™ä¸€è¦æ±‚ï¼Œä»¥å‡å°‘æ—¥å¿—è®°å½•å¸¦æ¥çš„å¼€é”€ã€‚</p>
<p>å› ä¸ºæ—¥å¿—åŒ…å«äº†æ‰€æœ‰æ•°æ®åº“æ´»åŠ¨çš„å®Œæ•´è®°å½•ï¼Œæ‰€ä»¥å­˜å‚¨åœ¨æ—¥å¿—ä¸­çš„æ•°æ®é‡å¯èƒ½ä¼šå˜å¾—éå¸¸åºå¤§ã€‚ä¹‹åæˆ‘ä»¬ä¹Ÿä¼šè¯´æ˜ä½•æ—¶å¯ä»¥å®‰å…¨åœ°åˆ é™¤ï¼ˆæ²¡æœ‰ç”¨çš„ï¼‰æ—¥å¿—ä¿¡æ¯ã€‚</p>
<hr/>
<p>å¯¹äºä¸åŒçš„å®ç°æ–¹å¼ï¼Œæ—¥å¿—è®°å½•çš„å†…å®¹ä¹Ÿä¼šæœ‰æ‰€åŒºåˆ†ã€‚æˆ‘ä»¬å¯¹æ—¥å¿—æ–¹æ¡ˆä½œå‡ºä»¥ä¸‹åˆ†ç±»ï¼š</p>
<ul>
<li><strong>ç‰©ç†æ—¥å¿—</strong>(physical logging)ï¼šè®°å½•å¯¹æ•°æ®åº“ä¸­ç‰¹å®šä½ç½®è¿›è¡Œçš„å­—èŠ‚çº§æ›´æ”¹<ul>
<li>ä¾‹å­ï¼š<code>git diff</code></li>
</ul>
</li>
<li><strong>é€»è¾‘æ—¥å¿—</strong>(logical logging)ï¼š<ul>
<li>è®°å½•äº‹åŠ¡æ‰§è¡Œçš„é«˜çº§æ“ä½œ</li>
<li>ä¸é™äºå•ä¸ªé¡µ</li>
<li>æ¯æ¡æ—¥å¿—è®°å½•éœ€å†™å…¥çš„æ•°æ®é‡å°‘äºç‰©ç†æ—¥å¿—ï¼Œå› ä¸ºå•æ¡è®°å½•å¯è·¨å¤šé¡µæ›´æ–°å¤šä¸ªå…ƒç»„</li>
<li>ä½†åœ¨éç¡®å®šæ€§å¹¶å‘æ§åˆ¶æ–¹æ¡ˆä¸­å­˜åœ¨å¹¶å‘äº‹åŠ¡æ—¶ï¼Œé€»è¾‘æ—¥å¿—éš¾ä»¥å®ç°æ•…éšœæ¢å¤</li>
<li>æ­¤å¤–ç”±äºå¿…é¡»é‡æ–°æ‰§è¡Œæ¯ä¸ªäº‹åŠ¡ï¼Œæ¢å¤è€—æ—¶æ›´é•¿</li>
<li>ä¾‹å­ï¼šäº‹åŠ¡è°ƒç”¨çš„ <code>UPDATE</code>ã€<code>DELETE</code>ã€<code>INSERT</code> è¯­å¥</li>
</ul>
</li>
<li><strong>ç”Ÿç†æ—¥å¿—</strong>(physiological logging)ï¼š<ul>
<li>è¿™æ˜¯ä¸€ç§æ··åˆå¼æ–¹æ³•ï¼Œå…¶æ—¥å¿—è®°å½•é’ˆå¯¹å•ä¸ªé¡µï¼Œä½†ä¸è§„å®šé¡µçš„æ•°æ®ç»„ç»‡å½¢å¼</li>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡é¡µä¸­çš„æ§½ä½å·<span class="heti-skip"><span class="heti-spacing"> </span>(slot number)<span class="heti-spacing"> </span></span>è¯†åˆ«å…ƒç»„ï¼Œè€Œä¸å…·ä½“æŒ‡æ˜ä¿®æ”¹å‘ç”Ÿåœ¨é¡µçš„å“ªä¸ªä½ç½®</li>
<li>å› æ­¤<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>å¯åœ¨æ—¥å¿—è®°å½•å†™å…¥ç£ç›˜åé‡æ–°ç»„ç»‡é¡µç»“æ„</li>
<li>è¿™æ˜¯<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>ä¸­æœ€ä¸ºå¸¸ç”¨çš„å®ç°æ–¹å¼</li>
</ul>
</li>
</ul>
<h3 id="database-modification">Database Modification<a class="headerlink" href="#database-modification" title="Permanent link">âš“ï¸</a></h3>
<p>ä¸ºäº†ç†è§£æ—¥å¿—è®°å½•åœ¨æ¢å¤è¿‡ç¨‹ä¸­æ‰€èµ·çš„ä½œç”¨ï¼Œæˆ‘ä»¬éœ€è¦å‰–æäº‹åŠ¡ä¿®æ”¹æ•°æ®é¡¹æ—¶æ‰€ç»å†çš„å…·ä½“æ­¥éª¤ï¼š</p>
<ol>
<li>äº‹åŠ¡åœ¨ä¸»å­˜ä¸­çš„ç§æœ‰ç©ºé—´ä¸­æ‰§è¡Œä¸€äº›è®¡ç®—</li>
<li>äº‹åŠ¡ä¿®æ”¹ä¸»å­˜ç£ç›˜ç¼“å†²åŒºä¸­æŒæœ‰æ•°æ®é¡¹çš„æ•°æ®å—</li>
<li>æ•°æ®åº“ç³»ç»Ÿæ‰§è¡Œ <code>output</code> æ“ä½œï¼Œå°†æ•°æ®å—å†™åˆ°ç£ç›˜ä¸­</li>
</ol>
<p>å¦‚æœäº‹åŠ¡å¯¹ç£ç›˜ç¼“å†²åŒºæˆ–ç£ç›˜æœ¬èº«æ‰§è¡Œäº†æ›´æ–°æ“ä½œï¼Œæˆ‘ä»¬è®¤ä¸ºè¯¥äº‹åŠ¡<strong>ä¿®æ”¹äº†æ•°æ®åº“</strong>ï¼ˆè€Œå¯¹ä¸»å­˜ç§æœ‰éƒ¨åˆ†çš„æ›´æ–°åˆ™ä¸è®¡å…¥æ•°æ®åº“ä¿®æ”¹<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</p>
<ul>
<li>è‹¥äº‹åŠ¡åœ¨æäº¤å‰æœªå¯¹æ•°æ®åº“è¿›è¡Œä»»ä½•ä¿®æ”¹ï¼Œåˆ™ç§°å…¶é‡‡ç”¨äº†<strong>å»¶è¿Ÿä¿®æ”¹</strong><span>(deferred-modification)<span class="heti-spacing"> </span></span>æŠ€æœ¯<ul>
<li>å»¶è¿Ÿä¿®æ”¹éœ€æ‰¿æ‹…é¢å¤–çš„å¼€é”€ï¼šäº‹åŠ¡é¡»ä¸ºæ‰€æœ‰æ›´æ–°çš„æ•°æ®é¡¹ç»´æŠ¤æœ¬åœ°æ‹·è´ï¼›å¹¶ä¸”ï¼Œè‹¥äº‹åŠ¡è¦è¯»å–å·²æ›´æ–°çš„æ•°æ®é¡¹ï¼Œå¿…é¡»ä»å…¶æœ¬åœ°æ‹·è´è·å–å€¼ã€‚</li>
</ul>
</li>
<li>è‹¥äº‹åŠ¡åœ¨æ´»åŠ¨æœŸé—´å³å‘ç”Ÿæ•°æ®åº“ä¿®æ”¹ï¼Œåˆ™ç§°å…¶é‡‡ç”¨äº†<strong>ç«‹å³ä¿®æ”¹</strong><span>(immediate-modification)<span class="heti-spacing"> </span></span>æŠ€æœ¯</li>
</ul>
<p>æ¢å¤ç®—æ³•å¿…é¡»è€ƒè™‘å¤šç§å› ç´ ï¼ŒåŒ…æ‹¬ï¼š</p>
<ul>
<li>äº‹åŠ¡å¯èƒ½å·²ç»æäº¤äº†ï¼Œä½†å…¶å¯¹æ•°æ®åº“çš„éƒ¨åˆ†ä¿®æ”¹ä»…å­˜åœ¨äºä¸»å­˜çš„ç£ç›˜ç¼“å†²åŒºä¸­ï¼Œè€Œæœªå†™å…¥ç£ç›˜ä¸Šçš„æ•°æ®åº“</li>
<li>äº‹åŠ¡åœ¨æ´»åŠ¨çŠ¶æ€æ—¶å¯èƒ½å·²ç»ä¿®æ”¹äº†æ•°æ®åº“ï¼Œä½†éšåå› ä¸ºæ•…éšœå¯èƒ½éœ€è¦ä¸­æ­¢</li>
</ul>
<p>ç”±äºæ‰€æœ‰æ•°æ®åº“ä¿®æ”¹å‰éƒ½å¿…é¡»å…ˆåˆ›å»ºæ—¥å¿—è®°å½•ï¼Œç³»ç»Ÿä¿ç•™äº†æ•°æ®é¡¹çš„æ—§å€¼å’Œçš„æ–°å€¼ï¼Œè¿™ä½¿å¾—ç³»ç»Ÿèƒ½å¤Ÿæ ¹æ®éœ€è¦æ‰§è¡Œæ’¤é”€å’Œé‡åšæ“ä½œï¼š</p>
<ul>
<li><strong>æ’¤é”€</strong>(undo)ï¼šå°†æ—¥å¿—ä¸­æŒ‡å®šçš„æ•°æ®é¡¹è®¾ç½®ä¸ºè¯¥è®°å½•æ‰€åŒ…å«çš„<strong>æ—§å€¼</strong></li>
<li><strong>é‡åš</strong>(redo)ï¼šå°†æ—¥å¿—ä¸­æŒ‡å®šçš„æ•°æ®é¡¹è®¾ç½®ä¸ºè¯¥è®°å½•æ‰€åŒ…å«çš„<strong>æ–°å€¼</strong></li>
</ul>
<h3 id="concurrency-control-and-recovery">Concurrency Control and Recovery<a class="headerlink" href="#concurrency-control-and-recovery" title="Permanent link">âš“ï¸</a></h3>
<p>è‹¥å¹¶å‘æ§åˆ¶æ–¹æ¡ˆå…è®¸ä¸€ä¸ªå·²è¢«äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_1\)</span><span class="heti-spacing"> </span></span>ä¿®æ”¹çš„æ•°æ®é¡¹<span><span class="heti-spacing"> </span><span class="arithmatex">\(X\)</span></span>ï¼Œåœ¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_1\)</span><span class="heti-spacing"> </span></span>æäº¤å‰åˆè¢«å¦ä¸€äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_2\)</span><span class="heti-spacing"> </span></span>è¿›ä¸€æ­¥ä¿®æ”¹ï¼Œé‚£ä¹ˆé€šè¿‡æ¢å¤<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(X\)</span><span class="heti-spacing"> </span></span>çš„æ—§å€¼ï¼ˆå³<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_1\)</span><span class="heti-spacing"> </span></span>æ›´æ–°å‰çš„å€¼ï¼‰æ¥æ’¤é”€<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_1\)</span><span class="heti-spacing"> </span></span>çš„å½±å“æ—¶ï¼Œä¹Ÿä¼šè¿å¸¦æ’¤é”€<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_2\)</span><span class="heti-spacing"> </span></span>çš„ä¿®æ”¹æ•ˆæœã€‚ä¸ºé¿å…æ­¤ç±»æƒ…å†µçš„å‘ç”Ÿï¼Œæ¢å¤ç®—æ³•é€šå¸¸è¦æ±‚ï¼šä¸€æ—¦æŸæ•°æ®é¡¹è¢«æŸäº‹åŠ¡ä¿®æ”¹ï¼Œåœ¨è¯¥äº‹åŠ¡æäº¤æˆ–ä¸­æ­¢å‰ï¼Œå…¶ä»–äº‹åŠ¡å‡ä¸å¾—å†ä¿®æ”¹è¯¥æ•°æ®é¡¹ã€‚</p>
<p>è¿™ä¸€è¦æ±‚å¯é€šè¿‡è·å–è¢«æ›´æ–°æ•°æ®é¡¹çš„<strong>ç‹¬å é”</strong>ï¼Œå¹¶å°†å…¶ä¿æŒè‡³äº‹åŠ¡æäº¤æ¥å®ç°ã€‚æ¢è¨€ä¹‹ï¼Œé‡‡ç”¨<strong>ä¸¥æ ¼ä¸¤é˜¶æ®µé”</strong>å³å¯æ»¡è¶³è¿™ä¸€è¦æ±‚ã€‚<strong>å¿«ç…§éš”ç¦»</strong>ä¸<strong>åŸºäºéªŒè¯çš„å¹¶å‘æ§åˆ¶</strong>æŠ€æœ¯åŒæ ·ä¼šåœ¨éªŒè¯é˜¶æ®µè·å–ç‹¬å é”ï¼Œå¹¶æŒæœ‰è¿™äº›é”ç›´è‡³äº‹åŠ¡æäº¤ï¼›å› æ­¤ä¸Šè¿°éœ€æ±‚åœ¨è¿™äº›å¹¶å‘æ§åˆ¶åè®®ä¸­ä¹Ÿèƒ½å¾—åˆ°æ»¡è¶³ã€‚ä¹‹åä¼šè®¨è®ºåœ¨æŸäº›æƒ…å†µä¸‹å¦‚ä½•æ”¾å®½è¯¥è¦æ±‚ã€‚</p>
<p>å½“é‡‡ç”¨å¿«ç…§éš”ç¦»æˆ–éªŒè¯æœºåˆ¶è¿›è¡Œå¹¶å‘æ§åˆ¶æ—¶ï¼Œäº‹åŠ¡æ‰€åšçš„æ•°æ®åº“æ›´æ–°ä¼š<strong>å»¶è¿Ÿ</strong>åˆ°å…¶éƒ¨åˆ†æäº¤æ—¶æ‰æ‰§è¡Œï¼›è¿™ç§å»¶è¿Ÿä¿®æ”¹æŠ€æœ¯ä¸è¿™ç±»å¹¶å‘æ§åˆ¶æ–¹æ¡ˆå¤©ç„¶å¥‘åˆã€‚ä½†éœ€æ³¨æ„ï¼š</p>
<ul>
<li>æŸäº›å¿«ç…§éš”ç¦»çš„å®ç°è™½ç„¶é‡‡ç”¨çš„æ˜¯ç«‹å³ä¿®æ”¹æ–¹å¼ï¼Œå´èƒ½æŒ‰éœ€æä¾›é€»è¾‘å¿«ç…§ï¼šå½“äº‹åŠ¡éœ€è¦è¯»å–è¢«å¹¶å‘äº‹åŠ¡æ›´æ–°çš„æ•°æ®é¡¹æ—¶ï¼Œç³»ç»Ÿä¼šåˆ›å»ºè¯¥æ•°æ®é¡¹ï¼ˆå·²æ›´æ–°ç‰ˆæœ¬ï¼‰çš„æ‹·è´å¹¶åœ¨æ‹·è´ä¸Šå›æ»šå…¶ä»–å¹¶å‘äº‹åŠ¡æ‰€åšçš„æ›´æ”¹</li>
<li>åŒç†ï¼Œè™½ç„¶ç«‹å³ä¿®æ”¹æ›´é€‚åˆå’Œä¸¤é˜¶æ®µé”æœºåˆ¶æ­é…ä½¿ç”¨ï¼Œä½†ä¹Ÿå¯ä»¥ç”¨å»¶è¿Ÿå˜æ›´</li>
</ul>
<h3 id="transaction-commit">Transaction Commit<a class="headerlink" href="#transaction-commit" title="Permanent link">âš“ï¸</a></h3>
<p>å½“äº‹åŠ¡æäº¤æ—¶ï¼Œ<span>DBMS<span class="heti-spacing"> </span></span>é¦–å…ˆå°†<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•å†™å…¥å†…å­˜ä¸­çš„æ—¥å¿—ç¼“å†²åŒºã€‚ç„¶åï¼Œ<span>DBMS<span class="heti-spacing"> </span></span>å°†æ‰€æœ‰æ—¥å¿—è®°å½•ï¼ˆåŒ…æ‹¬äº‹åŠ¡çš„<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•ï¼‰åˆ·æ´—åˆ°ç£ç›˜ä¸­ã€‚è¯·æ³¨æ„ï¼Œæ—¥å¿—çš„åˆ·æ´—æ“ä½œæ˜¯é¡ºåºçš„ã€åŒæ­¥çš„ç£ç›˜å†™å…¥ã€‚æ¯ä¸ªæ—¥å¿—é¡µå¯ä»¥æœ‰å¤šä¸ªæ—¥å¿—è®°å½•ã€‚</p>
<p>å½“äº‹åŠ¡çš„<strong>æäº¤æ—¥å¿—è®°å½•</strong>ï¼ˆå³è¯¥äº‹åŠ¡çš„æœ€åä¸€æ¡æ—¥å¿—è®°å½•ï¼‰è¢«è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨æ—¶ï¼Œæˆ‘ä»¬ç§°è¯¥äº‹åŠ¡<strong>å·²æäº¤</strong>(committed)ã€‚å› æ­¤ï¼Œæ—¥å¿—ä¸­åŒ…å«è¶³å¤Ÿä¿¡æ¯æ¥ç¡®ä¿å³ä½¿ç³»ç»Ÿå´©æºƒï¼Œä¹Ÿèƒ½é‡åšè¯¥äº‹åŠ¡çš„æ‰€æœ‰æ›´æ–°æ“ä½œã€‚</p>
<p>ä¸€æ—¦<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•å®‰å…¨åœ°å­˜å‚¨åˆ°ç£ç›˜ä¸Šï¼Œ<span>DBMS<span class="heti-spacing"> </span></span>ä¼šå‘åº”ç”¨ç¨‹åºè¿”å›äº‹åŠ¡å·²æäº¤çš„ç¡®è®¤ã€‚éšåæŸä¸ªæ—¶åˆ»ï¼Œç³»ç»Ÿå°†å†™å…¥ä¸€æ¡ç‰¹æ®Šçš„<span class="heti-skip"><span class="heti-spacing"> </span>TXN-END<span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•ï¼Œæ ‡å¿—ç€è¯¥äº‹åŠ¡åœ¨ç³»ç»Ÿä¸­å½»åº•å®Œæˆï¼Œä¸”ä¸ä¼šå†æœ‰å…¶ç›¸å…³çš„æ—¥å¿—è®°å½•äº§ç”Ÿã€‚æ­¤ç±»<span class="heti-skip"><span class="heti-spacing"> </span>TXN-END<span class="heti-spacing"> </span></span>è®°å½•ä»…ç”¨äºå†…éƒ¨ç°¿è®°ç®¡ç†ï¼Œæ— éœ€ç«‹å³åˆ·å…¥åˆ°ç£ç›˜ä¸­ã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/13.gif" width="80%/"/>
</div>
</details>
<p>è‹¥ç³»ç»Ÿåœ¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•å†™å…¥è‡³ç¨³å®šå­˜å‚¨å™¨å‰å‘ç”Ÿå´©æºƒï¼Œåˆ™äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>å°†è¢«å›æ»šã€‚ç”±æ­¤å¯è§ï¼ŒåŒ…å«æäº¤æ—¥å¿—è®°å½•çš„æ•°æ®å—è¾“å‡ºæ˜¯å¯¼è‡´äº‹åŠ¡æˆåŠŸæäº¤çš„<strong>åŸå­æ€§</strong>æ“ä½œã€‚</p>
<p>åœ¨å¤§å¤šæ•°åŸºäºæ—¥å¿—çš„æ¢å¤æŠ€æœ¯ä¸­ï¼Œå½“äº‹åŠ¡æäº¤æ—¶ï¼Œè¢«è¯¥äº‹åŠ¡ä¿®æ”¹çš„æ•°æ®é¡¹æ‰€åœ¨çš„å—ä¸å¿…ç«‹å³è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨è®¾å¤‡ä¸Šï¼Œè€Œæ˜¯å¯ä»¥ç¨åå†è¿›è¡Œè¾“å‡ºã€‚</p>
<h4 id="group-commit">Group Commit<a class="headerlink" href="#group-commit" title="Permanent link">âš“ï¸</a></h4>
<p>æäº¤äº‹åŠ¡è¦æ±‚å…¶æ—¥å¿—è®°å½•è¢«å¼ºåˆ¶å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚è‹¥ä¸ºæ¯ä¸ªäº‹åŠ¡å•ç‹¬æ‰§è¡Œæ—¥å¿—æ¸…é™¤æ“ä½œï¼Œé‚£ä¹ˆæ¯æ¬¡æäº¤éƒ½ä¼šäº§ç”Ÿå¾ˆå¤§çš„æ—¥å¿—å†™å…¥å¼€é”€ã€‚å› æ­¤ï¼Œæˆ‘ä»¬é‡‡ç”¨<strong>ç»„æäº¤</strong><span>(group-commit)<span class="heti-spacing"> </span></span>çš„æŠ€æœ¯ï¼Œä»¥æå‡äº‹åŠ¡çš„æäº¤é€Ÿç‡ï¼š</p>
<ul>
<li>ç³»ç»Ÿä¸å†åœ¨å•ä¸ªäº‹åŠ¡å®Œæˆåç«‹å³å¼ºåˆ¶å†™å…¥æ—¥å¿—ï¼Œè€Œæ˜¯ç­‰å¾…å¤šä¸ªäº‹åŠ¡å®Œæˆï¼Œæˆ–è‡ªä¸Šæ¬¡äº‹åŠ¡æ‰§è¡Œå®Œæ¯•ç»è¿‡ä¸€å®šæ—¶é—´é—´éš”åï¼Œå°†å¤„äºç­‰å¾…çŠ¶æ€çš„äº‹åŠ¡ç»„æ‰¹é‡æäº¤ã€‚æ­¤æ—¶ç¨³å®šå­˜å‚¨å™¨ä¸Šçš„æ—¥å¿—å—å°†åŒ…å«å¤šä¸ªäº‹åŠ¡çš„è®°å½•</li>
<li>é€šè¿‡åˆç†è®¾ç½®<strong>ç»„å¤§å°</strong>å’Œ<strong>æœ€å¤§ç­‰å¾…æ—¶é—´</strong>ï¼Œç³»ç»Ÿæ—¢èƒ½ç¡®ä¿å†™å…¥ç¨³å®šå­˜å‚¨çš„å—æ•°æ®æ»¡è½½ï¼Œåˆä¸ä¼šå¯¼è‡´äº‹åŠ¡è¿‡åº¦å»¶è¿Ÿ</li>
<li>å¹³å‡è€Œè¨€ï¼Œè¯¥æŠ€æœ¯èƒ½å¤Ÿå‡å°‘æ¯ä¸ªå·²æäº¤äº‹åŠ¡æ‰€å¯¹åº”çš„è¾“å‡ºæ“ä½œæ¬¡æ•°</li>
<li>å¯¹é—ªå­˜è€Œè¨€ï¼Œç»„æäº¤è¿˜èƒ½æ˜¾è‘—é™ä½åŒä¸€é¡µé¢çš„é‡å¤å†™å…¥æ¬¡æ•°æ¬¡æ•°ï¼Œè¿›è€Œå‡å°‘æ˜‚è´µçš„æ“¦é™¤æ“ä½œï¼ˆéœ€æ³¨æ„é—ªå­˜ç³»ç»Ÿä¼šå°†é€»è¾‘é¡µé¢é‡æ˜ å°„è‡³é¢„æ“¦é™¤ç‰©ç†é¡µé¢ä»¥é¿å…å³æ—¶æ“¦é™¤å»¶è¿Ÿï¼‰</li>
<li>å°½ç®¡ç»„æäº¤ä»¥ç•¥å¾®å»¶è¿Ÿæ›´æ–°å‹äº‹åŠ¡ä¸ºä»£ä»·é™ä½äº†æ—¥å¿—å¼€é”€ï¼Œä½†åœ¨é«˜é¢‘ç‡æäº¤åœºæ™¯ä¸‹ï¼Œæ€»ä½“å»¶è¿Ÿåè€Œä¼šä¸‹é™ï¼›ä½†ä½é¢‘ç‡æ—¶è¿™ç§æ–¹æ³•å¯èƒ½å¾—ä¸å¿å¤±</li>
</ul>
<p>é™¤äº†åœ¨æ•°æ®åº“å±‚é¢è¿›è¡Œçš„ä¼˜åŒ–å¤–ï¼Œç¨‹åºå‘˜è¿˜å¯ä»¥é‡‡å–ä¸€äº›æªæ–½æ¥æå‡äº‹åŠ¡æäº¤æ€§èƒ½ã€‚ä¾‹å¦‚é€šè¿‡<strong>å°†æ‰¹é‡æ’å…¥åˆå¹¶ä¸ºå•ä¸ªäº‹åŠ¡æ‰§è¡Œ</strong>ï¼Œæ€§èƒ½å¯è·å¾—æ˜¾è‘—æå‡â€”â€”å¤šä¸ªæ’å…¥æ“ä½œå¯¹åº”çš„æ—¥å¿—è®°å½•ä¼šè¢«é›†ä¸­å†™å…¥åŒä¸€é¡µé¢ä¸­ï¼Œä»è€Œä½¿æ¯ç§’å¯å¤„ç†çš„æ’å…¥æ•°é‡æˆæ¯”ä¾‹å¢é•¿ã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/9.gif" width="80%/"/>
</div>
</details>
<h3 id="using-the-log-to-redo-and-undo-transactions">Using the Log to Redo and Undo Transactions<a class="headerlink" href="#using-the-log-to-redo-and-undo-transactions" title="Permanent link">âš“ï¸</a></h3>
<p>ä¸‹é¢æˆ‘ä»¬æ¥å¤§è‡´äº†è§£ä¸€ä¸‹å¦‚ä½•ç”¨æ—¥å¿—æ¥æ¢å¤å´©æºƒçš„ç³»ç»Ÿå’Œå›æ»šäº‹åŠ¡ã€‚æœ‰ä»¥ä¸‹ä¸¤ä¸ªæ¢å¤è¿‡ç¨‹ï¼š</p>
<ul>
<li><code>redo(T_i)</code>ï¼šå°†äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>æ›´æ–°è¿‡çš„æ‰€æœ‰æ•°æ®é¡¹çš„å€¼è®¾ç½®ä¸º<strong>æ–°å€¼</strong>ã€‚<ul>
<li><code>redo</code> æ‰§è¡Œæ›´æ–°çš„é¡ºåºå¾ˆé‡è¦ï¼›åœ¨ä»ç³»ç»Ÿå´©æºƒä¸­æ¢å¤æ—¶ï¼Œå¦‚æœå¯¹ç‰¹å®šæ•°æ®é¡¹çš„æ›´æ–°é¡ºåºä¸æœ€åˆåº”ç”¨çš„é¡ºåºä¸åŒï¼Œè¯¥æ•°æ®é¡¹çš„æœ€ç»ˆçŠ¶æ€å°±ä¼šæœ‰é”™è¯¯çš„å€¼ã€‚</li>
<li>å¤§å¤šæ•°æ¢å¤ç®—æ³•ï¼Œéƒ½ä¸å¯¹æ¯ä¸ªäº‹åŠ¡å•ç‹¬æ‰§è¡Œ <code>redo</code>ï¼Œè€Œæ˜¯å¯¹æ—¥å¿—è¿›è¡Œå•æ¬¡æ‰«æã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œæ¯å½“é‡åˆ°æ—¥å¿—è®°å½•æ—¶ï¼Œéƒ½ä¼šæ‰§è¡Œ <code>redo</code> æ“ä½œã€‚è¿™ç§æ–¹æ³•ä¸ä»…ä¿ç•™äº†æ›´æ–°é¡ºåºï¼Œå¹¶ä¸”æ›´é«˜æ•ˆï¼ˆå› ä¸ºæ—¥å¿—åªéœ€è¦è¯»å–ä¸€æ¬¡ï¼Œè€Œä¸ç”¨ä¸ºæ¯ä¸ªäº‹åŠ¡è¯»ä¸€éæ—¥å¿—<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
</ul>
</li>
<li><code>undo(T_i)</code>ï¼šè¯¥è¿‡ç¨‹å°†æ‰€æœ‰ç”±äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>æ›´æ–°çš„æ•°æ®é¡¹çš„å€¼æ¢å¤åˆ°<strong>æ—§å€¼</strong>ã€‚<ul>
<li>è¯¥æ“ä½œä¸ä»…å°†æ•°æ®é¡¹æ¢å¤åˆ°æ—§å€¼ï¼Œè€Œä¸”è¿˜è¦å†™å…¥æ—¥å¿—è®°å½•ï¼Œä»¥è®°å½•ä½œä¸ºæ’¤é”€è¿‡ç¨‹ä¸­ä¸€éƒ¨åˆ†æ‰§è¡Œçš„æ›´æ–°ã€‚<ul>
<li>è¿™äº›æ—¥å¿—è®°å½•æ˜¯ç‰¹æ®Šçš„<strong>ä»…é‡åš</strong><span>(redo-only)<span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•ï¼Œå› ä¸ºå®ƒä»¬ä¸éœ€è¦åŒ…å«æ›´æ–°æ•°æ®é¡¹çš„æ—§å€¼</li>
<li>è¯·æ³¨æ„ï¼Œåœ¨æ’¤é”€è¿‡ç¨‹ä¸­ä½¿ç”¨æ­¤ç±»æ—¥å¿—è®°å½•æ—¶<heti-adjacent class="heti-adjacent-quarter">ï¼Œ</heti-adjacent>â€œæ—§å€¼â€å®é™…ä¸Šæ˜¯æ­£åœ¨å›æ»šçš„äº‹åŠ¡å†™å…¥çš„å€¼<heti-adjacent class="heti-adjacent-quarter">ï¼Œ</heti-adjacent>â€œæ–°å€¼â€æ˜¯æ’¤é”€æ“ä½œæ­£åœ¨æ¢å¤çš„åŸå§‹å€¼</li>
<li>ä¸é‡åšè¿‡ç¨‹ä¸€æ ·ï¼Œæ’¤é”€æ“ä½œæ‰§è¡Œçš„é¡ºåºå¾ˆé‡è¦</li>
</ul>
</li>
<li>å½“äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„æ’¤é”€æ“ä½œå®Œæˆæ—¶ï¼Œå®ƒå†™å…¥ä¸€ä¸ª<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•ï¼ŒæŒ‡ç¤ºæ’¤é”€å·²å®Œæˆã€‚<ul>
<li>å¦‚æœäº‹åŠ¡åœ¨æ­£å¸¸å¤„ç†è¿‡ç¨‹ä¸­å›æ»šæˆ–ä»ç³»ç»Ÿå´©æºƒä¸­æ¢å¤ï¼Œä¸”æœªæ‰¾åˆ°äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„æäº¤æˆ–ä¸­æ­¢è®°å½•ï¼Œåˆ™ä»…æ‰§è¡Œä¸€æ¬¡ <code>undo(Ti)</code> è¿‡ç¨‹ï¼›å› æ­¤ï¼Œæ¯ä¸ªäº‹åŠ¡æœ€ç»ˆéƒ½ä¼šåœ¨æ—¥å¿—ä¸­æœ‰ä¸€ä¸ªæäº¤æˆ–ä¸­æ­¢è®°å½•</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>ç³»ç»Ÿå‘ç”Ÿå´©æºƒåä¼šæŸ¥é˜…æ—¥å¿—ï¼Œæ¥ç¡®å®šå“ªäº›äº‹åŠ¡éœ€è¦é‡åšã€å“ªäº›éœ€è¦æ’¤é”€ï¼Œä»è€Œç¡®ä¿åŸå­æ€§ï¼š</p>
<ul>
<li>å½“äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„æ—¥å¿—è®°å½•åŒ…å«<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ start}&gt;\)</span><span class="heti-spacing"> </span></span>ä½†æœªåŒ…å«<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>æˆ–<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¶ï¼Œè¯¥äº‹åŠ¡éœ€è¢«<strong>æ’¤é”€</strong>ã€‚</li>
<li>å½“äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„æ—¥å¿—è®°å½•åŒæ—¶å­˜åœ¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ start}&gt;\)</span><span class="heti-spacing"> </span></span>ä»¥åŠ<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>æˆ–<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¶ï¼Œè¯¥äº‹åŠ¡éœ€è¢«<strong>é‡åš</strong>ã€‚<ul>
<li>å…¶è¿ä½œæœºåˆ¶åœ¨äºï¼šå½“<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>å­˜åœ¨äºæ—¥å¿—æ—¶ï¼Œç”±æ’¤é”€æ“ä½œå†™å…¥çš„ä»…é‡åšçš„è®°å½•ä¹Ÿå¿…ç„¶å­˜åœ¨ã€‚å› æ­¤æœ€ç»ˆæ‰§è¡Œæ•ˆæœä»æ˜¯å¯¹<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>ä¿®æ”¹çš„æ’¤é”€ã€‚è¿™ç§å¾®å°çš„å†—ä½™è®¾è®¡ç®€åŒ–äº†æ¢å¤ç®—æ³•å¹¶æå‡äº†æ•´ä½“æ¢å¤é€Ÿåº¦ã€‚</li>
</ul>
</li>
</ul>
<h3 id="transaction-rollback">Transaction Rollback<a class="headerlink" href="#transaction-rollback" title="Permanent link">âš“ï¸</a></h3>
<p>é¦–å…ˆè€ƒè™‘åœ¨æ­£å¸¸è¿è¡ŒæœŸé—´ï¼ˆå³éç³»ç»Ÿå´©æºƒæ¢å¤æ—¶ï¼‰çš„äº‹åŠ¡<strong>å›æ»š</strong>ï¼ˆå³<strong>æ’¤é”€</strong>æ“ä½œ<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„å›æ»šæ“ä½œæŒ‰ä»¥ä¸‹æ­¥éª¤æ‰§è¡Œï¼š</p>
<ol>
<li><strong>åå‘æ‰«ææ—¥å¿—</strong>ï¼Œå¯¹äºå‘ç°çš„æ¯ä¸ªå½¢å¼ä¸º<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, X_j, V_1, V_2&gt;\)</span><span class="heti-spacing"> </span></span>çš„<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„æ—¥å¿—è®°å½•ï¼š</li>
<li>å°†å€¼<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(V_1\)</span><span class="heti-spacing"> </span></span>å†™å›æ•°æ®é¡¹<span><span class="heti-spacing"> </span><span class="arithmatex">\(X_j\)</span></span></li>
<li>
<p>åŒæ—¶å‘æ—¥å¿—å†™å…¥ä¸€æ¡ç‰¹æ®Šçš„ä»…é‡åšè®°å½•<span><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, X_j, V_1&gt;\)</span></span>ï¼Œå…¶ä¸­<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(V_1\)</span><span class="heti-spacing"> </span></span>æ˜¯å›æ»šè¿‡ç¨‹ä¸­è¦æ¢å¤åˆ°æ•°æ®é¡¹<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(X_j\)</span><span class="heti-spacing"> </span></span>çš„å€¼ã€‚è¿™ç±»æ—¥å¿—è®°å½•æœ‰æ—¶ç§°ä¸º<strong>è¡¥å¿æ—¥å¿—è®°å½•</strong>(compensation log records)ã€‚æ­¤ç±»è®°å½•ä¸éœ€è¦åŒ…å«æ’¤é”€ä¿¡æ¯ï¼Œå› ä¸ºæˆ‘ä»¬æ°¸è¿œä¸éœ€è¦æ’¤é”€è¿™ç±»é€†å‘æ“ä½œã€‚</p>
</li>
<li>
<p>å½“æ‰«æåˆ°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ start}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•æ—¶åœæ­¢åå‘æ‰«æï¼Œå¹¶å‘æ—¥å¿—å†™å…¥ä¸€æ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•ã€‚</p>
</li>
</ol>
<p>è¿™æ ·ï¼Œæ— è®ºæ˜¯äº‹åŠ¡æœ¬èº«æ‰§è¡Œçš„æ›´æ–°æ“ä½œï¼Œè¿˜æ˜¯ä»£è¡¨äº‹åŠ¡æ‰§è¡Œçš„æ“ä½œï¼ˆåŒ…æ‹¬å°†æ•°æ®é¡¹æ¢å¤æ—§å€¼çš„æ‰€æœ‰æ“ä½œ<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œç°åœ¨éƒ½å·²å®Œæ•´è®°å½•åœ¨æ—¥å¿—ä¸­ã€‚</p>
<h3 id="checkpoints">Checkpoints<a class="headerlink" href="#checkpoints" title="Permanent link">âš“ï¸</a></h3>
<p>å…³äºç³»ç»Ÿå´©æºƒåæŸ¥é˜…æ—¥å¿—è¿™ä»¶äº‹ï¼Œæœ€ç›´æ¥çš„æ–¹å¼ä¾¿æ˜¯æœç´¢æ•´ä¸ªæ—¥å¿—æ¥è·å–ç”¨äºæ¢å¤çš„ä¿¡æ¯ã€‚ä½†è¿™ç§åšæ³•å­˜åœ¨ä¸¤å¤§éš¾ç‚¹ï¼š</p>
<ul>
<li>æœç´¢è¿‡ç¨‹è€—æ—¶å¤§</li>
<li>æ ¹æ®æˆ‘ä»¬çš„ç®—æ³•ï¼Œåˆ¤å®šéœ€é‡åšçš„äº‹åŠ¡ä¸­ï¼Œç»å¤§å¤šæ•°å…¶å®æ—©å·²å°†æ›´æ–°å†™å…¥æ•°æ®åº“é‡Œäº†ã€‚å°½ç®¡é‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œä¸ä¼šé€ æˆä»€ä¹ˆæŸå®³ï¼Œä½†ä¼šå¯¼è‡´æ¢å¤æ—¶é—´çš„å»¶é•¿ã€‚</li>
</ul>
<p>ä¸ºé™ä½æ­¤ç±»å¼€é”€ï¼Œæˆ‘ä»¬å¼•å…¥äº†<strong>æ£€æŸ¥ç‚¹</strong><span>(checkpoints)<span class="heti-spacing"> </span></span>æœºåˆ¶ã€‚ä»¥ä¸‹æè¿°ä¸€ç§ç®€å•çš„æ£€æŸ¥ç‚¹æ–¹æ¡ˆï¼š</p>
<ul>
<li>åœ¨æ£€æŸ¥ç‚¹æ“ä½œæ‰§è¡ŒæœŸé—´ç¦æ­¢ä»»ä½•æ•°æ®æ›´æ–°<ul>
<li>åœæ­¢ä»»ä½•æ–°äº‹åŠ¡çš„çš„å¼€å§‹</li>
<li>ç­‰å¾…æ‰€æœ‰æ´»è·ƒäº‹åŠ¡æ‰§è¡Œå®Œæ¯•</li>
</ul>
</li>
<li>æ‰§è¡Œæ£€æŸ¥ç‚¹æ—¶å°†æ‰€æœ‰ä¿®æ”¹è¿‡çš„ç¼“å†²åŒºå—ï¼ˆè„é¡µï¼‰è¾“å‡ºåˆ°ç£ç›˜ä¸­</li>
</ul>
<p>åé¢æˆ‘ä»¬å°†è®¨è®ºå¦‚ä½•é€šè¿‡æ”¾å®½è¿™ä¸¤é¡¹è¦æ±‚æ¥æ”¹è¿›æ£€æŸ¥ç‚¹å’Œæ¢å¤æµç¨‹ï¼Œä»è€Œè·å¾—æ›´å¤§çµæ´»æ€§ã€‚</p>
<p>è€Œæ£€æŸ¥ç‚¹çš„å…·ä½“æ‰§è¡Œæ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å°†å½“å‰é©»ç•™åœ¨ä¸»å­˜ä¸­çš„æ‰€æœ‰æ—¥å¿—è®°å½•è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­</li>
<li>å°†æ‰€æœ‰ä¿®æ”¹è¿‡çš„ç¼“å†²åŒºå—ï¼ˆ<strong>è„é¡µ</strong>(dirty pages)ï¼‰è¾“å‡ºè‡³ç£ç›˜ä¸­<ul>
<li>ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä¾¿è¿™ä¸ªäº‹åŠ¡è¿˜æ²¡æœ‰æäº¤ï¼Œåœ¨æ£€æŸ¥ç‚¹ä¹‹å‰å¯¹æ•°æ®çš„ä¿®æ”¹ä¹Ÿä¼šä½œç”¨åœ¨æ•°æ®åº“ä¸Š</li>
</ul>
</li>
<li>å‘ç¨³å®šå­˜å‚¨å™¨è¾“å‡ºä¸€ä¸ªæ ¼å¼ä¸º<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;\text{checkpoint } L&gt;\)</span><span class="heti-spacing"> </span></span>çš„æ—¥å¿—è®°å½•ï¼Œå…¶ä¸­<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(L\)</span><span class="heti-spacing"> </span></span>æ˜¯åœ¨æ£€æŸ¥ç‚¹æ—¶åˆ»ä¸Šçš„<strong>æ´»è·ƒäº‹åŠ¡è¡¨</strong></li>
</ol>
<details class="info">
<summary>æ´»è·ƒäº‹åŠ¡è¡¨</summary>
<p><strong>æ´»åŠ¨äº‹åŠ¡è¡¨</strong>(active transcation list, <strong>ATT</strong><span>)<span class="heti-spacing"> </span></span>è¡¨ç¤ºåœ¨<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>ä¸­æ­£åœ¨è¿è¡Œçš„äº‹åŠ¡çš„çŠ¶æ€ã€‚åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>å®Œæˆè¯¥äº‹åŠ¡çš„æäº¤<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>ä¸­æ­¢è¿‡ç¨‹åï¼Œäº‹åŠ¡çš„æ¡ç›®å°†è¢«åˆ é™¤ã€‚å¯¹äºæ¯ä¸ªäº‹åŠ¡æ¡ç›®ï¼Œ<span>ATT<span class="heti-spacing"> </span></span>åŒ…å«ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<ul>
<li>transactionIdï¼šå”¯ä¸€çš„äº‹åŠ¡æ ‡è¯†ç¬¦</li>
<li>statusï¼šäº‹åŠ¡å½“å‰çš„â€œæ¨¡å¼â€ï¼ˆè¿è¡Œä¸­<span><span class="heti-spacing"> </span>(R)</span>ã€æäº¤ä¸­<span><span class="heti-spacing"> </span>(C)</span>ã€æ’¤é”€å€™é€‰<span><span class="heti-spacing"> </span>(U)</span><heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
<li>lastLSNï¼šäº‹åŠ¡å†™å…¥çš„æœ€æ–°çš„<span><span class="heti-spacing"> </span>LSN</span></li>
</ul>
<p>æ³¨æ„ï¼Œ<span>ATT<span class="heti-spacing"> </span></span>åŒ…å«é™¤<span class="heti-skip"><span class="heti-spacing"> </span>TXN-END<span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•å¤–çš„æ¯ä¸ªäº‹åŠ¡ï¼ŒåŒ…æ‹¬å·²æäº¤æˆ–ä¸­æ­¢çš„äº‹åŠ¡ã€‚</p>
</details>
<p>æ—¥å¿—ä¸­å­˜åœ¨çš„<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;\text{checkpoint } L&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•èƒ½è®©ç³»ç»Ÿç®€åŒ–æ¢å¤è¿‡ç¨‹ï¼šè€ƒè™‘ä¸€ä¸ªåœ¨æ£€æŸ¥ç‚¹ä¹‹å‰å®Œæˆçš„äº‹åŠ¡<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span></span>ï¼Œå¯¹äºæ­¤ç±»äº‹åŠ¡ï¼Œ<span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span>ï¼ˆæˆ–<span><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span></span>ï¼‰ä¼šå‡ºç°åœ¨æ—¥å¿—çš„<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;\text{checkpoint}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•ä¹‹å‰ã€‚ç”±<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>æ‰§è¡Œçš„æ‰€æœ‰æ•°æ®åº“ä¿®æ”¹å¿…ç„¶å·²åœ¨æ£€æŸ¥ç‚¹å‰å†™å…¥æ•°æ®åº“ï¼Œæˆ–æ˜¯ä½œä¸ºæ£€æŸ¥ç‚¹æœ¬èº«çš„ä¸€éƒ¨åˆ†å®Œæˆã€‚å› æ­¤ï¼Œåœ¨æ¢å¤é˜¶æ®µæ— éœ€å¯¹<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>æ‰§è¡Œé‡åšæ“ä½œã€‚</p>
<p>å½“ç³»ç»Ÿå‘ç”Ÿå´©æºƒåï¼Œç³»ç»Ÿä¼šæ‰«ææ—¥å¿—ä»¥å®šä½åˆ°æœ€è¿‘çš„<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;\text{checkpoint } L&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•â€”â€”å…·ä½“å¯é€šè¿‡ä»æ—¥å¿—æœ«å°¾å‘å‰æœç´¢ï¼Œç›´è‡³æ‰¾åˆ°é¦–ä¸ª<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;\text{checkpoint } L&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•æ¥å®ç°ã€‚</p>
<p>é‡åšä¸æ’¤é”€æ“ä½œä»…éœ€åº”ç”¨äºé›†åˆ<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(L\)</span><span class="heti-spacing"> </span></span>ä¸­çš„äº‹åŠ¡ï¼Œä»¥åŠæ‰€æœ‰åœ¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;\text{checkpoint } L&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•å†™å…¥æ—¥å¿—åå¼€å§‹æ‰§è¡Œçš„äº‹åŠ¡ã€‚æˆ‘ä»¬å°†è¯¥äº‹åŠ¡é›†åˆè®°ä¸º<span><span class="heti-spacing"> </span><span class="arithmatex">\(T\)</span></span>ï¼š</p>
<ul>
<li>å¯¹äº<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T\)</span><span class="heti-spacing"> </span></span>ä¸­æ‰€æœ‰åœ¨æ—¥å¿—ä¸­<strong>æ²¡æœ‰</strong> <span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>æˆ–<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•çš„äº‹åŠ¡<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_k\)</span></span>ï¼Œæ‰§è¡Œ <code>undo(T_k)</code></li>
<li>å¯¹äº<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T\)</span><span class="heti-spacing"> </span></span>ä¸­æ‰€æœ‰åœ¨æ—¥å¿—ä¸­<strong>å­˜åœ¨</strong> <span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>æˆ–<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•çš„äº‹åŠ¡<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_k\)</span></span>ï¼Œæ‰§è¡Œ <code>redo(T_k)</code></li>
</ul>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/11.gif" width="80%/"/>
</div>
</details>
<p>æ³¨æ„ï¼šæˆ‘ä»¬åªéœ€æ£€æŸ¥æ—¥å¿—ä¸­è‡ªä¸Šä¸€ä¸ªæ£€æŸ¥ç‚¹è®°å½•å¼€å§‹çš„éƒ¨åˆ†ï¼Œä»¥æ‰¾å‡ºäº‹åŠ¡é›†<span><span class="heti-spacing"> </span><span class="arithmatex">\(T\)</span></span>ï¼Œå¹¶ç¡®å®š<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T\)</span><span class="heti-spacing"> </span></span>ä¸­æ¯ä¸ªäº‹åŠ¡çš„æ—¥å¿—é‡Œæ˜¯å¦å‡ºç°äº†æäº¤æˆ–ä¸­æ­¢è®°å½•ã€‚</p>
<p>è€ƒè™‘æ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•ä¸­çš„äº‹åŠ¡é›†åˆ<span><span class="heti-spacing"> </span><span class="arithmatex">\(L\)</span></span>ã€‚å¯¹äº<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(L\)</span><span class="heti-spacing"> </span></span>ä¸­çš„æ¯ä¸ªäº‹åŠ¡<span><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span></span>ï¼Œè‹¥è¯¥äº‹åŠ¡æœªæäº¤ï¼Œåˆ™å¯èƒ½éœ€è¦æ’¤é”€è¯¥äº‹åŠ¡åœ¨æ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•ä¹‹å‰çš„æ‰€æœ‰ç›¸å…³æ—¥å¿—è®°å½•ã€‚ç„¶è€Œï¼Œä¸€æ—¦æ£€æŸ¥ç‚¹å®Œæˆï¼Œæ—©äº<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(L\)</span><span class="heti-spacing"> </span></span>ä¸­æ‰€æœ‰<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ start}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•çš„æœ€æ—©æ—¶é—´ç‚¹çš„æ‰€æœ‰å†å²æ—¥å¿—å‡ä¸å†éœ€è¦ã€‚å½“æ•°æ®åº“ç³»ç»Ÿéœ€è¦å›æ”¶è¿™äº›è®°å½•å ç”¨çš„ç©ºé—´æ—¶ï¼Œå¯éšæ—¶æ¸…é™¤æ­¤ç±»æ—¥å¿—ã€‚</p>
<p>è¦æ±‚äº‹åŠ¡åœ¨æ£€æŸ¥ç‚¹è¿‡ç¨‹ä¸­ä¸å¾—å¯¹ç¼“å†²å—æˆ–æ—¥å¿—æ‰§è¡Œä»»ä½•æ›´æ–°æ“ä½œå¯èƒ½ä¸å¤ªåˆç†ï¼Œå› ä¸ºè¿™æ„å‘³ç€æ£€æŸ¥ç‚¹è¿›è¡ŒæœŸé—´å¿…é¡»æš‚åœäº‹åŠ¡å¤„ç†ã€‚å› æ­¤æˆ‘ä»¬å¼•å…¥<strong>æ¨¡ç³Šæ£€æŸ¥ç‚¹</strong>(fuzzy checkpoints)ï¼šå³ä½¿åœ¨ç¼“å†²å—æ­£è¢«å†™å‡ºçš„æƒ…å†µä¸‹ï¼Œäº‹åŠ¡ä»å¯ç»§ç»­æ‰§è¡Œæ›´æ–°æ“ä½œã€‚ä¸‹é¢é©¬ä¸Šä»‹ç»ï¼</p>
<h4 id="fuzzy-checkpointing">Fuzzy Checkpointing<a class="headerlink" href="#fuzzy-checkpointing" title="Permanent link">âš“ï¸</a></h4>
<details class="info">
<summary>å¼•å…¥ï¼šç¨å¾®æ›´å¥½ä¸€ç‚¹çš„æ£€æŸ¥ç‚¹æ–¹æ¡ˆ</summary>
<p>ä¸ä¹‹å‰çš„æ£€æŸ¥ç‚¹æ–¹æ¡ˆç±»ä¼¼ï¼Œä¸åŒä¹‹å¤„åœ¨äº<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>æ— éœ€ç­‰å¾…æ´»è·ƒäº‹åŠ¡æ‰§è¡Œå®Œæ¯•ã€‚ç³»ç»Ÿéœ€è¦è®°å½•çš„æ˜¯æ£€æŸ¥ç‚¹å¼€å§‹æ—¶çš„å†…éƒ¨çŠ¶æ€ï¼š</p>
<ul>
<li>æš‚åœæ‰€æœ‰æ–°äº‹åŠ¡çš„å¯åŠ¨</li>
<li>åœ¨åˆ›å»ºæ£€æŸ¥ç‚¹æ—¶å†»ç»“ç°æœ‰äº‹åŠ¡</li>
</ul>
<p>è¯¥è¿‡ç¨‹éœ€è®°å½•èµ·å§‹æ—¶åˆ»çš„å†…éƒ¨ç³»ç»ŸçŠ¶æ€ï¼Œå› æ­¤è¦åŒ…å«ä¸¤ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šè¿½è¸ªè¿è¡Œä¸­äº‹åŠ¡çš„<strong>æ´»è·ƒäº‹åŠ¡è¡¨</strong>(active transaction table, ATT)ï¼Œä»¥åŠè®°å½•æ‰€æœ‰å°šæœªå†™å…¥ç£ç›˜çš„è¢«ä¿®æ”¹é¡µçš„<strong>è„é¡µè¡¨</strong>(dirty page table, DPT)ã€‚</p>
<p>åœ¨è®¾ç«‹æ£€æŸ¥ç‚¹æ—¶ï¼Œè¿™äº›è¡¨ä¼šæ•è·æ•°æ®åº“çš„å½“å‰çŠ¶æ€ã€‚åœ¨æ‰§è¡Œæ¢å¤æ“ä½œæ—¶ï¼ˆä¾‹å¦‚é‡‡ç”¨<a href="#aries"><span class="heti-skip"><span class="heti-spacing"> </span>ARIES<span class="heti-spacing"> </span></span></a>åè®®<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œè¿™äº›è¡¨æ ¼ä¸ºæ•°æ®åº“æ¢å¤åˆ°å´©æºƒå‰çš„ä¸€è‡´æ€§çŠ¶æ€èµ·åˆ°è¾…åŠ©ä½œç”¨ã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/15.png" width="40%/"/>
</div>
</details>
</details>
<p>ä¸ºé¿å…å‰é¢æåˆ°æ‰§è¡Œä¸­æ–­é—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨åŸæœ‰çš„æ£€æŸ¥ç‚¹æŠ€æœ¯ä¸Šè¿›è¡Œæ”¹è¿›ï¼šå…è®¸åœ¨å†™å…¥æ£€æŸ¥ç‚¹è®°å½•åã€ä½†ä¿®æ”¹è¿‡çš„ç¼“å†²åŒºå—å°šæœªå†™å…¥ç£ç›˜å‰å°±æ¢å¤æ›´æ–°æ“ä½œã€‚è¿™æ ·å¾—åˆ°çš„æ£€æŸ¥ç‚¹ç§°ä¸º<strong>æ¨¡ç³Šæ£€æŸ¥ç‚¹</strong>(fuzzy checkpoints)ã€‚</p>
<p>ç”±äºåªæœ‰åœ¨æ£€æŸ¥ç‚¹è®°å½•å†™å…¥åï¼Œæ•°æ®é¡µæ‰ä¼šè¢«è¾“å‡ºåˆ°ç£ç›˜ä¸­ï¼Œå› æ­¤ç³»ç»Ÿå¯èƒ½åœ¨æ‰€æœ‰é¡µéƒ½å†™å…¥ä¹‹å‰å°±å´©æºƒäº†ã€‚æ‰€ä»¥ç£ç›˜ä¸Šçš„æ£€æŸ¥ç‚¹å¯èƒ½æ˜¯<strong>ä¸å®Œæ•´çš„</strong>ã€‚å¤„ç†ä¸å®Œæ•´æ£€æŸ¥ç‚¹çš„ä¸€ç§æ–¹æ³•å¦‚ä¸‹ï¼šå°†æœ€åä¸€ä¸ªå®Œæˆçš„æ£€æŸ¥ç‚¹è®°å½•åœ¨æ—¥å¿—ä¸­çš„ä½ç½®å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„ä¸€ä¸ªå›ºå®šä½ç½®ï¼Œå³æœ€åæ£€æŸ¥ç‚¹ã€‚ç³»ç»Ÿåœ¨å†™å…¥æ£€æŸ¥ç‚¹è®°å½•æ—¶ä¸ä¼šæ›´æ–°æ­¤ä¿¡æ¯ã€‚ç›¸åï¼Œåœ¨å†™å…¥æ£€æŸ¥ç‚¹è®°å½•ä¹‹å‰ï¼Œå®ƒåˆ›å»ºä¸€ä¸ªåŒ…å«æ‰€æœ‰å·²ä¿®æ”¹ç¼“å­˜å—çš„åˆ—è¡¨ã€‚åªæœ‰å½“åˆ—è¡¨ä¸­çš„æ‰€æœ‰ç¼“å†²åŒºå—éƒ½å·²è¾“å‡ºåˆ°ç£ç›˜åï¼Œæ‰ä¼šæ›´æ–°æœ€åæ£€æŸ¥ç‚¹ä¿¡æ¯ã€‚</p>
<p>å³ä½¿åœ¨æ¨¡ç³Šæ£€æŸ¥ç‚¹ä¸­ï¼Œç¼“å­˜å—åœ¨è¾“å‡ºåˆ°ç£ç›˜æ—¶ä¹Ÿä¸åº”è¯¥è¢«æ›´æ–°ï¼Œå°½ç®¡å…¶ä»–ç¼“å­˜å—å¯ä»¥åŒæ—¶æ›´æ–°ã€‚å¿…é¡»éµå¾ªå†™æå‰æ—¥å¿—åè®®ï¼Œä»¥ç¡®ä¿ä¸å—ç›¸å…³çš„ï¼ˆæ’¤é”€ï¼‰æ—¥å¿—è®°å½•åœ¨å—è¾“å‡ºä¹‹å‰ä½äºç¨³å®šå­˜å‚¨å™¨ä¸­ã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/16.png" width="40%/"/>
</div>
</details>
<h3 id="recovery-after-a-system-crash">Recovery After a System Crash<a class="headerlink" href="#recovery-after-a-system-crash" title="Permanent link">âš“ï¸</a></h3>
<p>æ¢å¤æ“ä½œåœ¨æ•°æ®åº“ç³»ç»Ÿå´©æºƒåé‡å¯æ—¶åˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µè¿›è¡Œï¼š</p>
<ol>
<li>
<p>åœ¨<strong>é‡åšé˜¶æ®µ</strong><span>(redo phase)<span class="heti-spacing"> </span></span>ä¸­ï¼Œç³»ç»Ÿé€šè¿‡ä»æœ€åä¸€ä¸ªæ£€æŸ¥ç‚¹å¼€å§‹æ­£å‘æ‰«ææ—¥å¿—ï¼Œé‡æ–°æ‰§è¡Œæ‰€æœ‰äº‹åŠ¡çš„æ›´æ–°æ“ä½œã€‚è¢«é‡åšçš„æ—¥å¿—è®°å½•åŒ…æ‹¬ï¼šç³»ç»Ÿå´©æºƒå‰å·²å›æ»šçš„äº‹åŠ¡æ—¥å¿—è®°å½•ï¼Œä»¥åŠç³»ç»Ÿå´©æºƒå‘ç”Ÿæ—¶å°šæœªæäº¤çš„äº‹åŠ¡æ—¥å¿—è®°å½•ã€‚</p>
<p>è¯¥é˜¶æ®µè¿˜éœ€ç¡®å®šæ‰€æœ‰åœ¨å´©æºƒæ—¶æœªå®Œæˆçš„äº‹åŠ¡ï¼ˆè¿™äº›äº‹åŠ¡å¿…é¡»è¢«å›æ»š<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚è¿™ç±»æœªå®Œæˆçš„äº‹åŠ¡è¦ä¹ˆåœ¨æ£€æŸ¥ç‚¹æ—¶å¤„äºæ´»åŠ¨çŠ¶æ€ï¼ˆå› æ­¤ä¼šå‡ºç°åœ¨æ£€æŸ¥ç‚¹è®°å½•çš„äº‹åŠ¡åˆ—è¡¨ä¸­<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œè¦ä¹ˆæ˜¯åœ¨ä¹‹åå¯åŠ¨çš„ï¼›æ­¤å¤–ï¼Œå®ƒä»¬çš„æ—¥å¿—ä¸­æ—¢æ²¡æœ‰<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>ä¹Ÿæ²¡æœ‰<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•ã€‚</p>
<p>å…·ä½“æ­¥éª¤å¦‚ä¸‹ï¼š</p>
<ol>
<li>å¾…å›æ»šäº‹åŠ¡åˆ—è¡¨ï¼ˆæˆ–è€…ç§°ä¸º<strong>æ’¤é”€åˆ—è¡¨</strong><span>(<span class="heti-spacing"> </span></span>æ’¤é”€åˆ—è¡¨<span><span class="heti-spacing"> </span>)</span>ï¼‰åˆå§‹åŒ–ä¸º<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;\text{checkpoint } L&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•ä¸­çš„åˆ—è¡¨<span><span class="heti-spacing"> </span><span class="arithmatex">\(L\)</span></span></li>
<li>é‡åˆ°å¸¸è§„æ ¼å¼<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, X_j, V_1, V_2&gt;\)</span><span class="heti-spacing"> </span></span>æˆ–ä»…é‡åšæ ¼å¼<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, X_j, V_2&gt;\)</span><span class="heti-spacing"> </span></span>çš„æ—¥å¿—è®°å½•æ—¶ï¼Œæ‰§è¡Œ<strong>é‡åš</strong>æ“ä½œâ€”â€”å°†å€¼<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(V_2\)</span><span class="heti-spacing"> </span></span>å†™å…¥æ•°æ®é¡¹<span><span class="heti-spacing"> </span><span class="arithmatex">\(X_j\)</span></span></li>
<li>å‘ç°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ start}&gt;\)</span><span class="heti-spacing"> </span></span>æ ¼å¼çš„æ—¥å¿—è®°å½•æ—¶ï¼Œå°†<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>åŠ å…¥åˆ°æ’¤é”€åˆ—è¡¨ä¸­</li>
<li>å‘ç°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>æˆ–<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>æ ¼å¼çš„æ—¥å¿—è®°å½•æ—¶ï¼Œå°†<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>ç§»å‡ºæ’¤é”€åˆ—è¡¨</li>
</ol>
<p>é‡åšé˜¶æ®µç»“æŸæ—¶ï¼Œæ’¤é”€åˆ—è¡¨å†…åŒ…å«äº†æ‰€æœ‰æœªå®Œæˆçš„äº‹åŠ¡æ¸…å•ã€‚</p>
</li>
<li>
<p>åœ¨<strong>æ’¤é”€é˜¶æ®µ</strong>(undo phase)ï¼Œç³»ç»Ÿä¼šå›æ»šæ’¤é”€åˆ—è¡¨ä¸­çš„æ‰€æœ‰äº‹åŠ¡ã€‚é€šè¿‡ä»æœ«å°¾åå‘æ‰«ææ—¥å¿—å®ç°å›æ»šï¼š</p>
<ol>
<li>å½“å‘ç°å±äºæ’¤é”€åˆ—è¡¨ä¸­æŸäº‹åŠ¡çš„æ—¥å¿—è®°å½•æ—¶ï¼Œæ‰§è¡Œ<strong>æ’¤é”€</strong>æ“ä½œï¼ˆå¤„ç†æ–¹å¼ä¸æ•…éšœäº‹åŠ¡å›æ»šæ—¶çš„å¤„ç†ç›¸åŒï¼‰</li>
<li>å½“å‘ç°æ’¤é”€åˆ—è¡¨ä¸­æŸäº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ start}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•æ—¶ï¼šå‘æ—¥å¿—å†™å…¥ä¸€æ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•å¹¶å°†<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>ç§»å‡ºæ’¤é”€åˆ—è¡¨</li>
<li>å½“æ’¤é”€åˆ—è¡¨ä¸ºç©ºæ—¶ï¼Œæ’¤é”€é˜¶æ®µç»ˆæ­¢â€”â€”æ­¤æ—¶ç³»ç»Ÿå·²ä¸ºåˆå§‹å­˜åœ¨äºæ’¤é”€åˆ—è¡¨çš„æ‰€æœ‰äº‹åŠ¡æ‰¾åˆ°å¯¹åº”çš„<span><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ start}&gt;\)</span></span>ã€‚</li>
</ol>
<p>åœ¨æ¢å¤çš„æ’¤é”€é˜¶æ®µç»ˆæ­¢åï¼Œæ­£å¸¸çš„äº‹åŠ¡å¤„ç†å¯ä»¥ç»§ç»­äº†ã€‚</p>
</li>
</ol>
<p>é‡åšé˜¶æ®µä¼šå›æ”¾è‡ªæœ€è¿‘æ£€æŸ¥ç‚¹è®°å½•ä»¥æ¥çš„æ¯ä¸€æ¡æ—¥å¿—è®°å½•ï¼Œå³é‡å¤æ‰§è¡Œæ£€æŸ¥ç‚¹ä¹‹åçš„æ‰€æœ‰æ›´æ–°æ“ä½œï¼Œè¿™äº›æ“ä½œæ—¢åŒ…å«æœªå®Œæˆäº‹åŠ¡çš„æ“ä½œï¼Œä¹ŸåŒ…å«ä¸ºå›æ»šå¤±è´¥äº‹åŠ¡æ‰€æ‰§è¡Œçš„æ“ä½œã€‚ç³»ç»Ÿä¸¥æ ¼æŒ‰ç…§åŸå§‹æ‰§è¡Œé¡ºåºé‡æ–°æ‰§è¡Œè¿™äº›æ“ä½œï¼Œå› æ­¤è¯¥è¿‡ç¨‹è¢«ç§°ä¸º<strong>å†å²é‡æ¼”</strong>(repeating history)ã€‚å°½ç®¡çœ‹ä¼¼å†—ä½™ï¼Œä½†è¿™ç§åšæ³•èƒ½å¤§å¹…ç®€åŒ–æ¢å¤æœºåˆ¶çš„è®¾è®¡ã€‚</p>
<h3 id="buffer-management">Buffer Management<a class="headerlink" href="#buffer-management" title="Permanent link">âš“ï¸</a></h3>
<h4 id="log-record-buffering">Log-Record Buffering<a class="headerlink" href="#log-record-buffering" title="Permanent link">âš“ï¸</a></h4>
<p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬ä¸€ç›´å‡è®¾æ¯æ¡æ—¥å¿—è®°å½•åœ¨åˆ›å»ºæ—¶éƒ½ä¼šè¢«ç«‹å³å†™å…¥åˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­ã€‚è¿™ä¸€å‡è®¾ç»™ç³»ç»Ÿæ‰§è¡Œå¸¦æ¥äº†å¾ˆå¤§çš„å¼€é”€ï¼Œå› ä¸ºç¨³å®šå­˜å‚¨å™¨é€šå¸¸ä»¥æ•°æ®å—ä¸ºå•ä½è¿›è¡Œå†™å…¥ï¼Œè€Œå¤§å¤šæ•°æƒ…å†µä¸‹å•æ¡æ—¥å¿—è®°å½•è¿œå°äºä¸€ä¸ªæ•°æ®å—ã€‚å› æ­¤æ¯æ¡æ—¥å¿—è®°å½•çš„è¾“å‡ºå®é™…ä¸Šä¼šå¼•å‘ç‰©ç†å±‚é¢ä¸Šæ›´å¤§é‡çš„å†™æ“ä½œã€‚</p>
<p>å› æ­¤ï¼Œæˆ‘ä»¬å¸Œæœ›å®ç°å¤šæ¡æ—¥å¿—è®°å½•çš„æ‰¹é‡è¾“å‡ºã€‚ä¸ºæ­¤ç³»ç»Ÿå…ˆå°†æ—¥å¿—è®°å½•æš‚å­˜äºä¸»å­˜çš„æ—¥å¿—ç¼“å†²åŒºä¸­ï¼Œå¾…ç§¯æ”’åˆ°ä¸€å®šæ•°é‡åï¼Œé€šè¿‡å•æ¬¡å†™æ“ä½œæ‰¹é‡æäº¤è‡³ç¨³å®šå­˜å‚¨å™¨ä¸­ã€‚è¿™ä¸ªè¿‡ç¨‹å¿…é¡»ç¡®ä¿ç¨³å®šå­˜å‚¨å™¨ä¸­çš„æ—¥å¿—é¡ºåºä¸å®ƒä»¬è¢«å†™å…¥ç¼“å†²åŒºçš„é¡ºåºå®Œå…¨ä¸€è‡´ã€‚</p>
<p>é‡‡ç”¨<strong>æ—¥å¿—ç¼“å­˜</strong>æœºåˆ¶æ„å‘³ç€æŸäº›è®°å½•å¯èƒ½åœ¨æ˜“å¤±æ€§ä¸»å­˜ä¸­é©»ç•™è¾ƒé•¿æ—¶é—´æ‰ä¼šè¢«å†™åˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­ã€‚è‹¥æ­¤æ—¶ç³»ç»Ÿå´©æºƒï¼Œè¿™äº›æ—¥å¿—è®°å½•å°†ä¼šä¸¢å¤±ã€‚å› æ­¤ï¼Œè¿™å°±è¦æ±‚æˆ‘ä»¬åœ¨æ¢å¤æŠ€æœ¯ä¸Šé™„åŠ ä¸€äº›æ–°çš„çº¦æŸæ¡ä»¶æ¥ä¿è¯äº‹åŠ¡çš„åŸå­æ€§ï¼š</p>
<ul>
<li>äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>åªæœ‰åœ¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•æˆåŠŸå†™å…¥åˆ°ç¨³å®šå­˜å‚¨å™¨åæ‰ä¼šè¿›å…¥æäº¤çŠ¶æ€  </li>
<li>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i \text{ commit}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•è¢«è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨ä¹‹å‰ï¼Œæ‰€æœ‰ä¸äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>ç›¸å…³çš„æ—¥å¿—è®°å½•å¿…é¡»å·²ç»è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­</li>
<li>åœ¨ä¸»å­˜ä¸­çš„æ•°æ®å—è¾“å‡ºåˆ°æ•°æ®åº“ä¹‹å‰ï¼Œä¸è¯¥æ•°æ®å—ä¸­æ•°æ®ç›¸å…³çš„æ‰€æœ‰æ—¥å¿—è®°å½•å¿…é¡»å·²ç»è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­â€”â€”è¿™ä¸€è§„åˆ™è¢«ç§°ä¸º<strong>å†™æå‰æ—¥å¿—</strong><span>(write-ahead logging, WAL)<span class="heti-spacing"> </span></span>è§„åˆ™<ul>
<li>çœæµç‰ˆï¼š<strong>å…ˆå†™æ—¥å¿—ï¼Œå†å†™æ•°æ®</strong></li>
</ul>
</li>
</ul>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/8.gif" width="80%/"/>
</div>
</details>
<p>è¿™ä¸‰æ¡è§„å®šæ˜ç¡®äº†æŸäº›æ—¥å¿—è®°å½•<strong>å¿…é¡»</strong>è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨çš„æƒ…å½¢ã€‚<strong>æå‰</strong>è¾“å‡ºæ—¥å¿—è®°å½•ä¸ä¼šå¼•å‘é—®é¢˜ã€‚å› æ­¤ï¼Œç³»ç»Ÿè®¤ä¸ºæœ‰å¿…è¦å°†æ—¥å¿—è®°å½•è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨æ—¶ï¼Œå¦‚æœä¸»å­˜ä¸­æœ‰è¶³å¤Ÿçš„æ—¥å¿—è®°å½•æ¥å¡«æ»¡ä¸€ä¸ªå—ï¼Œå®ƒå°±ä¼šè¾“å‡ºæ•´å—æ—¥å¿—è®°å½•ï¼›è‹¥ä¸è¶³ä»¥å¡«æ»¡å—ï¼Œåˆ™å°†æ‰€æœ‰ä¸»å­˜ä¸­çš„æ—¥å¿—è®°å½•åˆå¹¶ä¸ºéƒ¨åˆ†å¡«å……çš„å—å¹¶è¾“å‡ºè‡³ç¨³å®šå­˜å‚¨å™¨ä¸­ã€‚</p>
<p>å°†ç¼“å†²çš„æ—¥å¿—å†™å…¥ç£ç›˜çš„æ“ä½œæœ‰æ—¶è¢«ç§°ä¸º<strong>æ—¥å¿—å¼ºåˆ¶</strong>(log force)ã€‚</p>
<h4 id="buffer-pool-management-policies">Buffer Pool Management Policies<a class="headerlink" href="#buffer-pool-management-policies" title="Permanent link">âš“ï¸</a></h4>
<p><span>DBMS<span class="heti-spacing"> </span></span>éœ€è¦ä¿è¯ï¼š</p>
<ul>
<li>ä¸€æ—¦<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>æäº¤äº†äº‹åŠ¡ï¼Œè¯¥äº‹åŠ¡çš„æ”¹å˜ä¸€å®šè¦æŒä¹…å­˜åœ¨</li>
<li>å¦‚æœäº‹åŠ¡è¢«ä¸­æ­¢ï¼Œé‚£ä¹ˆè¯¥äº‹åŠ¡çš„ä»»ä½•æ”¹å˜éƒ½ä¸å¾—å­˜åœ¨äºæ•°æ®åº“ä¸­</li>
</ul>
<p>ä¸ºæ­¤ï¼Œ<span>DBMS<span class="heti-spacing"> </span></span>ä¼šä»ä»¥ä¸‹ä¸¤ä¸ªè§’åº¦è€ƒè™‘ç¼“å­˜æ± çš„ç®¡ç†ç­–ç•¥ï¼š</p>
<ul>
<li><strong>çªƒå–ç­–ç•¥</strong><span>(steal policy)<span class="heti-spacing"> </span></span>è§„å®šäº†<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>æ˜¯å¦å…è®¸æœªæäº¤çš„äº‹åŠ¡è¦†ç›–éæ˜“å¤±æ€§å­˜å‚¨å™¨ï¼ˆç£ç›˜ï¼‰ä¸­å¯¹è±¡çš„æœ€æ–°å·²æäº¤å€¼ã€‚<ul>
<li>åˆ†ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>STEAL<span class="heti-spacing"> </span></span>å’Œ<span><span class="heti-spacing"> </span>NO-STEAL</span></li>
</ul>
</li>
<li><strong>å¼ºåˆ¶ç­–ç•¥</strong><span>(force policy)<span class="heti-spacing"> </span></span>è§„å®šäº†<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>æ˜¯å¦è¦æ±‚äº‹åŠ¡åœ¨å…è®¸æäº¤ä¹‹å‰ï¼Œå¿…é¡»å°†æ‰€æœ‰æ›´æ–°å†…å®¹å†™å…¥éæ˜“å¤±æ€§å­˜å‚¨å™¨ï¼ˆç£ç›˜ï¼‰ä¸­ã€‚<ul>
<li>åˆ†ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>FORCE<span class="heti-spacing"> </span></span>å’Œ<span><span class="heti-spacing"> </span>NO-FORCE</span></li>
</ul>
</li>
</ul>
<p>æœ€ç®€å•çš„ç¼“å­˜æ± ç®¡ç†ç­–ç•¥ç§°ä¸º <strong>NO-STEAL + FORCE</strong>ã€‚åœ¨è¯¥ç­–ç•¥ä¸‹ï¼Œ</p>
<ul>
<li>DBMS <strong>æ— éœ€æ’¤é”€</strong>å·²ä¸­æ­¢äº‹åŠ¡çš„æ›´æ”¹ï¼Œå› ä¸ºè¿™äº›æ›´æ”¹å¹¶æœªå†™å…¥ç£ç›˜</li>
<li>åŒæ—¶å®ƒä¹Ÿ<strong>æ— éœ€é‡åš</strong>å·²æäº¤äº‹åŠ¡çš„æ›´æ”¹ï¼Œå› ä¸ºæ‰€æœ‰å˜æ›´éƒ½ç¡®ä¿åœ¨æäº¤æ—¶å†™å…¥ç£ç›˜</li>
</ul>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/5.png" width="80%/"/>
</div>
</details>
<p>è¯¥ç­–ç•¥çš„å±€é™åœ¨äºï¼šäº‹åŠ¡æ‰€éœ€ä¿®æ”¹çš„æ‰€æœ‰æ•°æ®å¿…é¡»èƒ½å¤Ÿå®Œå…¨è¢«å†…å­˜å®¹çº³ã€‚è‹¥æ— æ³•æ»¡è¶³æ­¤æ¡ä»¶ï¼Œåˆ™è¯¥äº‹åŠ¡å°†æ— æ³•æ‰§è¡Œï¼Œå› ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>ä¸å…è®¸åœ¨äº‹åŠ¡æäº¤å‰å°†è„é¡µå†™å…¥ç£ç›˜ã€‚æ­¤å¤–ï¼Œæ›´é¢‘ç¹çš„å†™æ“ä½œä¹Ÿå¯èƒ½åŠ é€Ÿ<span class="heti-skip"><span class="heti-spacing"> </span>SSD<span class="heti-spacing"> </span></span>ç­‰å­˜å‚¨è®¾å¤‡çš„ç£¨æŸã€‚</p>
<details class="info">
<summary>è¡¥å……çŸ¥è¯†ï¼šå½±å­é¡µ</summary>
<p><strong>å½±å­é¡µ</strong><span>(shadow paging)<span class="heti-spacing"> </span></span>æŠ€æœ¯æ˜¯å¯¹<span class="heti-skip"><span class="heti-spacing"> </span>NO-STEAL + FORCE<span class="heti-spacing"> </span></span>æ–¹æ¡ˆçš„ä¸€ç§æ”¹è¿›ï¼š<span>DBMS<span class="heti-spacing"> </span></span>åœ¨å†™å…¥æ—¶å¤åˆ¶é¡µï¼Œå› è€Œå¾—åˆ°ä¸¤ä¸ªç‹¬ç«‹çš„æ•°æ®åº“ç‰ˆæœ¬ï¼š</p>
<ul>
<li>ä¸»ç‰ˆæœ¬<span><span class="heti-spacing"> </span>(master)</span>ï¼šä»…åŒ…å«æ¥è‡ªæäº¤äº‹åŠ¡çš„æ”¹å˜</li>
<li>å½±å­ç‰ˆæœ¬<span><span class="heti-spacing"> </span>(shadow)</span>ï¼šè¿˜åŒ…å«æœªæäº¤äº‹åŠ¡æ”¹å˜çš„ä¸´æ—¶æ•°æ®åº“</li>
</ul>
<p>æ›´æ–°ä»…åœ¨å½±å­å‰¯æœ¬ä¸­è¿›è¡Œã€‚å½“äº‹åŠ¡æäº¤æ—¶ï¼Œå½±å­å‰¯æœ¬ä¼šä»¥åŸå­æ–¹å¼åˆ‡æ¢æˆä¸ºæ–°çš„ä¸»ç‰ˆæœ¬ã€‚æ—§çš„ä¸»ç‰ˆæœ¬æœ€ç»ˆä¼šè¢«åƒåœ¾å›æ”¶æœºåˆ¶æ¸…ç†ã€‚</p>
<p>å…·ä½“å®ç°ä¸ºï¼š</p>
<ul>
<li><span>DBMS<span class="heti-spacing"> </span></span>å°†æ•°æ®åº“çš„é¡µç»„ç»‡æˆæ ‘çŠ¶ç»“æ„ï¼Œå…¶ä¸­æ ¹èŠ‚ç‚¹ä¸ºå•ä¸ªç£ç›˜é¡µ</li>
<li>è¯¥æ ‘å­˜åœ¨ä¸¤ä¸ªå‰¯æœ¬ï¼šä¸»ç‰ˆæœ¬ä¸å½±å­ç‰ˆæœ¬ï¼›æ ¹èŠ‚ç‚¹å§‹ç»ˆæŒ‡å‘å½“å‰çš„ä¸»ç‰ˆæœ¬</li>
<li>æ‰§è¡Œäº‹åŠ¡æ—¶ï¼Œåªæ”¹å˜å½±å­ç‰ˆæœ¬çš„å†…å®¹</li>
<li>å½“ä¸€ä¸ªäº‹åŠ¡å‡†å¤‡æäº¤æ—¶ï¼Œ<span>DBMS<span class="heti-spacing"> </span></span>å¿…é¡»åº”ç”¨å…¶æ›´æ–°ï¼›ä¸ºæ­¤åªéœ€è¦†å†™æ ¹èŠ‚ç‚¹ï¼Œä½¿å…¶æŒ‡å‘æ•°æ®åº“çš„å½±å­ç‰ˆæœ¬ï¼Œä»è€Œå®ç°ä¸»ç‰ˆæœ¬ä¸å½±å­ç‰ˆæœ¬çš„åˆ‡æ¢</li>
<li>åœ¨è¦†å†™æ ¹èŠ‚ç‚¹ä¹‹å‰ï¼Œè¯¥äº‹åŠ¡çš„æ‰€æœ‰æ›´æ–°éƒ½ä¸å±äºç£ç›˜é©»ç•™æ•°æ®åº“çš„ç»„æˆéƒ¨åˆ†ï¼›è€Œä¸€æ—¦å®Œæˆæ ¹èŠ‚ç‚¹è¦†å†™ï¼Œè¯¥äº‹åŠ¡çš„å…¨éƒ¨æ›´æ–°ä¾¿æˆä¸ºç£ç›˜é©»ç•™æ•°æ®åº“çš„ä¸€éƒ¨åˆ†</li>
<li>è¿™ç§å¯¹æ ¹èŠ‚ç‚¹çš„è¦†å†™æ“ä½œèƒ½ä»¥åŸå­æ–¹å¼å®Œæˆ</li>
</ul>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/6.gif" width="80%/"/>
</div>
</details>
<p>å¯¹åº”çš„æ¢å¤æªæ–½ä¸ºï¼š</p>
<ul>
<li>æ’¤é”€ï¼šç§»é™¤å½±å­é¡µï¼Œä¿ç•™ä¸»ç‰ˆæœ¬å’Œæ•°æ®åº“æ ¹æŒ‡é’ˆ</li>
<li>é‡åšï¼šæ— éœ€é‡åš</li>
</ul>
<div class="admonition bug">
<p class="admonition-title">ç¼ºç‚¹</p>
<ul>
<li>å¤åˆ¶æ•´ä¸ªé¡µè¡¨çš„å¼€é”€å¾ˆå¤§ã€‚<ul>
<li>å®é™…ä¸Šï¼Œåªéœ€å¤åˆ¶æ ‘ä¸­é€šå‘æ›´æ–°å¶èŠ‚ç‚¹çš„è·¯å¾„ï¼Œæ²¡æœ‰å¿…è¦å¤åˆ¶æ•´æ£µæ ‘ã€‚</li>
</ul>
</li>
<li>å½±å­é¡µçš„æäº¤å¼€é”€ä¹Ÿå¾ˆé«˜ï¼šæäº¤æ“ä½œéœ€è¦åˆ·æ–°é¡µè¡¨ã€æ ¹é¡µé¢åŠæ¯ä¸ªè¢«ä¿®æ”¹çš„é¡µé¢ã€‚<ul>
<li>è¿™ç§æ–¹æ³•ä¼šå¯¼è‡´å¤§é‡éšæœºéè¿ç»­é¡µé¢çš„å†™å…¥æ“ä½œï¼ŒåŒæ—¶å¼•å‘æ•°æ®ç¢ç‰‡åŒ–é—®é¢˜ï¼Œå› ä¸ºæ½œåœ¨å…³è”çš„æ•°æ®å¯èƒ½åˆ†æ•£åœ¨ä¸åŒé¡µé¢é—´ã€‚</li>
<li>è¯¥æœºåˆ¶è¿˜éœ€åƒåœ¾å›æ”¶åŠŸèƒ½ï¼šå½“æ•°æ®æ›´æ–°æ—¶ï¼ŒæŒ‡å‘æ—§é¡µé¢çš„å¼•ç”¨ä¼šå¤±æ•ˆï¼Œå¿…é¡»æ›´æ–°è¿™äº›å¼•ç”¨ä»¥ç¡®ä¿æ²¡æœ‰é¡µé¢æŒ‡å‘æœªæ›´æ–°çš„é™ˆæ—§æ•°æ®</li>
</ul>
</li>
<li>ä»…æ”¯æŒå•æ¬¡å•å†™äº‹åŠ¡æˆ–æ‰¹é‡äº‹åŠ¡å¤„ç†ã€‚</li>
</ul>
</div>
</details>
<p>å‰é¢ä»‹ç»åˆ°çš„<span class="heti-skip"><span class="heti-spacing"> </span>WAL<span class="heti-spacing"> </span></span>é‡‡ç”¨çš„ç¼“å­˜æ± ç­–ç•¥æ˜¯<span><span class="heti-spacing"> </span>STEAL + NO-FORCE</span>ã€‚</p>
<p>ä¸‹å›¾ä»çªƒå–å’Œå¼ºåˆ¶è¿™ä¸¤ä¸ªç»´åº¦æ¥æ€»ç»“è¿™äº›ç­–ç•¥çš„ç‰¹ç‚¹ï¼š</p>
<div style="text-align: center">
<img src="images/lec15/7.png" width="90%/"/>
</div>
<div style="text-align: center">
<img src="images/lec15/10.png" width="80%/"/>
</div>
<p>å®é™…ä¸Šï¼Œå‡ ä¹æ‰€æœ‰çš„<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>é‡‡ç”¨çš„éƒ½æ˜¯<span class="heti-skip"><span class="heti-spacing"> </span>STEAL + NO-FORCE<span class="heti-spacing"> </span></span>ç­–ç•¥ã€‚</p>
<hr/>
<p>å½“éœ€è¦å°†å—<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_1\)</span><span class="heti-spacing"> </span></span>è¾“å‡ºåˆ°ç£ç›˜æ—¶ï¼Œæ‰€æœ‰æ¶‰åŠ<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_1\)</span><span class="heti-spacing"> </span></span>ä¸­æ•°æ®çš„æ—¥å¿—è®°å½•å¿…é¡»åœ¨<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_1\)</span><span class="heti-spacing"> </span></span>è¢«è¾“å‡ºå‰å†™å…¥ç¨³å®šå­˜å‚¨å™¨ä¸­ã€‚å…³é”®æ˜¯åœ¨å—è¾“å‡ºè¿‡ç¨‹ä¸­ï¼Œä¸èƒ½å­˜åœ¨å¯¹è¯¥å—çš„å†™æ“ä½œï¼Œå¦åˆ™å¯èƒ½è¿åå†™æå‰æ—¥å¿—è§„åˆ™ã€‚é€šè¿‡ä»¥ä¸‹ç‰¹æ®Šé”æœºåˆ¶å¯ç¡®ä¿æ— è¿›è¡Œä¸­çš„å†™æ“ä½œï¼š</p>
<ul>
<li>äº‹åŠ¡æ‰§è¡Œæ•°æ®é¡¹å†™å…¥å‰ï¼Œå¿…é¡»è·å–è¯¥æ•°æ®é¡¹æ‰€åœ¨å—çš„<strong>ç‹¬å é”</strong>ï¼Œæ›´æ–°å®Œæˆåç«‹å³é‡Šæ”¾é”ã€‚</li>
<li>å—è¾“å‡ºæ—¶æŒ‰å¦‚ä¸‹é¡ºåºæ“ä½œï¼š<ul>
<li>è·å–å—çš„ç‹¬å é”ï¼Œä»¥ç¡®ä¿æ²¡æœ‰äº‹åŠ¡æ­£åœ¨å†™å…¥è¯¥å—</li>
<li>å°†æ‰€æœ‰å…³è”<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_1\)</span><span class="heti-spacing"> </span></span>çš„æ—¥å¿—è®°å½•è¾“å‡ºè‡³ç¨³å®šå­˜å‚¨å™¨ä¸­</li>
<li>å°†<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_1\)</span><span class="heti-spacing"> </span></span>å—è¾“å‡ºåˆ°ç£ç›˜ä¸­</li>
<li>å®Œæˆå—è¾“å‡ºåç«‹å³é‡Šæ”¾é”</li>
</ul>
</li>
</ul>
<p>ç¼“å­˜å—çš„é”ä¸äº‹åŠ¡å¹¶å‘æ§åˆ¶çš„é”æ²¡æœ‰å…³ç³»ï¼Œæ‰€ä»¥é€šè¿‡éä¸¤é˜¶æ®µæ–¹å¼æ¥é‡Šæ”¾è¿™äº›é”ä¸ä¼šå½±å“äº‹åŠ¡çš„å¯ä¸²è¡Œæ€§ã€‚è¿™ç§çŸ­æœŸæŒæœ‰çš„é”é€šå¸¸ç§°ä¸º<strong>é”å­˜</strong>(latches)ã€‚</p>
<p>åœ¨æ£€æŸ¥ç‚¹è¿›è¡ŒæœŸé—´ï¼Œç¼“å­˜å—çš„é”è¿˜å¯ç”¨äºç¡®ä¿ç¼“å­˜å—ä¸è¢«æ›´æ–°ä¸”ä¸ç”Ÿæˆæ—¥å¿—è®°å½•ã€‚è¿™ä¸€é™åˆ¶å¯é€šè¿‡åœ¨æ‰§è¡Œæ£€æŸ¥ç‚¹æ“ä½œå‰ï¼Œè·å–æ‰€æœ‰ç¼“å­˜å—çš„ç‹¬å é”åŠæ—¥å¿—çš„ç‹¬å é”æ¥å®ç°ã€‚è¿™äº›é”å¯åœ¨æ£€æŸ¥ç‚¹æ“ä½œå®Œæˆåç«‹å³é‡Šæ”¾ã€‚</p>
<p>æ•°æ®åº“ç³»ç»Ÿé€šå¸¸è®¾æœ‰ä¸€ä¸ªæŒç»­å¾ªç¯éå†ç¼“å­˜å—çš„è¿‡ç¨‹ï¼Œå°†å·²ä¿®æ”¹çš„ç¼“å­˜å—å†™å›ç£ç›˜ã€‚åœ¨è¾“å‡ºè¿™äº›å—æ—¶ï¼Œå¿…é¡»éµå¾ªä¸Šè¿°é”åè®®ã€‚é€šè¿‡æŒç»­è¾“å‡ºè¢«ä¿®æ”¹çš„å—ï¼Œç¼“å†²åŒºå†…çš„<strong>è„å—</strong>ï¼ˆå³åœ¨ç¼“å†²åŒºä¸­è¢«ä¿®æ”¹ä½†å°šæœªå†™å›ç£ç›˜çš„å—ï¼‰çš„æ•°é‡å¾—ä»¥æœ€å°åŒ–ã€‚å¦‚æ­¤ä¸€æ¥ï¼Œæ£€æŸ¥ç‚¹æœŸé—´éœ€è¦è¾“å‡ºçš„å—æ•°é‡ä¹Ÿç›¸åº”å‡å°‘ï¼›æ­¤å¤–ï¼Œå½“éœ€è¦ä»ç¼“å†²åŒºä¸­é©±é€ä¸€ä¸ªå—æ—¶ï¼Œå¾ˆå¯èƒ½ä¼šæœ‰ä¸€ä¸ªéè„å—å¯ä¾›é©±é€ï¼Œè¿™ä½¿å¾—è¾“å…¥å¾—ä»¥ç«‹å³è¿›è¡Œï¼Œæ— éœ€ç­‰å¾…è¾“å‡ºå®Œæˆã€‚</p>
<h4 id="operating-system-role-in-buffer-management">Operating System Role in Buffer Management<a class="headerlink" href="#operating-system-role-in-buffer-management" title="Permanent link">âš“ï¸</a></h4>
<p>å¯é€šè¿‡ä»¥ä¸‹ä¸¤ç§æ–¹æ³•ä¹‹ä¸€æ¥ç®¡ç†æ•°æ®åº“çš„ç¼“å†²åŒºï¼š</p>
<ul>
<li>
<p>æ•°æ®åº“ç³»ç»Ÿé¢„ç•™éƒ¨åˆ†ä¸»å­˜ä½œä¸ºå…¶è‡ªè¡Œç®¡ç†çš„ç¼“å†²åŒºï¼ˆè€Œéç”±æ“ä½œç³»ç»Ÿç®¡ç†<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</p>
<ul>
<li>è¿™ç§æ–¹æ³•çš„ç¼ºç‚¹åœ¨äºé™åˆ¶äº†ä¸»å­˜ä½¿ç”¨çš„çµæ´»æ€§ã€‚å› ä¸ºç¼“å†²åŒºå¿…é¡»ä¿æŒè¶³å¤Ÿå°ï¼Œä»¥ç¡®ä¿å…¶ä»–åº”ç”¨ç¨‹åºæœ‰è¶³å¤Ÿçš„ä¸»å­˜æ¥æ»¡è¶³è‡ªèº«éœ€æ±‚ã€‚ç„¶è€Œå³ä½¿å…¶ä»–åº”ç”¨ç¨‹åºæœªè¿è¡Œï¼Œæ•°æ®åº“ä¹Ÿæ— æ³•åˆ©ç”¨å…¨éƒ¨å¯ç”¨çš„å†…å­˜ã€‚åŒç†ï¼Œéæ•°æ®åº“åº”ç”¨ç¨‹åºä¹Ÿä¸èƒ½ä½¿ç”¨ä¸ºæ•°æ®åº“ç¼“å†²åŒºä¿ç•™çš„é‚£éƒ¨åˆ†ä¸»å­˜ï¼ˆå³ä¾¿è¯¥ç¼“å†²åŒºçš„æŸäº›é¡µé¢å½“å‰æœªè¢«ä½¿ç”¨<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</li>
</ul>
</li>
<li>
<p>å½“æ•°æ®åº“ç³»ç»Ÿåœ¨æ“ä½œç³»ç»Ÿæä¾›çš„<strong>è™šæ‹Ÿå†…å­˜</strong>ä¸­å®ç°å…¶ç¼“å†²åŒºæ—¶ï¼Œç”±äºæ“ä½œç³»ç»ŸçŸ¥æ™“ç³»ç»Ÿä¸­æ‰€æœ‰è¿›ç¨‹çš„å†…å­˜éœ€æ±‚ï¼Œç†è®ºä¸Šåº”ç”±å®ƒå†³å®šå“ªäº›ç¼“å­˜å—å¿…é¡»å¼ºåˆ¶å†™å…¥ç£ç›˜åŠæ‰§è¡Œæ—¶æœºã€‚ä½†ä¸ºç¡®ä¿å†™æå‰æ—¥å¿—çš„è¦æ±‚ï¼Œæ“ä½œç³»ç»Ÿä¸åº”ç›´æ¥å†™å‡ºæ•°æ®åº“ç¼“å†²é¡µï¼Œè€Œåº”è¯·æ±‚æ•°æ®åº“ç³»ç»Ÿæ‰§è¡Œå¼ºåˆ¶è¾“å‡ºæ“ä½œã€‚æ­¤æ—¶æ•°æ®åº“ç³»ç»Ÿä¼šå…ˆå°†ç›¸å…³æ—¥å¿—è®°å½•å†™å…¥åˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­ï¼Œå†å°†ç¼“å­˜å—å¼ºåˆ¶è¾“å‡ºåˆ°æ•°æ®åº“ä¸­ã€‚</p>
<ul>
<li>é—æ†¾çš„æ˜¯ï¼Œå‡ ä¹æ‰€æœ‰å½“ä»£çš„æ“ä½œç³»ç»Ÿéƒ½å®Œå…¨æŒæ§ç€è™šæ‹Ÿå†…å­˜çš„ç®¡ç†æƒã€‚å®ƒä»¬ä¼šåœ¨ç£ç›˜ä¸Šé¢„ç•™<strong>äº¤æ¢ç©ºé—´</strong><span>(swap space)<span class="heti-spacing"> </span></span>æ¥å­˜å‚¨å½“å‰ä¸åœ¨ä¸»å­˜çš„è™šæ‹Ÿå†…å­˜é¡µã€‚è‹¥æ“ä½œç³»ç»Ÿå†³å®šå†™å‡º<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_x\)</span><span class="heti-spacing"> </span></span>å—æ—¶ï¼Œè¯¥å—åªä¼šè¢«è¾“å‡ºè‡³ç£ç›˜çš„äº¤æ¢ç©ºé—´â€”â€”è¿™ä½¿å¾—æ•°æ®åº“ç³»ç»Ÿæ— æ³•å¹²é¢„ç¼“å­˜å—çš„è¾“å‡ºè¿‡ç¨‹ã€‚</li>
<li>å› æ­¤ï¼Œè‹¥æ•°æ®åº“ç¼“å†²åŒºä½äºè™šæ‹Ÿå†…å­˜ä¸­ï¼Œåˆ™æ•°æ®åº“æ–‡ä»¶ä¸è™šæ‹Ÿå†…å­˜ç¼“å†²åŒºé—´çš„æ•°æ®ä¼ è¾“å¿…é¡»ç”±æ•°æ®åº“ç³»ç»Ÿç®¡ç†ï¼Œè¯¥ç³»ç»Ÿå¼ºåˆ¶æ‰§è¡Œå†™æå‰æ—¥å¿—è¦æ±‚ã€‚</li>
<li>è¿™ç§æ–¹å¼å¯èƒ½å¯¼è‡´æ•°æ®é¢å¤–å†™å…¥åˆ°ç£ç›˜ä¸­ã€‚å¦‚æœæ“ä½œç³»ç»Ÿå°†åŒºå—<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_x\)</span><span class="heti-spacing"> </span></span>å†™å‡ºï¼Œè¯¥åŒºå—å¹¶ä¸ä¼šç›´æ¥è¾“å‡ºè‡³æ•°æ®åº“æ–‡ä»¶ä¸­ï¼Œè€Œæ˜¯è¢«å†™å…¥æ“ä½œç³»ç»Ÿè™šæ‹Ÿå†…å­˜çš„äº¤æ¢ç©ºé—´ã€‚å½“æ•°æ®åº“ç³»ç»Ÿéœ€è¦å†™å‡º<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_x\)</span><span class="heti-spacing"> </span></span>æ—¶ï¼Œæ“ä½œç³»ç»Ÿå¯èƒ½éœ€å…ˆä»äº¤æ¢ç©ºé—´è¯»å…¥<span><span class="heti-spacing"> </span><span class="arithmatex">\(B_x\)</span></span>ã€‚å¦‚æ­¤ä¸€æ¥ï¼ŒåŸæœ¬åªéœ€ä¸€æ¬¡çš„<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(B_x\)</span><span class="heti-spacing"> </span></span>è¾“å‡ºæ“ä½œï¼Œå°±å¯èƒ½æ¼”å˜ä¸ºä¸¤æ¬¡è¾“å‡ºï¼Œå¤–åŠ ä¸€æ¬¡é¢å¤–çš„è¾“å…¥æ“ä½œã€‚</li>
</ul>
</li>
</ul>
<p>è™½ç„¶è¿™ä¸¤ç§æ–¹æ¡ˆéƒ½å­˜åœ¨ç¼ºé™·ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯å¾—é€‰æ‹©å…¶ä¸­ä¸€ç§æ¥å®ç°ã€‚</p>
<h2 id="early-lock-release-and-logical-undo-operations">Early Lock Release and Logical Undo Operations<a class="headerlink" href="#early-lock-release-and-logical-undo-operations" title="Permanent link">âš“ï¸</a></h2>
<p>åœ¨å¤„ç†äº‹åŠ¡è¿‡ç¨‹ä¸­ï¼Œä½¿ç”¨çš„ä»»ä½•ç´¢å¼•å‡å¯è§†ä¸ºæ™®é€šæ•°æ®ï¼Œä½†ä¸ºäº†æé«˜å¹¶å‘æ€§ï¼Œå¯é‡‡ç”¨<span class="heti-skip"><span class="heti-spacing"> </span>B+<span class="heti-spacing"> </span></span>æ ‘å¹¶å‘æ§åˆ¶ç®—æ³•ï¼Œä»¥éä¸¤é˜¶æ®µæ–¹å¼å®ç°é”çš„æå‰é‡Šæ”¾ã€‚è¿™ä¸€æ€æƒ³ä¹Ÿå¯ä»¥æ‰©å±•è‡³æ¢å¤ç®—æ³•ä¸­ï¼Œä¸‹é¢å°±æ¥è¯¦ç»†ä»‹ç»å…·ä½“å®ç°ã€‚</p>
<h3 id="logical-operations">Logical Operations<a class="headerlink" href="#logical-operations" title="Permanent link">âš“ï¸</a></h3>
<p><strong>æ’</strong>å…¥å’Œ<strong>åˆ é™¤</strong>æ“ä½œæ˜¯ä¸€ç±»éœ€è¦é€»è¾‘å›æ»šæ“ä½œçš„å…¸å‹ä»£è¡¨ï¼Œå› ä¸ºå®ƒä»¬ä¼šæå‰é‡Šæ”¾é”â€”â€”æˆ‘ä»¬å°†è¿™ç±»æ“ä½œç§°ä¸º<strong>é€»è¾‘æ“ä½œ</strong>(logical operations)ã€‚è¿™ç§æå‰é‡Šæ”¾é”çš„è¡Œä¸ºä¸ä»…å¯¹ç´¢å¼•è‡³å…³é‡è¦ï¼Œå¯¹äºå…¶ä»–è¢«é¢‘ç¹è®¿é—®å’Œæ›´æ–°çš„ç³»ç»Ÿæ•°æ®ç»“æ„ä¹ŸåŒæ ·é‡è¦ã€‚è‹¥åœ¨æ­¤ç±»æ•°æ®ç»“æ„ä¸Šæ‰§è¡Œæ“ä½œåæœªåŠæ—¶é‡Šæ”¾é”ï¼Œäº‹åŠ¡å°†è¶‹å‘äºä¸²è¡ŒåŒ–æ‰§è¡Œï¼Œè¿›è€Œå½±å“ç³»ç»Ÿæ€§èƒ½ã€‚</p>
<p>æ“ä½œåœ¨æ‰§è¡Œæ—¶è·å–<strong>ä½çº§é”</strong>(lower-level locks)ï¼Œä½†åœ¨å®Œæˆæ—¶é‡Šæ”¾å®ƒä»¬ï¼›ç„¶è€Œï¼Œç›¸åº”çš„äº‹åŠ¡å¿…é¡»ä»¥ä¸¤é˜¶æ®µæ–¹å¼ä¿ç•™<strong>é«˜çº§é”</strong>(high-level locks)ï¼Œä»¥é˜²æ­¢å¹¶å‘äº‹åŠ¡æ‰§è¡Œå†²çªæ“ä½œã€‚</p>
<p>è¿™ç§æ—©æœŸé”é‡Šæ”¾å…è®¸åœ¨ç›¸åŒé¡µä¸Šæ‰§è¡Œç¬¬äºŒä¸ªæ’å…¥ã€‚ç„¶è€Œï¼Œæ¯ä¸ªäº‹åŠ¡å¿…é¡»è·å–è¦æ’å…¥æˆ–åˆ é™¤çš„é”®å€¼çš„é”ï¼Œå¹¶ä»¥ä¸¤é˜¶æ®µæ–¹å¼ä¿ç•™å®ƒï¼Œä»¥é˜²æ­¢å¹¶å‘äº‹åŠ¡åœ¨ç›¸åŒçš„é”®å€¼ä¸Šæ‰§è¡Œå†²çªçš„è¯»å–ã€æ’å…¥æˆ–åˆ é™¤æ“ä½œã€‚</p>
<p>ä¸€æ—¦é‡Šæ”¾äº†ä½çº§é”ï¼Œå°±ä¸èƒ½é€šè¿‡ä½¿ç”¨æ›´æ–°æ•°æ®é¡¹çš„æ—§å€¼æ¥æ’¤é”€æ“ä½œï¼Œè€Œå¿…é¡»é€šè¿‡æ‰§è¡Œè¡¥å¿æ“ä½œæ¥æ’¤é”€â€”â€”è¿™ç§æ“ä½œç§°ä¸º<strong>é€»è¾‘æ’¤é”€æ“ä½œ</strong>(logical undo operation)ã€‚åœ¨æ“ä½œæœŸé—´è·å–çš„ä½çº§é”è¶³ä»¥æ‰§è¡Œéšåçš„é€»è¾‘æ’¤é”€ï¼Œå…¶åŸå› è§ä¸‹ä¸€å°èŠ‚ã€‚</p>
<h3 id="logical-undo-log-records">Logical Undo Log Records<a class="headerlink" href="#logical-undo-log-records" title="Permanent link">âš“ï¸</a></h3>
<p>ä¸ºäº†å®ç°é€»è¾‘æ’¤é”€æ“ä½œï¼Œåœ¨æ‰§è¡Œä¿®æ”¹ç´¢å¼•çš„æ“ä½œå‰ï¼Œäº‹åŠ¡ä¼šåˆ›å»ºä¸€æ¡å½¢å¦‚<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, O_j, \text{operation-begin}&gt;\)</span><span class="heti-spacing"> </span></span>çš„æ—¥å¿—è®°å½•ï¼Œå…¶ä¸­<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O_j\)</span><span class="heti-spacing"> </span></span>æ˜¯è¯¥æ“ä½œå®ä¾‹çš„å”¯ä¸€æ ‡è¯†ç¬¦ã€‚ç³»ç»Ÿæ‰§è¡Œæ“ä½œè¿‡ç¨‹ä¸­ï¼Œä¼šä»¥å¸¸è§„æ–¹å¼ä¸ºæ‰€æœ‰çš„æ›´æ–°ç”Ÿæˆæ›´æ–°æ—¥å¿—è®°å½•ã€‚å› æ­¤æ¯ä¸ªæ“ä½œå¼•å‘çš„æ›´æ–°ä»æŒ‰æƒ¯ä¾‹è®°å½•æ—§å€¼å’Œæ–°å€¼ä¿¡æ¯ã€‚</p>
<p>å½“æ“ä½œå®Œæˆæ—¶ï¼Œç³»ç»Ÿå°†å†™å…¥æ ¼å¼ä¸º<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, O_j, \text{operation-end}, U&gt;\)</span><span class="heti-spacing"> </span></span>çš„æ“ä½œç»“æŸæ—¥å¿—è®°å½•ï¼Œå…¶ä¸­<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(U\)</span><span class="heti-spacing"> </span></span>è¡¨ç¤ºæ’¤é”€ä¿¡æ¯ï¼ˆäººè¯ï¼šåœ¨æ’¤é”€é˜¶æ®µè¦åšçš„<strong>è¡¥å¿æ“ä½œ</strong><heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚æ¯”å¦‚ï¼šè‹¥è¯¥æ“ä½œä¸º<span class="heti-skip"><span class="heti-spacing"> </span>B+<span class="heti-spacing"> </span></span>æ ‘æ’å…¥æ¡ç›®ï¼Œåˆ™æ’¤é”€ä¿¡æ¯<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(U\)</span><span class="heti-spacing"> </span></span>éœ€æŒ‡æ˜å¾…æ‰§è¡Œçš„åˆ é™¤åŠ¨ä½œã€ç›®æ ‡<span class="heti-skip"><span class="heti-spacing"> </span>B+<span class="heti-spacing"> </span></span>æ ‘åŠå¾…åˆ é™¤æ¡ç›®ã€‚è¿™ç±»è®°å½•æ“ä½œä¿¡æ¯çš„æ—¥å¿—æ–¹å¼ç§°ä¸º<strong>é€»è¾‘æ—¥å¿—</strong>(logical logging)ï¼›è€Œè®°å½•æ—§å€¼ä¸æ–°å€¼çš„ä¼ ç»Ÿæ–¹å¼ç§°ä¸º<strong>ç‰©ç†æ—¥å¿—</strong>(physical logging)ï¼Œå¯¹åº”è®°å½•å³ç‰©ç†æ—¥å¿—è®°å½•ã€‚</p>
<p>éœ€æ³¨æ„ä¸Šè¿°æ–¹æ¡ˆä¸­ï¼Œé€»è¾‘æ—¥å¿—ä»…ç”¨äº<strong>æ’¤é”€</strong>è€Œéé‡åšï¼›é‡åšå®Œå…¨ä¾èµ–ç‰©ç†æ—¥å¿—å®ç°ã€‚è¿™æ˜¯å› ä¸ºç³»ç»Ÿæ•…éšœåçš„æ•°æ®åº“çŠ¶æ€å¯èƒ½ä»…åæ˜ éƒ¨åˆ†æ“ä½œçš„æ›´æ–°ï¼Œæ­¤æ—¶<span class="heti-skip"><span class="heti-spacing"> </span>B+<span class="heti-spacing"> </span></span>æ ‘ç­‰æ•°æ®ç»“æ„å¤„äºä¸ä¸€è‡´çŠ¶æ€ï¼šæ—¢æ— æ³•æ‰§è¡Œé€»è¾‘é‡åšï¼Œä¹Ÿæ— æ³•è¿›è¡Œé€»è¾‘æ’¤é”€ã€‚è¦å®æ–½é€»è¾‘é‡åš<span class="heti-skip"><span class="heti-spacing"> </span>/<span class="heti-spacing"> </span></span>æ’¤é”€ï¼Œå¿…é¡»ç¡®ä¿ç£ç›˜ä¸Šçš„æ•°æ®åº“çŠ¶æ€æ»¡è¶³<strong>æ“ä½œä¸€è‡´æ€§</strong>(operation consistent)ï¼Œå³ä¸åº”æœ‰ä»»ä½•æ“ä½œçš„å±€éƒ¨å½±å“ã€‚ä½†æ­£å¦‚åç»­æ‰€è¿°ï¼Œæ¢å¤æ–¹æ¡ˆçš„é‡åšé˜¶æ®µé€šè¿‡ç‰©ç†é‡åšå¤„ç†ï¼Œç»“åˆç‰©ç†æ—¥å¿—è®°å½•çš„å›æ»šå¤„ç†ï¼Œèƒ½ç¡®ä¿è¢«é€»è¾‘å›æ»šæ“ä½œè®¿é—®çš„æ•°æ®åº“éƒ¨åˆ†åœ¨æ‰§è¡Œå‰è¾¾åˆ°æ“ä½œä¸€è‡´çŠ¶æ€ã€‚</p>
<p>è‹¥è¿ç»­å¤šæ¬¡æ‰§è¡ŒæŸæ“ä½œä¸æ‰§è¡Œä¸€æ¬¡è¯¥æ“ä½œçš„ç»“æœç›¸åŒï¼Œåˆ™æˆ‘ä»¬è®¤ä¸ºè¯¥æ“ä½œæ˜¯<strong>å¹‚ç­‰çš„</strong>(idempotent)ã€‚å‘<span class="heti-skip"><span class="heti-spacing"> </span>B+<span class="heti-spacing"> </span></span>æ ‘æ’å…¥æ¡ç›®è¿™ç±»æ“ä½œå¯èƒ½ä¸å…·å¤‡å¹‚ç­‰æ€§ï¼Œå› æ­¤æ¢å¤ç®—æ³•å¿…é¡»ç¡®ä¿ä¸ä¼šé‡å¤æ‰§è¡Œå·²å®Œæˆçš„æ“ä½œã€‚ç›¸ååœ°ï¼Œ<strong>ç‰©ç†æ—¥å¿—è®°å½•</strong>å…·æœ‰å¹‚ç­‰æ€§ï¼šæ— è®ºè®°å½•çš„æ›´æ–°è¢«æ‰§è¡Œä¸€æ¬¡è¿˜æ˜¯å¤šæ¬¡ï¼Œå¯¹åº”æ•°æ®é¡¹éƒ½å°†ä¿æŒç›¸åŒå€¼ã€‚</p>
<h3 id="transaction-rollback-with-logical-undo">Transaction Rollback with Logical Undo<a class="headerlink" href="#transaction-rollback-with-logical-undo" title="Permanent link">âš“ï¸</a></h3>
<p>åœ¨å›æ»šäº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>æ—¶ï¼Œç³»ç»Ÿä¼šé€†å‘æ‰«ææ—¥å¿—è®°å½•ï¼Œå¹¶æŒ‰ä»¥ä¸‹æ–¹å¼å¤„ç†ä¸<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>å¯¹åº”çš„æ—¥å¿—æ¡ç›®ï¼š</p>
<ol>
<li>æ‰«æè¿‡ç¨‹ä¸­é‡åˆ°çš„ç‰©ç†æ—¥å¿—è®°å½•æŒ‰å‰è¿°è§„åˆ™å¤„ç†ï¼ˆä¹‹åè¯´æ˜çš„è·³è¿‡æƒ…å†µé™¤å¤–<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚æœªå®Œæˆçš„é€»è¾‘æ“ä½œé€šè¿‡è¯¥æ“ä½œç”Ÿæˆçš„ç‰©ç†æ—¥å¿—è®°å½•è¿›è¡Œæ’¤é”€ã€‚</li>
<li>
<p>å·²å®Œæˆçš„é€»è¾‘æ“ä½œï¼ˆç”±<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(\text{operation-end}\)</span><span class="heti-spacing"> </span></span>æ ‡è¯†çš„è®°å½•ï¼‰é‡‡ç”¨ä¸åŒå›æ»šæ–¹å¼ï¼šå½“ç³»ç»Ÿå‘ç°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, O_j, \text{operation-end}, U&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•æ—¶ï¼Œæ‰§è¡Œä»¥ä¸‹ç‰¹æ®Šæ“ä½œï¼š</p>
<ul>
<li>åˆ©ç”¨è¯¥è®°å½•çš„æ’¤é”€ä¿¡æ¯<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(U\)</span><span class="heti-spacing"> </span></span>å›æ»šæ•´ä¸ªæ“ä½œã€‚ç³»ç»Ÿä¼šåƒé¦–æ¬¡æ‰§è¡Œè¯¥æ“ä½œæ—¶é‚£æ ·ï¼Œå°†å›æ»šè¿‡ç¨‹ä¸­æ‰§è¡Œçš„æ›´æ–°æ“ä½œè®°å…¥æ—¥å¿—ã€‚å®Œæˆæ“ä½œå›æ»šåï¼Œæ•°æ®åº“ç³»ç»Ÿä¸ä¼šç”Ÿæˆ<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, O_j, \text{operation-end}, U&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•ï¼Œè€Œæ˜¯ç”Ÿæˆ<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, O_j, \text{operation-abort}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•ã€‚</li>
<li>éšç€æ—¥å¿—é€†å‘æ‰«æçš„ç»§ç»­ï¼Œç³»ç»Ÿä¼šè·³è¿‡äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>çš„æ‰€æœ‰æ—¥å¿—è®°å½•ï¼Œç›´è‡³æ‰¾åˆ°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, O_j, \text{operation-begin}&gt;\)</span><span class="heti-spacing"> </span></span>ä¸ºæ­¢ã€‚å®šä½åˆ°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(\text{operation-begin}\)</span><span class="heti-spacing"> </span></span>è®°å½•åï¼Œå†æ¢å¤æ­£å¸¸çš„äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(T_i\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—å¤„ç†æµç¨‹ã€‚</li>
</ul>
<p>ç³»ç»Ÿåœ¨å›æ»šè¿‡ç¨‹ä¸­ä¸ºæ›´æ–°æ“ä½œè®°å½•çš„æ˜¯ç‰©ç†æ’¤é”€ä¿¡æ¯ï¼Œè€Œéä»…ä½¿ç”¨é‡åšè¡¥å¿æ—¥å¿—è®°å½•ã€‚è¿™æ˜¯å› ä¸ºåœ¨é€»è¾‘æ’¤é”€çš„è¿‡ç¨‹ä¸­å¯èƒ½ä¼šå´©æºƒï¼Œç³»ç»Ÿåœ¨æ¢å¤æ—¶å¿…é¡»å®Œæˆè¯¥é€»è¾‘æ’¤é”€ï¼›ä¸ºæ­¤ï¼Œé‡å¯æ¢å¤å°†åˆ©ç”¨ç‰©ç†æ’¤é”€ä¿¡æ¯ï¼Œå…ˆæ¶ˆé™¤å…ˆå‰æœªå®Œæˆæ’¤é”€çš„éƒ¨åˆ†å½±å“ï¼Œå†é‡æ–°æ‰§è¡Œé€»è¾‘æ’¤é”€ã€‚</p>
<p>è¿˜éœ€æ³¨æ„ï¼šå½“å›æ»šè¿‡ç¨‹ä¸­å‘ç°æ“ä½œç»“æŸçš„æ—¥å¿—è®°å½•æ—¶ï¼Œè·³è¿‡ç‰©ç†æ—¥å¿—è®°å½•ï¼Œä»¥ç¡®ä¿ä¸€æ—¦æ“ä½œå®Œæˆå°±ä¸å†ä½¿ç”¨ç‰©ç†æ—¥å¿—ä¸­çš„æ—§å€¼è¿›è¡Œå›æ»šã€‚</p>
</li>
<li>
<p>è‹¥ç³»ç»Ÿå‘ç°ä¸€æ¡è®°å½•<span><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, O_j, \text{operation-abort}&gt;\)</span></span>ï¼Œå®ƒå°†è·³è¿‡æ‰€æœ‰å…ˆå‰çš„è®°å½•ï¼ˆåŒ…æ‹¬<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(O_j\)</span><span class="heti-spacing"> </span></span>çš„æ“ä½œç»“æŸè®°å½•<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œç›´è‡³æ‰¾åˆ°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, O_j, \text{operation-begin}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•ã€‚</p>
<ul>
<li>ä»…å½“æ­£åœ¨å›æ»šçš„äº‹åŠ¡å…ˆå‰å·²éƒ¨åˆ†å›æ»šæ—¶ï¼Œæ‰ä¼šå‡ºç°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(operation-abort\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•ã€‚éœ€æ³¨æ„é€»è¾‘æ“ä½œå¯èƒ½ä¸å…·å¤‡å¹‚ç­‰æ€§ï¼Œå› æ­¤å¿…é¡»é¿å…å¯¹åŒä¸€é€»è¾‘æ’¤é”€æ“ä½œé‡å¤æ‰§è¡Œã€‚è¿™äº›å‰ç½®æ—¥å¿—è®°å½•çš„è·³è¿‡æœºåˆ¶ç¡®ä¿äº†åœ¨å…ˆå‰å›æ»šè¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿå´©æºƒä¸”äº‹åŠ¡å·²éƒ¨åˆ†å›æ»šçš„æƒ…å†µä¸‹ï¼Œä¸ä¼šå¯¹åŒä¸€æ“ä½œè¿›è¡Œå¤šæ¬¡å›æ»šã€‚</li>
</ul>
</li>
<li>
<p>å½“æ‰¾åˆ°<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, \text{ start}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•æ—¶ï¼Œå³è¡¨ç¤ºè¯¥äº‹åŠ¡å›æ»šå·²å®Œæˆï¼Œæ­¤æ—¶ç³»ç»Ÿä¼šåœ¨æ—¥å¿—ä¸­è¿½åŠ ä¸€æ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i, \text{ abort}&gt;\)</span><span class="heti-spacing"> </span></span>è®°å½•ã€‚</p>
</li>
</ol>
<h2 id="aries">ARIES<a class="headerlink" href="#aries" title="Permanent link">âš“ï¸</a></h2>
<p>æœ€ç»å…¸çš„æ•°æ®åº“æ¢å¤ç®—æ³•æ˜¯ <a href="https://en.wikipedia.org/wiki/Algorithms_for_Recovery_and_Isolation_Exploiting_Semantics"><strong>ARIES</strong></a>ï¼ˆå…¨ç§°<span><span class="heti-spacing"> </span>Algorithms for Recovery and Isolation Exploiting Semantics</span>ï¼Œåˆ©ç”¨è¯­ä¹‰çš„æ¢å¤å’Œéš”ç¦»ç®—æ³•<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚å®ƒè¿ç”¨å¤šé¡¹æ–°æŠ€æœ¯æ¥ç¼©çŸ­æ¢å¤è€—æ—¶ï¼Œå¹¶é™ä½æ£€æŸ¥ç‚¹æ“ä½œçš„å¼€é”€ã€‚å…¶ç‹¬åˆ°ä¹‹å¤„åœ¨äºèƒ½è§„é¿å¯¹å·²æ‰§è¡Œæ—¥å¿—æ“ä½œçš„å†—ä½™é‡åšï¼ŒåŒæ—¶ç²¾ç®€æ—¥å¿—è®°å½•é‡ã€‚</p>
<p><span>ARIES<span class="heti-spacing"> </span></span>é‡‡ç”¨ä»¥ä¸‹æŠ€æœ¯ï¼š</p>
<ul>
<li>ä½¿ç”¨<strong>æ—¥å¿—åºåˆ—å·</strong><span>(log sequence number, LSN)<span class="heti-spacing"> </span></span>æ¥æ ‡è¯†æ—¥å¿—è®°å½•ï¼Œå¹¶å°†<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>å­˜å‚¨åœ¨æ•°æ®åº“é¡µä¸­ï¼Œä»¥ç¡®å®šå“ªäº›æ“ä½œå·²åº”ç”¨äºæ•°æ®åº“é¡µä¸Šã€‚</li>
<li>æ”¯æŒ<strong>ç”Ÿç†é‡åš</strong><span>(physiological redo)<span class="heti-spacing"> </span></span>æ“ä½œï¼Œè¿™ç§æ“ä½œåœ¨ç‰©ç†å±‚é¢ä¸Šè¡¨ç°ä¸ºå—å½±å“é¡µé¢è¢«å®é™…æ ‡è¯†ï¼Œä½†åœ¨é¡µé¢å†…éƒ¨å¯ä»¥å…·æœ‰é€»è¾‘æ€§ã€‚</li>
<li>é‡‡ç”¨<strong>è„é¡µè¡¨</strong><span>(dirty page table)<span class="heti-spacing"> </span></span>æœºåˆ¶ä»¥å‡å°‘æ¢å¤è¿‡ç¨‹ä¸­ä¸å¿…è¦çš„é‡åšæ“ä½œã€‚</li>
<li>å®æ–½<a href="#fuzzy-checkpointing"><strong>æ¨¡ç³Šæ£€æŸ¥ç‚¹</strong></a><span>(fuzzy checkpoints)<span class="heti-spacing"> </span></span>æ–¹æ¡ˆï¼Œä»…éœ€è®°å½•è„é¡µä¿¡æ¯åŠç›¸å…³å…ƒæ•°æ®ï¼Œæ— éœ€åœ¨æ£€æŸ¥ç‚¹æ—¶å¼ºåˆ¶å†™å…¥è„é¡µå†…å®¹ã€‚è¯¥ç³»ç»Ÿé€šè¿‡åå°æŒç»­æ¸…é™¤è„é¡µçš„æ–¹å¼æ›¿ä»£äº†æ£€æŸ¥ç‚¹æœŸé—´çš„é›†ä¸­å†™å…¥æ“ä½œã€‚</li>
</ul>
<p>ä¸‹é¢å°†è¯¦ç»†ä»‹ç»<span class="heti-skip"><span class="heti-spacing"> </span>ARIES<span class="heti-spacing"> </span></span>çš„å·¥ä½œæœºåˆ¶ã€‚</p>
<h3 id="data-structures">Data Structures<a class="headerlink" href="#data-structures" title="Permanent link">âš“ï¸</a></h3>
<p><span>ARIES<span class="heti-spacing"> </span></span>ä¸­çš„æ¯æ¡æ—¥å¿—è®°å½•éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ <strong>LSN</strong>ã€‚è¿™ä¸ªç¼–å·çœ‹èµ·æ¥ä»…ä»…æ˜¯ä¸€ä¸ªé€»è¾‘æ ‡è¯†ç¬¦ï¼Œå®é™…ä¸Šä¹Ÿèƒ½ç”¨äºå®šä½ç£ç›˜ä¸Šçš„æ—¥å¿—è®°å½•ã€‚é€šå¸¸ï¼Œ<span>ARIES<span class="heti-spacing"> </span></span>ä¼šå°†æ—¥å¿—åˆ†å‰²æˆå¤šä¸ªæ—¥å¿—æ–‡ä»¶ï¼Œæ¯ä¸ªæ–‡ä»¶éƒ½æœ‰å„è‡ªçš„æ–‡ä»¶ç¼–å·ã€‚å½“æŸä¸ªæ—¥å¿—æ–‡ä»¶å¢é•¿åˆ°ä¸€å®šé™åˆ¶æ—¶ï¼Œ<span>ARIES<span class="heti-spacing"> </span></span>ä¼šå°†åç»­çš„æ—¥å¿—è®°å½•è¿½åŠ è‡³æ–°çš„æ—¥å¿—æ–‡ä»¶ä¸­ï¼›æ–°æ–‡ä»¶çš„ç¼–å·æ¯”å‰ä¸€ä¸ªæ–‡ä»¶é«˜<span><span class="heti-spacing"> </span>1</span>ã€‚å› æ­¤ï¼Œ<span>LSN<span class="heti-spacing"> </span></span>ç”±<strong>æ–‡ä»¶ç¼–å·</strong>å’Œè¯¥æ–‡ä»¶å†…çš„<strong>åç§»é‡</strong>ç»„æˆã€‚</p>
<p>æ¯ä¸ªé¡µè¿˜ç»´æŠ¤ç€ä¸€ä¸ªç§°ä¸º <strong>PageLSN</strong> çš„æ ‡è¯†ç¬¦ï¼š</p>
<ul>
<li>æ¯å½“é¡µé¢ä¸Šå‘ç”Ÿæ›´æ–°æ“ä½œï¼ˆæ— è®ºæ˜¯ç‰©ç†è¿˜æ˜¯ç”Ÿç†æ“ä½œï¼‰æ—¶ï¼Œè¯¥æ“ä½œä¼šå°†å…¶å¯¹åº”æ—¥å¿—è®°å½•çš„<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>å­˜å‚¨åœ¨è¯¥é¡µé¢çš„<span class="heti-skip"><span class="heti-spacing"> </span>PageLSN<span class="heti-spacing"> </span></span>å­—æ®µä¸­</li>
<li>åœ¨æ¢å¤çš„é‡åšé˜¶æ®µï¼Œä»»ä½•<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>å°äºæˆ–ç­‰äºé¡µçš„<span class="heti-skip"><span class="heti-spacing"> </span>PageLSN<span class="heti-spacing"> </span></span>å€¼çš„æ—¥å¿—è®°å½•éƒ½ä¸åº”å†å¯¹è¯¥é¡µé¢æ‰§è¡Œæ“ä½œâ€”â€”å› ä¸ºè¿™äº›æ“ä½œçš„å½±å“å·²ä½“ç°åœ¨å½“å‰é¡µä¸Š</li>
<li>ç»“åˆç¨åå°†ä»‹ç»çš„ã€å°†<span class="heti-skip"><span class="heti-spacing"> </span>PageLSN<span class="heti-spacing"> </span></span>ä½œä¸ºæ£€æŸ¥ç‚¹ç»„æˆéƒ¨åˆ†çš„è®°å½•æ–¹æ¡ˆåï¼Œ<span>ARIES<span class="heti-spacing"> </span></span>ç”šè‡³èƒ½é¿å…è¯»å–é‚£äº›å·²åæ˜ ç£ç›˜ä¸Šæ‰€æœ‰ç›¸å…³æ“ä½œçš„é¡µæ•°æ®ï¼Œä»è€Œæ˜¾è‘—ç¼©çŸ­æ¢å¤æ—¶é—´</li>
<li><span>PageLSN<span class="heti-spacing"> </span></span>å¯¹äºç¡®ä¿åœ¨ç”Ÿç†é‡åšæ“ä½œå­˜åœ¨æ—¶çš„å¹‚ç­‰æ€§è‡³å…³é‡è¦ï¼Œå› ä¸ºå¯¹äºå·²ç»åº”ç”¨è¿‡ç”Ÿç†é‡åšçš„é¡µï¼Œå†æ¬¡æ‰§è¡Œè¯¥æ“ä½œå¯èƒ½å¯¼è‡´é¡µçš„å†…å®¹å‘ç”Ÿé”™è¯¯å˜æ›´</li>
</ul>
<p>æ­¤å¤–ï¼Œ<span>DBMS<span class="heti-spacing"> </span></span>è¿˜ä¼šè®°å½•ç›®å‰å·²åˆ·å†™åˆ°ç£ç›˜çš„æœ€å¤§çš„æ—¥å¿—åºåˆ—å·ï¼Œè®°ä½œ <strong>flushedLSN</strong>ã€‚æ¯å½“<span class="heti-skip"><span class="heti-spacing"> </span>DBMS<span class="heti-spacing"> </span></span>å°†æ—¥å¿—ç¼“å†²åŒºå†™å…¥ç£ç›˜æ—¶ï¼Œå†…å­˜ä¸­çš„<span class="heti-skip"><span class="heti-spacing"> </span>flushedLSN<span class="heti-spacing"> </span></span>å°±ä¼šéšä¹‹æ›´æ–°ã€‚</p>
<p>å½“æ­£åœ¨æ›´æ–°æŸä¸ªé¡µæ—¶ï¼Œä¸åº”å°†å…¶åˆ·æ–°è‡³ç£ç›˜ä¸­ï¼Œå› ä¸ºæ— æ³•åŸºäºç£ç›˜ä¸Šçš„é¡µçš„éƒ¨åˆ†æ›´æ–°çŠ¶æ€é‡æ–°æ‰§è¡Œç”Ÿç†æ“ä½œã€‚å› æ­¤ï¼Œ<span>ARIES<span class="heti-spacing"> </span></span>é‡‡ç”¨ç¼“å­˜é¡µä¸Šçš„é”å­˜<span class="heti-skip"><span class="heti-spacing"> </span>(latch)<span class="heti-spacing"> </span></span>æ¥é˜²æ­¢æ­£åœ¨æ›´æ–°çš„ç¼“å­˜é¡µè¢«å†™å…¥ç£ç›˜ä¸­ã€‚è¯¥ç³»ç»Ÿä»…åœ¨æ›´æ–°å®Œæˆä¸”ç›¸å…³æ—¥å¿—è®°å½•å†™å…¥æ—¥å¿—åï¼Œæ‰ä¼šé‡Šæ”¾ç¼“å­˜é¡µé”å­˜ã€‚</p>
<p>æ¯æ¡æ—¥å¿—è®°å½•è¿˜åŒ…å«åŒä¸€äº‹åŠ¡ä¸­å‰ä¸€æ¡æ—¥å¿—è®°å½•çš„<span><span class="heti-spacing"> </span>LSN</span>ï¼Œè¯¥å€¼å­˜å‚¨åœ¨ <strong>PrevLSN</strong> å­—æ®µä¸­ï¼Œè¿™æ ·æ— éœ€è¯»å–æ•´ä¸ªæ—¥å¿—ï¼Œå°±å¯é€†å‘è·å–äº‹åŠ¡çš„æ‰€æœ‰æ—¥å¿—è®°å½•ã€‚</p>
<p>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>ARIES<span class="heti-spacing"> </span></span>ç³»ç»Ÿä¸­ï¼Œäº‹åŠ¡å›æ»šæœŸé—´ä¼šç”Ÿæˆç‰¹æ®Šçš„ä»…é‡åšæ—¥å¿—è®°å½•â€”â€”<strong>è¡¥å¿æ—¥å¿—è®°å½•</strong>(compensation log records, CLR)ï¼Œå…¶ä½œç”¨ç­‰åŒäºå‰é¢ä»‹ç»çš„æ¢å¤æ–¹æ¡ˆä¸­çš„ä»…é‡åšæ—¥å¿—è®°å½•ã€‚æ­¤å¤–ï¼Œ<span>CLR<span class="heti-spacing"> </span></span>è¿˜æ‰¿æ‹…äº†æ–¹æ¡ˆä¸­æ“ä½œä¸­æ­¢æ—¥å¿—è®°å½•çš„èŒèƒ½ï¼šè¿™ç±»è®°å½•å¢è®¾äº† <strong>UndoNextLSN</strong> å­—æ®µï¼Œç”¨äºåœ¨äº‹åŠ¡å›æ»šæ—¶æ ‡è®°ä¸‹ä¸€ä¸ªå¾…æ’¤é”€æ“ä½œçš„<span><span class="heti-spacing"> </span>LSN</span>ã€‚æ­¤å­—æ®µåŠŸèƒ½ç­‰åŒäºå‰é¢ä»‹ç»çš„æ¢å¤æ–¹æ¡ˆä¸­æ“ä½œä¸­æ­¢æ—¥å¿—è®°å½•çš„æ“ä½œæ ‡è¯†ç¬¦ï¼Œç”¨äºè·³è¿‡å·²å›æ»šçš„æ—¥å¿—è®°å½•ã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<p>åˆ©ç”¨<span class="heti-skip"><span class="heti-spacing"> </span>CLR<span class="heti-spacing"> </span></span>å®ç°äº‹åŠ¡ä¸­æ­¢ï¼š</p>
<p></p><div style="text-align: center">
<img src="images/lec15/14.gif" width="80%/"/>
</div>
</details>
<p><strong>DirtyPageTable</strong>ï¼ˆ<strong>è„é¡µè¡¨</strong>ï¼Œä¸‹é¢ç®€è®°ä¸º<span><span class="heti-spacing"> </span>DPT</span>ï¼‰è®°å½•äº†æ•°æ®åº“ç¼“å†²åŒºä¸­è¢«ä¿®æ”¹è¿‡çš„é¡µåˆ—è¡¨ã€‚é’ˆå¯¹æ¯ä¸ªé¡µï¼Œè¡¨ä¸­å­˜å‚¨<span class="heti-skip"><span class="heti-spacing"> </span>PageLSN<span class="heti-spacing"> </span></span>åŠ <strong>RecLSN</strong> å­—æ®µï¼ˆç”¨äºè¯†åˆ«å·²åº”ç”¨åˆ°ç£ç›˜é¡µç‰ˆæœ¬çš„æ—¥å¿—è®°å½•<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚å½“æŸä¸ªé¡µé¦–æ¬¡åœ¨ç¼“å­˜æ± ä¸­è¢«ä¿®æ”¹å¹¶åŠ å…¥åˆ°<span class="heti-skip"><span class="heti-spacing"> </span>DPT<span class="heti-spacing"> </span></span>æ—¶ï¼Œ<span>RecLSN<span class="heti-spacing"> </span></span>å€¼è¢«è®¾ä¸ºå½“å‰æ—¥å¿—æœ«å°¾ï¼›è€Œæ¯å½“é¡µé¢è¢«åˆ·å†™åˆ°ç£ç›˜åï¼Œè¯¥é¡µä¾¿ä»<span class="heti-skip"><span class="heti-spacing"> </span>DPT<span class="heti-spacing"> </span></span>ä¸­ç§»é™¤ã€‚</p>
<p><strong>æ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•</strong><span>(checkpoint-log record)<span class="heti-spacing"> </span></span>åŒ…æ‹¬äº†<span class="heti-skip"><span class="heti-spacing"> </span>DPT<span class="heti-spacing"> </span></span>å’Œæ´»è·ƒäº‹åŠ¡åˆ—è¡¨ã€‚å¯¹äºæ¯ä¸ªäº‹åŠ¡ï¼Œæ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•è¿˜ä¼šæ ‡æ³¨<span><span class="heti-spacing"> </span>LastLSN</span>ã€‚ç£ç›˜ä¸Šçš„å›ºå®šä½ç½®åŒæ ·ä¼šæ ‡æ³¨æœ€è¿‘ä¸€æ¬¡ï¼ˆå®Œæ•´ï¼‰æ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•çš„<span><span class="heti-spacing"> </span>LSN</span>ã€‚</p>
<p>ä¸‹è¡¨åˆ—å‡ºä¸€äº›å¸¸è§çš„<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>ä»¥åŠå®ƒä»¬å„è‡ªçš„ä½œç”¨ï¼š</p>
<table>
<thead>
<tr>
<th style="text-align: left;">åç§°</th>
<th style="text-align: left;">ä½ç½®</th>
<th style="text-align: left;">å®šä¹‰</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">flushedLSN</td>
<td style="text-align: left;">å†…å­˜</td>
<td style="text-align: left;">ç£ç›˜æ—¥å¿—ä¸­çš„æœ€åçš„<span><span class="heti-spacing"> </span>LSN</span></td>
</tr>
<tr>
<td style="text-align: left;">pageLSN</td>
<td style="text-align: left;">page_x</td>
<td style="text-align: left;"><span>page_x<span class="heti-spacing"> </span></span>çš„æœ€æ–°æ›´æ–°</td>
</tr>
<tr>
<td style="text-align: left;">recLSN</td>
<td style="text-align: left;">è„é¡µè¡¨</td>
<td style="text-align: left;">è‡ªä¸Šä¸€æ¬¡åˆ·æ´—å<span class="heti-skip"><span class="heti-spacing"> </span>page_x<span class="heti-spacing"> </span></span>ä¸­çš„æœ€æ—§æ›´æ–°</td>
</tr>
<tr>
<td style="text-align: left;">lastLSN</td>
<td style="text-align: left;">æ´»è·ƒäº‹åŠ¡è¡¨</td>
<td style="text-align: left;">äº‹åŠ¡<span class="heti-skip"><span class="heti-spacing"> </span>T_i<span class="heti-spacing"> </span></span>ä¸­æœ€æ–°çš„è®°å½•</td>
</tr>
<tr>
<td style="text-align: left;">MasterRecord</td>
<td style="text-align: left;">ç£ç›˜</td>
<td style="text-align: left;">æœ€æ–°æ£€æŸ¥ç‚¹çš„<span><span class="heti-spacing"> </span>LSN</span></td>
</tr>
</tbody>
</table>
<p>ä¸‹å›¾å±•ç¤ºäº†è¿™äº›<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>WAL<span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•ä¸­çš„åˆ†å¸ƒï¼š</p>
<div style="text-align: center">
<img src="images/lec15/12.png" width="90%/"/>
</div>
<h3 id="recovery-algorithm">Recovery Algorithm<a class="headerlink" href="#recovery-algorithm" title="Permanent link">âš“ï¸</a></h3>
<p>æ¢å¤ç®—æ³•åˆ†ä¸ºä¸‰ä¸ªé˜¶æ®µï¼š</p>
<ul>
<li><strong>åˆ†æé˜¶æ®µ</strong>(analysis pass)ï¼šç¡®å®šéœ€è¦æ’¤é”€å“ªäº›äº‹åŠ¡ã€å´©æºƒæ—¶å“ªäº›é¡µæ˜¯è„çš„ï¼Œä»¥åŠé‡åšé˜¶æ®µåº”ä»å“ªä¸ª<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>å¼€å§‹ã€‚</li>
<li><strong>é‡åšé˜¶æ®µ</strong>(redo pass)ï¼šä»åˆ†æç¡®å®šçš„èµ·å§‹ç‚¹å¼€å§‹ï¼Œæ‰§è¡Œé‡åšæ“ä½œï¼Œé‡ç°å†å²è®°å½•ï¼Œä½¿æ•°æ®åº“æ¢å¤åˆ°å´©æºƒå‰çš„çŠ¶æ€ã€‚</li>
<li><strong>æ’¤é”€é˜¶æ®µ</strong>(undo pass)ï¼šå›æ»šæ‰€æœ‰åœ¨å´©æºƒæ—¶æœªå®Œæˆçš„äº‹åŠ¡ã€‚</li>
</ul>
<div style="text-align: center">
<img src="images/lec15/17.png" width="50%/"/>
</div>
<p>ä¸‹é¢å…·ä½“ä»‹ç»æ¯ä¸ªé˜¶æ®µã€‚</p>
<h4 id="analysis-pass">Analysis Pass<a class="headerlink" href="#analysis-pass" title="Permanent link">âš“ï¸</a></h4>
<ul>
<li>ä¸ºé‡åšé˜¶æ®µåšå‡†å¤‡ï¼š<ul>
<li>åˆ†æé˜¶æ®µä¼šæ‰¾åˆ°æœ€åä¸€ä¸ªå®Œæ•´çš„æ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•ï¼Œå¹¶ä»è¯¥è®°å½•ä¸­è¯»å–<span><span class="heti-spacing"> </span>DPT</span>ã€‚</li>
<li>éšåå°† <strong>RedoLSN</strong> è®¾ç½®ä¸º<span class="heti-skip"><span class="heti-spacing"> </span>DPT<span class="heti-spacing"> </span></span>ä¸­æ‰€æœ‰é¡µçš„<u><span class="heti-skip"><span class="heti-spacing"> </span>RecLSN<span class="heti-spacing"> </span></span>ä¸­çš„æœ€å°å€¼</u>ã€‚</li>
<li>è‹¥ä¸å­˜åœ¨è„é¡µï¼Œåˆ™å°†<span class="heti-skip"><span class="heti-spacing"> </span>RedoLSN<span class="heti-spacing"> </span></span>è®¾ä¸ºæ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•çš„<span><span class="heti-spacing"> </span>LSN</span>ï¼›é‡åšè¿‡ç¨‹ä»<span class="heti-skip"><span class="heti-spacing"> </span>RedoLSN<span class="heti-spacing"> </span></span>å¼€å§‹æ‰«ææ—¥å¿—ï¼ˆæ—©äºæ­¤ç‚¹çš„æ‰€æœ‰æ—¥å¿—è®°å½•å‡å·²åº”ç”¨åˆ°ç£ç›˜ä¸Šçš„æ•°æ®åº“é¡µé¢<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚<ul>
<li>ä¸è¿‡ç¬”è€…è®¤ä¸ºæ•™æçš„è¯´æ³•ä¸å¤Ÿå‡†ç¡®â€”â€”æ²¡æœ‰å¿…è¦åœ¨é‡åšé˜¶æ®µæ‰«ææ£€æŸ¥ç‚¹ï¼Œå› æ­¤<span class="heti-skip"><span class="heti-spacing"> </span>RedoLSN<span class="heti-spacing"> </span></span>åº”è¯¥è®¾ç½®ä¸º<u>æ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•çš„ä¸‹ä¸€æ¡æ—¥å¿—è®°å½•çš„<span><span class="heti-spacing"> </span>LSN</span></u></li>
</ul>
</li>
<li>å½“å‘ç°é’ˆå¯¹æŸé¡µçš„<strong>æ›´æ–°</strong>æ“ä½œæ—¥å¿—æ—¶ï¼Œåˆ†æé˜¶æ®µä¼šåŒæ­¥æ›´æ–°<span><span class="heti-spacing"> </span>DPT</span>ï¼šè‹¥è¯¥é¡µé¢æœªåœ¨<span class="heti-skip"><span class="heti-spacing"> </span>DPT<span class="heti-spacing"> </span></span>ä¸­ç™»è®°ï¼Œåˆ™å°†å…¶åŠ å…¥ï¼Œå¹¶è®¾ç½®è¯¥é¡µé¢çš„<span class="heti-skip"><span class="heti-spacing"> </span>RecLSN<span class="heti-spacing"> </span></span>ä¸ºå½“å‰æ—¥å¿—è®°å½•çš„<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>å€¼ã€‚</li>
</ul>
</li>
<li>ä¸ºæ’¤é”€é˜¶æ®µåšå‡†å¤‡ï¼š<ul>
<li>å°†<strong>æ’¤é”€åˆ—è¡¨</strong>åˆå§‹åŒ–ä¸ºæ£€æŸ¥ç‚¹æ—¥å¿—è®°å½•ä¸­çš„äº‹åŠ¡åˆ—è¡¨ï¼ŒåŒæ—¶ä»æ£€æŸ¥ç‚¹è®°å½•ä¸­è¯»å–æ’¤é”€åˆ—è¡¨å†…æ¯ä¸ªäº‹åŠ¡çš„æœ€åä¸€æ¡æ—¥å¿—è®°å½•çš„<span><span class="heti-spacing"> </span>LSN</span>ã€‚ç„¶åä»æ£€æŸ¥ç‚¹<strong>æ­£å‘</strong>æ‰«æï¼š<ul>
<li>æ¯å½“å‘ç°ä¸å±äºæ’¤é”€åˆ—è¡¨çš„äº‹åŠ¡æ—¥å¿—è®°å½•æ—¶ï¼Œå°±å°†è¯¥äº‹åŠ¡åŠ å…¥æ’¤é”€åˆ—è¡¨ï¼›</li>
<li>å½“é‡åˆ°äº‹åŠ¡ç»“æŸï¼ˆ<strong>æäº¤</strong>è€Œéä¸­æ­¢ï¼‰çš„æ—¥å¿—è®°å½•æ—¶ï¼Œåˆ™å°†è¯¥äº‹åŠ¡ä»æ’¤é”€åˆ—è¡¨ä¸­<strong>ç§»é™¤</strong>ã€‚</li>
</ul>
</li>
<li>æœ€ç»ˆç•™åœ¨æ’¤é”€åˆ—è¡¨ä¸­çš„æ‰€æœ‰äº‹åŠ¡éƒ½å¿…é¡»åœ¨åç»­çš„æ’¤é”€è¿‡ç¨‹ä¸­å›æ»šã€‚</li>
<li>åˆ†æé˜¶æ®µè¿˜ä¼šè·Ÿè¸ªæ’¤é”€åˆ—è¡¨ä¸­å„äº‹åŠ¡çš„æœ€åä¸€æ¡è®°å½•ï¼Œä¾›æ’¤é”€é˜¶æ®µä½¿ç”¨ã€‚</li>
</ul>
</li>
<li>è¯¥é˜¶æ®µ<strong>ä¸ä¼š</strong>è¯»å–å†…å­˜ç¼“å†²åŒºçš„å†…å®¹ã€‚</li>
</ul>
<details class="example">
<summary>ä¾‹å­</summary>
<p></p><div style="text-align: center">
<img src="images/lec15/18.gif" width="80%/"/>
</div>
</details>
<h4 id="redo-pass">Redo Pass<a class="headerlink" href="#redo-pass" title="Permanent link">âš“ï¸</a></h4>
<p>é‡åšé˜¶æ®µé€šè¿‡é‡æ”¾æ‰€æœ‰å°šæœªåæ˜ åœ¨ç£ç›˜é¡µçš„æ“ä½œæ¥é‡å¤å†å²ã€‚è¯¥é˜¶æ®µä» <strong>RedoLSN</strong> å¼€å§‹<strong>æ­£å‘</strong>æ‰«ææ—¥å¿—ï¼Œæ¯å½“å‘ç°æ›´æ–°æ—¥å¿—è®°å½•æ—¶ï¼Œä¼šæ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p>
<ul>
<li>è‹¥ç›®æ ‡é¡µä¸åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>DPT<span class="heti-spacing"> </span></span>ä¸­ï¼Œæˆ–è¯¥æ›´æ–°æ—¥å¿—è®°å½•çš„<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>å°äº<span class="heti-skip"><span class="heti-spacing"> </span>DPT<span class="heti-spacing"> </span></span>ä¸­å¯¹åº”é¡µé¢çš„<span class="heti-skip"><span class="heti-spacing"> </span>RecLSN<span class="heti-spacing"> </span></span>å€¼ï¼Œåˆ™è·³è¿‡æ­¤æ—¥å¿—è®°å½•ï¼›</li>
<li>å¦åˆ™é‡åšé˜¶æ®µä¼šä»ç£ç›˜è¯»å–è¯¥é¡µï¼Œè‹¥å…¶<span class="heti-skip"><span class="heti-spacing"> </span>PageLSN<span class="heti-spacing"> </span></span>å°äºå½“å‰æ—¥å¿—è®°å½•çš„<span><span class="heti-spacing"> </span>LSN</span>ï¼Œåˆ™é‡æ–°æ‰§è¡Œè¯¥æ—¥å¿—è®°å½•ã€‚</li>
</ul>
<p>éœ€æ³¨æ„ï¼šåªè¦ä»»ä¸€æ¡ä»¶ä¸æ»¡è¶³ï¼Œå°±æ„å‘³ç€è¯¥æ—¥å¿—è®°å½•çš„ä¿®æ”¹æ•ˆæœå·²ä½“ç°åœ¨é¡µä¸Šï¼›åä¹‹åˆ™è¯´æ˜ä¿®æ”¹æ•ˆæœå°šæœªåæ˜ åˆ°é¡µä¸Šã€‚ç”±äº<span class="heti-skip"><span class="heti-spacing"> </span>ARIES<span class="heti-spacing"> </span></span>å…è®¸éå¹‚ç­‰çš„ç”Ÿç†æ—¥å¿—è®°å½•å­˜åœ¨ï¼Œè‹¥æŸæ¡æ—¥å¿—è®°å½•çš„ä¿®æ”¹å·²ä½œç”¨äºé¡µé¢ï¼Œå°±ä¸åº”å†æ¬¡é‡åšã€‚å½“ç¬¬ä¸€ä¸ªæ¡ä»¶ä¸æ»¡è¶³æ—¶ï¼Œç”šè‡³æ— éœ€ä»ç£ç›˜ä¸­è·å–é¡µé¢æ¥æ£€æŸ¥å…¶<span class="heti-skip"><span class="heti-spacing"> </span>PageLSN<span class="heti-spacing"> </span></span>å€¼ã€‚</p>
<h4 id="undo-pass">Undo Pass<a class="headerlink" href="#undo-pass" title="Permanent link">âš“ï¸</a></h4>
<p>æ’¤é”€é˜¶æ®µä¼šæ‰§è¡Œä¸€æ¬¡æ—¥å¿—çš„<strong>é€†å‘</strong>æ‰«æï¼Œå¯¹æ’¤é”€åˆ—è¡¨ä¸­çš„æ‰€æœ‰äº‹åŠ¡è¿›è¡Œ<strong>å›æ»š</strong>æ“ä½œã€‚æ­¤é˜¶æ®µä»…æ£€æŸ¥æ’¤é”€åˆ—è¡¨ä¸­äº‹åŠ¡çš„æ—¥å¿—è®°å½•ï¼›åˆ†æé˜¶æ®µè®°å½•çš„æœ€åä¸€ä¸ª<span class="heti-skip"><span class="heti-spacing"> </span>LSN<span class="heti-spacing"> </span></span>ç”¨äºå®šä½æ¯ä¸ªå¾…æ’¤é”€äº‹åŠ¡çš„æœ€åä¸€æ¡æ—¥å¿—è®°å½•ã€‚</p>
<p>æ¯å½“å‘ç°æ›´æ–°æ—¥å¿—è®°å½•æ—¶ï¼Œæ— è®ºè¯¥è®°å½•æ˜¯æ­£å¸¸å¤„ç†ä¸­çš„äº‹åŠ¡å›æ»šè¿˜æ˜¯é‡å¯æ¢å¤æœŸé—´çš„æ’¤é”€æ“ä½œï¼Œéƒ½å°†ä¾æ®è¯¥è®°å½•æ‰§è¡Œæ’¤é”€åŠ¨ä½œã€‚æ’¤é”€é˜¶æ®µä¼šç”ŸæˆåŒ…å«æ‰€æ‰§è¡Œï¼ˆå¿…é¡»æ˜¯ç”Ÿç†æ€§ï¼‰æ’¤é”€æ“ä½œçš„<span><span class="heti-spacing"> </span>CLR</span>ï¼Œå¹¶å°†è¯¥<span class="heti-skip"><span class="heti-spacing"> </span>CLR<span class="heti-spacing"> </span></span>çš„ <strong>UndoNextLSN</strong> å€¼è®¾ä¸ºåŸæ›´æ–°æ—¥å¿—è®°å½•çš„ <strong>PrevLSN</strong> å€¼ã€‚</p>
<ul>
<li>è‹¥é‡åˆ°<span><span class="heti-spacing"> </span>CLR</span>ï¼Œå…¶<span class="heti-skip"><span class="heti-spacing"> </span>UndoNextLSN<span class="heti-spacing"> </span></span>å­—æ®µå³æŒ‡æ˜è¯¥äº‹åŠ¡ä¸‹ä¸€æ¡å¾…æ’¤æ¶ˆæ—¥å¿—è®°å½•çš„<span><span class="heti-spacing"> </span>LSN</span>â€”â€”è¿™æ„å‘³ç€åç»­çš„è¯¥äº‹åŠ¡æ—¥å¿—è®°å½•å·²è¢«å›æ»šå®Œæ¯•ã€‚</li>
<li>å¯¹äºé<span class="heti-skip"><span class="heti-spacing"> </span>CLR<span class="heti-spacing"> </span></span>ç±»å‹çš„å…¶ä»–æ—¥å¿—è®°å½•ï¼Œåˆ™é€šè¿‡å…¶<span class="heti-skip"><span class="heti-spacing"> </span>PrevLSN<span class="heti-spacing"> </span></span>å­—æ®µç¡®å®šä¸‹ä¸€æ¡éœ€æ’¤æ¶ˆçš„è®°å½•ä½ç½®ã€‚</li>
</ul>
<p>åœ¨æ¯æ¬¡ä¸­æ–­åç»§ç»­å¤„ç†æ—¶ï¼Œç³»ç»Ÿä¼šé€‰æ‹©æ‰€æœ‰å¤„äºæ’¤æ¶ˆåˆ—è¡¨å†…çš„äº‹åŠ¡ä¸­æœ€å¤§çš„â€œä¸‹æ¡å¾…å¤„ç†<span><span class="heti-spacing"> </span>LSN</span>â€ä½œä¸ºä¸‹ä¸€æ­¥çš„æ“ä½œå¯¹è±¡ã€‚</p>
<p>æœ€åï¼Œè¢«æ’¤é”€çš„äº‹åŠ¡éƒ½è¦è¢«<strong>ä¸­æ­¢</strong>ï¼Œæ‰€ä»¥éœ€è¦æ’å…¥å’Œä¸­æ­¢ç›¸å…³çš„<span><span class="heti-spacing"> </span>CLR</span>ï¼ˆæ¯”å¦‚<span><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;T_i\ \text{abort}&gt;\)</span></span><heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</p>
<details class="example">
<summary>ä¾‹å­</summary>
<div class="tabbed-set tabbed-alternate" data-tabs="1:5"><input checked="" id="__tabbed_1_1" name="__tabbed_1" type="radio"/><input id="__tabbed_1_2" name="__tabbed_1" type="radio"/><input id="__tabbed_1_3" name="__tabbed_1" type="radio"/><input id="__tabbed_1_4" name="__tabbed_1" type="radio"/><input id="__tabbed_1_5" name="__tabbed_1" type="radio"/><div class="tabbed-labels"><label for="__tabbed_1_1">ä¾‹<span class="heti-skip"><span class="heti-spacing"> </span>1<span class="heti-spacing"> </span></span></label><label for="__tabbed_1_2">ä¾‹<span class="heti-skip"><span class="heti-spacing"> </span>2<span class="heti-spacing"> </span></span></label><label for="__tabbed_1_3">ä¾‹<span class="heti-skip"><span class="heti-spacing"> </span>3<span class="heti-spacing"> </span></span></label><label for="__tabbed_1_4">ä¾‹<span class="heti-skip"><span class="heti-spacing"> </span>4<span class="heti-spacing"> </span></span></label><label for="__tabbed_1_5">ä¾‹<span><span class="heti-spacing"> </span>5</span></label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/lec15/4.png" width="70%/"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/lec15/19.gif" width="80%/"/>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="" id="__tabbed_2_1" name="__tabbed_2" type="radio"/><input id="__tabbed_2_2" name="__tabbed_2" type="radio"/><div class="tabbed-labels"><label for="__tabbed_2_1">é¢˜ç›®</label><label for="__tabbed_2_2">è§£ç­”</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/lec15/20.png" width="80%/"/>
</div>
<p></p><div style="text-align: center">
<img src="images/lec15/21.png" width="80%/"/>
</div>
</div>
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/lec15/22.png" width="30%/"/>
</div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="" id="__tabbed_3_1" name="__tabbed_3" type="radio"/><input id="__tabbed_3_2" name="__tabbed_3" type="radio"/><div class="tabbed-labels"><label for="__tabbed_3_1">é¢˜ç›®</label><label for="__tabbed_3_2">è§£ç­”</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<blockquote>
<p>è²Œä¼¼æ˜¯æ¥è‡ªå†å¹´å·çš„é¢˜ç›®ï¼Ÿ</p>
</blockquote>
<p></p><div style="text-align: center">
<img src="images/lec15/23.png" width="80%/"/>
</div>
</div>
<div class="tabbed-block">
<p>æ²¡æœ‰æ ‡å‡†ç­”æ¡ˆï¼Œæˆ‘å¾—åˆ°çš„ç­”æ¡ˆæ˜¯ï¼š</p>
<ol>
<li>A</li>
<li>D</li>
<li>E(AB)</li>
<li>E(BC)</li>
</ol>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="" id="__tabbed_4_1" name="__tabbed_4" type="radio"/><input id="__tabbed_4_2" name="__tabbed_4" type="radio"/><div class="tabbed-labels"><label for="__tabbed_4_1">é¢˜ç›®</label><label for="__tabbed_4_2">è§£ç­”</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p></p><div style="text-align: center">
<img src="images/lec15/24.png" width="80%/"/>
</div>
</div>
<div class="tabbed-block">
<p>ç­”æ¡ˆç”±<span class="heti-skip"><span class="heti-spacing"> </span>Gemini 2.5 pro<span class="heti-spacing"> </span></span>ç”Ÿæˆã€‚</p>
<p></p><div style="text-align: center">
<img src="images/lec15/25.png" width="80%/"/>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</details>
<h3 id="other-features">Other Features<a class="headerlink" href="#other-features" title="Permanent link">âš“ï¸</a></h3>
<p><span>ARIES<span class="heti-spacing"> </span></span>è¿˜æœ‰ä»¥ä¸‹åŠŸèƒ½ï¼š</p>
<ul>
<li>
<p><strong>åµŒå¥—é¡¶å±‚æ“ä½œ</strong>(nested top actions)ï¼š</p>
<ul>
<li><span>ARIES<span class="heti-spacing"> </span></span>å…è®¸è®°å½•é‚£äº›å³ä¾¿äº‹åŠ¡å›æ»šä¹Ÿä¸åº”æ’¤é”€çš„æ“ä½œã€‚ä¾‹å¦‚ï¼Œè‹¥ä¸€ä¸ªäº‹åŠ¡ä¸ºå…³ç³»åˆ†é…äº†ä¸€ä¸ªé¡µï¼Œå³ä½¿è¯¥äº‹åŠ¡è¢«å›æ»šï¼Œé¡µçš„åˆ†é…ä¹Ÿä¸åº”æ’¤é”€ï¼Œå› ä¸ºå…¶ä»–äº‹åŠ¡å¯èƒ½å·²åœ¨è¯¥é¡µä¸Šå­˜å‚¨äº†è®°å½•ã€‚æ­¤ç±»ä¸åº”æ’¤é”€çš„æ“ä½œè¢«ç§°ä¸º<strong>åµŒå¥—é¡¶å±‚æ“ä½œ</strong>ã€‚</li>
<li>è¿™ç±»æ“ä½œå¯å»ºæ¨¡ä¸ºå…¶æ’¤é”€åŠ¨ä½œä¸ºç©ºçš„æ“ä½œã€‚</li>
<li>åœ¨<span class="heti-skip"><span class="heti-spacing"> </span>ARIES<span class="heti-spacing"> </span></span>ä¸­ï¼Œé€šè¿‡åˆ›å»ºä¸€ä¸ªè™šæ‹Ÿçš„<span class="heti-skip"><span class="heti-spacing"> </span>CLR<span class="heti-spacing"> </span></span>æ¥å®ç°æ­¤ç±»æ“ä½œï¼Œå…¶<span class="heti-skip"><span class="heti-spacing"> </span>UndoNextLSN<span class="heti-spacing"> </span></span>çš„è®¾ç½®ä½¿å¾—äº‹åŠ¡å›æ»šæ—¶è·³è¿‡ç”±è¯¥æ“ä½œç”Ÿæˆçš„æ—¥å¿—è®°å½•ã€‚</li>
</ul>
</li>
<li>
<p><strong>æ¢å¤ç‹¬ç«‹æ€§</strong>(recovery independence)ï¼šæŸäº›é¡µå¯ä»¥ç‹¬ç«‹äºå…¶ä»–é¡µè¿›è¡Œæ¢å¤ï¼Œè¿™æ ·å³ä½¿å…¶ä»–é¡µæ­£åœ¨æ¢å¤ä¸­ï¼Œè¿™äº›é¡µä»å¯ä½¿ç”¨ã€‚å¦‚æœç£ç›˜ä¸Šçš„éƒ¨åˆ†é¡µå‘ç”Ÿæ•…éšœï¼Œå¯ä»¥åœ¨ä¸ä¸­æ–­å…¶ä»–é¡µä¸Šäº‹åŠ¡å¤„ç†çš„æƒ…å†µä¸‹å•ç‹¬æ¢å¤å®ƒä»¬ã€‚</p>
</li>
<li>
<p><strong>ä¿å­˜ç‚¹</strong>(savepoints)ï¼šäº‹åŠ¡å¯ä»¥è®°å½•ä¿å­˜ç‚¹ï¼Œå¹¶ä¸”èƒ½å¤Ÿéƒ¨åˆ†å›æ»šè‡³æŸä¸ªä¿å­˜ç‚¹ã€‚</p>
<ul>
<li>è¿™å¯¹äºæ­»é”å¤„ç†å°¤ä¸ºæœ‰ç”¨ï¼Œå› ä¸ºäº‹åŠ¡å¯ä»¥å›æ»šåˆ°å…è®¸é‡Šæ”¾æ‰€éœ€é”çš„ä½ç½®ï¼Œç„¶åä»è¯¥ç‚¹é‡æ–°å¼€å§‹ã€‚</li>
<li>ç¨‹åºå‘˜è¿˜å¯ä»¥åˆ©ç”¨ä¿å­˜ç‚¹æ¥éƒ¨åˆ†æ’¤é”€ä¸€ä¸ªäº‹åŠ¡ï¼Œéšåç»§ç»­æ‰§è¡Œï¼›è¿™ç§æ–¹æ³•é€‚ç”¨äºå¤„ç†åœ¨äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­æ£€æµ‹åˆ°çš„æŸäº›ç‰¹å®šç±»å‹çš„é”™è¯¯ã€‚</li>
</ul>
</li>
<li>
<p><strong>ç²’åº¦é”å®š</strong>(fine-grained locking)ï¼š<span>ARIES<span class="heti-spacing"> </span></span>æ¢å¤ç®—æ³•å¯ä¸ç´¢å¼•å¹¶å‘æ§åˆ¶ç®—æ³•é…åˆä½¿ç”¨ï¼Œè¿™äº›ç®—æ³•å…è®¸åœ¨ç´¢å¼•ä¸Šè¿›è¡Œå…ƒç»„çº§é”å®šè€Œéé¡µçº§é”å®šï¼Œä»è€Œæ˜¾è‘—æå‡å¹¶å‘æ€§èƒ½ã€‚</p>
</li>
<li>
<p><strong>æ¢å¤ä¼˜åŒ–</strong>(recovery optimizations)ï¼š</p>
<ul>
<li>å¯åˆ©ç”¨<span class="heti-skip"><span class="heti-spacing"> </span>DPT<span class="heti-spacing"> </span></span>åœ¨é‡åšé˜¶æ®µé¢„å–é¡µã€‚</li>
<li>æ­¤å¤–è¿˜å¯ä»¥æ”¯æŒä¹±åºé‡åšï¼šå¯¹äºæ­£ä»ç£ç›˜è¯»å–çš„é¡µï¼Œå¯æš‚ç¼“æ‰§è¡Œé‡åšæ“ä½œï¼Œå¾…é¡µåŠ è½½å®Œæˆåå†è¡Œå¤„ç†ï¼›ä¸æ­¤åŒæ—¶ï¼Œç³»ç»Ÿä»å¯æŒç»­å¤„ç†å…¶ä»–æ—¥å¿—è®°å½•ã€‚</li>
</ul>
</li>
</ul>
<h2 id="supplements">Supplements<a class="headerlink" href="#supplements" title="Permanent link">âš“ï¸</a></h2>
<div class="admonition warning">
<p class="admonition-title">æ³¨æ„</p>
<p>ä»¥ä¸‹ä¸ºåœ¨æ•™æä¸­å‡ºç°ï¼Œä½†æ˜¯ä¸ä½œä¸ºè€ƒç‚¹çš„å†…å®¹ï¼Œå¤ä¹ æ—¶å¯ç›´æ¥ç•¥è¿‡ã€‚</p>
</div>
<h3 id="failure-with-loss-of-non-volatile-storage">Failure with Loss of Non-Volatile Storage<a class="headerlink" href="#failure-with-loss-of-non-volatile-storage" title="Permanent link">âš“ï¸</a></h3>
<p>è¿„ä»Šä¸ºæ­¢ï¼Œæˆ‘ä»¬ä»…è®¨è®ºäº†æ•…éšœå¯¼è‡´æ˜“å¤±æ€§å­˜å‚¨å™¨ä¿¡æ¯ä¸¢å¤±çš„æƒ…å†µã€‚å°½ç®¡å¯¼è‡´éæ˜“å¤±æ€§å­˜å‚¨å™¨æ•°æ®ä¸¢å¤±çš„æ•…éšœæä¸ºç½•è§ï¼Œä½†æˆ‘ä»¬ä»éœ€åšå¥½åº”å¯¹å‡†å¤‡ï¼Œæ‰€ä»¥æœ¬èŠ‚å°±æ¥æ¢è®¨è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>ä¸€ç§ç®€å•çš„åº”å¯¹æ–¹æ¡ˆæ˜¯å®šæœŸå°†æ•°æ®åº“å…¨éƒ¨å†…å®¹<strong>è½¬å‚¨</strong><span>(dump)<span class="heti-spacing"> </span></span>è‡³ç¨³å®šå­˜å‚¨å™¨ã€‚å½“å‘ç”Ÿå¯¼è‡´ç‰©ç†æ•°æ®åº“çš„æ•°æ®å—æŸæ¯çš„æ•…éšœæ—¶ï¼Œç³»ç»Ÿå¯åˆ©ç”¨æœ€è¿‘ä¸€æ¬¡çš„è½¬å‚¨æ‹·è´ï¼Œå°†æ•°æ®åº“æ¢å¤åˆ°ä¹‹å‰æŸä¸ªä¸€è‡´çŠ¶æ€ã€‚å®Œæˆè¿™ä¸ªæ“ä½œåï¼Œå†é€šè¿‡æ—¥å¿—ä½¿æ•°æ®åº“ç³»ç»Ÿè¾¾åˆ°æœ€æ–°çš„ä¸€è‡´çŠ¶æ€ã€‚</p>
<p>è¿˜æœ‰ä¸€ç§ä¸¥æ ¼çš„æ•°æ®åº“è½¬å‚¨æ–¹æ³•ï¼Œè¦æ±‚è½¬å‚¨æœŸé—´ä¸å¾—å­˜åœ¨æ´»è·ƒçš„äº‹åŠ¡ï¼Œå…¶æ‰§è¡Œæµç¨‹ç±»ä¼¼æ£€æŸ¥ç‚¹æœºåˆ¶ï¼š</p>
<ol>
<li>å°†æ‰€æœ‰é©»ç•™åœ¨å†…å­˜çš„æ—¥å¿—è®°å½•è¾“å‡ºåˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­</li>
<li>å°†æ‰€æœ‰ç¼“å­˜å—å†™å…¥åˆ°ç£ç›˜ä¸­</li>
<li>å°†æ•°æ®åº“å†…å®¹å¤åˆ¶åˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­</li>
<li>å‘ç¨³å®šå­˜å‚¨å™¨è¾“å‡ºä¸€æ¡<span class="heti-skip"><span class="heti-spacing"> </span><span class="arithmatex">\(&lt;\text{dump}&gt;\)</span><span class="heti-spacing"> </span></span>æ—¥å¿—è®°å½•</li>
</ol>
<p>å…¶ä¸­æ­¥éª¤<span><span class="heti-spacing"> </span>1</span>ã€2ã€<span>4<span class="heti-spacing"> </span></span>ä¸æ£€æŸ¥ç‚¹æœºåˆ¶çš„ä¸‰ä¸ªæ­¥éª¤ç›¸å¯¹åº”ã€‚å½“æ•´ä¸ªéæ˜“å¤±æ€§å­˜å‚¨å™¨å¤±æ•ˆæ—¶ï¼Œç³»ç»Ÿé¦–å…ˆåˆ©ç”¨æœ€æ–°çš„è½¬å‚¨æ‹·è´é‡å»ºç£ç›˜æ•°æ®åº“ï¼Œéšåæ£€ç´¢æ—¥å¿—ï¼Œå¹¶é‡åšè‡ªè¯¥æ¬¡è½¬å‚¨ä»¥æ¥çš„æ‰€æœ‰æ“ä½œï¼ˆæ³¨æ„æ­¤æ—¶æ— éœ€æ‰§è¡Œæ’¤é”€æ“ä½œ<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚è‹¥é‡åˆ°çš„æ˜¯å±€éƒ¨çš„éæ˜“å¤±æ€§å­˜å‚¨å™¨æ•…éšœï¼ˆå¦‚å•ä¸ªæˆ–å°‘é‡æ•°æ®å—æŸå<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ï¼Œåˆ™åªéœ€è¿˜åŸå—æŸå—å¹¶åœ¨è¿™äº›å—ä¸Šæ‰§è¡Œé‡åšæ“ä½œã€‚</p>
<p>æ•°æ®åº“å†…å®¹çš„è½¬å‚¨ä¹Ÿè¢«ç§°ä¸º<strong>å½’æ¡£è½¬å‚¨</strong>(archival dump)ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥å°†è½¬å‚¨æ–‡ä»¶å­˜æ¡£ï¼Œå¹¶åœ¨ä¹‹ååˆ©ç”¨å®ƒä»¬æ¥æ£€æŸ¥æ•°æ®åº“çš„æ—§çŠ¶æ€ã€‚</p>
<p>å¤§å¤šæ•°æ•°æ®åº“ç³»ç»Ÿè¿˜æ”¯æŒ<span class="heti-skip"><span class="heti-spacing"> </span>SQL<span class="heti-spacing"> </span></span>è½¬å‚¨åŠŸèƒ½ï¼Œè¯¥åŠŸèƒ½å°†<span class="heti-skip"><span class="heti-spacing"> </span>SQL<span class="heti-spacing"> </span></span>æ•°æ®å®šä¹‰è¯­è¨€è¯­å¥å’Œæ’å…¥è¯­å¥å†™å…¥æ–‡ä»¶ï¼Œåç»­å¯é€šè¿‡é‡æ–°æ‰§è¡Œè¿™äº›è¯­å¥æ¥é‡å»ºæ•°æ®åº“ã€‚æ­¤ç±»è½¬å‚¨åœ¨å°†æ•°æ®è¿ç§»è‡³ä¸åŒæ•°æ®åº“å®ä¾‹æˆ–ä¸åŒç‰ˆæœ¬çš„æ•°æ®åº“è½¯ä»¶æ—¶å°¤ä¸ºå®ç”¨ï¼Œå› ä¸ºåœ¨å…¶ä»–å®ä¾‹æˆ–ç‰ˆæœ¬ä¸­ï¼Œç‰©ç†å­˜å‚¨ä½ç½®å’Œå¸ƒå±€å¯èƒ½å­˜åœ¨å·®å¼‚ã€‚</p>
<p>ä¸Šè¿°è½¬å‚¨æµç¨‹çš„é«˜æˆæœ¬ä½“ç°åœ¨ï¼š</p>
<ul>
<li>æ•´ä¸ªæ•°æ®åº“å¿…é¡»å¤åˆ¶åˆ°ç¨³å®šå­˜å‚¨å™¨ä¸­ï¼Œå¯¼è‡´å¤§é‡çš„æ•°æ®ä¼ è¾“</li>
<li>ç”±äºè½¬å‚¨è¿‡ç¨‹ä¸­éœ€æš‚åœäº‹åŠ¡å¤„ç†ï¼Œä¼šé€ æˆ<span class="heti-skip"><span class="heti-spacing"> </span>CPU<span class="heti-spacing"> </span></span>è®¡ç®—èµ„æºçš„é—²ç½®</li>
</ul>
<p>å› æ­¤ï¼Œä¸€ç§æ”¹è¿›æ–¹æ¡ˆæ˜¯<strong>æ¨¡ç³Šè½¬å‚¨æ–¹æ¡ˆ</strong>(fuzzy dump schemes)ï¼Œå…è®¸äº‹åŠ¡åœ¨è½¬å‚¨è¿›è¡Œæ—¶ä»ä¿æŒæ´»è·ƒçŠ¶æ€ï¼ˆç±»ä¼¼æ¨¡ç³Šæ£€æŸ¥ç‚¹æŠ€æœ¯<heti-adjacent class="heti-adjacent-half">ï¼‰</heti-adjacent>ã€‚</p>
<h3 id="high-availability-of-using-remote-backup-system">High Availability of Using Remote Backup System<a class="headerlink" href="#high-availability-of-using-remote-backup-system" title="Permanent link">âš“ï¸</a></h3>
<p>ç°åœ¨çš„åº”ç”¨ç¨‹åºéœ€è¦ä¸€ç§èƒ½å¤Ÿåœ¨ç³»ç»Ÿæ•…éšœæˆ–ç¾éš¾å‘ç”Ÿæ—¶ä»èƒ½è¿è¡Œçš„äº‹åŠ¡å¤„ç†ç³»ç»Ÿã€‚æ­¤ç±»ç³»ç»Ÿå¿…é¡»æä¾›<strong>é«˜å¯ç”¨æ€§</strong>(high availability)ï¼Œå³ç³»ç»Ÿä¸å¯ç”¨çš„æ—¶é—´å¿…é¡»éå¸¸çŸ­ã€‚</p>
<p>æˆ‘ä»¬å¯ä»¥é€šè¿‡åœ¨ä¸€ä¸ªç§°ä¸º<strong>ä¸»ç«™ç‚¹</strong><span>(primary site)<span class="heti-spacing"> </span></span>çš„åœ°ç‚¹æ‰§è¡Œäº‹åŠ¡å¤„ç†ï¼Œå¹¶åœ¨<strong>è¿œç¨‹å¤‡ä»½</strong><span>(remote backup)<span class="heti-spacing"> </span></span>ç«™ç‚¹å¤åˆ¶ä¸»ç«™ç‚¹çš„æ‰€æœ‰æ•°æ®æ¥å®ç°é«˜å¯ç”¨æ€§ã€‚è¿œç¨‹å¤‡ä»½ç«™ç‚¹æœ‰æ—¶ä¹Ÿè¢«ç§°ä¸º<strong>è¾…åŠ©ç«™ç‚¹</strong>(secondary site)ã€‚è¿œç¨‹ç«™ç‚¹å¿…é¡»ä¸ä¸»ç«™ç‚¹ä¿æŒåŒæ­¥ï¼Œå› ä¸ºä¸»ç«™ç‚¹ä¼šè¿›è¡Œæ›´æ–°ã€‚é€šè¿‡å°†ä¸»ç«™ç‚¹çš„æ‰€æœ‰æ—¥å¿—è®°å½•å‘é€åˆ°è¿œç¨‹å¤‡ä»½ç«™ç‚¹æ¥å®ç°åŒæ­¥ã€‚è¿œç¨‹å¤‡ä»½ç«™ç‚¹å¿…é¡»ä¸ä¸»ç«™ç‚¹åœ¨ç‰©ç†ä¸Šåˆ†å¼€ï¼Œè¿™æ ·ä¸»ç«™ç‚¹å‘ç”Ÿçš„ç¾éš¾å°±ä¸ä¼šæŸå®³åˆ°è¿œç¨‹å¤‡ä»½ç«™ç‚¹äº†ã€‚ä¸‹å›¾å±•ç¤ºçš„å°±æ˜¯ä¸€ä¸ªè¿œç¨‹å¤‡ä»½ç³»ç»Ÿçš„æ¶æ„ï¼š</p>
<div style="text-align: center">
<img src="images/lec15/2.png" width="70%/"/>
</div>
<p>å½“ä¸»ç«™ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œè¿œç¨‹å¤‡ä»½ç«™ç‚¹å°†æ¥ç®¡å¤„ç†å·¥ä½œã€‚åœ¨æ­¤ä¹‹å‰ï¼Œå®ƒä¼šåˆ©ç”¨ä»ä¸»ç«™ç‚¹è·å–çš„ï¼ˆå¯èƒ½å·²è¿‡æ—¶çš„ï¼‰æ•°æ®å‰¯æœ¬ï¼Œä»¥åŠæ¥æ”¶åˆ°çš„æ—¥å¿—è®°å½•è¿›è¡Œæ¢å¤æ“ä½œã€‚å®é™…ä¸Šï¼Œè¿œç¨‹å¤‡ä»½ç«™ç‚¹æ‰§è¡Œçš„æ˜¯åŸæœ¬åº”ç”±ä¸»ç«™ç‚¹åœ¨æ¢å¤æ—¶å®Œæˆçš„æ¢å¤åŠ¨ä½œã€‚åªéœ€ç¨ä½œä¿®æ”¹çš„æ ‡å‡†æ¢å¤ç®—æ³•å³å¯åº”ç”¨äºè¿œç¨‹å¤‡ä»½ç«™ç‚¹çš„æ¢å¤è¿‡ç¨‹ã€‚ä¸€æ—¦å®Œæˆæ¢å¤ï¼Œè¿œç¨‹å¤‡ä»½ç«™ç‚¹ä¾¿å¼€å§‹å¤„ç†äº‹åŠ¡ã€‚ç›¸æ¯”å•ç‚¹ç³»ç»Ÿï¼Œè¿™ç§æ¶æ„æ˜¾è‘—æé«˜äº†å¯ç”¨æ€§â€”â€”å³ä½¿ä¸»ç«™ç‚¹çš„æ‰€æœ‰æ•°æ®å…¨éƒ¨ä¸¢å¤±ï¼Œç³»ç»Ÿä»èƒ½æ¢å¤æ­£å¸¸è¿è¡Œã€‚</p>
<p>åœ¨è®¾è®¡è¿œç¨‹å¤‡ä»½ç³»ç»Ÿæ—¶å¿…é¡»è§£å†³ä»¥ä¸‹å‡ ä¸ªå…³é”®é—®é¢˜ï¼š</p>
<ul>
<li>
<p><strong>æ•…éšœæ£€æµ‹</strong>(detection of failure)ï¼š</p>
<ul>
<li>é€šä¿¡çº¿è·¯çš„æ•…éšœå¯èƒ½ä¼šæ¬ºéª—è¿œç¨‹å¤‡ä»½ç³»ç»Ÿï¼Œä½¿å…¶è¯¯ä»¥ä¸ºä¸»ç³»ç»Ÿå‘ç”Ÿæ•…éšœ</li>
<li>ä¸ºäº†é¿å…è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ç»´æŠ¤äº†ä¸»ç³»ç»Ÿå’Œè¿œç¨‹å¤‡ä»½ä¹‹é—´çš„å¤šä¸ªç‹¬ç«‹é€šä¿¡é“¾è·¯ï¼Œè¿™äº›é“¾è·¯å…·æœ‰ç‹¬ç«‹çš„æ•…éšœæ¨¡å¼</li>
</ul>
</li>
<li>
<p><strong>ä¼ è¾“æ§åˆ¶</strong>(transfer of control)ï¼š</p>
<ul>
<li>å½“ä¸»ç«™ç‚¹å¤±æ•ˆæ—¶ï¼Œå¤‡ä»½ç«™ç‚¹ä¼šæ¥ç®¡å¤„ç†ä»»åŠ¡å¹¶æˆä¸ºæ–°çš„ä¸»ç«™ç‚¹ï¼Œæ­¤æ—¶æŸ¥è¯¢è¯·æ±‚å¿…é¡»å‘é€è‡³æ–°ä¸»ç«™ç‚¹</li>
<li>æ§åˆ¶æƒè½¬ç§»çš„å†³ç­–å¯ä»¥æ‰‹åŠ¨æ‰§è¡Œï¼Œä¹Ÿå¯ä»¥é€šè¿‡æ•°æ®åº“ç³»ç»Ÿä¾›åº”å•†æä¾›çš„è½¯ä»¶è‡ªåŠ¨å®Œæˆ</li>
<li>ä¸ºå®ç°è‡ªåŠ¨åˆ‡æ¢ï¼Œè®¸å¤šç³»ç»Ÿä¼šå°†åŸä¸»ç«™ç‚¹çš„<span class="heti-skip"><span class="heti-spacing"> </span>IP<span class="heti-spacing"> </span></span>åœ°å€åˆ†é…ç»™æ–°ä¸»ç«™ç‚¹ï¼›æ­¤æ—¶ç°æœ‰æ•°æ®åº“è¿æ¥å°†ä¸­æ–­ï¼Œä½†å½“åº”ç”¨ç¨‹åºå°è¯•é‡æ–°å»ºç«‹è¿æ¥æ—¶ï¼Œå®é™…ä¸Šä¼šè¿æ¥åˆ°æ–°ä¸»ç«™ç‚¹</li>
<li>å¦ä¸€äº›ç³»ç»Ÿåˆ™é‡‡ç”¨<strong>é«˜å¯ç”¨æ€§ä»£ç†</strong><span>(high availability proxy)<span class="heti-spacing"> </span></span>æœºå™¨ï¼šåº”ç”¨å®¢æˆ·ç«¯ä¸ç›´æ¥è¿æ¥æ•°æ®åº“ï¼Œè€Œæ˜¯é€šè¿‡ä»£ç†è¿›è¡Œè¿æ¥â€”â€”è¯¥ä»£ç†ä¼šå°†åº”ç”¨è¯·æ±‚é€æ˜è·¯ç”±è‡³å½“å‰çš„ä¸»èŠ‚</li>
<li>å½“åŸä¸»ç«™ç‚¹æ¢å¤åï¼Œæ–°ä¸»ç«™ç‚¹æ—¢å¯æ‰®æ¼”è¿œç¨‹å¤‡ä»½è§’è‰²ï¼Œä¹Ÿå¯ç»§ç»­æ¥ç®¡</li>
<li>æ— è®ºå“ªç§æƒ…å†µï¼ŒåŸä¸»ç«™ç‚¹éƒ½å¿…é¡»è·å–å…¶æ•…éšœæœŸé—´å¤‡ä»½ç«™ç‚¹æ‰§è¡Œçš„æ‰€æœ‰æ›´æ–°æ—¥å¿—è®°å½•ï¼Œå…·ä½“é€šè¿‡æœ¬åœ°åº”ç”¨è¿™äº›æ—¥å¿—æ›´æ–°å®ç°åŒæ­¥ï¼›ä¹‹ååŸä¸»ç«™ç‚¹å¯ä»¥ä½œä¸ºè¿œç¨‹å¤‡ä»½èŠ‚ç‚¹è¿è¡Œ</li>
<li>è‹¥éœ€äº¤è¿˜æ§åˆ¶æƒï¼Œæ–°ä¸»ç«™ç‚¹ï¼ˆå³åŸå¤‡ä»½ç«™ç‚¹ï¼‰å¯æ¨¡æ‹Ÿæ•…éšœçŠ¶æ€è§¦å‘æ—§ä¸»ç«™çš„æ¥ç®¡æµç¨‹</li>
</ul>
</li>
<li>
<p><strong>æ¢å¤æ—¶é—´</strong>(time to recover)ï¼š</p>
<ul>
<li>è‹¥è¿œç¨‹å¤‡ä»½ç«™ç‚¹çš„æ—¥å¿—å¢é•¿è¿‡å¤§ï¼Œæ¢å¤è¿‡ç¨‹å°†è€—æ—¶æ¼«é•¿</li>
<li>å› æ­¤è¿œç¨‹å¤‡ä»½ç«™ç‚¹å¯å®šæœŸå¤„ç†å·²æ¥æ”¶çš„é‡åšæ—¥å¿—è®°å½•ï¼Œå¹¶æ‰§è¡Œæ£€æŸ¥ç‚¹æ“ä½œï¼Œä»¥åˆ æ‰å¾ˆæ—§çš„é‚£éƒ¨åˆ†æ—¥å¿—ï¼Œä»è€Œç¼©çŸ­è¿œç¨‹å¤‡ä»½æ¥ç®¡çš„å»¶è¿Ÿæ—¶é—´</li>
<li>é‡‡ç”¨<strong>çƒ­å¤‡é…ç½®</strong><span>(hot-spare configuration)<span class="heti-spacing"> </span></span>å¯ä½¿å¤‡ç”¨ç«™ç‚¹çš„æ¥ç®¡å‡ ä¹ç¬é—´å®Œæˆ<ul>
<li>åœ¨æ­¤é…ç½®ä¸‹ï¼Œè¿œç¨‹å¤‡ä»½ç«™ç‚¹ä¼šæŒç»­å¤„ç†åˆ°è¾¾çš„é‡åšæ—¥å¿—è®°å½•ï¼Œå¹¶åœ¨æœ¬åœ°åº”ç”¨è¿™äº›æ›´æ–°</li>
<li>ä¸€æ—¦æ£€æµ‹åˆ°ä¸»ç«™ç‚¹æ•…éšœï¼Œå¤‡ç”¨ç«™ç‚¹é€šè¿‡å›æ»šæœªå®Œæˆäº‹åŠ¡æ¥å®Œæˆæ¢å¤ï¼Œéšåå³å¯ç«‹å³å¤„ç†æ–°äº‹åŠ¡</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>æäº¤æ—¶é—´</strong>(time to commit)ï¼š</p>
<ul>
<li>ä¸ºç¡®ä¿å·²æäº¤äº‹åŠ¡çš„æ›´æ–°å…·æœ‰æŒä¹…æ€§ï¼Œäº‹åŠ¡åœ¨å…¶æ—¥å¿—è®°å½•é€è¾¾å¤‡ä»½ç«™ç‚¹ä¹‹å‰ä¸å¾—å£°æ˜ä¸ºå·²æäº¤</li>
<li>
<p>è¿™ä¸€å»¶è¿Ÿå¯èƒ½å¯¼è‡´äº‹åŠ¡æäº¤ç­‰å¾…æ—¶é—´å»¶é•¿ï¼Œå› æ­¤éƒ¨åˆ†ç³»ç»Ÿå…è®¸é‡‡ç”¨è¾ƒä½çº§åˆ«çš„æŒä¹…æ€§ä¿éšœã€‚æŒä¹…æ€§çº§åˆ«å¯åˆ†ç±»å¦‚ä¸‹ï¼š</p>
<ul>
<li>
<p><strong>ä¸€çº§å®‰å…¨</strong>(one-safe)ï¼šå½“äº‹åŠ¡çš„æäº¤æ—¥å¿—è®°å½•å†™å…¥ä¸»ç«™ç‚¹çš„ç¨³å®šå­˜å‚¨å™¨åå°±ç«‹å³æäº¤</p>
<ul>
<li>é—®é¢˜ï¼šå½“å¤‡ä»½ç«™ç‚¹æ¥ç®¡å¤„ç†æ—¶ï¼Œå·²æäº¤äº‹åŠ¡çš„æ›´æ–°å¯èƒ½å°šæœªåŒæ­¥è‡³å¤‡ä»½ç«™ç‚¹ï¼Œå¯¼è‡´è¿™äº›æ›´æ–°çœ‹ä¼¼ä¸¢å¤±ã€‚å¾…ä¸»ç«™ç‚¹æ¢å¤åï¼Œç”±äºä¸¢å¤±çš„æ›´æ–°å¯èƒ½ä¸å¤‡ä»½ç«™ç‚¹åç»­æ‰§è¡Œçš„æ›´æ–°äº§ç”Ÿå†²çªï¼Œæ— æ³•ç›´æ¥åˆå¹¶æ•°æ®å·®å¼‚ï¼Œæ­¤æ—¶å¯èƒ½éœ€è¦äººå·¥å¹²é¢„æ‰èƒ½ä½¿æ•°æ®åº“æ¢å¤ä¸€è‡´çŠ¶æ€ã€‚</li>
</ul>
</li>
<li>
<p><strong>äºŒçº§éå¸¸å®‰å…¨</strong>(two-very-safe)ï¼šä»…å½“äº‹åŠ¡çš„æäº¤æ—¥å¿—è®°å½•åŒæ—¶å†™å…¥ä¸»ç«™ç‚¹å’Œå¤‡ä»½ç«™ç‚¹çš„ç¨³å®šå­˜å‚¨å™¨åæ‰å…è®¸æäº¤</p>
<ul>
<li>è¯¥æœºåˆ¶çš„ç¼ºé™·æ˜¯ï¼šè‹¥ä¸»ç«™ç‚¹å’Œå¤‡ä»½ç«™ç‚¹ä¸­çš„ä»»æ„ä¸€ç«™ä¸å¯ç”¨ï¼Œå°±æ— æ³•ç»§ç»­å¤„ç†äº‹åŠ¡äº†ã€‚å°½ç®¡æ•°æ®ä¸¢å¤±æ¦‚ç‡å¤§å¹…é™ä½ï¼Œä½†å®é™…å¯ç”¨æ€§åè€Œä½äºå•ç‚¹éƒ¨ç½²æ–¹æ¡ˆã€‚</li>
</ul>
</li>
<li>
<p><strong>äºŒçº§å®‰å…¨</strong>(two-safe)ï¼šå½“ä¸»ç«™ç‚¹å’Œå¤‡ä»½ç«™ç‚¹éƒ½å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶ï¼Œä¸â€œäºŒçº§éå¸¸å®‰å…¨â€æœºåˆ¶ç›¸åŒï¼›è‹¥ä»…æœ‰ä¸»ç«™ç‚¹æ´»è·ƒæ—¶ï¼Œåˆ™å…è®¸äº‹åŠ¡åœ¨æ—¥å¿—è®°å½•å†™å…¥ä¸»ç«™ç‚¹çš„ç¨³å®šå­˜å‚¨å™¨åç«‹å³æäº¤ã€‚</p>
<ul>
<li>æ­¤æ–¹æ¡ˆåœ¨æä¾›æ¯”<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>äºŒçº§éå¸¸å®‰å…¨<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>æ›´é«˜å¯ç”¨æ€§çš„åŒæ—¶ï¼Œè§„é¿äº†<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>ä¸€çº§å®‰å…¨<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>å¯èƒ½é¢ä¸´çš„äº‹åŠ¡ä¸¢å¤±é—®é¢˜ã€‚è™½ç„¶å…¶æäº¤é€Ÿåº¦æ…¢äº<span class="heti-skip"><span class="heti-spacing"> </span>"<span class="heti-spacing"> </span></span>ä¸€çº§å®‰å…¨<span><span class="heti-spacing"> </span>"</span>ï¼Œä½†æ•´ä½“æ”¶ç›Šé€šå¸¸è¿œè¶…æ€§èƒ½ä»£ä»·ã€‚</li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>
<hr/>
<p>å°½ç®¡å¤‡ä»½æœåŠ¡å™¨æ— æ³•æ‰§è¡Œæ›´æ–°äº‹åŠ¡ï¼Œä½†å¤šæ•°æ•°æ®åº“ç³»ç»Ÿå…è®¸åœ¨å¤‡ç”¨ç«™ç‚¹å¤„ç†åªè¯»æŸ¥è¯¢ã€‚é€šè¿‡å°†éƒ¨åˆ†åªè¯»äº‹åŠ¡åˆ†æµè‡³å¤‡ä»½ç«™ç‚¹æ‰§è¡Œï¼Œå¯æœ‰æ•ˆå‡è½»ä¸»ç«™ç‚¹çš„è´Ÿè½½ã€‚å€ŸåŠ©å¿«ç…§éš”ç¦»æŠ€æœ¯ï¼Œå¤‡ä»½ç«™ç‚¹èƒ½ä¸ºè¯»å–æ“ä½œæä¾›äº‹åŠ¡çº§ä¸€è‡´è§†å›¾ï¼ŒåŒæ—¶ç¡®ä¿æ¥è‡ªä¸»ç«™ç‚¹çš„æ›´æ–°æ“ä½œå§‹ç»ˆä¸ä¼šè¢«é˜»å¡ã€‚</p></div>
<aside class="md-source-file">
<span class="md-source-file__fact">
<span class="md-icon" title="æœ€åæ›´æ–°">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2025å¹´6æœˆ22æ—¥ 19:26:01">2025å¹´6æœˆ22æ—¥ 19:26:01</span>
</span>
<span class="md-source-file__fact">
<span class="md-icon" title="åˆ›å»ºæ—¥æœŸ">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"></path></svg>
</span>
<span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-datetime" title="2024å¹´10æœˆ7æ—¥ 21:20:16">2024å¹´10æœˆ7æ—¥ 21:20:16</span>
</span>
</aside>
<p style="font-size: 30px; font-weight: 600">è¯„è®ºåŒº</p>
<div>
    å¦‚æœå¤§å®¶æœ‰ä»€ä¹ˆé—®é¢˜æˆ–æƒ³æ³•ï¼Œæ¬¢è¿åœ¨ä¸‹æ–¹ç•™è¨€~
  </div>
<!-- Insert generated snippet here -->
<script async="" crossorigin="anonymous" data-category="Announcements" data-category-id="DIC_kwDOMAb9Zs4CfmpP" data-emit-metadata="0" data-input-position="bottom" data-lang="zh-CN" data-mapping="pathname" data-reactions-enabled="1" data-repo="noughtq/notebook" data-repo-id="R_kgDOMAb9Zg" data-strict="0" data-theme="preferred_color_scheme" src="https://giscus.app/client.js">
</script>
<!-- Synchronize Giscus theme with palette -->
<script>
    var giscus = document.querySelector("script[src*=giscus]")

    // Set palette on initial load
    var palette = __md_get("__palette")
    if (palette && typeof palette.color === "object") {
      var theme = palette.color.scheme === "slate"
        ? "transparent_dark"
        : "light"

      // Instruct Giscus to set theme
      giscus.setAttribute("data-theme", theme) 
    }

    // Register event handlers after documented loaded
    document.addEventListener("DOMContentLoaded", function() {
      var ref = document.querySelector("[data-md-component=palette]")
      ref.addEventListener("change", function() {
        var palette = __md_get("__palette")
        if (palette && typeof palette.color === "object") {
          var theme = palette.color.scheme === "slate"
            ? "dark"
            : "light"

          // Instruct Giscus to change theme
          var frame = document.querySelector(".giscus-frame")
          frame.contentWindow.postMessage(
            { giscus: { setConfig: { theme } } },
            "https://giscus.app"
          )
        }
      })
    })
  </script>
<!-- æ ‡é¢˜è®¡æ•°å™¨ -->
<link href="/css/counter.css" rel="stylesheet"/>
<!-- ä¸»é¡µä¸ªæ€§åŒ– -->
</article>
</div>
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
</div>
<button class="md-top md-icon" data-md-component="top" hidden="" type="button">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"></path></svg>
  å›åˆ°é¡µé¢é¡¶éƒ¨
</button>
</main>
<footer class="md-footer">
<nav aria-label="é¡µè„š" class="md-footer__inner md-grid">
<a aria-label="ä¸Šä¸€é¡µ: Lec 14: Concurrency Control" class="md-footer__link md-footer__link--prev" href="14.html">
<div class="md-footer__button md-icon">
<svg viewbox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M9.4 233.4c-12.5 12.5-12.5 32.8 0 45.3l160 160c12.5 12.5 32.8 12.5 45.3 0s12.5-32.8 0-45.3L77.3 256l137.3-137.4c12.5-12.5 12.5-32.8 0-45.3s-32.8-12.5-45.3 0l-160 160z" fill="currentColor"></path></svg>
</div>
<div class="md-footer__title">
<span class="md-footer__direction">
                ä¸Šä¸€é¡µ
              </span>
<div class="md-ellipsis">
                Lec 14: Concurrency Control
              </div>
</div>
</a>
<a aria-label="ä¸‹ä¸€é¡µ: Web ç›¸å…³" class="md-footer__link md-footer__link--next" href="../../web/index.html">
<div class="md-footer__title">
<span class="md-footer__direction">
                ä¸‹ä¸€é¡µ
              </span>
<div class="md-ellipsis">
                Web ç›¸å…³
              </div>
</div>
<div class="md-footer__button md-icon">
<svg viewbox="0 0 256 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M247.1 233.4c12.5 12.5 12.5 32.8 0 45.3l-160 160c-12.5 12.5-32.8 12.5-45.3 0s-12.5-32.8 0-45.3L179.2 256 41.9 118.6c-12.5-12.5-12.5-32.8 0-45.3s32.8-12.5 45.3 0l160 160z" fill="currentColor"></path></svg>
</div>
</a>
</nav>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-copyright" style="margin-left: 33.5%">
<div class="md-copyright__highlight" style="text-align: center">
        Copyright Â© 2024-2025 <a href="https://github.com/NoughtQ">NoughtQ</a>
</div>
    
    
      Powered by
      <a href="https://www.mkdocs.org/" rel="noopener" target="_blank">
        MkDocs
      </a>
      with theme
      <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
        Material
      </a>
      modified by
      <a href="https://github.com/NoughtQ" rel="noopener" target="_blank">
        NoughtQ
      </a>
<!-- <br> -->
<div style="text-align: center;">
<a href="https://icp.gov.moe/?keyword=20252357" target="_blank">èŒICPå¤‡20252357å·</a>
</div>
</div>
<div class="md-social">
<a class="md-social__link" href="https://noughtq.top" rel="noopener" target="_blank" title="noughtq.top">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M277.8 8.6c-12.3-11.4-31.3-11.4-43.5 0l-224 208c-9.6 9-12.8 22.9-8 35.1S18.8 272 32 272h16v176c0 35.3 28.7 64 64 64h288c35.3 0 64-28.7 64-64V272h16c13.2 0 25-8.1 29.8-20.3s1.6-26.2-8-35.1zM240 320h32c26.5 0 48 21.5 48 48v96H192v-96c0-26.5 21.5-48 48-48" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://blog.noughtq.top" rel="noopener" target="_blank" title="blog.noughtq.top">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M224 24c0-13.3 10.7-24 24-24 145.8 0 264 118.2 264 264 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-119.3-96.7-216-216-216-13.3 0-24-10.7-24-24M80 96c26.5 0 48 21.5 48 48v224c0 26.5 21.5 48 48 48s48-21.5 48-48-21.5-48-48-48c-8.8 0-16-7.2-16-16v-64c0-8.8 7.2-16 16-16 79.5 0 144 64.5 144 144s-64.5 144-144 144S32 447.5 32 368V144c0-26.5 21.5-48 48-48m168 0c92.8 0 168 75.2 168 168 0 13.3-10.7 24-24 24s-24-10.7-24-24c0-66.3-53.7-120-120-120-13.3 0-24-10.7-24-24s10.7-24 24-24" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="https://github.com/noughtq" rel="noopener" target="_blank" title="github.com">
<svg viewbox="0 0 512 512" xmlns="http://www.w3.org/2000/svg"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2" fill="currentColor"></path></svg>
</a>
<a class="md-social__link" href="mailto:noughtq666@gmail.com" rel="noopener" target="_blank" title="">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="m20 8-8 5-8-5V6l8 5 8-5m0-2H4c-1.11 0-2 .89-2 2v12a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V6a2 2 0 0 0-2-2"></path></svg>
</a>
</div>
</div>
</div>
</footer>
</div>
<div class="md-dialog" data-md-component="dialog">
<div class="md-dialog__inner md-typeset"></div>
</div>
<script id="__config" type="application/json">{"base": "../..", "features": ["content.action.edit", "content.action.view", "content.code.copy", "content.code.annotate", "content.footnote.tooltips", "navigation.tabs", "navigation.top", "navigation.footer", "navigation.indexes", "navigation.tracking", "navigation.prune", "search.share"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": null}</script>
<script src="../../assets/javascripts/bundle.92b07e13.min.js"></script>
<script src="../../js/anchor.js"></script>
<script src="../../js/katex.js"></script>
<script src="../../js/toc.js"></script>
<script src="../../js/typed.js"></script>
<script src="../../js/custom.js"></script>
<script src="https://unpkg.com/katex@0/dist/katex.min.js"></script>
<script src="https://unpkg.com/katex@0/dist/contrib/auto-render.min.js"></script>
</body>
</html>