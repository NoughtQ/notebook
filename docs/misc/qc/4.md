---
counter: true
---

# é‡å­ç®—æ³•

## é‡å­å‚…é‡Œå¶å˜æ¢

### å‚…é‡Œå¶å˜æ¢

- é€šè¿‡ä¸åŒçš„è§’åº¦å¯ä»¥å‘ç°äº‹ç‰©ä¸åŒçš„ç‰¹å¾ï¼Œä¿¡å·ä¹Ÿæ˜¯è¿™æ ·
- **å‚…é‡Œå¶å˜æ¢**å°±æ˜¯ä¸ºä¿¡å·åœ¨**æ—¶åŸŸ**è¡¨ç¤ºå’Œ**é¢‘åŸŸ**è¡¨ç¤ºä¹‹é—´çš„è½¬æ¢æä¾›äº†ä¸€ä¸ªæ¡¥æ¢
    - å½“æˆ‘ä»¬ä½¿ç”¨å‚…é‡Œå¶å˜æ¢æ¥åˆ†æä¸€ä¸ªéŸ³é¢‘ä¿¡å·æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥å°†å…¶çœ‹ä½œæ˜¯**æ—¶åŸŸä¸­çš„æ³¢å½¢**
    - ç»è¿‡å‚…é‡Œå¶å˜æ¢åï¼Œæˆ‘ä»¬å¯ä»¥å°†è¿™ä¸ªä¿¡å·è½¬æ¢ä¸º**é¢‘åŸŸä¸­çš„é¢‘ç‡åˆ†é‡**
    - æ¯ä¸ªå³°è¡¨ç¤ºäº†è¾“å…¥ä¿¡å·ä¸­çš„ä¸€ä¸ªé¢‘ç‡åˆ†é‡ï¼Œå…¶é«˜åº¦è¡¨ç¤ºäº†è¯¥**é¢‘ç‡åœ¨åŸå§‹ä¿¡å·ä¸­çš„å¼ºåº¦**
    
    <div style="text-align: center">
        <img src="images/lec4/1.png" width=40% />
    </div>

- å‚…é‡Œå¶å˜æ¢ä½¿å¾—äººä»¬èƒ½ä»èƒ½é‡çš„è§’åº¦çœ‹å¾…ä¿¡å·ï¼ŒåŒæ—¶å¤§å¤§ç®€åŒ–äº†ä¿¡å·å¤„ç†ä¸­æ‰€éœ€è¦çš„è®¡ç®—é‡
- å‚…é‡Œå¶å˜æ¢åœ¨ç°ä»£ç¤¾ä¼šä¸­å¾—åˆ°äº†å¹¿æ³›åº”ç”¨ï¼Œä¾‹å¦‚æ‰‹æœºä¸­çš„é€šä¿¡æ¨¡å—æ— æ—¶æ— åˆ»ä¸åœ¨è¿›è¡Œå‚…é‡Œå¶å˜æ¢

å¹¿æ³›çš„åº”ç”¨åœºæ™¯ï¼š

- åˆ†è§£ä¿¡å·é¢‘ç‡æˆåˆ†ï¼Œä¼˜åŒ–ä¿¡å·ä¼ è¾“è´¨é‡
- å£°éŸ³ç‰¹æ•ˆå¤„ç†ä¸åˆ†æï¼Œå˜æ¢å£°éŸ³ç‰¹å¾ç­‰
- å¤„ç†åœ°éœ‡ä¿¡å·ï¼Œäº†è§£åœ°è´¨ç»“æ„

ä½†å®é™…ä¸Šï¼Œå‚…é‡Œå¶å˜æ¢æ—©åœ¨ 18 ä¸–çºªå°±ç”±è®©Â·å·´æ™®è’‚æ–¯Â·çº¦ç‘Ÿå¤«Â·å‚…é‡Œå¶ï¼ˆBaron Jean Baptiste Joseph Fourierï¼‰æå‡ºï¼Œä½†å…¶çœŸæ­£å¾—åˆ°å¿«é€Ÿå‘å±•å’Œå¹¿æ³›ä½¿ç”¨å´å·²æ˜¯åœ¨ 19 ä¸–çºª 60 å¹´ä»£ **FFT**ï¼ˆFast Fourier Transformï¼Œ**å¿«é€Ÿå‚…é‡Œå¶å˜æ¢**ï¼‰ç®—æ³•å‘æ˜åï¼ŒæœŸé—´é—´éš”äº†è¿‘ä¸¤ç™¾å¹´ã€‚


### ç¦»æ•£å‚…é‡Œå¶å˜æ¢

**ç¦»æ•£å‚…é‡Œå¶å˜æ¢**ï¼ˆ**DFT**ï¼‰æ˜¯ç”¨äºå°†ç¦»æ•£ä¿¡å·ä»æ—¶åŸŸè½¬æ¢åˆ°é¢‘åŸŸçš„ä¸€ç§æ•°å­¦å·¥å…·ã€‚å®ƒå°†ä¸€ç³»åˆ—ç­‰é—´éš”é‡‡æ ·çš„ä¿¡å·è¡¨ç¤ºä¸ºä¸åŒé¢‘ç‡æˆåˆ†çš„ç»„åˆï¼Œç”¨ä»¥åˆ†æä¿¡å·çš„é¢‘ç‡ç‰¹æ€§ã€‚DFT æ˜¯å‚…é‡Œå¶å˜æ¢åœ¨**ç¦»æ•£æƒ…å†µ**ä¸‹çš„å¯¹åº”å½¢å¼ï¼Œç‰¹åˆ«é€‚ç”¨äº**å¤„ç†æ•°å­—ä¿¡å·å’Œæœ‰é™é•¿åº¦çš„æ•°æ®åºåˆ—**ã€‚

- ç¦»æ•£å‚…é‡Œå¶å˜æ¢

    $$
    \{x_j\} \xrightarrow{\text{DFT}} \{y_k\} \\
    y_k = \frac{1}{\sqrt{N}} \sum_{j=0}^{N-1} x_j e^{\frac{2\pi i}{N} \cdot j k}
    $$

- é€†ç¦»æ•£å‚…é‡Œå¶å˜æ¢

    $$
    \{y_k\} \xrightarrow{\text{IDFT}} \{x_j\} \\
    x_j = \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1} y_k e^{-\frac{2\pi i}{N} \cdot j k}
    $$


### é‡å­å‚…é‡Œå¶å˜æ¢

**é‡å­å‚…é‡Œå¶å˜æ¢**ï¼ˆ**QFT**ï¼‰çš„ä½œç”¨æ˜¯å°†é‡å­æ€ä»è®¡ç®—åŸº $\{|j\rangle\}$ æ˜ å°„è‡³é¢‘åŸŸåŸº Û§$\{|k\rangle\}$ ï¼Œå…¶ä¸­æŒ¯å¹…åºåˆ— $\{x_j\}$ ç”± DFT å˜æ¢ä¸º $\{y_k\}$ã€‚
$$
\sum_{k=0}^{N-1} y_k |k\rangle \xleftarrow{\text{QFT}} \sum_{j=0}^{N-1} x_j |j\rangle
$$

QFT ä½œä¸ºé‡å­ç®—ç¬¦å³å®šä¹‰ä¸ºï¼š
$$
\text{QFT}|j\rangle = \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1} e^{\frac{2\pi i}{N} \cdot j k} |k\rangle
$$

QFT ä¸ä»…æ˜¯ DFT çš„é‡å­è®¡ç®—å®ç°ï¼ŒåŒæ ·æ˜¯ä¼—å¤šé‡å­ç®—æ³•ï¼ˆQPEã€Shorï¼‰çš„å­æ¨¡å—ã€‚

<div style="text-align: center">
    <img src="images/lec4/2.png" width=60% />
</div>


#### å¼ é‡ç§¯å½¢å¼

ä¸ºåˆ†æåŸºäºé‡å­æ¯”ç‰¹çš„ QFT ç®—æ³•ç”µè·¯å®ç°ï¼Œè§„å®šä»¥ä¸‹è®°æ³•ï¼š

- åŸºæ€ $|j\rangle$ è¡¨ç¤ºä¸º $|j_1j_2\cdots j_n\rangle$ï¼Œå³ $j = 2^{n-1}j_1 + 2^{n-2}j_2 + \cdots + 2^0j_n$
- ç”¨ $0.j_1j_2\cdots j_n$ è¡¨ç¤ºå°æ•° $2^{-1}j_1 + 2^{-2}j_2 + \cdots + 2^{-n}j_n$

è‹¥ä½¿ç”¨ $n$ ä¸ªé‡å­æ¯”ç‰¹æ‰§è¡Œé‡å­å‚…é‡Œå¶å˜æ¢ï¼Œåˆ™å…±æœ‰ $2^n$ ä¸ªåŸºæ€ï¼Œ$N = 2^n$ã€‚
$$
\text{QFT}|j\rangle = \frac{1}{\sqrt{N}} \sum_{k=0}^{N-1} e^{\frac{2\pi i}{N} \cdot j k} |k\rangle
$$

ä¸Šè¿° QFT ç®—ç¬¦å¯å†™ä½œå¦‚ä¸‹çš„å¼ é‡ç§¯å½¢å¼ï¼š
$$
\text{QFT}|j_1j_2\cdots j_n\rangle = \frac{1}{\sqrt{2^n}} \left( |0\rangle + e^{2\pi i \cdot 0.j_n}|1\rangle \right) \left( |0\rangle + e^{2\pi i \cdot 0.j_{n-1}j_n}|1\rangle \right) \cdots \left( |0\rangle + e^{2\pi i \cdot 0.j_1j_2\cdots j_n}|1\rangle \right)
$$

å¼ é‡ç§¯å½¢å¼æœ‰åŠ©äºæ„å»º $\text{QFT}$ çš„é‡å­ç”µè·¯å¹¶è¯æ˜å…¶é…‰æ€§ã€‚

ä¸‹é¢è¯æ˜ QFT å¼ é‡ç§¯å½¢å¼çš„æ­£ç¡®æ€§ï¼š

???+ proof "è¯æ˜"

    1. å°†é¢‘åŸŸåŸºåŒæ ·å±•å¼€ä¸ºäºŒè¿›åˆ¶è¡¨ç¤º

        $$
        \begin{aligned}
        \text{QFT}|j\rangle & = \frac{1}{\sqrt{2^n}} \sum_{k=0}^{N-1} e^{\frac{2\pi i}{N} \cdot j k} |k\rangle \\
        & = \frac{1}{\sqrt{2^n}} \sum_{k_1=0}^{1} \cdots \sum_{k_n=0}^{1} e^{\frac{2\pi i}{2^n} \cdot j \sum_{l=1}^n k_l 2^{n-l}} |k_1 \cdots k_n\rangle \\
        & = \frac{1}{\sqrt{2^n}} \sum_{k_1=0}^{1} \cdots \sum_{k_n=0}^{1} e^{2\pi i j \sum_{l=1}^n k_l 2^{-l}} |k_1 \cdots k_n\rangle
        \end{aligned}
        $$

    2. $e$ çš„æŒ‡æ•°ä¸­çš„æ±‚å’Œæ‹†è§£è‡³å¼ é‡ç§¯ä¸­

        $$
        \begin{aligned}
        \text{QFT}|j\rangle & = \frac{1}{\sqrt{2^n}} \sum_{k=0}^{N-1} e^{\frac{2\pi i}{N} \cdot j k} |k\rangle \\
        & = \frac{1}{\sqrt{2^n}} \sum_{k_1=0}^{1} \cdots \sum_{k_n=0}^{1} e^{2\pi i j \sum_{l=1}^n k_l 2^{-l}} |k_1 \cdots k_n\rangle \\
        & = \frac{1}{\sqrt{2^n}} \sum_{k_1=0}^{1} \cdots \sum_{k_n=0}^{1} \bigotimes_{l=1}^n e^{2\pi i j k_l 2^{-l}} |k_l\rangle
        \end{aligned}
        $$

    3. äº¤æ¢æ±‚å’Œä¸å¼ é‡ç§¯çš„è¿ç®—é¡ºåº

        $$
        \begin{aligned}
        \text{QFT}|j\rangle & = \frac{1}{\sqrt{2^n}} \sum_{k=0}^{N-1} e^{\frac{2\pi i}{N} \cdot j k} |k\rangle \\
        & = \frac{1}{\sqrt{2^n}} \sum_{k_1=0}^{1} \cdots \sum_{k_n=0}^{1} \bigotimes_{l=1}^n e^{2\pi i j k_l 2^{-l}} |k_l\rangle \\
        & = \frac{1}{\sqrt{2^n}} \bigotimes_{l=1}^n \sum_{k_l=0}^{1} e^{2\pi i j k_l 2^{-l}} |k_l\rangle
        \end{aligned}
        $$

    4. å±•å¼€ $k_l$ æ±‚å’Œ

        $$
        \begin{aligned}
        \text{QFT}|j\rangle & = \frac{1}{\sqrt{2^n}} \sum_{k=0}^{N-1} e^{\frac{2\pi i}{N} \cdot j k} |k\rangle \\
        & = \frac{1}{\sqrt{2^n}} \bigotimes_{l=1}^n \sum_{k_l=0}^{1} e^{2\pi i j k_l 2^{-l}} |k_l\rangle \\
        & = \frac{1}{\sqrt{2^n}} \bigotimes_{l=1}^n \left( |0\rangle + e^{2\pi i j 2^{-l}} |1\rangle \right)
        \end{aligned}
        $$

    5. æ ¹æ® $e^{2 \pi i} = 1$ï¼Œå¯å°† $j2^{-l}$ çš„æ•´æ•°éƒ¨åˆ†ç•¥å»

        $$
        \begin{aligned}
        \text{QFT}|j\rangle & = \frac{1}{\sqrt{2^n}} \sum_{k=0}^{N-1} e^{\frac{2\pi i}{N} \cdot j k} |k\rangle \\
        & = \frac{1}{\sqrt{2^n}} \bigotimes_{l=1}^n \left( |0\rangle + e^{2\pi i j 2^{-l}} |1\rangle \right) \\
        & = \frac{1}{\sqrt{2^n}} \left( |0\rangle + e^{2\pi i 0.j_n} |1\rangle \right) \left( |0\rangle + e^{2\pi i 0.j_{n-1}j_n} |1\rangle \right) \cdots \left( |0\rangle + e^{2\pi i 0.j_1j_2\cdots j_n} |1\rangle \right)
        \end{aligned}
        $$


#### ç¤ºä¾‹

=== "å•æ¯”ç‰¹ç³»ç»Ÿ"

    è€ƒè™‘å•æ¯”ç‰¹ç³»ç»Ÿä¸‹çš„ QFT ç®—ç¬¦

    $$
    \begin{aligned}\mathrm{QFT}_1|j\rangle=\frac{1}{\sqrt{2}}\sum_{k=0}^{1}e^{\frac{2\pi i}{2}\cdot jk}|k\rangle\end{aligned}
    $$

    å¯¹äºè®¡ç®—åŸº $|0\rangle, |1\rangle$ æœ‰ï¼š

    $$
    \begin{aligned}\mathrm{QFT}_1|0\rangle&=\frac{1}{\sqrt{2}}\left(|0\rangle+|1\rangle\right)\\\mathrm{QFT}_1|1\rangle&=\frac{1}{\sqrt{2}}\left(|0\rangle-|1\rangle\right)\end{aligned}
    $$

    ç”±çŸ©é˜µå½¢å¼å¯çŸ¥ï¼Œå•æ¯”ç‰¹çš„ QFT ç®—ç¬¦å’Œ H é—¨ç­‰ä»·

    $$
    \mathrm{QFT}_1=\frac{1}{\sqrt{2}}\begin{bmatrix}1&1\\1&-1\end{bmatrix}=H
    $$

    ---
    è€ƒè™‘å¯¹å•æ¯”ç‰¹æ€ $|\psi\rangle=\alpha|0\rangle+\beta|1\rangle$ æ‰§è¡Œ QFT è¿‡ç¨‹ï¼š
    $$
    y_k=\frac{1}{\sqrt{2}}\sum_{j=0}^1x_je^{\frac{2\pi i}{2}\cdot jk}
    $$

    å…¶ä¸­ $x_0 = \alpha, x_1 = \beta$ï¼Œäºæ˜¯æœ‰ï¼š

    $$
    y_0=\frac{1}{\sqrt{2}}\left(\alpha+\beta\right) \\
    y_1=\frac{1}{\sqrt{2}}\left(\alpha-\beta\right)
    $$

    åŒæ ·å¯çŸ¥ï¼Œå•æ¯”ç‰¹çš„ QFT ç®—ç¬¦å’Œ H é—¨ç­‰ä»·ï¼š
    $$
    \mathrm{QFT}_1|\psi\rangle=\frac{1}{\sqrt{2}}\left(\alpha+\beta\right)|0\rangle+\frac{1}{\sqrt{2}}\left(\alpha-\beta\right)|1\rangle=H|\psi\rangle
    $$

=== "åŒæ¯”ç‰¹ç³»ç»Ÿ"

    è€ƒè™‘åŒæ¯”ç‰¹ç³»ç»Ÿä¸‹çš„ QFT ç®—ç¬¦

    $$
    \mathrm{QFT}_2|j\rangle=\frac{1}{\sqrt{4}}\sum_{k=0}^3e^{\frac{2\pi i}{4}\cdot jk}|k\rangle=\frac{1}{\sqrt{4}}\left(|0\rangle+e^{2\pi i\overline{0.j_2}}|1\rangle\right)\left(|0\rangle+e^{2\pi i\overline{0.j_1j_2}}|1\rangle\right)
    $$

    å¯¹äºè®¡ç®—åŸº $|2\rangle = |10\rangle$ æœ‰
    $$
    \mathrm{QFT}_2|10\rangle=\frac{1}{2}\left(|00\rangle-|01\rangle+|10\rangle-|11\rangle\right)=\frac{1}{2}\left(|0\rangle+|1\rangle\right)\left(|0\rangle-|1\rangle\right)
    $$


#### é‡å­ç”µè·¯

ä¸ºæ„å»º QFT çš„é‡å­ç”µè·¯ï¼Œå®šä¹‰å¦‚ä¸‹å½¢å¼çš„å•æ¯”ç‰¹ç›¸ä½æ—‹è½¬é—¨

$$
R_k=\begin{bmatrix}1&0\\0&e^{\frac{2\pi i}{2^k}}\end{bmatrix},\quad k=2,\cdots,n
$$

QFT å¯ç”±å¦‚ä¸‹é‡å­ç”µè·¯å®ç°

- QFTç”µè·¯ä¸­ä»…ä½¿ç”¨äº† Hadamard é—¨å’Œå—æ§æ—‹è½¬é—¨ã€‚ç”µè·¯ä¸­æ‰€æœ‰é‡å­é—¨éƒ½æ˜¯é…‰çš„ï¼ŒQFTæ— ç–‘æ˜¯**é…‰å˜æ¢**

<div style="text-align: center">
    <img src="images/lec4/3.png" width=80% />
</div>

ä¸‹é¢éªŒè¯ QFT çš„é‡å­ç”µè·¯æ‰§è¡Œè¿‡ç¨‹ï¼š

- å½“ $j_1 = 1$ æ—¶ï¼Œ $e^{2\pi i \overline{0.j_1}} = -1$ï¼Œå¦åˆ™ä¸º $1$ã€‚å› æ­¤ï¼Œç»è¿‡ä¸€ä¸ª $\text{H}$ é—¨åç³»ç»Ÿé‡å­æ€å˜ä¸º $\frac{1}{\sqrt{2}}\left(|0\rangle + e^{2\pi i \overline{0.j_1}}|1\rangle\right)\Big|\overline{j_2\cdots j_n}\Big\rangle$ã€‚
- å½“ $j_2 = 1$ æ—¶ï¼Œæ‰§è¡Œå—æ§æ—‹è½¬é—¨ $R_2$ï¼Œå°† $|j_1\rangle$ ç›¸ä½ä¹˜ä»¥ $e^{2\pi i \overline{0.0.j_2}}$ã€‚æ­¤æ—¶ï¼Œç³»ç»Ÿé‡å­æ€å˜ä¸º $\frac{1}{\sqrt{2}}\left(|0\rangle + e^{2\pi i \overline{0.j_1j_2}}|1\rangle\right)\Big|\overline{j_2\cdots j_n}\Big\rangle$ã€‚
- ä»¥æ­¤ç±»æ¨ï¼Œæ‰§è¡Œé’ˆå¯¹ç¬¬ä¸€ä¸ªé‡å­æ¯”ç‰¹çš„æ‰€æœ‰å—æ§æ—‹è½¬é—¨ï¼Œæ­¤æ—¶ç³»ç»Ÿé‡å­æ€å˜ä¸º $\frac{1}{\sqrt{2}}\left(|0\rangle + e^{2\pi i \overline{0.j_1j_2 \dots j_n}}|1\rangle\right)\Big|\overline{j_2\cdots j_n}\Big\rangle$ã€‚
- åŒç†ï¼Œæ‰§è¡Œé’ˆå¯¹å‰©ä½™é‡å­æ¯”ç‰¹çš„æ‰€æœ‰ H é—¨å’Œå—æ§æ—‹è½¬é—¨ã€‚æœ€ç»ˆï¼Œç³»ç»Ÿé‡å­æ€å˜ä¸º

    $$
    \frac{1}{\sqrt{2^n}}\left(|0\rangle+e^{2\pi i\overline{0.j_1j_2\cdots j_n}}|1\rangle\right)\left(|0\rangle+e^{2\pi i\overline{0.j_2\cdots j_n}}|1\rangle\right)\cdotp\cdotp\cdotp\left(|0\rangle+e^{2\pi i\overline{0.j_n}}|1\rangle\right)
    $$

å¯¹æ¯” QFT çš„å¼ é‡ç§¯å½¢å¼ï¼Œå‘ç°ç”µè·¯æœ«ç«¯çš„æ€å’Œå¼ é‡ç§¯å½¢å¼**é¡ºåºç›¸å**ï¼Œå†åŠ **ä¸€äº› SWAP é—¨**å³å¯ã€‚

å¤æ‚åº¦åˆ†æï¼šè§‚å¯Ÿé‡å­ç”µè·¯æ˜“çŸ¥ï¼ŒQFT çš„é‡å­é—¨å¤æ‚åº¦ä¸º $O(n^2)$ã€‚


#### åŒæ¯”ç‰¹é‡å­ç”µè·¯

ç”±ä¸Šè¿°åˆ†æå¯çŸ¥ï¼ŒåŒæ¯”ç‰¹çš„ QFT é‡å­ç”µè·¯å¦‚ä¸‹æ‰€ç¤ºï¼š

<div style="text-align: center">
    <img src="images/lec4/4.png" width=30% />
</div>

1. å‡è®¾å¯¹ $|\psi\rangle = |10\rangle$ è¿›è¡Œ QFT æ“ä½œï¼Œé¦–å…ˆä½œç”¨ H é—¨ï¼Œå¾—åˆ° $H|10\rangle = \frac{1}{\sqrt{2}}(|0\rangle - |1\rangle) \otimes |0\rangle$
2. ç„¶åä½œç”¨å—æ§ R~2~ é—¨ï¼Œæ­¤æ—¶æ€ä¸å˜
3. æœ€åå¯¹ $|j_2\rangle$ ä½œç”¨ H é—¨ï¼Œå¾—åˆ° $\frac{1}{\sqrt{2}}(|0\rangle - |1\rangle) \otimes \frac{1}{\sqrt{2}}(|0\rangle + |1\rangle)$
4. ç„¶å SWAP é—¨äº¤æ¢é‡å­æ€ï¼Œå¾—åˆ° $\frac{1}{2}(|0\rangle + |1\rangle) \otimes (|0\rangle - |1\rangle)$
5. æœ€ç»ˆåŒ–ç®€åå¾—åˆ° $\frac{1}{2}|00\rangle - \frac{1}{2}|01\rangle + \frac{1}{2}|10\rangle - \frac{1}{2}|11\rangle$


## é‡å­ç›¸ä½ä¼°è®¡

**é‡å­ç›¸ä½ä¼°è®¡**ï¼ˆ**QPE**ï¼‰ç”¨äºä¼°è®¡ç»™å®šé‡å­æ€çš„ç›¸ä½ä¿¡æ¯ã€‚å®ƒæ˜¯è®¸å¤šé‡å­ç®—æ³•çš„æ ¸å¿ƒç»„æˆéƒ¨åˆ†ï¼Œåœ¨é‡å­æ¨¡æ‹Ÿã€é‡å­åŒ–å­¦å’Œé‡å­æœºå™¨å­¦ä¹ ä¸­å…·æœ‰å¹¿æ³›åº”ç”¨ã€‚

åŸºæœ¬ç›®æ ‡ï¼šå¯¹äºä¸€ä¸ªé…‰ç®—ç¬¦ $U$ï¼Œå·²çŸ¥å…¶æœ¬å¾æ€ $|\mu\rangle$ï¼Œå¯¹åº”æœ¬å¾å€¼ä¸º $e^{2\pi i \varphi}$ï¼Œä¼°è®¡ç›¸ä½ $\varphi$ çš„å€¼ï¼Œå…¶ä¸­ $\varphi \in [0, 1)$ã€‚

ç®—æ³•æµç¨‹ï¼š

- **åˆå§‹åŒ–**ï¼šå‡†å¤‡ä¸¤ä¸ªé‡å­å¯„å­˜å™¨ï¼Œä¸€ä¸ªå­˜å‚¨ç›¸ä½ä¼°è®¡ç»“æœï¼Œå¦ä¸€ä¸ªå­˜å‚¨æœ¬å¾æ€ $|u\rangle$
- **ä½œç”¨ H é—¨**ï¼šå¯¹ç”¨äºå­˜å‚¨ç›¸ä½çš„é‡å­æ¯”ç‰¹æ–½åŠ  H é—¨
- **ä½œç”¨å—æ§ U é—¨**ï¼šå¯¹æ¯ä¸ªé‡å­æ¯”ç‰¹æ‰§è¡Œå—æ§ U é—¨æ“ä½œï¼ˆç¬¬ j ä¸ªé‡å­æ¯”ç‰¹æ‰§è¡Œå—æ§ $U^{2^{j-1}}$ é—¨ï¼‰
- **é€† QFT**ï¼šå¯¹ç›¸ä½å¯„å­˜å™¨è¿›è¡Œé€† QFT æ“ä½œï¼Œå°†ç›¸ä½ä¿¡æ¯è½¬ä¸ºä½ä¿¡æ¯
- **æµ‹é‡**ï¼šè·å¾—ç›¸ä½ä¼°è®¡å€¼


### QPE é‡å­ç”µè·¯

<div style="text-align: center">
    <img src="images/lec4/5.png" width=50% />
</div>

- **å¯„å­˜å™¨ 1** ç”¨æ¥å­˜å‚¨æœ€ç»ˆçš„ç‰¹å¾å€¼
- **å¯„å­˜å™¨ 2** ç”¨æ¥å­˜å‚¨è¾“å…¥çš„ç‰¹å¾å‘é‡
- è€Œ**é…‰ç®—å­ U** é€šè¿‡å—æ§ U é—¨è¾“å…¥åˆ°é‡å­ç”µè·¯ä¸­

#### ç¬¬ä¸€é˜¶æ®µ

ä½œç”¨ H é—¨ä¸å—æ§ U é—¨ï¼š

<div style="text-align: center">
    <img src="images/lec4/6.png" width=50% />
</div>

ä½œç”¨ H é—¨ï¼š

<div style="text-align: center">
    <img src="images/lec4/7.png" width=50% />
</div>

ä½œç”¨å—æ§ U é—¨ï¼š

<div style="text-align: center">
    <img src="images/lec4/8.png" width=40% />
</div>

åœ¨ $\text{R}_p$ ä¸­ï¼Œ**ä»ä¸‹å¾€ä¸Š**è®¾ç½®é‡å­æ€ä¸º $|j_1\rangle, |j_2\rangle, \ldots, |j_n\rangle$ï¼Œåˆ™æœ‰

$$
|j_i\rangle|\mu\rangle \xrightarrow{CU^{2^i}} |j_i\rangle U^{2^i}|j_i\rangle|\mu\rangle
$$

å› ä¸º $U|\mu\rangle = e^{2\pi i \varphi}|\mu\rangle$ï¼Œåˆ™æœ‰

$$
|j_i\rangle U^{2^i}|j_i\rangle|\mu\rangle = \frac{1}{\sqrt{2}}(|0\rangle + e^{2\pi i 2^{i-1}\varphi}|1\rangle)|\mu\rangle
$$


#### ç¬¬äºŒé˜¶æ®µ

<div style="text-align: center">
    <img src="images/lec4/9.png" width=40% />
</div>

- $\varphi=\overline{0.\varphi_1\varphi_2\cdots\varphi_n}$
- QFT å¼ é‡ç§¯å½¢å¼ï¼š
  $$
  \frac{1}{\sqrt{2^n}} \left( |0\rangle + e^{2\pi i 0.\overline{\varphi_n}} |1\rangle \right) \left( |0\rangle + e^{2\pi i 0.\overline{\varphi_{n-1}\varphi_n}} |1\rangle \right) \cdots \left( |0\rangle + e^{2\pi i 0.\overline{\varphi_1\varphi_2\cdots \varphi_n}} |1\rangle \right)
  $$

- ä½œç”¨é€† QFT ç”µè·¯ï¼Œå³å¯å¾—åˆ° $\varphi$


#### ç»“æœ

<div style="text-align: center">
    <img src="images/lec4/10.png" width=40% />
</div>

$$
U_{QPE}|j\rangle|\mu\rangle=|\widetilde{\varphi}\rangle|\mu\rangle
$$

æ¼”åŒ–è¿‡ç¨‹ï¼š

$$
\begin{aligned}
|0\rangle^{\otimes n}|\mu\rangle & \xrightarrow{H^{\otimes n}} \frac{1}{\sqrt{2^n}}(|0\rangle + |1\rangle)^{\otimes n}|\mu\rangle \\
& \xrightarrow{CU\dots} \bigotimes_{k=0}^{n-1} \left( |0\rangle + e^{2\pi i 2^{n-1-k}\varphi} |1\rangle \right) \\
& \xrightarrow{QFT^\dagger} |\tilde{\varphi}\rangle|\mu\rangle
\end{aligned}
$$


### QPE è¿‡ç¨‹ä¸¾ä¾‹

=== "ä¾‹1ï¼šç²¾ç¡®è§£"

    é—®é¢˜ï¼šè€ƒè™‘ç›¸ä½æ—‹è½¬é—¨ $P(\varphi) = \begin{bmatrix} 1 & 0 \\ 0 & e^{i\varphi} \end{bmatrix}$ï¼Œå…¶æœ¬å¾æ€ä¹‹ä¸€ä¸º $|1\rangle$ã€‚å– $\varphi = \frac{\pi}{4}$ï¼Œå³ $P\left(\frac{\pi}{4}\right) = \begin{bmatrix} 1 & 0 \\ 0 & e^{i\frac{\pi}{4}} \end{bmatrix}$ï¼Œæ±‚å…¶å¯¹åº”æœ¬å¾å€¼çš„ç›¸ä½ã€‚

    ---
    - $q_0, q_1, q_2$ ä½œä¸ºç¬¬ä¸€ä¸ªå¯„å­˜å™¨ä¼°è®¡ç›¸ä½ï¼Œå‡åˆå§‹åŒ–ä¸º $|0\rangle$
    - $q_3$ ä½œä¸ºç¬¬äºŒä¸ªå¯„å­˜å™¨åˆå§‹åŒ–ä¸ºæœ¬å¾æ€ $|1\rangle$
    - è¿è¡Œ QPE ç”µè·¯ï¼Œè¾“å‡ºç›¸ä½çš„ä¸‰æ¯”ç‰¹ä¼°è®¡å€¼ä¸º $\varphi = (0.001)_2 = \frac{1}{8}$
    - éªŒè¯ä¸ $|1\rangle$ æ€æœ¬å¾å€¼ç†è®ºå€¼ç›¸ç¬¦ï¼š$e^{2\pi i \varphi} = e^{2\pi i \frac{1}{8}} = e^{i \frac{\pi}{4}} = e^{i\phi}$

    <div style="text-align: center">
        <img src="images/lec4/11.png" width=70% />
    </div>

    å¯¹äºæ—‹è½¬ç›¸ä½é—¨ $P(\phi) = \begin{pmatrix} 1 & 0 \\ 0 & e^{i\phi} \end{pmatrix}$

    - è‹¥ $\phi = \frac{\pi}{4}$ï¼Œç”µè·¯å¯ç²¾ç¡®ä¼°è®¡å‡ºç›¸ä½ $\varphi$
    - è‹¥ $\phi = \frac{2\pi}{3}$ï¼Œ$P\left(\frac{2\pi}{3}\right)|1\rangle=e^{i\frac{2\pi}{3}}|1\rangle=e^{2\pi i\varphi}, (011)_2 = \dfrac{3}{8}$ï¼Œç›¸æ¯”æ›´æ¥è¿‘

    ???+ warning "æ³¨æ„"

        ![](images/lec4/12.png){ align=right width=20% }

        - $\varphi = \dfrac{1}{3}$ ä¸èƒ½ç”±äºŒè¿›åˆ¶ç²¾ç¡®è¡¨ç¤º
        - å…±è®¡è¿è¡Œç”µè·¯ 1000 æ¬¡ï¼Œæµ‹é‡å¾—åˆ°æŸä¸ªå€¼çš„æ¦‚ç‡å¯ç”¨äºè¡¡é‡ä¸çœŸå®å€¼çš„æ¥è¿‘ç¨‹åº¦
        - QPE ç²¾åº¦å–å†³äº qubit æ•°ç›®ï¼šn ä¸ª qubit å¯ä»¥ä¼°è®¡ç›¸ä½åˆ° $\dfrac{1}{2^n}$ çš„ç²¾åº¦

=== "ä¾‹2ï¼šä½¿ç”¨ç‰¹å¾å‘é‡"

???+ tip "æç¤º"

    - å°†é…‰çŸ©é˜µ U è°±åˆ†è§£ï¼š$U = \sum_{j=1}^n \lambda_j |\mu_j\rangle\langle\mu_j|$
    - ä»»æ„å‘é‡ $|b\rangle = \sum_{j=1}^n \beta_j |\mu_j\rangle$
    - æ‰§è¡Œ QPE å¾—åˆ° $\sum_{j=1}^n \beta_j |\varphi_j\rangle|\mu_j\rangle$

![](images/lec4/13.png){ align=right width=30% }

$$
\begin{gathered}U=P\left(\frac{\pi}{4}\right)=\begin{bmatrix}1&0\\0&e^{\frac{i\pi}{4}}\end{bmatrix}\\\lambda_1=1,\quad\lambda_2=e^{\frac{i\pi}{4}}\\|\mu_1\rangle=\begin{bmatrix}1\\0\end{bmatrix},\quad|\mu_2\rangle=\begin{bmatrix}0\\1\end{bmatrix}\\|b\rangle=\frac{1}{5}\left[\begin{array}{c}3\\4\end{array}\right]=\frac{3}{5}|\mu_1\rangle+\frac{4}{5}|\mu_2\rangle\end{gathered}
$$

QPE ç”µè·¯æµ‹å¾—ç›¸ä½ $0$ å’Œ $\frac{1}{8}$ çš„æ¦‚ç‡å„ä¸º $\frac{9}{25}$ å’Œ $\frac{16}{25}$ã€‚


## Shor ç®—æ³•

### èƒŒæ™¯

#### å¯¹ç§°åŠ å¯†

<div style="text-align: center">
    <img src="images/lec4/14.png" width=60% />
</div>


#### éå¯¹ç§°åŠ å¯†

éå¯¹ç§°åŠ å¯†è§£å†³äº†å¯¹ç§°åŠ å¯†å¯†é’¥åˆ†å‘çš„é—®é¢˜ï¼š

- éå¯¹ç§°åŠ å¯†æ˜¯å•å‘çš„ï¼Œä¸€ä¸ªäººä½¿ç”¨ä¸€ç»„å¯†é’¥å’Œå…¬é’¥
- å¯†é’¥ç”± Bob è‡ªå·±â€œåˆ¶é€ â€å¹¶ä½¿ç”¨ï¼Œå…¬é’¥å¯å‘Šè¯‰æ‰€æœ‰äººï¼Œæ‰€æœ‰ä¿¡æ¯å‘é€æ–¹éƒ½å¯ä½¿ç”¨å…¬é’¥åŠ å¯†

???+ note "å‰ç½®çŸ¥è¯†"

    - åŒä½™
        - $a \equiv b \pmod n$ï¼š$a$ å’Œ $b$ é™¤ä»¥ $n$ çš„ä½™æ•°ç›¸åŒ
        - $ab \equiv 1 \pmod n$ï¼š$b$ æ˜¯ $a$ æ¨¡ $n$ ä¸‹çš„é€†å…ƒ

    - é˜¶ï¼š$a^r \equiv 1 \pmod n$
        - $a$ æ¨¡ $n$ çš„é˜¶ï¼šä»¤ä¸Šå¼æˆç«‹çš„æœ€å°æ­£æ•´æ•° $r$ï¼Œè®°ä½œ $\text{ord}_n a$

    - æ¬§æ‹‰å‡½æ•° $\varphi(n)$ æ˜¯ä¸ $n$ äº’è´¨çš„å°äº $n$ çš„æ•´æ•°ä¸ªæ•°ï¼Œäº’è´¨å³æœ€å¤§å…¬çº¦æ•°ä¸º 1
        - è‹¥ $p$ æ˜¯è´¨æ•°ï¼Œæ˜¾ç„¶æœ‰ $\varphi(p) = p-1$
        - æ¬§æ‹‰å‡½æ•°æ˜¯ç§¯æ€§å‡½æ•°ï¼šè‹¥ $\text{gcd}(a, b) = 1$ ($a, b$ äº’è´¨)ï¼Œåˆ™ $\varphi(ab) = \varphi(a)\varphi(b)$
        - è‹¥ $\text{gcd}(a, n) = 1$ï¼Œåˆ™ $a^{\varphi(n)} \equiv 1 \pmod n$

<div style="text-align: center">
    <img src="images/lec4/15.png" width=60% />
</div>

åˆ¶é€ å…¬é’¥ï¼ˆ$n, e$ï¼‰å’Œå¯†é’¥ï¼ˆ$n, d$ï¼‰ï¼š

- è·å¾—ä¸¤ä¸ªå¤§è´¨æ•° $p_1$ å’Œ $p_2$
- ä»¤ $n = p_1p_2$ï¼Œåˆ™ $\varphi(n) = \varphi(p_1p_2) = (p_1-1)(p_2-1)$
- å–ä¸ $\varphi(n)$ äº’è´¨çš„æ­£æ•´æ•° $e$ï¼Œæ»¡è¶³ $\text{gcd}(e, \varphi(n)) = 1, e \neq p_1, p_2$
- æ±‚ $e$ æ¨¡ $\varphi(n)$ çš„é€†å…ƒ $d$ï¼Œæ»¡è¶³ $ed \equiv 1 \pmod{\varphi(n)}$

??? example "ä¾‹å­"

    <div style="text-align: center">
        <img src="images/lec4/16.png" width=60% />
    </div>

å¦‚ä½•ç ´è§£ RSAï¼Ÿ

1. å·²çŸ¥å…¬é’¥ $n, e$
2. åˆ†è§£ $n = p_1 p_2$
3. è®¡ç®— $\varphi(n)$
4. è®¡ç®—ç§é’¥ $d$

???+ info "è¯•é™¤æ³•ï¼ˆä¼ ç»Ÿï¼‰"

    ```py
    for i in 2, 3, 4, ..., sqrt(n)
        while ğ‘› equiv 0 mod i
            n := n / i
            add i to ans
    if n > 1
        add n to ans

    return ans
    ```

    - å°è¯•ç”¨å°äº n çš„**æ‰€æœ‰å¯èƒ½å› æ•°**å»é™¤ç›®æ ‡æ•°ï¼Œç›´åˆ°æ‰¾åˆ°è´¨å› æ•°ä¸ºæ­¢ã€‚
    - è¯•é™¤æ³•æ˜¯ä¼ ç»Ÿçš„åˆ†è§£è´¨å› æ•°æ–¹æ³•ï¼Œæ—¶é—´å¤æ‚åº¦ $O(\sqrt{n})$
    - è¯•é™¤æ³•éå¸¸ä½æ•ˆï¼Œå½“å‰å¸¸ç”¨çš„ RSA å¯†é’¥é•¿åº¦å³ä¾¿ä½¿ç”¨æœ€å¿«çš„è®¡ç®—æœºè¿›è¡Œè¯•é™¤æ³•ï¼Œä¹Ÿä¼š**è€—è´¹æå…¶é•¿çš„æ—¶é—´**


### Shor ç®—æ³•

<div style="text-align: center">
    <img src="images/lec4/17.png" width=60% />
</div>

åªæœ‰â€œ**è®¡ç®—é˜¶**â€è¿™ä¸€æ­¥ä½¿ç”¨é‡å­è®¡ç®—ï¼Œå…¶ä½™ä¸ºç»å…¸è®¡ç®—ã€‚

å¦‚ä½•ä½¿ç”¨ Shor ç®—æ³•æ±‚é˜¶ï¼Ÿ

- å®šä¹‰é…‰å˜æ¢
    - $U|y\rangle=|ay(\mathrm{mod~}n)\rangle$
    - $U^2|y\rangle=U|ay\left(\mathrm{mod~}n\right)\rangle=|a^2y(\mathrm{mod~}n)\rangle$
    - $U^t|y\rangle=|a^ty(\mathrm{mod~}n)\rangle$

- å®šä¹‰é‡å­æ€ $|u_s\rangle$

    $$
    |u_s\rangle = \frac{1}{\sqrt{r}} \sum_{k=0}^{r-1} e^{-\frac{2\pi isk}{r}} |a^k \pmod N\rangle
    $$

    - æ€§è´¨1ï¼š$U|u_s\rangle = e^{\frac{2\pi is}{r}} |u_s\rangle$
    - æ€§è´¨2ï¼š$\frac{1}{\sqrt{r}} \sum_{s=0}^{r-1} |u_s\rangle = |1\rangle$

    ??? info "è¯´æ˜"

        - $|u_s\rangle$ æ˜¯ $U$ çš„ç‰¹å¾å‘é‡
        - $|1\rangle$ æ˜¯ $|u_s\rangle_{s=0}^{r-1} $ ç­‰æ¦‚ç‡çš„å åŠ æ€ï¼Œæ‰€ä»¥æ ¹æ®æ€§è´¨ 2 æˆ‘ä»¬å¯ä»¥è§„é¿åˆ¶å¤‡ $|u_s\rangle$

    ??? proof "è¯æ˜"

        === "æ€§è´¨1"

            $$
            U|u_s\rangle = \frac{1}{\sqrt{r}} \sum_{k=0}^{r-1} e^{-\frac{2\pi isk}{r}} |a^{k+1} \pmod N\rangle = e^{2\pi is} |u_s\rangle
            $$

        === "æ€§è´¨2"

            $$
            \begin{aligned}
            & \frac{1}{\sqrt{r}} \sum_{s=0}^{r-1} |u_s\rangle = |1\rangle \iff \frac{1}{\sqrt{r}} \sum_{s=0}^{r-1} e^{\frac{2\pi isk}{r}} |u_s\rangle = |a^k \pmod N\rangle \\
            & \frac{1}{\sqrt{r}} \sum_{s=0}^{r-1} e^{\frac{2\pi isk}{r}} |u_s\rangle = \frac{1}{\sqrt{r}} \sum_{s,l=0}^{r-1} e^{\frac{2\pi isk}{r}} |a^l \pmod N\rangle
            \end{aligned}
            $$

            æ­¤æ—¶è®¾

            $$
            \sum_{s=0}^{r-1} e^{\frac{2\pi is(k-l)}{r}} = \begin{cases} r & \text{if } k=l \\ \frac{1-e^{\frac{2\pi i(k-l)}{r}}}{1-e^{\frac{2\pi i(k-l)}{r}}} = 0 & \text{if } k\neq l \end{cases}
            $$

            å³æœ‰
            $$
            \frac{1}{\sqrt{r}} \sum_{s=0}^{r-1} e^{\frac{2\pi isk}{r}} |u_s\rangle = \frac{1}{r} \sum_{s,l=0}^{r-1} e^{\frac{2\pi isk}{r}} |a^l \pmod N\rangle = \frac{1}{r} \sum_{l=0}^{r-1} r\delta_{k,l}|a^l \pmod N\rangle = |a^k \pmod N\rangle
            $$


### é‡å­ç”µè·¯

<div style="text-align: center">
    <img src="images/lec4/18.png" width=50% />
</div>

é‡å­ç”µè·¯è¯´æ˜ï¼š

$$
U|u_s\rangle = e^{\frac{2\pi is}{r}} |u_s\rangle \\
\frac{1}{\sqrt{r}} \sum_{s=0}^{r-1} |u_s\rangle = |1\rangle
$$

å¯¹ $U$ å’Œ $|1\rangle$ è¿›è¡Œ QPEï¼Œå¯ç­‰æ¦‚ç‡æµ‹é‡å¾—åˆ°ç›¸ä½ $\left\{ 0, \frac{1}{r}, \frac{2}{r}, \ldots, \frac{r-1}{r} \right\}$


??? example "ä¾‹å­"

    <div style="text-align: center">
        <img src="images/lec4/19.png" width=60% />
    </div>


### U ç®—å­çš„ä¸€ç§æ„é€ æ–¹æ³•

$U$ ç®—å­çš„åˆæ­¥æ„é€ æ–¹æ³•ååˆ†ç®€å•ï¼š

1. å°†å˜æ¢å‰æ‰€æœ‰å¯èƒ½çš„ $x$ **è¿›è¡Œç©·ä¸¾**ï¼ˆä» $0$ åˆ° $N-1$ å…±æœ‰ $N$ ä¸ªæ•°ï¼‰ï¼Œå¹¶ä¸€ä¸€ç®—å‡ºå¯¹åº”çš„ $f(x) = a^x \bmod N$

2. å¯¹æ¯ä¸€ä¸ª $x$ï¼Œæˆ‘ä»¬éƒ½å¯ä»¥å†™å‡ºå˜æ¢å‰çš„æ€ $|x\rangle$ å’Œå˜æ¢åçš„æ€ $|f(x)\rangle$ çš„çŸ©é˜µè¡¨ç¤ºï¼Œå°†å®ƒä»¬è¿›è¡Œå¤–ä¹˜å³å¯å¾—åˆ°æ¯ä¸€ä¸ª $x$ å¯¹åº”çš„å˜æ¢çŸ©é˜µï¼Œç„¶åå°†æ‰€æœ‰çŸ©é˜µæ±‚å’Œå³å¾—åˆ°ç®—å­ $U$ çš„çŸ©é˜µè¡¨ç¤ºï¼Œå³

$$
U = \sum_{x=0}^{N-1} |f(x)\rangle\langle x|
$$


## Grover ç®—æ³•

???+ info "å¼•å…¥ï¼šç®€å•æœç´¢é—®é¢˜ä¸¾ä¾‹ï¼ˆå¯»æ‰¾å› å­ï¼‰"

    å¯»æ‰¾ 24 çš„å› å­ï¼Ÿ

    <div align=center>
    **1**,**2**,**3**,**4**,5,**6**,7,**8**,9,10,11,**12**,13,14,15,16,17,18,19,20,21,22,23,**24**
    </div>

    é€šè¿‡éå† 1 è‡³ 24 æ‰€æœ‰æ•´æ•°ï¼Œ**é€ä¸ªæ£€éªŒ**ã€‚

    ---
    **Grover ç®—æ³•**å¯ä»¥å°† $O(N)$ çš„ç»å…¸ç®—æ³•ï¼ŒåŠ é€Ÿè‡³ $O(\sqrt{N})$ã€‚

Groverç®—æ³•çš„**å‡ ä½•**è§£é‡Šï¼š

![](images/lec4/20.png){ align=right width=30% }

- $|\alpha\rangle$ æ˜¯**æ‰€æœ‰é”™è§£**çš„å åŠ æ€
- $|\beta\rangle$ æ˜¯**æ‰€æœ‰æ­£è§£**çš„å åŠ æ€

??? example "ä¾‹å­"

    å¯»æ‰¾ 24 çš„å› å­

    - $|\alpha\rangle$ å¤„äº 5, 7, 9, 10, 13... çš„å åŠ æ€
    - $|\beta\rangle$ å¤„äº 1, 2, 3, 4, 6... çš„å åŠ æ€

Grover ç®—æ³•é€šè¿‡æ—‹è½¬åˆå§‹é‡å­æ€ï¼Œä½¿å…¶é€æ¸æ¥è¿‘ $|\beta\rangle$ã€‚


### Oracle

- **Oracle** æ˜¯ä¸€ä¸ªé»‘ç›’ï¼Œå®ƒä¸èƒ½ç»™å‡ºé—®é¢˜çš„å¯è¡Œè§£ï¼Œä½†**èƒ½æ£€éªŒæŸä¸ªè§£æ˜¯ä¸æ˜¯æ­£ç¡®çš„**
- å‡ ä½•ä¸Šçš„æ—‹è½¬ä¸»è¦é€šè¿‡ Oracle ç”µè·¯å®ç°
- ä¸åŒé—®é¢˜çš„ Oracle ç”µè·¯ä¸åŒï¼Œæ¯”å¦‚æ£€éªŒæ˜¯å¦ä¸º $x$ å› å­çš„ç”µè·¯ã€æ£€éªŒ $x$ æ˜¯å¦å°äºä¸€ä¸ªå¸¸æ•° $C$ çš„ç”µè·¯ï¼Œå­¦ä¹  Grover ç®—æ³•ä¸å¿…çº ç»“ Oracle ç”µè·¯å®ç°

??? example "ä¾‹å­"

    $$
    |x\rangle \xrightarrow{\text{Oracle}} (-1)^{f(x)} |x\rangle
    $$

    $x$ ä¸ºæ­£è§£æ—¶ $f(x) = 1$ï¼Œå¦åˆ™ $f(x) = 0$ã€‚


### é‡å­ç”µè·¯

<div style="text-align: center">
    <img src="images/lec4/21.png" width=60% />
</div>

ç®—æ³•å§‹äºçŠ¶æ€ $|0\rangle^{\otimes n}$ï¼Œç”¨ $H^{\otimes n}$ ä½¿å¯„å­˜å™¨å¤„äºå‡åŒ€å åŠ æ€ï¼š

$$
|\psi\rangle = \frac{1}{\sqrt{N}} \sum_{x=0}^{N-1} |x\rangle
$$

<div style="text-align: center">
    <img src="images/lec4/22.png" width=70% />
</div>

ç®€å•è¯æ˜ç¬¬2, 3, 4æ­¥ï¼šå¯å†™ä¸º $2|\psi\rangle\langle\psi| - I$

<div style="text-align: center">
    <img src="images/lec4/23.png" width=50% />
</div>

ç¬¬ 3 æ­¥çš„é…‰çŸ©é˜µè¡¨ç¤ºä¸º 

$$
2|\psi\rangle\langle\psi| - I \left\{
\begin{aligned}
(2|0\rangle\langle 0|-I)|0\rangle &= 2|0\rangle - |0\rangle = |0\rangle \\
(2|0\rangle\langle 0|-I)|x\rangle &= 0 - |x\rangle = -|x\rangle
\end{aligned}
\right.
$$

äºæ˜¯ $H^{\otimes n} (2|0\rangle\langle 0| - I) H^{\otimes n} = 2|\psi\rangle\langle\psi| - I$ã€‚


### G è¿­ä»£çš„å‡ ä½•æ„ä¹‰

![](images/lec4/24.png){ align=right width=30% }

åˆå§‹çŠ¶æ€ï¼š$|\psi\rangle = \sqrt{\frac{N-M}{N}} |\alpha\rangle + \sqrt{\frac{M}{N}} |\beta\rangle$

- å¾…æ£€éªŒçš„è§£ä¸ªæ•°ï¼š$N$
- å¯è¡Œè§£ä¸ªæ•°ï¼š$N$

<br/>
<br/>

---
![](images/lec4/25.png){ align=right width=30% }

ç¬¬ 1 æ­¥ï¼šä½œç”¨ Oracleï¼ˆç®—å­ $O$ï¼‰ï¼Œæ”¹å˜æ­£è§£ç›¸ä½

- $O$ å°±æ˜¯ä»¥ $|\alpha\rangle$ ä¸ºå¯¹ç§°è½´åšå¯¹ç§°æ“ä½œ
- ä»¤ $a = \sqrt{\frac{N-M}{N}}, b = \sqrt{\frac{M}{N}}$ï¼Œå³æœ‰ï¼š

    $$
    O(a|\alpha\rangle + b|\beta\rangle) = a|\alpha\rangle - b|\beta\rangle
    $$

- åœ¨ $|\alpha\rangle$ ä¸Šçš„æŠ•å½±ä¸å˜ï¼Œåœ¨ $|\beta\rangle$ ä¸Šçš„æŠ•å½±ç¿»è½¬

---
![](images/lec4/26.png){ align=right width=30% }

ç¬¬ 2, 3, 4 æ­¥ï¼šä½œç”¨ $2|\psi\rangle\langle\psi| - I$

- ä»»æ„é‡å­æ€ï¼ˆå•ä½å‘é‡ï¼‰$|v\rangle = p|\psi\rangle + q|\psi\rangle_{\perp}$
- å…¶ä¸­ $|\psi\rangle_\perp$ è¡¨ç¤ºä¸ $|\psi\rangle$ å‚ç›´çš„åˆ†é‡

    $$
    (2|\psi\rangle\langle\psi| - I)|v\rangle = p|\psi\rangle - q|\psi\rangle_{\perp}
    $$

- $2|\psi\rangle\langle\psi| - I$ å°±æ˜¯ä»¥ $|\psi\rangle$ ä¸ºå¯¹ç§°è½´åšå¯¹ç§°æ“ä½œ

---
![](images/lec4/27.png){ align=right width=30% }

æ€»ç»“ï¼š

- åˆå§‹çŠ¶æ€ä¸º $|\psi\rangle = \sqrt{\frac{N-M}{N}} |\alpha\rangle + \sqrt{\frac{M}{N}} |\beta\rangle$
- $G$ ç®—å­å‡ ä½•æ„ä¹‰ï¼šå…ˆå°†é‡å­æ€ç›¸å¯¹ $|\alpha\rangle$ åšå¯¹ç§°ï¼Œå†å°†é‡å­æ€ç›¸å¯¹ $|\psi\rangle$ åšå¯¹ç§°
- ä½¿ç”¨ $G$ ç®—å­åï¼Œé‡å­æ€å‘æ­£ç¡®è§£çš„å åŠ æ€æ—‹è½¬
- å¯ä»¥è¯æ˜ï¼Œä½œç”¨ä¸€æ¬¡ $G$ ç®—å­ï¼Œå¯å°†é‡å­æ€å‘ $|\beta \rangle$ æ—‹è½¬è§’åº¦ $\theta$ï¼Œå³ $G^k |\psi\rangle = \cos\left(\frac{2k+1}{2}\theta\right) |\alpha\rangle + \sin\left(\frac{2k+1}{2}\theta\right) |\beta\rangle$
    - $|\psi\rangle=\sqrt{\frac{N-M}{N}}|\alpha\rangle+\sqrt{\frac{M}{N}}|\beta\rangle$
    - $\theta=2\arccos\sqrt{\frac{N-M}{N}}$
    - $\sin\theta=\frac{2\sqrt{M(N-M)}}{N}$


### å¤æ‚åº¦åˆ†æ

<div style="text-align: center">
    <img src="images/lec4/28.png" width=80% />
</div>
