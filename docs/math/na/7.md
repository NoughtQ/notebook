---
counter: true
---

# Chap 7: Iterative Techniques in Matrix Algebra

??? abstract "æ ¸å¿ƒçŸ¥è¯†"

    - èŒƒæ•°
        - å‘é‡èŒƒæ•°
        - çŸ©é˜µèŒƒæ•°
    - ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡ã€è°±åŠå¾„
    - å„ç±»è¿­ä»£æ–¹æ³•
        - é›…å¯æ¯”è¿­ä»£æ³•
        - é«˜æ–¯-å¡å¾·å°”è¿­ä»£æ³•
        - SOR
    - æ”¶æ•›é€Ÿåº¦ã€è¯¯å·®è¾¹ç•Œ
    - è¿­ä»£ä¼˜åŒ–

ç›®æ ‡ï¼šåŒç¬¬6ç« ï¼Œè¿˜æ˜¯æ±‚è§£ $A \bm{x} = \bm{b}$ã€‚

!!! info "æ€è·¯"

    ç±»ä¼¼æ±‚è§£ $f(x) = 0$ ç”¨çš„ä¸åŠ¨ç‚¹è¿­ä»£ï¼š
    
    - å…ˆå°† $A \bm{x} = \bm{b}$ è½¬åŒ–ä¸ºç­‰ä»·çš„ $\bm{x} = T\bm{x} + \bm{c}$ çš„å½¢å¼
    - ç„¶åä»åˆå§‹çŒœæµ‹å€¼ $\bm{x}^{(0)}$ å¼€å§‹ $\bm{x}^{(k+1)} = T\bm{x}^{(k)} + \bm{c}$ çš„è¿­ä»£ï¼Œå¾—åˆ°ï¼ˆæ”¶æ•›çš„ï¼‰åºåˆ— $\{\bm{x}^{(k)}\}$

ä¸Šè¿°æ€è·¯çš„ä¼˜åŠ¿åœ¨äºï¼š

- å¯ä»¥é€šè¿‡è¿­ä»£æ¬¡æ•°æ¥æ§åˆ¶ç²¾åº¦
- è¿­ä»£æŠ€æœ¯è¢«å®é™…è¿ç”¨äºæ±‚è§£**ç¨€ç–çš„**(sparse)çº¿æ€§æ–¹ç¨‹ç»„

æ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åˆ†æï¼š

- å¦‚ä½•è®¾è®¡ä¸€ä¸ªè¿­ä»£æ–¹æ¡ˆ
- åœ¨ä½•ç§æ¡ä»¶ä¸‹åºåˆ—å°†ä¼šæ”¶æ•›
- æŸä¸ªæ–¹æ³•çš„æ”¶æ•›é€Ÿåº¦æœ‰å¤šå¿«
- è¯¯å·®è¯„ä¼°


## Norms of Vectors and Matrices

### Vector Norms

åœ¨ $R^n$ ä¸Šçš„**å‘é‡èŒƒæ•°**(vector norm)æ˜¯ä¸€ä¸ª $R^n \rightarrow R$ çš„å‡½æ•° $\| \cdot \|$ã€‚$\forall \bm{x}, \bm{y} \in R^n, \alpha \in C$ï¼Œå®ƒæ»¡è¶³ä»¥ä¸‹æ€§è´¨ï¼š

- **æ­£å®š**ï¼š$\| \bm{x} \| \ge 0;\ \| \bm{x} \| = 0 \Leftrightarrow \bm{x} = \bm{0}$
>æ­¤â€œæ­£å®šâ€éå½¼[æ­£å®š](6.md#choleskis-method-for-positive-definite-matrix)

- **é½æ¬¡**(homogeneous)ï¼š$\| \alpha \bm{x} \| = |\alpha| \cdot \| \bm{x} \|$
- **ä¸‰è§’ä¸ç­‰å¼**ï¼š$\| \bm{x} + \bm{y}\| \le \| \bm{x} \| + \| \bm{y} \|$

??? example "ä¾‹å­"

    === "é¢˜ç›®"

        <div style="text-align: center">
            <img src="images/C7/8.png" width=80%/>
        </div>

    === "è§£ç­”"

        å°±è¯æ˜è¿™ä¸ªèŒƒæ•°æ»¡è¶³ä¸Šè¿°ä¸‰æ¡æ€§è´¨å°±è¡Œäº†ï¼Œå¾ˆç®€å•çš„ï¼

ä¸€äº›å¸¸ç”¨çš„èŒƒæ•°ï¼š

- $\| \bm{x} \|_1 = \sum\limits_{i=1}^n |x_i|$
- $\| \bm{x} \|_2 = \sqrt{\sum\limits_{i=1}^n |x_i|^2}$ï¼ˆ**æ¬§å‡ é‡Œå¾—èŒƒæ•°**ï¼Œå³æˆ‘ä»¬ç†ŸçŸ¥çš„**æ¨¡é•¿**ï¼‰
- $\| \bm{x} \|_p = \Big( \sum\limits_{i=1}^n |x_i|^p \Big)^{\frac{1}{p}}$ï¼ˆ**$p$ èŒƒæ•°**ï¼‰
- $\| \bm{x} \|_\infty = \max\limits_{1 \le i \le n} |x_i|$ï¼ˆ**æ— ç©·èŒƒæ•°**ï¼‰

æ³¨ï¼š$\lim\limits_{p \rightarrow \infty} \| \bm{x} \|_p = \| \bm{x} \|_{\infty}$

!!! theorem "ä¸€äº›å®šä¹‰å’Œå®šç†"

    å‘é‡çš„æ”¶æ•›æ€§ï¼š

    === "å®šä¹‰1"

        è‹¥ $\forall \varepsilon > 0$ï¼Œ$\exists N(\varepsilon) \in N$ï¼Œä½¿å¾— $\|\bm{x}^{(k)} - \bm{x}\| < \varepsilon$ æˆç«‹ï¼Œé‚£ä¹ˆåœ¨ $R^n$ ä¸Šçš„å‘é‡åºåˆ— $\{ \bm{x}^{(k)} \}_{k=1}^{\infty}$ å…³äºèŒƒæ•° $\| \cdot \|$ æ”¶æ•›åˆ° $\bm{x}$ã€‚

    === "å®šç†1"

        å½“ä¸”ä»…å½“ $\lim\limits_{k \rightarrow \infty} x_i^{(k)} = x_i\ (i = 1, 2, \dots, n)$ æ—¶ï¼Œé‚£ä¹ˆåœ¨ $R^n$ ä¸Šçš„å‘é‡åºåˆ— $\{\bm{x}\}_{k=1}^{\infty}$ å…³äºèŒƒæ•° $\| \cdot \|_{\infty}$ æ”¶æ•›åˆ° $\bm{x}$ã€‚

    èŒƒæ•°çš„ç­‰ä»·æ€§ï¼š

    === "å®šä¹‰2"

        è‹¥å­˜åœ¨æ­£å¸¸æ•° $C_1, C_2$ï¼Œä½¿å¾— $C_1 \|\bm{x}\|_B \le \|\bm{x}\|_A \le C_2 \| \bm{x} \|_B$ï¼Œé‚£ä¹ˆ $\| \cdot \|_A$ å’Œ $\| \cdot \|_B$ æ˜¯ç­‰ä»·çš„ã€‚

    === "å®šç†2"

        æ‰€æœ‰åœ¨ $R^n$ ä¸Šçš„å‘é‡èŒƒæ•°éƒ½æ˜¯ç­‰ä»·çš„ã€‚

    ä¸‹é¢è¯æ˜äº† $\| \cdot \|_2$ å’Œ $\| \cdot \|_\infty$ çš„ç­‰ä»·æ€§ï¼š

    ??? proof "è¯æ˜"

        <div style="text-align: center">
            <img src="images/C7/4.png" width=90%/>
        </div>


### Matrix Norms

å¯¹äºæ‰€æœ‰è§„æ¨¡ä¸º $n \times n$ çš„çŸ©é˜µï¼Œ**çŸ©é˜µèŒƒæ•°**(matrix norms)æ˜¯ä¸€ä¸ªå®æ•°å€¼å‡½æ•° $\| \cdot \|$ã€‚å¯¹äºæ‰€æœ‰è§„æ¨¡ä¸º $n \times n$ çš„çŸ©é˜µ $A, B$ ä»¥åŠæ‰€æœ‰çš„ $\alpha \in C$ï¼Œæ»¡è¶³ï¼š

- **æ­£å®š**ï¼š$\| A \| \ge 0;\ \| A \| = 0 \Leftrightarrow A = O$
- **é½æ¬¡**ï¼š$\| \alpha A \| = |\alpha| \cdot \| A \|$
- **ä¸‰è§’ä¸ç­‰å¼**ï¼š$\| A + B \| \le \| A \| + \| B \|$
- :star2: **ä¸€è‡´æ€§**(consistency)ï¼š$\| AB \| \le \| A \| \cdot \| B \|$

ä¸‹é¢æ•´ç†äº†ä¸€äº›å¸¸ç”¨çš„èŒƒæ•°ï¼š

- **å¼—ç½—è´å°¼ä¹Œæ–¯èŒƒæ•°**(Frobenius norm)ï¼š$\| A \|_F = \sqrt{\sum\limits_{i=1}^n \sum\limits_{j=1}^n |a_{ij}|^2}$
- **è‡ªç„¶èŒƒæ•°**(natural norm)
    - **ç®—å­èŒƒæ•°**(operator norm)ï¼ˆå’Œå‘é‡èŒƒæ•° $\| \cdot \|$ å…³è”ï¼Œæ‰€ä»¥ä¹Ÿå¯ç§°ä¸º **$p$ èŒƒæ•°**ï¼‰

        $$
        \| A \|_p = \max\limits_{\bm{x} \ne \bm{0}} \dfrac{\| A \bm{x} \|_p}{\| \bm{x} \|_p} = \max\limits_{\| \bm{x} \|_p = 1} \| A\bm{x} \|_p
        $$

    - **æ— ç©·èŒƒæ•°**ï¼š$\| A \|_{\infty} = \max\limits_{1 \le i \le n} \sum\limits_{j=1}^n |a_{ij}|$

        ??? proof "è¯æ˜ $\|A \|_{\infty} = \max\limits_{1 \le i \le n} \sum\limits_{j=1}^n |a_{ij}|$"

            1. è¯æ˜ $\| A \|_{\infty} = \max\limits_{\| \bm{x} \|_{\infty} = 1} \| A \bm{x} \|_{\infty} \le \max\limits_{1 \le i \le n} \sum\limits_{j=1}^n |a_{ij}|$

                $$
                \| A \bm{x} \|_{\infty} = \max\limits_{1 \le i \le n} |(A \bm{x})_i| = \max\limits_{1 \le i \le n} |\sum\limits_{j=1}^n a_{ij} x_j| \le \max\limits_{1 \le i \le n} \sum\limits_{j=1}^n |a_{ij}| \cdot \max\limits_{1 \le i \le n} |x_j|
                $$

            2. è¯æ˜ $\| A \|_{\infty} = \max\limits_{\| \bm{x} \|_{\infty} = 1} \| A\bm{x} \|_{\infty} \ge \max\limits_{1 \le i \le n} \sum\limits_{j=1}^n |a_{ij}|$

                - ä»¤ç¬¬ $p$ è¡Œä¸ºæœ€å¤§è¡Œï¼Œå³æ»¡è¶³ $\sum\limits_{j=1}^n |a_{pj}| = \max\limits_{1 \le i \le n} \sum\limits_{j=1}^n |a_{ij}|$
                - å–ä¸€ä¸ªç‰¹æ®Šçš„å•ä½å‘é‡ $\bm{x}$ ä½¿å¾— $x_j = \begin{cases} 1, & \text{if } a_{pj} \ge 0 \\ -1, & \text{if } a_{pj} < 0 \end{cases}$

                $$
                \| A \bm{x} \|_{\infty} = \max\limits_{1 \le i \le n} \Big| \sum\limits_{j=1}^n a_{ij} x_j\Big| \ge \Big| \sum\limits_{j=1}^n a_{pj} x_j \Big| = \Big| \sum\limits_{j=1}^n |a_{pj}| \Big| = \max\limits_{1 \le i \le n} \sum\limits_{j=1}^n |a_{ij}|
                $$

    - **1-èŒƒæ•°**ï¼š$\| A \|_1 = \max\limits_{1 \le j \le n} \sum\limits_{i=1}^n |a_{ij}|$
    - **2-èŒƒæ•°**ï¼ˆåˆç§°**è°±èŒƒæ•°**(spectral norm)ï¼‰ï¼š$\| A \|_2 = \sqrt{\lambda_{\max} (A^T A)}$

???+ note "æ¨è®º"

    å¯¹äºä»»æ„å‘é‡ $\bm{z} \ne 0$ï¼ŒçŸ©é˜µ $A$ ä»¥åŠä»»æ„è‡ªç„¶èŒƒæ•° $\| \cdot \|$ï¼Œæˆ‘ä»¬æœ‰ï¼š

    $$
    \| A \bm{z} \| \le \| A \| \cdot \| \bm{z} \|
    $$

    æˆç«‹ã€‚

??? question "æ‰€ä»¥èŒƒæ•°åˆ°åº•æ˜¯ä»€ä¹ˆï¼Ÿ"

    PPT ä¸Šæ²¡æœ‰è®²æ¸…æ¥šæˆ‘ä»¬è¦å­¦èŒƒæ•°çš„åŸå› ï¼ˆè™½ç„¶å¯ä»¥æ ¹æ®ä¸Šä¸‹æ–‡æ¨æµ‹å‡ºå®ƒä¼šè¢«ç”¨äºè¿­ä»£æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ï¼‰ï¼Œæ‰€ä»¥çœ‹è¿™äº›æ¦‚å¿µçš„æ—¶å€™éš¾å…ä¼šä¸€å¤´é›¾æ°´ã€‚äºæ˜¯ï¼Œæˆ‘è¿˜æ˜¯è®©è€æœ‹å‹ Gemini 2.5 Flash å¸®æˆ‘ç”¨ç›¸å¯¹é€šä¿—çš„è¯­è¨€ç®€å•è¯´æ˜èŒƒæ•°çš„æ„ä¹‰ï¼Œè¿›è€Œç†è§£å­¦ä¹ èŒƒæ•°çš„åŸå› ï¼š

    - æ˜¯ä»€ä¹ˆï¼Ÿâ€”â€”èŒƒæ•°æ˜¯å¹¿ä¹‰ä¸Šçš„â€œé•¿åº¦â€æˆ–â€œå¤§å°â€ï¼Œæ˜¯ä»»ä½•æ»¡è¶³ä¸‰æ¡åŸºæœ¬æ€§è´¨ï¼ˆéè´Ÿã€é½æ¬¡ã€ä¸‰è§’ä¸ç­‰å¼ï¼‰çš„å‡½æ•°ã€‚
    - æœ‰ä»€ä¹ˆç”¨ï¼Ÿâ€”â€”å®ƒæ˜¯ä¸€æŠŠä¸‡èƒ½çš„â€œå°ºå­â€ï¼Œæ ¸å¿ƒæ„ä¹‰åœ¨äº**é‡åŒ–**ã€‚
        - å®ƒé‡åŒ–äº†**è·ç¦»**ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨æŠ½è±¡ç©ºé—´ä¸­æ¯”è¾ƒâ€œè¿œè¿‘â€ã€‚
        - å®ƒé‡åŒ–äº†**è¯¯å·®**ï¼Œæˆä¸ºæœºå™¨å­¦ä¹ å’Œä¼˜åŒ–é—®é¢˜çš„åŸºçŸ³ã€‚
        - å®ƒé‡åŒ–äº†**æ¨¡å‹å¤æ‚åº¦**ï¼ˆé€šè¿‡æ­£åˆ™åŒ–ï¼‰ï¼Œå¸®åŠ©æˆ‘ä»¬æ„å»ºæ›´å¥å£®çš„æ¨¡å‹ã€‚

    ç®€è€Œè¨€ä¹‹ï¼Œæ²¡æœ‰èŒƒæ•°ï¼Œæˆ‘ä»¬å°±æ— æ³•è¡¡é‡å’Œæ¯”è¾ƒï¼Œç°ä»£æœºå™¨å­¦ä¹ å’Œè®¸å¤šç§‘å­¦è®¡ç®—é¢†åŸŸçš„å¤§å¦éƒ½å°†æ— ä»è°ˆèµ·ã€‚


## Eigenvalues and Eigenvectors

???+ info "ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡"

    - å¦‚æœ $A$ æ˜¯ä¸€ä¸ªæ–¹é˜µï¼Œé‚£ä¹ˆ $A$ çš„**ç‰¹å¾å¤šé¡¹å¼**(characteristic polynomial)ä¸º $p(\lambda) = \det (A - \lambda I)$
    - ç‰¹å¾æ–¹ç¨‹ $p(\lambda) = 0$ çš„è§£å°±æ˜¯çŸ©é˜µ $A$ çš„**ç‰¹å¾å€¼**(eigenvalues)
    - è‹¥å­˜åœ¨ç‰¹å¾å€¼ $\lambda$å’Œå‘é‡ $\bm{x} \ne \bm{0}$ï¼Œæ»¡è¶³ $(A - \lambda I) \bm{x} = \bm{0}$ï¼Œé‚£ä¹ˆ $\bm{x}$ å°±æ˜¯ $A$ çš„**ç‰¹å¾å‘é‡**(eigenvector)

    è¿™ä¹ˆè¯´æ„Ÿè§‰å¾ˆæŠ½è±¡ï¼ˆ~~å°¤å…¶æ˜¯å¯¹ç¬”è€…è¿™ç§å·²ç»å¾ˆä¹…æ²¡æœ‰æ¥è§¦è¿‡çº¿æ€§ä»£æ•°é¢˜ç›®çš„äºº~~ï¼‰ã€‚æ‰€ä»¥å»ºè®®å„ä½è§‚çœ‹ [3b1b çš„ç›¸å…³è§†é¢‘](https://www.youtube.com/watch?v=PFDu9oVAE-g&list=PLZHQObOWTQDPD3MizzM2xVFitgF8hE_ab&index=14)ï¼Œå¯¹ç‰¹å¾å€¼å’Œç‰¹å¾å‘é‡æœ‰ä¸€ä¸ªæ›´ä¸ºç›´è§‚å½¢è±¡çš„è®¤è¯†ã€‚

çŸ©é˜µ $A$ çš„**è°±åŠå¾„**(spectral radius) $\rho(A) = \max{| \lambda |}$ï¼Œå…¶ä¸­ $\lambda$ æ˜¯ $A$ çš„ç‰¹å¾å€¼ï¼ˆå¤æ•°èŒƒå›´ï¼Œæ‰€ä»¥ $|\lambda|$ è¡¨ç¤ºç‰¹å¾å€¼çš„**æ¨¡é•¿**ï¼‰ã€‚

<div style="text-align: center">
    <img src="images/C7/1.png" width=50%/>
</div>

!!! theorem "å®šç†"

    å¦‚æœ $A$ æ˜¯ä¸€ä¸ª $n \times n$ çš„çŸ©é˜µï¼Œé‚£ä¹ˆå¯¹äºæ‰€æœ‰çš„è‡ªç„¶èŒƒæ•° $\| \cdot \|$ï¼Œæœ‰ $\rho(A) \le \| A \|$ æˆç«‹ã€‚

    ??? proof "è¯æ˜"

        å¯¹äº $A$ çš„ä»»ä½•ç‰¹å¾å€¼ $\lambda$ ä»¥åŠç‰¹å¾å‘é‡ $\| \bm{x} \|$ï¼Œä¸” $\| \bm{x} \| = 1$ï¼Œæœ‰ï¼š

        $$
        |\lambda| \cdot \| \bm{x} \| = \| \lambda \bm{x} \| = \| A\bm{x} \| \le \| A \| \cdot \| \bm{x} \|
        $$

è‹¥ $\forall i, j = 1, 2, \dots, n$ï¼Œæœ‰ $\lim\limits_{k \rightarrow \infty} (A^k)_{ij} = 0$ï¼Œé‚£ä¹ˆç§°è§„æ¨¡ä¸º $n \times n$ çš„çŸ©é˜µ $A$ æ˜¯**æ”¶æ•›**çš„ã€‚


## Iterative Techniques for Solving Linear Systems

å½“çº¿æ€§æ–¹ç¨‹ç»„ç»´åº¦ä¸é«˜çš„æ—¶å€™ï¼Œå¾ˆå°‘ä¼šç”¨åˆ°è¿­ä»£æ–¹æ³•ï¼Œå› ä¸ºè¿­ä»£æ–¹æ³•è¾¾åˆ°è¶³å¤Ÿç²¾åº¦æ‰€éœ€çš„æ—¶é—´è¶…è¿‡ç”¨é«˜æ–¯æ¶ˆå…ƒæ³•è®¡ç®—çš„æ—¶é—´ã€‚ä¸è¿‡åœ¨å¤§å‹çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼Œè¿­ä»£æ–¹æ³•åœ¨å­˜å‚¨å’Œè®¡ç®—ä¸Šçš„æ•ˆç‡ä¼˜åŠ¿ä¼šå˜å¾—æ›´ä¸ºæ˜æ˜¾ã€‚

ä¸‹é¢ä»‹ç»ä¸€äº›å¸¸è§çš„æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„çš„è¿­ä»£æ–¹æ³•ã€‚


### Jacobi Iterative Method

å¯¹äºçº¿æ€§æ–¹ç¨‹ç»„ $\begin{cases}a_{11}x_1 + a_{12}x_2 + \dots + a_{1n}x_n = b_1 \\ a_{21}x_1 + a_{22}x_2 + \dots + a_{2n}x_n = b_2 \\ \dots \\ a_{n1}x_1 + a_{n2}x_2 + \dots + a_{nn}x_n = b_n\end{cases}$ï¼Œå½“ $a_{ii} \ne 0$ æ—¶ï¼Œä¸éš¾å¾—åˆ°ï¼š

$$
\begin{cases}
x_1 = \dfrac{1}{a_{11}}(-a_{12}x_2 - \dots - a_{1n}x_n + b_1) \\ x_2 = \dfrac{1}{a_{22}}(-a_{21}x_1 - \dots - a_{2n}x_n + b_1) \\ x_n = \dfrac{1}{a_{nn}}(-a_{n1}x_1 - \dots - a_{1n, n-1}x_{n-1} + b_n) 
\end{cases}
$$

ç”¨çŸ©é˜µå½¢å¼è¡¨ç¤ºä¸Šè¿°çº¿å½¢æ–¹ç¨‹ç»„ï¼Œå¹¶è½¬åŒ–ä¸ºä»¥ä¸‹å½¢å¼ï¼š

<div style="text-align: center">
    <img src="images/C7/2.png" width=20%/>
</div>

é‚£ä¹ˆï¼š

$$
\begin{align}
A\bm{x} = \bm{b} & \Leftrightarrow (D - L - U)\bm{x} = \bm{b} \notag \\
& \Leftrightarrow D\bm{x} = (L + U) \bm{x} + \bm{b} \notag \\
& \Leftrightarrow \bm{x} = \underbrace{D^{-1} (L + U)}_{T_j} \bm{x} + \underbrace{D^{-1} \bm{b}}_{\bm{c_j}} \notag
\end{align}
$$

å› æ­¤è¯¥è¿­ä»£æ³•çš„é€’æ¨å…¬å¼ä¸ºï¼š$\bm{x}^{(k)} = T_j \bm{x}^{(k-1)} + \bm{c_j}$ï¼Œå…¶ä¸­ $T_j$ è¢«ç§°ä¸º**é›…å¯æ¯”è¿­ä»£çŸ©é˜µ**(Jacobi iterative matrix)ã€‚

>çœ‹èµ·æ¥çŸ©é˜µè¡¨ç¤ºæ›´ä¸ºç®€æ´ï¼Œä½†ç®—çš„æ—¶å€™æˆ‘ä»¬å°±å¯ä»¥ç›´æ¥ç”¨ä¸Šé¢ç»™å‡ºçš„çº¿æ€§æ–¹ç¨‹ç»„è§£æ¥è®¡ç®—ï¼ˆä¸‹é¢ç»™å‡ºçš„ç®—æ³•ä¹Ÿæ­£æ˜¯è¿™ä¹ˆåšçš„ï¼‰ã€‚

???+ code "ç®—æ³•ï¼šé›…å¯æ¯”è¿­ä»£æ–¹æ³•"

    å¯¹äºç»™å®šçš„åˆå§‹è¿‘ä¼¼è§£ $\bm{x}^{(0)}$ï¼Œæ±‚è§£ $A\bm{x} = \bm{b}$

    - è¾“å…¥ï¼šæ–¹ç¨‹å’ŒæœªçŸ¥æ•°çš„ä¸ªæ•° $n$ï¼ŒçŸ©é˜µå…ƒç´  $a[][]$ï¼Œå¸¸æ•°é¡¹ $b[]$ï¼Œåˆå§‹è¿‘ä¼¼è§£ $X0[]$ï¼Œå®¹å¿å€¼ $TOL$ï¼Œæœ€å¤§è¿­ä»£æ¬¡æ•° $N_{max}$
    - è¾“å‡ºï¼šè¿‘ä¼¼è§£ $X[]$ æˆ–é”™è¯¯ä¿¡æ¯

    ```c linenums="1" hl_lines="4 7"
    Step 1  Set k = 1;
    Step 2  while (k <= N_max) do step 3-6
            Step 3  for i = 1, ..., n
                        Set X[i] = (b[i] - sum(j=1, j!=i, j<=n, a[i][j] * X[0][j])) / a[i][i];  // compute x^k
            Step 4  if norm(X - X0)_infty = max(1<=i<=n, X[i] - X0[i]) < TOL then Output(X[]);
                    STOP;    // successful
            Step 5  for i = 1, ..., n  Set X0[] = X[];  // update X0
            Step 6  Set k++;
    Step 7  Output (Maximum number of iterations exceeded);
            STOP.    // unsuccessful
    ```

    è€ƒè™‘é«˜äº®è¡Œï¼š

    - ç¬¬4è¡Œï¼š`a[i][i]` æœ‰å¯èƒ½ä¸º0ï¼Œä¸è¿‡ç”±äºåœ¨è®¡ç®—è¿‡ç¨‹ä¸­ä¸ä¼šä¿®æ”¹çŸ©é˜µ $A$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥åœ¨è®¡ç®—å‰ä¸ºçŸ©é˜µå…ƒç´ **é‡æ–°æ’åº**ï¼Œä»¥ä¿è¯ `a[i][i] != 0`ã€‚å¦‚æœæ— æ³•é€šè¿‡é‡æ’é¿å…è¿™ä¸€é—®é¢˜ï¼Œé‚£ä¹ˆçŸ©é˜µ $A$ å°±æ˜¯**å¥‡å¼‚çš„**ã€‚
    - ç¬¬7è¡Œï¼š$X^{(k+1)}$ å¿…é¡»ç­‰åˆ° $X^{(k)}$ çš„é¡¹å…¨éƒ¨ç®—å‡ºæ¥ï¼Œå› æ­¤è¦ç”¨ä¸¤ä¸ªå‘é‡æ¥å­˜å‚¨ç»“æœã€‚ä½†è¿™æ ·å°±æœ‰äº›æµªè´¹ç©ºé—´äº†ï¼Œå› ä¸ºæˆ‘ä»¬æœ€ååªä¼šç”¨åˆ°ä¸€ä¸ªå‘é‡ã€‚


### Gauss-Seidel Iterative Method

è§‚å¯Ÿçº¿æ€§æ–¹ç¨‹ç»„çš„è§£ï¼š

$$
\begin{align}
x_2^{(k)} & = \dfrac{1}{a_{22}}(\textcolor{red}{-a_{21}x_1^{(k)}} - a_{23}x_3^{(k-1)} - a_{24}x_4^{(k-1)} - \dots - a_{2n}x_n^{k-1} + b_2) \notag \\ 
x_3^{(k)} & = \dfrac{1}{a_{33}}(\textcolor{red}{-a_{31}x_1^{(k)} - a_{32}x_2^{(k)}} - a_{34}x_4^{(k-1)} - \dots - a_{3n}x_n^{k-1} + b_3) \notag \\ 
\dots \notag \\ 
x_n^{(k)} & = \dfrac{1}{a_{nn}}(\textcolor{red}{-a_{n1}x_1^{(k)} -a_{n2}x_2^{(k)} -a_{n3}x_3^{(k)} - \dots - a_{n, n-1}x_{n-1}^{k}} + b_n) \notag
\end{align}
$$

ç”¨çŸ©é˜µå½¢å¼è¡¨è¿°ä¸ºï¼š

$$
\begin{align}
& \bm{x}^{(k)} = D^{-1} (L\bm{x}^{(k)} + U\bm{x}^{(k-1)}) + D^{-1} \bm{b} \notag \\
\Leftrightarrow & (D - L)\bm{x}^{(k)} = U\bm{x}^{(k-1)} + \bm{b} \notag \\
\Leftrightarrow & \bm{x}^{(k)} = \underbrace{(D - L)^{-1} U }_{T_g} \bm{x}^{(k-1)} + \underbrace{(D - L)^{-1}}_{\bm{c}_g} \bm{b} \notag
\end{align}
$$

å› æ­¤è¯¥è¿­ä»£æ³•çš„é€’æ¨å…¬å¼ä¸ºï¼š$\bm{x}^{(k)} = T_g \bm{x}^{(k-1)} + c_g \bm{b}$ï¼Œå…¶ä¸­ $T_g$ ä¸º**é«˜æ–¯-å¡å¾·å°”è¿­ä»£çŸ©é˜µ**(Gauss-Seidel iterative matrix)ã€‚

??? code "ç®—æ³•ï¼šé«˜æ–¯-å¡å¾·å°”è¿­ä»£æ–¹æ³•"

    å¯¹äºç»™å®šçš„åˆå§‹è¿‘ä¼¼è§£ $\bm{x}^{(0)}$ï¼Œæ±‚è§£ $A\bm{x} = \bm{b}$

    - è¾“å…¥ï¼šæ–¹ç¨‹å’ŒæœªçŸ¥æ•°çš„ä¸ªæ•° $n$ï¼ŒçŸ©é˜µå…ƒç´  $a[][]$ï¼Œå¸¸æ•°é¡¹ $b[]$ï¼Œåˆå§‹è¿‘ä¼¼è§£ $X0[]$ï¼Œå®¹å¿å€¼ $TOL$ï¼Œæœ€å¤§è¿­ä»£æ¬¡æ•° $N_{max}$
    - è¾“å‡ºï¼šè¿‘ä¼¼è§£ $X[]$ æˆ–é”™è¯¯ä¿¡æ¯

    ```c
    Step 1  Set k = 1;
    Step 2  while (k <= N_max) do step 3-6
            Step 3  for i = 1, ..., n
                        Set X[i] = (-sum(j=1, i-1, a[i][j] * x[j]) - sum(j=i+1, n, a[i][j] * X0[j]) + b[i]) / a[i][i];  // compute x^k
            Step 4  if norm(X - X0)_infty = max(1<=i<=n, X[i] - X0[i]) < TOL then Output(X[]);
                    STOP;    // successful
            Step 5  for i = 1, ..., n  Set X0[] = X[];  // update X0
            Step 6  Set k++;
    Step 7  Output (Maximum number of iterations exceeded);
            STOP.    // unsuccessful
    ```

!!! note "æ³¨"

    ä¸Šè¿°ä¸¤ç§è¿­ä»£æ–¹æ³•**ä¸æ€»æ˜¯æ”¶æ•›çš„**ã€‚å¹¶ä¸”å­˜åœ¨é›…å¯æ¯”è¿­ä»£æ³•å¤±è´¥ï¼Œä½†é«˜æ–¯-å¡å¾·å°”è¿­ä»£æ³•æˆåŠŸçš„æƒ…å†µï¼Œåä¹‹äº¦ç„¶ã€‚

??? abstract "é›…å¯æ¯”è¿­ä»£æ³• v.s. é«˜æ–¯-å¡å¾·å°”è¿­ä»£æ³•ï¼ˆby Gemini 2.5 Flashï¼‰"

    | ç‰¹æ€§           | é›…å¯æ¯”è¿­ä»£æ³• (Jacobi Iteration)                               | é«˜æ–¯-å¡å¾·å°”è¿­ä»£æ³• (Gauss-Seidel Iteration)                          |
    | :------------- | :------------------------------------------------------------ | :------------------------------------------------------------------ |
    | **ä¿¡æ¯åˆ©ç”¨**   | è®¡ç®— $x_i^{(k+1)}$ æ—¶ï¼Œå®Œå…¨ä½¿ç”¨ $x^{(k)}$ çš„æ‰€æœ‰åˆ†é‡ã€‚      | è®¡ç®— $x_i^{(k+1)}$ æ—¶ï¼Œä½¿ç”¨ $x_1^{(k+1)}, \dots, x_{i-1}^{(k+1)}$ï¼ˆæœ€æ–°å€¼ï¼‰å’Œ $x_{i+1}^{(k)}, \dots, x_n^{(k)}$ï¼ˆæ—§å€¼ï¼‰ã€‚ |
    | **æ”¶æ•›é€Ÿåº¦**   | é€šå¸¸æ¯”é«˜æ–¯-å¡å¾·å°”æ…¢ã€‚                                         | é€šå¸¸æ¯”é›…å¯æ¯”å¿«ï¼ˆå¦‚æœæ”¶æ•›çš„è¯ï¼‰ã€‚                                    |
    | **æ”¶æ•›æ¡ä»¶**   | è¿­ä»£çŸ©é˜µ $B_J = -D^{-1}(L+U)$ çš„è°±åŠå¾„ $\rho(B_J) < 1$ã€‚     | è¿­ä»£çŸ©é˜µ $B_{GS} = -(D+L)^{-1}U$ çš„è°±åŠå¾„ $\rho(B_{GS}) < 1$ã€‚     |
    | **å¹¶è¡Œæ€§**     | **æ˜“äºå¹¶è¡ŒåŒ–**ï¼Œå› ä¸ºæ¯ä¸ªåˆ†é‡çš„è®¡ç®—æ˜¯ç‹¬ç«‹çš„ã€‚                  | **éš¾ä»¥å¹¶è¡ŒåŒ–**ï¼Œå› ä¸ºæ¯ä¸ªåˆ†é‡çš„è®¡ç®—ä¾èµ–äºå‰ä¸€ä¸ªåˆ†é‡çš„æœ€æ–°å€¼ã€‚        |
    | **å†…å­˜éœ€æ±‚**   | éœ€è¦å­˜å‚¨ $x^{(k)}$ å’Œ $x^{(k+1)}$ ä¸¤å¥—å‘é‡ã€‚                 | å¯ä»¥åœ¨åŸåœ°æ›´æ–°ï¼Œåªéœ€è¦å­˜å‚¨ä¸€å¥—å‘é‡ï¼ˆä½†å®é™…å®ç°å¯èƒ½ä»ç”¨ä¸¤å¥—ï¼‰ã€‚      |
    | **å®ç°å¤æ‚åº¦** | ç›¸å¯¹ç®€å•ã€‚                                                    | ç•¥å¤æ‚ï¼Œéœ€è¦æ³¨æ„æ›´æ–°é¡ºåºã€‚                                          |
    | **é€‚ç”¨çŸ©é˜µ**   | å¯¹è§’å ä¼˜çŸ©é˜µï¼ˆä¸¥æ ¼å¯¹è§’å ä¼˜æˆ–ä¸å¯çº¦å¯¹è§’å ä¼˜ï¼‰ä¿è¯æ”¶æ•›ã€‚        | å¯¹è§’å ä¼˜çŸ©é˜µï¼ˆä¸¥æ ¼å¯¹è§’å ä¼˜æˆ–ä¸å¯çº¦å¯¹è§’å ä¼˜ï¼‰ä¿è¯æ”¶æ•›ã€‚å¯¹äºå¯¹ç§°æ­£å®šçŸ©é˜µï¼Œé«˜æ–¯-å¡å¾·å°”ä¹Ÿä¿è¯æ”¶æ•›ã€‚ |
    | **é²æ£’æ€§**     | ç›¸å¯¹è¾ƒå·®ï¼Œæœ‰æ—¶ä¼šå‘æ•£ã€‚                                        | ç›¸å¯¹è¾ƒå¥½ï¼Œé€šå¸¸æ¯”é›…å¯æ¯”æ›´ç¨³å®šã€‚                                      |


### Convergence of Iterative Method

ç°åœ¨æˆ‘ä»¬æ¥è€ƒå¯Ÿè¿­ä»£æ³• $\bm{x}^{(k)} = T\bm{x}^{(k-1)} + \bm{c}$ çš„æ”¶æ•›æ€§ã€‚

!!! theorem "å®šç†"

    ä»¥ä¸‹è¯­å¥æ˜¯ç­‰ä»·çš„ï¼š

    - $A$ æ˜¯ä¸€ä¸ªæ”¶æ•›çŸ©é˜µ
    - å¯¹äº<u>æŸäº›</u>è‡ªç„¶èŒƒæ•°ï¼Œ$\lim\limits_{n \rightarrow \infty} \| A^n \| = 0$
    - å¯¹äº<u>æ‰€æœ‰</u>è‡ªç„¶èŒƒæ•°ï¼Œ$\lim\limits_{n \rightarrow \infty} \| A^n \| = 0$
    - $\textcolor{red}{\rho(A) < 1}$ï¼ˆæ¯”è¾ƒå¸¸ç”¨ï¼‰
    - $\forall \bm{x},\ \lim\limits_{n \rightarrow \infty} A^n \bm{x} = \bm{0}$

    ??? note "ä¸€äº›è¡¥å……è¯´æ˜ï¼ˆä¸»è¦é’ˆå¯¹ç¬¬4å’Œ5ç‚¹ï¼‰"

        $$
        \textcolor{red}{\bm{e}^{(k)}} = \bm{x^{(k)}} - \bm{x^*} = (T\bm{x^{(k-1)}} + \bm{c}) - (T\bm{x^*} + \bm{c}) = T(\bm{x}^{(k-1)} - \bm{x^*}) = \textcolor{red}{T \bm{e^{(k-1)}}}
        $$

        æ ¹æ®ä¸Šè¿°é€’æ¨å¼ï¼Œå¯ä»¥å¾—åˆ° $\bm{e^{(k)}} = T^k \bm{e^{(0)}}$ï¼Œå› æ­¤ 

        $$
        \|\bm{e^{(k)}}\| \le \| T \| \cdot \| \bm{e^{(k-1)}} \| \le \dots \le \| T \|^k \cdot \| \bm{e^{(0)}} \|
        $$

        - å……åˆ†æ¡ä»¶ï¼š$\|T\| < 1\ \Rightarrow\ \|T\|^k \rightarrow 0\ \text{as}\ k \rightarrow \infty$
        - å¿…è¦æ¡ä»¶ï¼š$\bm{e^{(k)}} \rightarrow \bm{0}\ \text{as}\ k \rightarrow \infty\ \Rightarrow T^k \rightarrow O$

!!! theorem "å®šç†"

    $\forall \bm{x^{(0)}} \in R^n$ï¼Œç”± $\bm{x}^{(k)} = T\bm{x}^{(k-1)} + \bm{c}\ (k \ge 1)$ å®šä¹‰çš„åºåˆ— $\{ \bm{x^{(k)}} \}_{k=0}^\infty$ï¼Œå½“ä¸”ä»…å½“ $\textcolor{red}{\rho(T) < 1}$ æ—¶ï¼Œä¼šæ”¶æ•›åˆ° $\bm{x} = T\bm{x} + \bm{c}$ çš„å”¯ä¸€è§£ã€‚

    >å¯ä»¥æŠŠè¿™ä¸ªå®šç†çœ‹ä½œæ˜¯[**ä¸åŠ¨ç‚¹å®šç†**](2.md#fixed-point-iteration)åœ¨çŸ©é˜µä¸­çš„åº”ç”¨ã€‚

    ??? proof "è¯æ˜"

        - å‡å¦‚ $\rho(T) < 1$ï¼Œé‚£ä¹ˆ

            $$
            \begin{align}
            \bm{x}^{(k)} & = T\bm{x}^{(k-1)} + \bm{c} = T(T\bm{x}^{(k-2)} + \bm{c}) + \bm{c} = T^2 \bm{x^{(k-2)}} + (T + I)\bm{c} \notag \\
            & = \dots = \cancel{T^k\bm{x^{(0)}}} + (\textcolor{red}{T^{k-1} + \dots + T + I})\bm{c} \notag
            \end{align}
            $$

            åˆå› ä¸º $\rho(T) < 1 \Rightarrow (I - T)^{-1} = \sum\limits_{j=0}^{\infty} T^j$ï¼Œæ‰€ä»¥ï¼š

            $$
            \lim\limits_{k \rightarrow \infty} \bm{x}^{(k)} = \lim\limits_{k \rightarrow \infty} T^k\bm{x^{(0)}} + \lim\limits_{k \rightarrow \infty} (T^{k-1} + \dots + T + I)\bm{c} = (I - T)^{-1} \bm{c}
            $$

        - $\lim\limits_{k \rightarrow \infty} \bm{e}^{(k)} \rightarrow \bm{0}\ \Rightarrow\ \lim\limits_{k \rightarrow \infty} T^k \bm{e^{(0)}} = \bm{0} \text{ for any } \bm{e^{0}}$ï¼Œæ‰€ä»¥ $\rho(T) < 1$

!!! theorem "å®šç†"

    å¯¹äºä»»æ„æ»¡è¶³ $\|T\| < 1$ çš„è‡ªç„¶çŸ©é˜µä»¥åŠç»™å®šçš„å‘é‡ $\bm{c}$ï¼Œé‚£ä¹ˆ $\forall \bm{x^{(0)}} \in R^n$ï¼Œç”± $\bm{x}^{(k)} = T\bm{x}^{(k-1)} + \bm{c}$ å®šä¹‰çš„åºåˆ— $\{ \bm{x^{(k)}} \}_{k=0}^\infty$ ä¼šæ”¶æ•›åˆ°å‘é‡ $\bm{x} \in R^n$ï¼Œå¹¶ä¸”ç”±ä»¥ä¸‹è¯¯å·®è¾¹ç•Œï¼š

    - $\| \bm{x} - \bm{x^{(k)}}\| \le \|T\|^k \| \bm{x} - \bm{x^{0}}\|$
        - $\| \bm{x} - \bm{x^{(k)}}\| \approx \rho(T)^k \| \bm{x} - \bm{x^{0}}\|$ã€‚å› æ­¤ï¼Œ**è°±åŠå¾„è¶Šå°ï¼Œè¿­ä»£æ³•çš„æ”¶æ•›é€Ÿåº¦è¶Šå¿«**

    - $\| \bm{x} - \bm{x^{(k)}}\| \le \dfrac{\|T\|^k}{1 - \|T\|} \| \bm{x^{(1)}} - \bm{x^{0}}\|$

    >è¯¥å®šç†åŒæ ·å¯¹åº”â€œ[ä¸åŠ¨ç‚¹å®šç†](2.md#fixed-point-iteration)â€ä¸€èŠ‚ä¸­ç»™å‡ºçš„é‚£2ä¸ªä¸ç­‰å¼æ¨è®º

    !!! proof "è¯æ˜å¯ä»¥çœ‹[å‰è¾ˆçš„ç¬”è®°](https://note.jiepeng.tech/CS/NA/Chapter_07/#error-bounds-for-iterative-methods)"

!!! theorem "å®šç†"

    å¦‚æœ $A$ æ˜¯ä¸€ä¸ªä¸¥æ ¼å¯¹è§’å ä¼˜çŸ©é˜µï¼Œé‚£ä¹ˆå¯¹äºä»»æ„é€‰æ‹©çš„åˆå§‹è¿‘ä¼¼è§£ $\bm{x^{(0)}}$ï¼Œæ— è®ºä½¿ç”¨é›…å¯æ¯”æ–¹æ³•è¿˜æ˜¯é«˜æ–¯-å¡å¾·å°”æ–¹æ³•ï¼Œéƒ½å¯ä»¥è®©åºåˆ— $\{ \bm{x^{(k)}} \}_{k=0}^\infty$ æ”¶æ•›åˆ° $A\bm{x} = \bm{b}$ çš„å”¯ä¸€è§£ã€‚

    ??? proof "è¯æ˜ï¼ˆæç¤ºï¼‰"

        åªéœ€è¯æ˜ $\forall |\lambda| \ge 1$ï¼Œæœ‰ $|\lambda I - T| \ne 0$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œ$\lambda$ ä¸èƒ½ç§°ä¸ºå¯¹åº”è¿­ä»£çŸ©é˜µ $T$ çš„ç‰¹å¾å€¼ã€‚


### Relaxation Methods

???+ note "æ®‹å·®å‘é‡"

    å‡è®¾ $\widetilde{\bm{x}} \in \mathbb{R}^n$ æ˜¯çº¿æ€§æ–¹ç¨‹ç»„ $A \bm{x} = \bm{b}$ çš„è¿‘ä¼¼è§£ï¼Œé‚£ä¹ˆå…³äºè¯¥çº¿æ€§æ–¹ç¨‹ç»„çš„ $\widetilde{\bm{x}}$ çš„**æ®‹å·®å‘é‡**(residual vector)ä¸º $\bm{r} = \bm{b} - A \widetilde{\bm{x}}$

æ¥ä¸‹æ¥æˆ‘ä»¬ä»æ®‹å·®å‘é‡çš„è§’åº¦å®¡è§†é«˜æ–¯-å¡å¾·å°”æ–¹æ³•ï¼š

$$
\begin{align}
x_i^{(k)} & = \dfrac{1}{a_{ii}} \Big[ b_i - \sum\limits_{j=1}^{i-1} a_{ij} x_i^{(k)} - \sum\limits_{j=i+1}^n a_{ij} x_j^{(k-1)} \Big] \notag \\
& = x_i^{(k-1)} + \dfrac{r_i^{(k)}}{a_{ii}} \quad \text{ where } r_i^{(k)} = b_i - \sum\limits_{j < i} a_{ij} x_j^{(k)} - \sum\limits_{j \ge i} a_{ij} x_j^{(k-1)} \notag
\end{align}
$$

ä»¤ $x_i^{(k)} = x_i^{(k-1)} + \textcolor{red}{\omega} \dfrac{r_i^{(k)}}{a_{ii}}$ã€‚å¯¹äºæ­£æ•° $\omega$ çš„æŸç§é€‰æ‹©ï¼Œæˆ‘ä»¬èƒ½å¤Ÿå‡å°‘æ®‹å·®å‘é‡ $\bm{r}$ çš„èŒƒæ•°ï¼Œå¹¶ä¸”å¾—åˆ°æ›´å¿«çš„æ”¶æ•›ã€‚è¿™æ ·çš„æ–¹æ³•ç§°ä¸º**æ¾å¼›æ³•**(relaxation methods)ã€‚æ ¹æ® $\omega$ çš„å¤§å°ï¼Œæˆ‘ä»¬æœ‰ä»¥ä¸‹å‡ ç±»æ¾å¼›æ³•ï¼š

- $0 < \omega < 1$ï¼š**æ¬ æ¾å¼›æ³•**(under-relaxation methods)
- $\omega = 1$ï¼š**é«˜æ–¯-å¡å¾·å°”æ–¹æ³•**
- $\omega > 1$ï¼š**é€æ¬¡è¶…æ¾å¼›æ³•**(successive over-relaxation methods, **SOR**)
    - é€šå¸¸èƒ½åŠ é€Ÿæ”¶æ•›ï¼Œè¿™å°±æ˜¯â€œè¶…æ¾å¼›â€çš„ç”±æ¥â€”â€”å®ƒâ€œè¶…å‰â€åœ°è°ƒæ•´äº†æ›´æ–°æ–¹å‘ï¼Œä½¿å¾—è¿­ä»£æ­¥é•¿æ›´å¤§ï¼Œæ›´å¿«åœ°é€¼è¿‘çœŸå®è§£

ç”¨çŸ©é˜µå½¢å¼å¯ä»¥è¡¨è¿°ä¸ºï¼š

$$
\begin{align}
x_i^{(k)} & = x_i^{(k-1)} + \omega \dfrac{r_i^{(k)}}{a_{ii}} = (1 - \omega)x_i^{(k-1)} + \dfrac{\omega}{a_{ii}} \Big[ -\sum\limits_{j<i} a_{ij} x_j^{(k)} - \sum\limits_{j>i} a_{ij} x_j^{k-1} + b_i \Big] \notag \\
& \Rightarrow\ \bm{x^{(k)}} = (1 - \omega) \bm{x^{(k-1)}} + \omega D^{-1} [L \bm{x^{(k)}} + U \bm{x^{(k-1)}} + \bm{b}] \notag \\
& \Rightarrow\ \underbrace{(D - \omega L)^{-1} [(1 - \omega) D + \omega U]}_{T_{\omega}} \bm{x}^{(k-1)} + \underbrace{(D - \omega L)^{-1} \omega}_{\bm{c_\omega}} \bm{b} \notag
\end{align}
$$

ä¹Ÿå°±æ˜¯è¯´ï¼ŒSOR è¿­ä»£æ³•çš„é€’æ¨å…¬å¼ä¸ºï¼š$\bm{x}^{(k)} = T_\omega \bm{x}^{(k-1)} + \bm{c}_\omega \bm{b}$ã€‚

æ˜¾ç„¶ï¼ŒçŸ©é˜µ $T_\omega$ çš„è¡¨ç¤ºè¿‡äºå¤æ‚ï¼Œå› è€Œå¾ˆéš¾å‡†ç¡®å¾—åˆ°å®ƒçš„è°±åŠå¾„ã€‚ä½†å¥½åœ¨æˆ‘ä»¬è¿˜å¯ä»¥èµ°ä»¥ä¸‹â€œæ·å¾„â€ï¼Œæœ‰åŠ©äºæˆ‘ä»¬é€‰æ‹©åˆé€‚çš„ $\omega$ å€¼ã€‚

!!! theorem "ä¸€äº›å®šç†"

    === "å®šç†1"

        **Kahan å®šç†**ï¼šè‹¥ $a_{ii} \ne 0\ (i = 1, 2, \dots, n)$ï¼Œé‚£ä¹ˆ $\rho(T_\omega) \ge |\omega - 1|$ï¼Œè¿™ä¹Ÿå°±æ„å‘³ç€ SOR æ–¹æ³•ä»…åœ¨ $0 < \omega < 2$ æ—¶æ”¶æ•›ã€‚

    === "å®šç†2"

        **Ostrowski-Reich å®šç†**ï¼šè‹¥ $A$ æ˜¯**æ­£å®š**çŸ©é˜µä¸” $0 < \omega < 2$ï¼Œé‚£ä¹ˆ SOR æ–¹æ³•å¯¹äºä»»æ„åˆå§‹è¿‘ä¼¼è§£å‡èƒ½æ”¶æ•›ã€‚

    === "å®šç†3"

        å¦‚æœ $A$ æ˜¯**æ­£å®š**çš„**ä¸‰å¯¹è§’çº¿**çŸ©é˜µï¼Œé‚£ä¹ˆ $\rho(T_g) = |\rho(T_j)|^2 < 1$ï¼Œä¸” SOR æ–¹æ³•ä¸­ $\omega$ çš„æœ€ä¼˜é€‰æ‹©æ˜¯ $\omega = \dfrac{2}{1 + \sqrt{1 - |[\rho(T_j)]^2|}}$ï¼Œæ­¤æ—¶ $\rho(T_\omega) = \omega - 1$ã€‚

!!! question "è®¨è®º"

    === "é¢˜ç›®"

        ç»™å®š $A = \begin{bmatrix}2 & 1 \\ 1 & 2\end{bmatrix}, \bm{b} = \begin{bmatrix}1 \\ 2\end{bmatrix}$ï¼Œä»¥åŠè¿­ä»£æ³• $\bm{x^{(k)}} = \bm{x^{(k-1)}} + \omega (A\bm{x^{(k-1)}} - \bm{b})$ï¼Œé‚£ä¹ˆï¼š

        - å½“ $\omega$ å–ä»€ä¹ˆå€¼æ—¶ï¼Œè¯¥æ–¹æ³•ä¼šæ”¶æ•›ï¼Ÿ
        - å½“ $\omega$ å–ä»€ä¹ˆå€¼æ—¶ï¼Œè¯¥æ–¹æ³•çš„æ”¶æ•›é€Ÿåº¦æœ€å¿«ï¼Ÿ

    === "è§£ç­”"

        è€ƒè™‘ $T = I + \omega A$ çš„ç‰¹å¾å€¼ï¼Œè§£å¾— $\lambda_1 = 1 + \omega, \lambda_2 = 1 + 3 \omega$

        - è¦ä½¿è¯¥æ–¹æ³•æ”¶æ•›ï¼Œéœ€æ»¡è¶³ $\rho(T) < 1 \quad \Rightarrow -\dfrac{2}{3} < \omega < 0$
        - ç°åœ¨è€ƒè™‘ $\rho(T) = \max\{|1 + \omega|, |1 + 3\omega|\}$ åœ¨ä½•æ—¶å–æœ€å°å€¼ï¼ˆå³æ”¶æ•›é€Ÿåº¦æœ€å¿«çš„æ—¶å€™ï¼‰â€”â€”æˆ‘ä»¬å¯ä»¥ç”»å›¾ç ”ç©¶ï¼š

        <div style="text-align: center">
            <img src="images/C7/3.png" width=40%/>
        </div>

        å‘ç°å½“ $\omega = -\dfrac{1}{2}$ æ—¶å–å€¼æœ€å°ã€‚

??? code "ç®—æ³•ï¼šSOR è¿­ä»£æ³•"

    å¯¹äºç»™å®šçš„åˆå§‹è¿‘ä¼¼è§£ $\bm{x}^{(0)}$ å’Œå‚æ•° $\omega$ï¼Œæ±‚è§£ $A\bm{x} = \bm{b}$

    - è¾“å…¥ï¼šæ–¹ç¨‹å’ŒæœªçŸ¥æ•°çš„ä¸ªæ•° $n$ï¼ŒçŸ©é˜µå…ƒç´  $a[][]$ï¼Œå¸¸æ•°é¡¹ $b[]$ï¼Œåˆå§‹è¿‘ä¼¼è§£ $X0[]$ï¼Œå‚æ•° $\omega$ï¼Œå®¹å¿å€¼ $TOL$ï¼Œæœ€å¤§è¿­ä»£æ¬¡æ•° $N_{max}$
    - è¾“å‡ºï¼šè¿‘ä¼¼è§£ $X[]$ æˆ–é”™è¯¯ä¿¡æ¯

    ```c
    Step 1  Set k = 1;
    Step 2  while (k <= N_max) do step 3-6
            Step 3  for i = 1, ..., n
                        Set X[i] = (1 - omega) * X0[i] + (omega * (-sum(j=1, i-1, a[i][j] * x[j]) - sum(j=i+1, n, a[i][j] * X0[j]) + b[i])) / a[i][i]  // compute x^k
            Step 4  if norm(X - X0)_infty = max(1<=i<=n, X[i] - X0[i]) < TOL then Output(X[]);
                    STOP;    // successful
            Step 5  for i = 1, ..., n  Set X0[] = X[];  // update X0
            Step 6  Set k++;
    Step 7  Output (Maximum number of iterations exceeded);
            STOP.    // unsuccessful
    ```


## Error Bounds and Iterative Refinement

ç›®æ ‡ï¼šç ”ç©¶ $A$ å’Œ $\bm{b}$ çš„è¯¯å·®ä¼šå¦‚ä½•å½±å“ $A \bm{x} = \bm{b}$ çš„è§£ $\bm{x}$ï¼Ÿ

å‡è®¾ <u>$A$ æ˜¯å‡†ç¡®çš„ï¼Œ$\bm{b}$ æœ‰è¯¯å·® $\delta \bm{b}$</u>ï¼Œé‚£ä¹ˆå¸¦æœ‰è¯¯å·®çš„è§£å¯ä»¥å†™æˆ $\bm{x} + \delta \bm{x}$ã€‚å¯ä»¥å¾—åˆ°ï¼š

$$
A (\bm{x} + \delta \bm{x}) = \bm{b} + \delta \bm{b} \Rightarrow \dfrac{\| \delta \bm{x} \|}{\| \bm{x} \|} \le \| A \| \cdot \| A^{-1} \| \cdot \dfrac{\| \delta \bm{b} \|}{\| \bm{b} \|}
$$

å…¶ä¸­ $\| A \| \cdot \| A^{-1} \|$ è¢«ç§°ä¸º**ç›¸å¯¹æ”¾å¤§å› å­**(relative amplification factor)ã€‚

??? proof "è¯æ˜"

    ç”± $\bm{b} = A\bm{x}$ï¼Œæ ¹æ®èŒƒæ•°çš„æ€§è´¨å¯ä»¥å¾—åˆ° $\|\bm{b}\| \le \|A\| \cdot \|\bm{x}\|$ï¼Œå› æ­¤ $\dfrac{1}{\|\bm{x}\|} \le \dfrac{\|A\|}{\|\bm{b}\|}$ã€‚æ‰€ä»¥ï¼š

    $$
    \dfrac{\| \delta \bm{x} \|}{\| \bm{x} \|} \le \dfrac{\| A \| \cdot \| A^{-1} \|}{\| \bm{b} \|} \cdot \| \delta \bm{b} \|
    $$

!!! theorem "å®šç†"

    å¦‚æœçŸ©é˜µ $B$ åœ¨æŸäº›è‡ªç„¶èŒƒæ•°ä¸Šæ»¡è¶³ $\| B \| < 1$ï¼Œé‚£ä¹ˆï¼š

    - $I \pm B$ æ˜¯éå¥‡å¼‚çš„
    - $\| (I \pm B)^{-1} \| \le \dfrac{1}{1 - \| B \|}$

---
å‡å¦‚ <u>$\bm{b}$ æ˜¯å‡†ç¡®çš„ï¼Œ$A$ æœ‰è¯¯å·® $\delta A$</u>ï¼Œé‚£ä¹ˆå¸¦æœ‰è¯¯å·®çš„è§£å¯ä»¥å†™æˆ $\bm{x} + \delta \bm{x}$ã€‚å¯ä»¥å¾—åˆ°ï¼š

$$
\begin{align}
& (A + \delta A) (\bm{x} + \delta \bm{x}) = \bm{b} \notag \\
\Rightarrow & \dfrac{\| \delta \bm{x} \|}{\| \bm{x} \|} \le \dfrac{\| A^{-1} \| \cdot \| \delta A \|}{1 - \| A^{-1} \| \cdot \| \delta A \|} = \dfrac{\| A^{-1} \| \cdot \| A \| \cdot \frac{\| \delta A \|}{\| A \|}}{1 - \| A^{-1} \| \cdot \| A \| \cdot \frac{\| \delta A \|}{\| A \|}} \notag
\end{align}
$$

å…¶ä¸­ $\| A \| \cdot \| A^{-1} \|$ æ˜¯è¯¯å·®æ”¾å¤§çš„å…³é”®å› å­ï¼Œè¢«ç§°ä¸º**æ¡ä»¶æ•°**(condition number)ï¼Œè®°ä½œ $K(A)$ã€‚

- å¦‚æœ $K(A)$ æ¥è¿‘1ï¼Œé‚£ä¹ˆçŸ©é˜µ $A$ æ˜¯**è‰¯æ€çš„**(well-conditioned)
- å¦‚æœ $K(A)$ æ¯”è¿œå¤§äº1ï¼Œé‚£ä¹ˆçŸ©é˜µ $A$ æ˜¯**ç—…æ€çš„**(ill-conditioned)

!!! theorem "å®šç†"

    å‡è®¾ $A$ æ˜¯éå¥‡å¼‚çš„ï¼Œä¸” $\| \delta A \| < \dfrac{1}{\| A^{-1} \|}$ã€‚é‚£ä¹ˆ $(A + \delta A) (\bm{x} + \delta \bm{x}) = \bm{b} + \delta \bm{b}$ çš„è§£ $\bm{x} + \delta \bm{x}$ è¿‘ä¼¼äº $A \bm{x} = \bm{b}$ çš„è§£ $\bm{x}$ï¼Œï¼ˆç›¸å¯¹ï¼‰è¯¯å·®ä¸ºï¼š

    $$
    \dfrac{\| \delta \bm{x} \|}{\| \bm{x} \|} \le \dfrac{K(A)}{1 - K(A) \frac{\| \delta A\|}{\| A \|}} \Big(\dfrac{\| \delta A \|}{\| A \|} + \dfrac{\| \delta \bm{b} \|}{\| \bm{b} \|} \Big)
    $$

!!! note "æ³¨"

    >æ¡ä»¶æ•° $K(A)_i$ çš„ä¸‹æ ‡ $i$ è¡¨ç¤ºæ‰€ä½¿ç”¨çš„[çŸ©é˜µèŒƒæ•°](#matrix-norms)çš„ç±»å‹ï¼ˆæ¯”å¦‚ $i=2$ è¡¨ç¤ºçš„å°±æ˜¯ 2-èŒƒæ•°ï¼‰

    - å¦‚æœ $A$ æ˜¯**å¯¹ç§°çš„**ï¼Œé‚£ä¹ˆ $K(A)_2 = \dfrac{\max |\lambda|}{\min |\lambda|}$
    - å¯¹äºæ‰€æœ‰è‡ªç„¶èŒƒæ•° $\| \cdot \|_p$ï¼Œ$K(A)_p \ge 1$
    - $\forall\ \alpha \in R, K(\alpha A) = K(A)$
    - å¦‚æœ $A$ æ˜¯æ­£äº¤çš„ï¼ˆå³ $A^{-1} = A^T$ï¼‰ï¼Œé‚£ä¹ˆ $K(A)_2 = 1$
    - å¯¹äºæ‰€æœ‰æ­£äº¤çŸ©é˜µ $R$ï¼Œ$K(RA)_2 = K(AR)_2 = K(A)_2$

???+ question "è®¨è®º"

    === "é—®é¢˜"

        å¯¹äºç»™å®šçš„ $A = \begin{bmatrix}1 & 0.99 \\ 0.99 & 0.98\end{bmatrix}, \bm{b} = \begin{bmatrix}1.99 \\ 1.97\end{bmatrix}$

        1. è®¡ç®— $K(A)_2$
        2. ç»™ $\bm{b}$ ä¸€ä¸ªå¾ˆå°çš„æ‰°åŠ¨ $\delta \bm{b} = \begin{bmatrix}-0.97 \times 10^{-4} \\ 0.106 \times 10^{-3}\end{bmatrix}$ï¼ŒåŸæ–¹ç¨‹çš„è§£ä¼šæœ‰ä»€ä¹ˆå˜åŒ–ï¼Ÿ

    === "è§£ç­”"

        ç›´æ¥ä»[å‰è¾ˆç¬”è®°](https://note.jiepeng.tech/CS/NA/Chapter_07/#_9)ä¸Š copy ä¸‹æ¥çš„ï¼š

        <div style="text-align: center">
            <img src="images/C7/5.png" width=60%/>
        </div>
        <div style="text-align: center">
            <img src="images/C7/6.png" width=80%/>
        </div>


### Iterative Refinement

!!! theorem "å®šç†"

    å‡è®¾ $\bm{x}^*$ æ˜¯ $A \bm{x} = \bm{b}$ çš„è¿‘ä¼¼è§£ï¼Œ$A$ æ˜¯ä¸€ä¸ªéå¥‡å¼‚çŸ©é˜µï¼Œ$\bm{r} = \bm{b} - A\bm{x}$ æ˜¯ $\bm{x}^*$ çš„æ®‹å·®å‘é‡ã€‚é‚£ä¹ˆå¯¹äºä»»æ„è‡ªç„¶èŒƒæ•°ï¼Œ$\| \bm{x} - \bm{x}^* \| \le \| \bm{r} \| \cdot \| A^{-1} \|$ã€‚ä¸”å¦‚æœ $\bm{x} \ne \bm{0}, \bm{b} \ne \bm{0}$ï¼Œé‚£ä¹ˆï¼š

    $$
    \dfrac{\| \bm{x} - \bm{x}^* \|}{\| \bm{x} \|} \le K(A) \dfrac{\| \bm{r} \|}{\| \bm{b} \|}
    $$

**è¿­ä»£ä¼˜åŒ–**(iterative refinement)çš„æ­¥éª¤ä¸ºï¼š

1. $A \bm{x} = \bm{b} \Rightarrow$ è¿‘ä¼¼è§£ $\bm{x}_1$
2. $\bm{r}_1 = \bm{b} - A \bm{x}_1$
3. $A \bm{d}_1 = \bm{r}_1 \Rightarrow \bm{d}_1$
    - å¦‚æœ $\bm{d}_1$ æ˜¯ç²¾ç¡®çš„ï¼Œé‚£ä¹ˆ $\bm{x}_2 = \bm{x}_1 + A^{-1} (\bm{b} - A\bm{x}_1) = A^{-1} \bm{b}$ï¼Œ$\bm{x}_2$ ä¹Ÿæ˜¯ç²¾ç¡®çš„ã€‚
4. $\bm{x}_2 = \bm{x}_1 + \bm{d}_1$

ä¹‹åé‡å¤ 2-4 æ­¥ã€‚

??? code "ç®—æ³•ï¼šè¿­ä»£ä¼˜åŒ–"

    <div style="text-align: center">
        <img src="images/C7/7.png" width=90%/>
    </div>


>å¯¹åº”çš„[ä½œä¸šç»ƒä¹ ](hw.md#chap-7-iterative-techniques-in-matrix-algebra)ğŸ“

>å¯¹åº”[å°æµ‹5å’Œ6](quizzes.md)ğŸ’¯