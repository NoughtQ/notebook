---
counter: true
---

# Chap 8: Approximation Theory

??? abstract "æ ¸å¿ƒçŸ¥è¯†"

    - LSA
        - ç¦»æ•£
        - è¿ç»­ï¼šæ­£äº¤å¤šé¡¹å¼
    - åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼
        - ç»æµåŒ–

è¿‘ä¼¼ç†è®ºçš„ç›®æ ‡æ˜¯ï¼šç»™å®š $x_1, \dots, x_m$ å’Œ $y_1, \dots y_m$ï¼Œå¯»æ‰¾æ›´ç®€å•çš„å‡½æ•° $P(x) \approx f(x)$ï¼ˆè¿‘ä¼¼è¡¨ç¤º $f(x)$ï¼‰ã€‚

ç„¶è€Œï¼Œå› ä¸ºæœ‰æ—¶ $m$ å¯èƒ½ä¼šç‰¹åˆ«å¤§ï¼Œå¹¶ä¸” $y_i$ æ˜¯ä¸å‡†ç¡®çš„å®éªŒæ•°æ®ï¼ˆå³ $y_i \ne f(x_i)$ï¼‰ï¼Œæ‰€ä»¥æ­¤æ—¶æ›´åˆç†çš„åšæ³•æ˜¯å»å¯»æ‰¾æœ€ä½³æ‹Ÿåˆçš„ $P(x)$ï¼Œä½¿å¾—å¯¹äºæ‰€æœ‰ç‚¹è€Œè¨€ï¼Œ$P(x_i) - y_i$ å°½å¯èƒ½å°ã€‚ä¸‹é¢æˆ‘ä»¬å°±æ¥ä»‹ç»è¿™äº›æ•°å­¦æ–¹æ³•ã€‚


## Discrete Least Square Approximation

ç›®æ ‡ï¼šç¡®å®šä¸€ä¸ªå¤šé¡¹å¼ $P_n(x) = a_0 + a_1 x + \dots a_n x^n$ï¼Œç”¨äºè¿‘ä¼¼è¡¨ç¤ºä¸€ç»„æ•°æ® $\{(x_i, y_i)\ |\ i = 1, 2, \dots, m\}$ï¼Œä½¿å¾—æœ€å°äºŒä¹˜è¯¯å·® $E_2 = \sum\limits_{i=1}^m [P_N(x_i) - y_i]^2$ æœ€å°åŒ–ï¼Œå…¶ä¸­ $n \ll m$

å…³é”®ï¼š$E_2$ å®é™…ä¸Šæ˜¯ä¸€ä¸ªå…³äº $a_0, a_1, \dots, a_n$ çš„å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ $E_2(a_0, a_1, \dots, a_n) = \sum\limits_{i=1}^m [a_0 + a_1 x_i + \dots + a_n x_i^n - y_i]^2$ã€‚è¦æƒ³è®© $E_2$ æœ€å°åŒ–ï¼Œå¿…è¦æ¡ä»¶æ˜¯ $\dfrac{\partial E_2}{\partial a_k} = 0, k = 0, \dots, n$

$$
\begin{align}
0 & = \dfrac{\partial E_2}{\partial a_k} = 2\sum\limits_{i=1}^m [P_N(x_i) - y_i]^2 \dfrac{\partial P_n(x_i)}{\partial a_k} = 2 \sum\limits_{i=1}^m \Big[\sum\limits_{j=0}^n a_j x_i^j - y_i \Big]x_i^k \notag \\
& = 2\Big\{\sum\limits_{j=0}^n a_j \Big(\sum\limits_{i=1}^m x_i^{j+k}\Big) - \sum\limits_{j=1}^m y_i x_i^k\Big\} \notag
\end{align}
$$

ä»¤ $b_k = \sum\limits_{i=1}^m x_i^k, c_k = \sum\limits_{i=1}^m y_i x_i^k$ï¼Œé‚£ä¹ˆï¼š

$$
\begin{bmatrix}b_{0+0} & \dots & b_{0+n} \\ \vdots & \vdots & \vdots \\ b_{n+0} & \dots & b_{n+n}\end{bmatrix} \begin{bmatrix}a_0 \\ \vdots \\ a_n\end{bmatrix} = \begin{bmatrix}c_0 \\ \vdots \\ c_n\end{bmatrix}
$$

!!! note "æ³¨"

    - $P_n(x)$ çš„é¡ºåºç”±ç”¨æˆ·ç»™å‡ºï¼Œä¸”å¿…é¡»ä¸å¾—è¶…è¿‡ $m-1$ã€‚è‹¥ $n=m-1$ï¼Œé‚£ä¹ˆ $P_n(x)$ å°±æ˜¯ $E_2 = 0$ çš„æ‹‰æ ¼æœ—æ—¥æ’å€¼å¤šé¡¹å¼
    - ä¸å¼ºåˆ¶è¦æ±‚ $P_n(x)$ æ˜¯ä¸€ä¸ªå¤šé¡¹å¼
    - å¦‚æœè¦è€ƒè™‘æƒé‡ $w_i$ çš„è¯ï¼ŒLSA çš„å…¬å¼å°±å˜æˆï¼š$E_2 = \sum\limits_{i=1}^m w_i [P_N(x_i) - y_i]^2$

??? example "ä¾‹å­"

    === "ä¾‹1"

        === "é¢˜ç›®"

            <div style="text-align: center">
                <img src="images/C8/1.png" width=80%/>
            </div>

        === "è§£ç­”"

            === "æ³•1"

                ä»¤ $y \approx P(x) = \dfrac{x}{ax + b}$ï¼Œå¯»æ‰¾ $a, b$ï¼Œä½¿å¾— $E_2(a, b) = \sum\limits_{i=1}^m \Big(\dfrac{x_i}{ax_i + b} - y_i\Big)^2$ æœ€å°åŒ–ã€‚

                **çº¿æ€§åŒ–**(linearization)ï¼šä»¤ $Y = \dfrac{1}{y}, X = \dfrac{1}{x}$ï¼Œé‚£ä¹ˆ $Y \approx a + b X$ å°±æ˜¯ä¸€ä¸ªçº¿æ€§é—®é¢˜äº†ã€‚

                å°† $(x_i, y_i)$ è½¬æ¢ä¸º $(X_i, Y_i)$ï¼Œ$a, b$ å°±èƒ½è¢«è§£å‡ºæ¥äº†ã€‚

            === "æ³•2"

                ä»¤ $y \approx P(x) = ae^{-\frac{b}{x}}$ï¼Œä¸éš¾å‘ç° $\ln y \approx \ln a - \dfrac{b}{x}$

                **çº¿æ€§åŒ–**ï¼šä»¤ $Y = \ln y, X = \dfrac{1}{x}, A = \ln a, B = -b$ï¼Œå¾—åˆ° $Y \approx A + BX$ è¿™æ ·ä¸€ä¸ªçº¿æ€§é—®é¢˜ã€‚

                å°† $(x_i, y_i)$ è½¬æ¢ä¸º $(X_i, Y_i)$ï¼Œ$a, b$ å°±èƒ½è¢«è§£å‡ºæ¥äº†ï¼ˆ$a = e^A, b = -B, P(x) = ae^{-\frac{b}{x}}$ï¼‰

    === "ä¾‹2"

        === "é¢˜ç›®"

            <div style="text-align: center">
                <img src="images/C8/8.png" width=80%/>
            </div>

        === "è§£ç­”"

            - æ‹¿é‚£ä¸ªå¸¦æƒé‡çš„ LSA å…¬å¼è®¡ç®—ï¼Œå¾—åˆ°ä¸€ä¸ªå…³äº $a, b$ çš„å‡½æ•°
            - å½“æ‰€æœ‰åå¯¼æ•°å‡ä¸º0æ—¶ï¼Œå‡½æ•°å€¼æœ€å°ï¼›æ‰€ä»¥åœ¨ä»£å…¥å…·ä½“å€¼å‰ï¼Œå»ºè®®å…ˆåŒ–ç®€åå¯¼æ•°å…¬å¼ï¼Œä»¥å‡å°è®¡ç®—é‡
            - å¾—åˆ°çš„åå¯¼æ•°ä¸ºï¼š$\begin{cases}\dfrac{\partial S}{\partial a} = 0 \Rightarrow \sum w_i x_i y_i = 0 \\ \dfrac{\partial S}{\partial b} = 0 \Rightarrow \sum w_i x_i^3 y_i = 0\end{cases}$
            - å†ä»£å…¥å…·ä½“å€¼ï¼Œå°±å¯ä»¥å¾—åˆ°å…³äº $a, b$ çš„äºŒå…ƒä¸€æ¬¡æ–¹ç¨‹
            - è§£å¾— $a = \dfrac{8}{7}, b = \dfrac{23}{49}$


## Orthorgonal Polynomials and Least Squares Approximation

ç›®æ ‡ï¼š

- ç¦»æ•£ç‰ˆæœ¬ï¼šç»™å®š $x_1, \dots, x_m;\ y_1, \dots, y_m$ï¼Œæ‰¾åˆ°æ›´ç®€å•çš„å‡½æ•° $P(x) \approx f(x)$ï¼Œä½¿å¾— $E = \sum\limits_{i=1}^m |P(x_i) - y_i|^2$ æœ€å°åŒ–ã€‚
- è¿ç»­ç‰ˆæœ¬ï¼šç»™å®šåœ¨ $[a, b]$ ä¸Šçš„å‡½æ•° $f(x)$ï¼Œæ‰¾åˆ°æ›´ç®€å•çš„å‡½æ•° $P(x) \approx f(x)$ï¼Œä½¿å¾— $E = \int_a^b [P(x) - f(x)]^2 dx$ æœ€å°åŒ–ã€‚

!!! definition "å®šä¹‰"

    å¯¹äºä¸€ç»„åœ¨åŒºé—´ $[a, b]$ ä¸Šçš„å‡½æ•° $\{\varphi_0(x), \varphi_1(x), \dots, \varphi_n(x)\}$ï¼Œå½“ $\forall x \in [a, b]$ï¼Œ$a_0 \varphi_0(x) + a_1 \varphi_1(x) + \dots + a_n \varphi_n(x) = 0$ æ—¶ï¼Œæœ‰ $a_0 = a_1 \dots = a_n = 0$ï¼Œé‚£ä¹ˆç§°è¿™ç»„å‡½æ•°æ˜¯**çº¿æ€§ç‹¬ç«‹**(linearly independent)çš„ï¼Œå¦åˆ™ç§°å®ƒä»¬æ˜¯**çº¿æ€§ç›¸å…³**(linearly dependent)çš„ã€‚

!!! theorem "å®šç†"

    å¦‚æœ $\varphi_j(x)$ æ˜¯ä¸€ä¸ª $j$ æ¬¡å¤šé¡¹å¼ï¼ˆ$j = 0, \dots, n$ï¼‰ï¼Œé‚£ä¹ˆ $\{\varphi_0(x), \varphi_1(x), \dots, \varphi_n(x)\}$ åœ¨ä»»æ„åŒºé—´ $[a, b]$ ä¸Šéƒ½æ˜¯**çº¿æ€§ç‹¬ç«‹çš„**(linear independent)ã€‚

    ??? proof "è¯æ˜"

        å‡è®¾ç»“è®ºä¸æˆç«‹ï¼Œæ ¹æ®å®šä¹‰ï¼Œ$\exists a_0, a_1, \dots, a_n, \forall x \in [a, b]$ ä½¿å¾— $P(x) = a_0 \varphi_0(x) + a_1 \varphi_1(x) + \dots + a_n \varphi_n(x) = 0$ã€‚
        
        æ­¤æ—¶ $P(x)$ æ˜¯ä¸€ä¸ªé›¶å¤šé¡¹å¼ï¼Œ$x^n$ çš„ç³»æ•°ä¸º0ï¼Œå³ $a_n = 0$ï¼Œé‚£ä¹ˆ $P(x) = a_0 \varphi_0(x) + a_1 \varphi_1(x) + \dots + a_{n-1} \varphi_{n-1}(x) = 0$ã€‚åŒç†å¯ä»¥æ¨å‡º $a_{n-1} = 0$ï¼Œä»¥æ­¤ç±»æ¨ï¼Œæœ€ç»ˆå‘ç°æ‰€æœ‰ç³»æ•°å‡ä¸º0ã€‚æ‰€ä»¥å‡è®¾ä¸æˆç«‹ï¼Œå¾—è¯ã€‚

!!! theorem "å®šç†"

    ä»¤ $\Pi_n$ ä¸ºä¸€ç»„æ¬¡æ•°è‡³å¤šä¸º $n$ çš„å¤šé¡¹å¼ï¼Œå¦‚æœ $\{\varphi_0(x), \varphi_1(x), \dots, \varphi_n(x)\}$ æ˜¯ $\Pi_n$ å†…ä¸€ç»„çº¿æ€§ç‹¬ç«‹çš„å¤šé¡¹å¼ï¼Œé‚£ä¹ˆ $\Pi_n$ å†…çš„ä»»æ„å¤šé¡¹å¼å‡å¯è¢«å”¯ä¸€å†™åš $\varphi_0(x), \varphi_1(x), \dots, \varphi_n(x)$ çš„ä¸€ä¸ªçº¿æ€§ç»„åˆã€‚

!!! definition "å®šä¹‰"

    å¯¹äºä¸€èˆ¬çš„ä¸€ç»„çº¿æ€§ç‹¬ç«‹çš„å‡½æ•° $\{\varphi_0(x), \varphi_1(x), \dots, \varphi_n(x)\}$ï¼Œå…³äºå®ƒä»¬çš„**çº¿æ€§ç»„åˆ** $P(x) = \sum\limits_{j=0}^n a_j \varphi_j(x)$ è¢«ç§°ä¸º**å¹¿ä¹‰å¤šé¡¹å¼**(generalized polynomial)ã€‚

ä¸€äº›ç‰¹æ®Šçš„å¤šé¡¹å¼ï¼š

- $\{\varphi_j(x) = \cos jx\}, \{\psi_j(x) = \sin jx\} \Rightarrow \{\varphi_j(x), \psi_j(x)\}$ å¾—åˆ°çš„æ˜¯**ä¸‰è§’å¤šé¡¹å¼**(trigonometric polynomial)
- $\{\varphi_j(x) = e^{kjx}, k_i \ne k_j\}$ å¾—åˆ°çš„æ˜¯**æŒ‡æ•°å¤šé¡¹å¼**(exponential polynomial)

!!! definition "å®šä¹‰ï¼šæƒé‡å‡½æ•°(weight function)"

    - **ç¦»æ•£**ç‰ˆæœ¬ï¼šå½“å¯¹ä¸€ç»„ç¦»æ•£ç‚¹ $(x_i, y_i) (i = 1, \dots, n)$ è¿›è¡Œè¿‘ä¼¼æ—¶ï¼Œæˆ‘ä»¬ä¸ºæ¯ä¸ªç‚¹èµ‹äºˆä¸€ä¸ªè¯¯å·®é¡¹ $w_i$ï¼Œå®ƒæ˜¯ä¸€ä¸ªæ­£å®æ•°ã€‚æ­¤æ—¶æˆ‘ä»¬è¦è€ƒè™‘è®© $E = \sum w_i [P(x_i) - y_i]^2$ æœ€å°åŒ–ã€‚é›†åˆ $\{w_i\}$ è¢«ç§°ä¸º**æƒé‡**(weight)ã€‚è®¾ç½®æƒé‡çš„ç›®æ ‡æ˜¯ä¸ºè¿™äº›ç‚¹èµ‹äºˆä¸åŒçš„â€œé‡è¦ç¨‹åº¦â€ï¼Œä»¥ä¾¿å®ç°æ›´å¥½çš„è¿‘ä¼¼ã€‚
    - **è¿ç»­**ç‰ˆæœ¬ï¼šä¸€ä¸ªåœ¨åŒºé—´ $I$ ä¸Šçš„å¯ç§¯åˆ†çš„å‡½æ•° $w$ è¢«ç§°ä¸ºæƒé‡å‡½æ•°ï¼Œå®ƒæ»¡è¶³ $\forall x \in I, w(x) \ge 0$ï¼Œä½† $w(x)$ ä¸ä¼šåœ¨ $I$ çš„ä»»æ„å­åŒºé—´ä¸Šæ¶ˆå¤±ã€‚æ­¤æ—¶æˆ‘ä»¬è¦è€ƒè™‘è®© $E = \int_a^b w(x) [P(x) - f(x)]^2 dx$ æœ€å°åŒ–ã€‚

!!! definition "å®šä¹‰ï¼šå¹¿ä¹‰çš„æœ€å°äºŒä¹˜è¿‘ä¼¼(general least square approximation)é—®é¢˜"

    - **ç¦»æ•£**ç‰ˆæœ¬ï¼šç»™å®šä¸€ç»„ç¦»æ•£ç‚¹ $(x_i, y_i)$ å’Œä¸€ç»„å¯¹åº”çš„æƒé‡ $\{w_i\}$ï¼ˆ$i = 1, \dots, m$ï¼‰ã€‚æˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ä¸ªå¹¿ä¹‰å¤šé¡¹å¼ $P(x)$ï¼Œä½¿å¾—è¯¯å·® $E = \sum w_i [P(x_i) - y_i]^2$ æœ€å°åŒ–ã€‚
    - **è¿ç»­**ç‰ˆæœ¬ï¼šç»™å®šå®šä¹‰åœ¨åŒºé—´ $[a, b]$ ä¸Šçš„ä¸€ä¸ªå‡½æ•° $f(x)$ å’Œä¸€ä¸ªæƒé‡å‡½æ•° $w(x)$ã€‚æˆ‘ä»¬è¦æ‰¾åˆ°ä¸€ä¸ªå¹¿ä¹‰å¤šé¡¹å¼ $P(x)$ï¼Œä½¿å¾—è¯¯å·® $E = \int_a^b w(x) [P(x) - f(x)]^2 dx$ æœ€å°åŒ–ã€‚

---
??? note "å†…ç§¯"

    æ˜ å°„ $V \times V \rightarrow F$ æ»¡è¶³ä»¥ä¸‹ä¸‰ä¸ªå…¬ç†ï¼š

    - å…±è½­å¯¹ç§°æ€§ï¼š$(x, y) = \overline{(y, x)}$
    - çº¿æ€§ï¼š$(ax, y) = a(x, y), (x + y, z) = (x, z) + (y, z)$
    - æ­£å®šæ€§ï¼š$(x, x) \ge 0;\ (x, x) = 0 \Rightarrow x = 0$

    å†…ç§¯å°±æ˜¯ $x$ çš„èŒƒæ•° $\|x\| = \sqrt{(x, x)}$

    å¯¹äºä¸€èˆ¬å‡½æ•° $(f, g)$ï¼š

    - ç¦»æ•£ç‰ˆæœ¬ï¼š$\sum\limits_i f_i g_i = (f_1\ f_2\ \dots\ f_n) \begin{pmatrix}g_1 \\ g_2 \\ \vdots \\ g_n\end{pmatrix} = (f)^T(g)$
    - è¿ç»­ç‰ˆæœ¬ï¼š$\int_a^b f(x)g(x) dx$

    è‹¥å¸¦æœ‰æƒé‡å‡½æ•°ï¼Œå³ $(f, g)_w$ï¼š

    - ç¦»æ•£ç‰ˆæœ¬ï¼š

        $$
        \begin{align}
        \sum\limits_i f_i g_i & = (f_1\ f_2\ \dots\ f_n) \begin{pmatrix}w_1 & 0 & \dots & 0 \\ 0 & w_2 & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ 0 & 0 & \dots & w_n\end{pmatrix} \begin{pmatrix}g_1 \\ g_2 \\ \vdots \\ g_n\end{pmatrix} \notag \\
        & = (f)^T[w](g) \notag
        \end{align}
        $$

    - è¿ç»­ç‰ˆæœ¬ï¼š$\int_a^b w(x)f(x)g(x) dx$

å¯¹äº $(f, g) = \begin{cases}\sum\limits_{i=1}^m w_i f(x_i) g(x_i) & \text{discrete version} \\ \int_a^b w(x) f(x) g(x) dx & \text{continuous version} \end{cases}$ï¼Œå¯ä»¥è¯æ˜å®ƒè¡¨ç¤ºçš„æ˜¯ä¸€ä¸ª**å†…ç§¯**(inner product)ï¼Œä¸” $\|f\| = \sqrt{(f, f)}$ æ˜¯ä¸€ä¸ª**èŒƒæ•°**ã€‚å¹¶ä¸”å½“ $(f, g) = 0$ æ—¶ï¼Œæˆ‘ä»¬ç§° $f, g$ æ˜¯**æ­£äº¤çš„**(orthogonal)ã€‚

å› æ­¤ä¸€èˆ¬çš„æœ€å°äºŒä¹˜è¿‘ä¼¼é—®é¢˜å¯ä»¥è¢«è½¬æ¢ä¸ºï¼š

!!! card ""

    <div style="text-align: center" markdown="1">
    å¯»æ‰¾ä¸€ä¸ªå¹¿ä¹‰å¤šé¡¹å¼ $P(x)$ï¼Œä½¿å¾— $E = (P - y, P - y) = \| P - y \|^2$ æœ€å°åŒ–ã€‚
    </div>

ä»¤ $P(x) = a_0 \varphi_0(x) + a_1 \varphi_1(x) + \dots + a_n \varphi_n(x)$ï¼Œç„¶åä¸æ±‚è§£ç¦»æ•£é—®é¢˜ç±»ä¼¼ï¼š$\dfrac{\partial E}{\partial a_k} = 0$ï¼Œå³å¯¹äºæ‰€æœ‰ $a_k$ åå¯¼æ•°ä¸º0æ—¶è¯¯å·®å–æœ€å°å€¼ã€‚å°†ç­‰å·å·¦ä¾§å…¬å¼åŒ–ç®€ï¼Œå¯ä»¥å¾—åˆ°ï¼š$\sum\limits_{j=0}^n (\varphi_k, \varphi_j) a_j = (\varphi_k, f), k = 0, \dots, n$ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼š

$$
\begin{bmatrix}b_{ij} = (\varphi_i, \varphi_j)\end{bmatrix} \begin{bmatrix}a_0 \\ \vdots \\ a_n\end{bmatrix} = \begin{bmatrix}(\varphi_0, f) \\  \vdots \\ (\varphi_n, f)\end{bmatrix} = \varepsilon
$$

??? example "ä¾‹å­"

    === "é¢˜ç›®"

        ä½¿ç”¨ $y = a_0 + a_1 x + a_2 x^2\ (w \equiv 1)$ è¿‘ä¼¼ç‚¹é›† $\{(1, 4), (2, 10), (3, 18), (4, 26)\}$

    === "è§£ç­”"

        $\varphi_0(x) = 1, \varphi_1(x) = x, \varphi_2(x) = x^2$ï¼Œå¯ä»¥è®¡ç®—å‡ºï¼š

        <div style="text-align: center">
            <img src="images/C8/2.png" width=70%/>
        </div>

        <div style="text-align: center">
            <img src="images/C8/3.png" width=70%/>
        </div>

        $\|B\|_{\infty} = 484, \|B^{-1}\|_{\infty} = \dfrac{63}{4} \Rightarrow K(B) = 7623$

---
???+ example "ä¾‹å­"

    å½“ä½¿ç”¨ $\varphi_j(x) = x^j$ å’Œ $w(x) \equiv 1$ è¿‘ä¼¼ $f(x) \in C[0, 1]$ æ—¶ï¼Œ$(\varphi_i, \varphi_j) = \int_0^1 x^i x^j dx = \dfrac{1}{i + j +1}$ï¼ˆ[**å¸Œå°”ä¼¯ç‰¹çŸ©é˜µ**](https://en.wikipedia.org/wiki/Hilbert_matrix)(Hilbert matrix)ï¼‰

    æ”¹è¿›ï¼šå¦‚æœæˆ‘ä»¬èƒ½æ‰¾åˆ°ä¸€ç»„ä¸€èˆ¬çš„çº¿æ€§ç‹¬ç«‹çš„å‡½æ•° $\{\varphi_0(x), \varphi_1(x), \dots, \varphi_n(x) \}$ï¼Œä½¿å¾—ä»»ä½•å‡½æ•°å¯¹ $\varphi_i(x), \varphi_j(x)$ æ˜¯**æ­£äº¤çš„**(orthogonal)ï¼Œé‚£ä¹ˆèŒƒæ•°çŸ©é˜µå°†ä¼šæ˜¯ä¸ª**å¯¹è§’çŸ©é˜µ**ã€‚æ­¤æ—¶æˆ‘ä»¬æœ‰ $a_k = \dfrac{(\varphi_k, f)}{(\varphi_k, \varphi_k)}$

ä¸‹é¢è€ƒè™‘æ„é€ **æ­£äº¤å¤šé¡¹å¼**(orthogonal polynomials)ã€‚

!!! theorem "å®šç†"

    å¯¹äºä¸€ç»„åœ¨ $[a, b]$ çš„å¤šé¡¹å¼å‡½æ•° $\{\varphi_0(x), \varphi_1(x), \dots, \varphi_n(x)\}$ ä»¥åŠä¸€ä¸ªæƒé‡å‡½æ•° $w$ï¼Œå½“æ»¡è¶³ä»¥ä¸‹æ¡ä»¶æ—¶ï¼Œæˆ‘ä»¬è®¤ä¸ºè¿™äº›å‡½æ•°æ˜¯æ­£äº¤çš„ï¼š

    $$
    \varphi_0 (x) \equiv 1, \varphi_1(x) = x - B_1, \varphi_k(x) = (x - B_k)\varphi_{k-1}(x) - C_k \varphi_{k-2}(x)
    $$

    å…¶ä¸­ $B_k = \dfrac{(x \varphi_{k-1}, \varphi_{k-1})}{(\varphi_{k-1}, \varphi_{k-1})}, C_k = \dfrac{(x \varphi_{k-1}, \varphi_{k-2})}{( \varphi_{k-2}, \varphi_{k-2})}$

    ???+ info "æ³¨"
    
        - è¿™æ ·æ„é€ å‡ºæ¥çš„æ­£äº¤å¤šé¡¹å¼éƒ½æ˜¯[**é¦–ä¸€å¤šé¡¹å¼**](https://en.wikipedia.org/wiki/Monic_polynomial)(monic polynomial)ï¼ˆå³æœ€é«˜æ¬¡æ•°é¡¹ç³»æ•°ä¸º1çš„å¤šé¡¹å¼ï¼‰ã€‚
        - è¯¥å®šç†æ­£æ˜¯æºè‡ªæˆ‘ä»¬åœ¨çº¿æ€§ä»£æ•°ä¸­å­¦è¿‡çš„[**æ ¼æ‹‰å§†-æ–½å¯†ç‰¹æ­£äº¤åŒ–**](https://en.wikipedia.org/wiki/Gram%E2%80%93Schmidt_process)(Gram-Schmidt process)ã€‚

??? example "ä¾‹å­"

    === "ä¾‹1"

        === "é¢˜ç›®"

            ï¼ˆå’Œä¹‹å‰åŸºæœ¬ä¸€æ ·çš„ï¼‰ä½¿ç”¨ $y = c_0 + c_1 x + c_2 x^2, w \equiv 1$ è¿‘ä¼¼ç‚¹é›† $\{(1, 4), (2, 10), (3, 18), (4, 26)\}$

        === "è§£ç­”"

            é¦–å…ˆæ„é€ æ­£äº¤å¤šé¡¹å¼ $\varphi_0(x), \varphi_1(x), \varphi_2(x)$ï¼Œä»¤ $y = a_0 \varphi_0(x) + a_1 \varphi_1(x) + a_2 \varphi_2(x)$ï¼ˆ$a_k = \dfrac{(\varphi_k, y)}{(\varphi_k, \varphi_k)}$ï¼‰ã€‚æ¥ä¸‹æ¥å°±è®¡ç®—å‡ºè¿™äº›å€¼ï¼š

            <div style="text-align: center">
                <img src="images/C8/4.png" width=80%/>
            </div>

            æœ€ç»ˆè§£å¾— $y = \dfrac{1}{2}x^2 + \dfrac{49}{10}x - \dfrac{3}{2}$

    === "ä¾‹2"

        === "é¢˜ç›®"

            <div style="text-align: center">
                <img src="images/C8/7.png" width=80%/>
            </div>

        === "è§£ç­”"

            çŸ¥é“å†…ç§¯çš„æ±‚è§£å…¬å¼å’Œä¸Šè¿°æ­£äº¤å¤šé¡¹å¼çš„æ„é€ åï¼Œè¿™é¢˜å…¶å®æŒºå®¹æ˜“çš„ã€‚æ‰€ä»¥å°±ç›´æ¥ç»™å‡ºç­”æ¡ˆäº†ï¼š

            - $\varphi_0(x) = 1$
            - $\varphi_1(x) = x - 2$
            - $\varphi_2(x) = x^2 - 4x + \dfrac{8}{3}$

???+ code "ç®—æ³•ï¼šæ­£äº¤å¤šé¡¹å¼è¿‘ä¼¼"

    ç”¨ä¸€ä¸ªæœ‰è¢«å®¹å¿å€¼çº¦æŸçš„è¯¯å·®çš„å¤šé¡¹å¼ï¼Œè¿‘ä¼¼ä¸€ä¸ªç»™å®šçš„å‡½æ•°ã€‚

    - è¾“å…¥ï¼šæ•°æ®ä¸ªæ•° $m$ï¼›$x[m];\ y[m]$ï¼›æƒé‡ $w[m]$ï¼›å®¹å¿å€¼ $TOL$ï¼›å¤šé¡¹å¼æœ€å¤§é˜¶æ•° $Max_n$
    - è¾“å‡ºï¼šè¿‘ä¼¼å¤šé¡¹å¼çš„ç³»æ•°

    ```c
    Step 1  Set phi_0(x) â‰¡ 1; 
                a_0 = iprod(phi_0, y) / iprod(phi_0, phi_0); 
                P(x) = a_0 * phi_0(x); 
                err = iprod(y, y) - a_0 * iprod(phi_0, y);
    Step 2  Set B_1 = iprod(x * phi_0, phi_0) / iprod(phi_0, phi_0); 
                phi_1(x) = x - B_1;
                a_1 = iprod(phi_1, y) / iprod(phi_1, phi_1); 
                P(x) += a_1 * phi_1(x); 
                err -= a_1 * iprod(phi_1, y);
    Step 3  Set k = 1;
    Step 4  while ((k < Max_n) && (|err| >= TOL)) do steps 5-7:
        Step 5  k++;
        Step 6  B_k = iprod(x * phi_1, phi_1) / iprod(phi_1, phi_1); 
                C_k = iprod(x * phi_1, phi_0) / iprod(phi_0, phi_0);
                phi_2(x) = (x - B_k) * phi_1(x) - C_k * phi_0(x); 
                a_k = iprod(phi_2, y) / iprod(phi_2, phi_2);
        Step 7  Set phi_0(x) = phi_1(x); phi_1(x) = phi_2(x);
    Step 8  Output(); STOP.
    ```

    ??? question "è®¨è®º"

        === "é—®é¢˜"

            è¿™é‡Œçš„ `err` æ˜¯å¦æ˜¯æœ€å°äºŒä¹˜è¯¯å·®ï¼Œä¸ºä»€ä¹ˆï¼Ÿ

        === "è§£ç­”"

            æ˜¯çš„ï¼Œå¹¶ä¸” `err` çš„æ¨å¯¼å…¬å¼å¦‚ä¸‹ï¼š

            $$
            \begin{align}
            err & = \| P - y \|^2 = (P - y, P - y) = (\sum\limits_{k=0}^n a_k \varphi_k - y, \sum\limits_{i=0}^n a_i \varphi_i - y) \notag \\
            & = \sum\limits_{k=0}^n a_k^2 (\varphi_k, \varphi_k) - 2 \sum\limits_{k=0}^n a_k (\varphi_k, y) + (y, y) = (y, y) - \sum\limits_{k=0}^n a_k (\varphi_k, y) \notag
            \end{align}
            $$



## Chebyshev Polynomials and Economization of Power Series

å‰é¢è®²è¿‡ï¼Œè§£å†³ä¸€èˆ¬çš„æœ€å°äºŒä¹˜è¿‘ä¼¼é—®é¢˜çš„ç›®æ ‡æ˜¯ï¼š

!!! card ""

    <div style="text-align: center" markdown="1">
    å¯»æ‰¾ä¸€ä¸ªå¹¿ä¹‰å¤šé¡¹å¼ $P(x)$ï¼Œä½¿å¾— $E = (P - y, P - y) = \| P - y \|^2$ æœ€å°åŒ–ã€‚
    </div>


å†æ¬¡æ˜ç¡®ï¼šæˆ‘ä»¬çš„ç›®æ ‡æ˜¯æœ€å°åŒ– $\|P - y\|_{\infty}$â€”â€”è¿™æ˜¯ä¸€ä¸ª**æå°åŒ–æå¤§é—®é¢˜**(minimax problem)ã€‚


### Targets

ç›®æ ‡ 1.0ï¼šæ‰¾åˆ° $n$ é˜¶å¤šé¡¹å¼ $P_n(x)$ ä½¿å¾— $\|P_n - f\|_{\infty}$ æœ€å°åŒ–ã€‚

!!! definition "å®šä¹‰"

    å¦‚æœ $P(x_0) - f(x_0) = \pm \|P - f\|_{\infty}$ï¼Œé‚£ä¹ˆæ­¤æ—¶ $x_0$ è¢«ç§°ä¸º $(\pm)$ **åå·®ç‚¹**(deviation point)ï¼ˆä¹Ÿå°±æ˜¯æ­£å¥½åœ¨è¯¯å·®è¾¹ç•Œä¸Šçš„ç‚¹ï¼‰ã€‚

ä»ä»»æ„åœ°æ–¹æ„é€ å‡ºå¤šé¡¹å¼å¹¶ä¸å®¹æ˜“ï¼Œä½†æˆ‘ä»¬èƒ½å¤Ÿæ£€éªŒå¤šé¡¹å¼çš„ä¸€äº›ç‰¹å¾ï¼š

- å¦‚æœ $f \in C[a, b]$ ä¸” $f$ **ä¸æ˜¯**ä¸€ä¸ª $n$ é˜¶å¤šé¡¹å¼ï¼Œé‚£ä¹ˆå­˜åœ¨ä¸€ä¸ªå”¯ä¸€çš„å¤šé¡¹å¼ $P_n(x)$ï¼Œä½¿å¾— $\|P_n - f\|_{\infty}$ æœ€å°åŒ–
- $P_n(x)$ å­˜åœ¨ï¼Œä¸”å¿…é¡»åŒæ—¶æœ‰æ­£è´Ÿåå·®ç‚¹
- **åˆ‡æ¯”é›ªå¤«å®šç†**(Chebyshev Theorem)ï¼š$P_n(x)$ æœ€å°åŒ–  $\|P_n - f\|_{\infty}\ \Leftrightarrow P_n(x)$ è‡³å°‘æœ‰ $n+2$ ä¸ªå…³äº $f$ çš„æ­£è´Ÿåå·®ç‚¹ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå­˜åœ¨ä¸€ç»„ç‚¹ $a \le t_1 < \dots < t_{n+2} \le b$ ä½¿å¾— $P_n(t_k) - f(t_k) = \pm(-1)^k \|P_n - f\|_{\infty}$ã€‚é›†åˆ $\{t_k\}$ è¢«ç§°ä¸º**åˆ‡æ¯”é›ªå¤«äº¤æ›¿åºåˆ—**(Chebyshev alternating sequence)ã€‚

    >$P_n(x) - f(x)$ è‡³å°‘æœ‰ $n+1$ ä¸ªæ ¹ã€‚

    <div style="text-align: center">
        <img src="images/C8/5.png" width=60%/>
    </div>

---
ç›®æ ‡ 2.0ï¼šç¡®å®šæ’å€¼ç‚¹ $\{x_0, \dots, x_n\}$ ä½¿å¾— $P_n(x)$ æœ€å°åŒ–ä½™é¡¹ $|P_n(x) - f(x)| = |R_n(x)| = \Big|\dfrac{f^{(n+1)}(\xi)}{(n+1)!} \prod\limits_{i=0}^n (x - x_i)\Big|$

ç›®æ ‡ 2.1ï¼šæ‰¾åˆ° $\{x_1, \dots, x_n\}$ ä½¿å¾— $\|w_n\|_{\infty}$ åœ¨ $[-1, 1]$ æœ€å°åŒ–ï¼Œå…¶ä¸­ $w_n(x) = \prod\limits_{i=1}^n (x - x_i)$

---
æ³¨æ„åˆ° $w_n(x) = x^n - P_{n-1}(x)$ï¼Œé—®é¢˜å°±å˜æˆäº†ï¼š

ç›®æ ‡ 3.0ï¼šæ‰¾åˆ°å¤šé¡¹å¼ $P_{n-1}(x)$ï¼Œä½¿å¾— $\|x^n - P_{n-1}(x)\|_{\infty}$ åœ¨ $[-1, 1]$ ä¸Šæœ€å°ã€‚

æ ¹æ®åˆ‡æ¯”é›ªå¤«å®šç†ï¼Œæˆ‘ä»¬çŸ¥é“ $P_{n-1}(x)$ æœ‰ $n+1$ ä¸ªå…³äº $x^n$ çš„åå·®ç‚¹ï¼Œä¹Ÿå°±æ˜¯è¯´ $w_n(x)$ åœ¨ $n+1$ ä¸ªç‚¹ä¸Šäº¤æ›¿è·å¾—æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚


### Chebyshev Polynomials

è€ƒè™‘ $\cos (n \theta)$ åœ¨ $[0, \pi]$ ä¸Šçš„ $n+1$ ä¸ªæå€¼ã€‚

ä»¤ $x = \cos (\theta)$ï¼Œé‚£ä¹ˆ $x \in [-1, 1]$ã€‚æˆ‘ä»¬ç§° $T_n(x) = \cos (n\theta) = \cos (n \cdot \text{arc} \cos x)$ ä¸º**åˆ‡æ¯”é›ªå¤«å¤šé¡¹å¼**(Chebyshev polonomial)ã€‚

- $T_n(x)$ å‡è®¾åœ¨ $t_k = \cos \Big(\dfrac{k}{n} \pi\Big) (k = 0, 1, \dots, n)$ ä¸Šï¼Œåœ¨æœ€å¤§å€¼1å’Œæœ€å°å€¼-1ä¹‹é—´äº¤æ›¿å˜æ¢ï¼Œä¹Ÿå°±æ˜¯è¯´ $T_n(t_k) = (-1)^k \|T_n(x)\|_{\infty}$
- $T_n(x)$ æœ‰ $n$ ä¸ªæ ¹ $x_k = \cos \Big(\dfrac{2k - 1}{2n} \pi \Big)(k = 1, \dots, n)$
- $T_n(x)$ æœ‰é€’æ¨å…³ç³»å¼ï¼š$T_0(x) = 1, T_1(x) = x, T_{n+1}(x) = 2x T_n(x) - T_{n-1}(x)$
    - $T_n(x)$ æ˜¯ä¸€ä¸ªæœ€é«˜é˜¶ç³»æ•°ä¸º $2^{n-1}$ çš„ $n$ é˜¶å¤šé¡¹å¼
- $\{T_0(x), T_1(x), \dots\}$ åœ¨ $[-1, 1]$ ä¸Šå…³äºæƒé‡å‡½æ•° $w(x) = \dfrac{1}{\sqrt{1 - x^2}}$ ä¸Šæ­£äº¤ï¼Œä¹Ÿå°±æ˜¯è¯´ $(T_n, T_m) = \int_{-1}^1 \dfrac{T_n(x) T_m(x)}{\sqrt{1-x^2}} dx = \begin{cases}0 & n \ne m \\ \pi & n = m = 0 \\ \dfrac{\pi}{2} & n = m \ne 0\end{cases}$

å›åˆ°ä¹‹å‰æåˆ°çš„ç›®æ ‡ï¼š

- ç›®æ ‡ 3.0ï¼šæ‰¾åˆ°å¤šé¡¹å¼ $P_{n-1}(x)$ï¼Œä½¿å¾— $\|x^n - P_{n-1}(x)\|_{\infty}$ åœ¨ $[-1, 1]$ ä¸Šæœ€å°ã€‚
    - æ­¤æ—¶ $w_n(x) = x^n - P_{n-1}(x) = \dfrac{T_n(x)}{2^{n-1}}$
- ç›®æ ‡ 2.1ï¼šæ‰¾åˆ° $\{x_1, \dots, x_n\}$ ä½¿å¾— $\|w_n\|_{\infty}$ åœ¨ $[-1, 1]$ æœ€å°åŒ–ï¼Œå…¶ä¸­ $w_n(x) = \prod\limits_{i=1}^n (x - x_i)$
    - æ­¤æ—¶ $\min\limits_{w_n \in \widetilde{\Pi}_n} \|w_n\|_{\infty} = \Big\|\dfrac{1}{2^{n-1}} T_n(x)\Big\|_{\infty} = \dfrac{1}{2^{n-1}}$ã€‚å…¶ä¸­ï¼š$\widetilde{\Pi}_n$ æ˜¯ $n$ é˜¶çš„**é¦–ä¸€å¤šé¡¹å¼**ï¼Œ$\{x_1, \dots, x_n\}$ æ˜¯ $T_n(x)$ çš„ $n$ ä¸ªæ ¹
- ç›®æ ‡ 2.0ï¼šç¡®å®šæ’å€¼ç‚¹ $\{x_0, \dots, x_n\}$ ä½¿å¾— $P_n(x)$ æœ€å°åŒ–ä½™é¡¹ $|P_n(x) - f(x)| = |R_n(x)| = \Big|\dfrac{f^{(n+1)}(\xi)}{(n+1)!} \prod\limits_{i=0}^n (x - x_i)\Big|$
    - å– $T_{n+1}(x)$ ä¸Šçš„ $n+1$ ä¸ªæ ¹ä½œä¸ºæ’å€¼ç‚¹ $\{x_0, \dots, x_n\}$ï¼Œç„¶åå…³äº $f(x)$ çš„æ’å€¼å¤šé¡¹å¼ $P_n(x)$ å‡è®¾ç»å¯¹è¯¯å·®çš„æœ€å°ä¸Šç•Œä¸º $\dfrac{M}{2^n (n+1)!}$

??? example "ä¾‹å­"

    === "é—®é¢˜"

        æ‰¾åˆ°åœ¨ $[0, 1]$ ä¸Šå…³äº $f(x) = e^x$ çš„æœ€ä½³è¿‘ä¼¼å¤šé¡¹å¼ï¼Œä½¿å¾—ç»å¯¹è¯¯å·®ä¸è¶…è¿‡ $0.5 \times 10^{-4}$ã€‚

    === "è§£ç­”"

        1. ç¡®å®š $n$ï¼š
            - æ”¹å†™å˜é‡ $x = \dfrac{a+b}{2} + \dfrac{b-a}{2} t = \dfrac{1}{2}(t+1)$
            - $|R_n| \le \dfrac{e}{(n+1)!} \times \dfrac{1}{2^{2n+1}} < \dfrac{1}{2} \times 10^{-4}$ï¼Œè§£å¾— $n = 4$
        2. æ‰¾åˆ° $T_5(t)$ çš„æ ¹ï¼š$t_0 = \cos \dfrac{\pi}{10}, \cos \dfrac{3 \pi}{10}, \cos \dfrac{5 \pi}{10}, \cos \dfrac{7 \pi}{10}, \cos \dfrac{9 \pi}{10}$
        3. å¯¹å˜é‡åšç‚¹æ”¹å˜ï¼š
            - $x_0 = \dfrac{1}{2} \Big(\cos \dfrac{\pi}{10} + 1\Big) \approx 0.98$
            - $x_1 = \dfrac{1}{2} \Big(\cos \dfrac{3 \pi}{10} + 1\Big) \approx 0.79$
            - $x_2 = \dfrac{1}{2} \Big(\cos \dfrac{5 \pi}{10} + 1\Big) \approx 0.50$
            - $x_3 = \dfrac{1}{2} \Big(\cos \dfrac{7 \pi}{10} + 1\Big) \approx 0.21$
            - $x_4 = \dfrac{1}{2} \Big(\cos \dfrac{9 \pi}{10} + 1\Big) \approx 0.02$
        4. ç”¨æ’å€¼ç‚¹ $x_0, \dots, x_4$ è®¡ç®— $L_4(x)$


### Economization of Power Series

ç›®æ ‡ï¼šç»™å®š $P_n(x) \approx f(x)$ï¼Œå¹‚çº§æ•°**ç»æµåŒ–**(economization)çš„ç›®æ ‡æ˜¯åœ¨ç¡®ä¿ç²¾åº¦æŸå¤±æœ€å°çš„æƒ…å†µä¸‹ï¼Œé™ä½å¤šé¡¹å¼çš„æ¬¡æ•°ã€‚

è€ƒè™‘ä¸€ä¸ªä»»æ„çš„ $n$ é˜¶å¤šé¡¹å¼ $P_n(x) = a_n x^n + a_{n-1} x^{n-1} + \dots + a_1 x + a_0$ï¼Œå¯¹åº”çš„å¤šé¡¹å¼ $P_{n-1}(x)$ é€šè¿‡ç§»é™¤ $n$ é˜¶å¤šé¡¹å¼ $Q_n(x)$ï¼ˆ$x^n$ é¡¹çš„ç³»æ•°ä¸º $a_n$ï¼‰å¾—åˆ°ã€‚é‚£ä¹ˆ $\max\limits_{[-1, 1]} |f(x) - P_{n-1}(x)| \le \max\limits_{[-1, 1]} |f(x) - P_n(x)| + \max\limits_{[-1, 1]} |Q_n(x)|$ï¼Œè€Œ $Q_n(x)$ èƒ½å¤Ÿåæ˜ ç²¾åº¦çš„æŸå¤±ã€‚

ä¸ºäº†æœ€å°åŒ–ç²¾åº¦æŸå¤±ï¼Œ$Q_n(x)$ å¿…é¡»ä¸º $a_n \times \dfrac{T_n(x)}{2^{n-1}}$

!!! note "æ³¨"

    - å¯¹äºä¸€èˆ¬åŒºé—´ $[a, b]$ï¼Œéœ€è¦æ”¹å˜å˜é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»¤ $x = [(b - a) t + (a + b)] / 2$ï¼Œç„¶åå¯»æ‰¾å¯¹äº $f(t)$ åœ¨ $[-1, 1]$ ä¸Šçš„ï¼ˆè¿‘ä¼¼ï¼‰å¤šé¡¹å¼ $P_n(t)$ï¼Œæœ€ç»ˆå¾—åˆ° $P_n(x)$ã€‚
    - å¦ä¸€ç§æ–¹æ³•æ˜¯ç”¨ $T_0(x), \dots, T_k(x)$ çš„çº¿æ€§ç»„åˆæ¥è¡¨ç¤ºæ¯ä¸€é¡¹ $x^k$ã€‚æ¯”å¦‚ï¼Œ$x = T_1(x)$ï¼Œä¸” $x^3 = [T_3(x) + 3T_1(x)] / 4$ã€‚ç„¶ååªè¦ä»åŸå§‹å¤šé¡¹å¼ä¸­ç§»é™¤åˆ‡æ¯”é›ªå¤«å‡½æ•°å°±è¡Œäº†ã€‚

??? example "ä¾‹å­"

    === "é¢˜ç›®"

        å·²çŸ¥ $f(x) = e^x$ åœ¨ $[-1, 1]$ ä¸Šçš„4é˜¶æ³°å‹’å¤šé¡¹å¼ä¸º $P_4 = 1 + x + \dfrac{x^2}{2} + \dfrac{x^3}{6} + \dfrac{x^4}{24}$ã€‚å®ƒçš„æˆªæ–­è¯¯å·®çš„ä¸Šç•Œä¸º $|R_4(x)| \le \dfrac{e}{5!} |x^5| \approx 0.023$ã€‚è¯·å°†è¿™ä¸ªè¿‘ä¼¼å¤šé¡¹å¼çš„æ¬¡æ•°é™è‡³2ã€‚

    === "è§£ç­”"

        <div style="text-align: center">
            <img src="images/C8/6.png" width=80%/>
        </div>

>å¯¹åº”çš„[ä½œä¸šç»ƒä¹ ](hw.md#chap-8-approximation-theory)ğŸ“

>å¯¹åº”[å°æµ‹8ã€9ã€10](quizzes.md)ğŸ’¯
