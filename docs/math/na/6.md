---
counter: true
---

# Chap 6: Direct Methods for Solving Linear Systems

??? abstract "æ ¸å¿ƒçŸ¥è¯†"

    - é«˜æ–¯æ¶ˆå…ƒæ³•
    - ä¸€äº›é€‰å–ä¸»å…ƒçš„ç­–ç•¥
        - éƒ¨åˆ†ä¸»å…ƒæ³•
        - ç¼©æ”¾éƒ¨åˆ†ä¸»å…ƒæ³•
        - å®Œå…¨ä¸»å…ƒæ³•
    - çŸ©é˜µåˆ†è§£ï¼šLU åˆ†è§£
    - ä¸€äº›ç‰¹æ®ŠçŸ©é˜µ
        - ä¸¥æ ¼å¯¹è§’å ä¼˜çŸ©é˜µ
        - æ­£å®šçŸ©é˜µ -> Choleski æ³•
        - ä¸‰å¯¹è§’çŸ©é˜µ -> Crout åˆ†è§£


ç›®æ ‡ï¼šæ±‚è§£ $A \bm{x} = \bm{b}$

!!! info "æ³¨"

    åœ¨ç»§ç»­ç¬¬6ç« ï¼ˆä»¥åŠç¬¬7ç« ï¼‰çš„å­¦ä¹ å‰ï¼Œå»ºè®®å…ˆå›é¡¾**çº¿æ€§ä»£æ•°**çš„çŸ¥è¯†ï¼Œå¦åˆ™ç†è§£èµ·æ¥å¯èƒ½æ¯”è¾ƒåƒåŠ›ï¼ˆä½†æœ‰äº›å†…å®¹å°±æ˜¯çº¿æ€§ä»£æ•°ä¸­å­¦è¿‡çš„ï¼Œæ¯”å¦‚ä¸‹é¢çš„é«˜æ–¯æ¶ˆå…ƒæ³•ï¼‰ã€‚

??? note "é€†çŸ©é˜µçš„æ±‚è§£"

    ä¸ªäººæ¯”è¾ƒå–œæ¬¢**é«˜æ–¯-çº¦æ—¦æ¶ˆå…ƒæ³•**(Gauss-Jordan elimination)ï¼ˆè®¡ç®—æœºä¹Ÿå¸¸ç”¨è¿™ç§æ–¹æ³•ï¼‰ï¼Œå…¶å¤§è‡´æ­¥éª¤å¦‚ä¸‹ï¼š

    1. æ„é€ å¢å¹¿çŸ©é˜µ $[A | I]$
    2. å¯¹å¢å¹¿çŸ©é˜µè¿›è¡Œè¡Œåˆç­‰å˜æ¢ï¼ˆç›®æ ‡æ˜¯å°†å·¦ä¾§çš„ $A$ å˜ä¸ºå•ä½çŸ©é˜µ $I$ï¼‰ï¼š
        - äº¤æ¢ä¸¤è¡Œã€‚
        - å°†æŸä¸€è¡Œä¹˜ä»¥ä¸€ä¸ªéé›¶å¸¸æ•°ã€‚
        - å°†æŸä¸€è¡Œçš„ä¸€ä¸ªå€æ•°åŠ åˆ°å¦ä¸€è¡Œã€‚ 
    3. æ£€æŸ¥ç»“æœï¼šå¦‚æœå·¦ä¾§æˆåŠŸå˜ä¸º $I$ï¼Œåˆ™å³ä¾§çš„çŸ©é˜µå°±æ˜¯ $A^{-1}$ã€‚å¦‚æœå·¦ä¾§åœ¨å˜æ¢è¿‡ç¨‹ä¸­å‡ºç°å…¨é›¶è¡Œï¼ˆæˆ–åˆ—ï¼‰ï¼Œåˆ™ $A$ ä¸å¯é€†ã€‚


## Linear Systems for Equations

### Gaussian Elimination

**é«˜æ–¯æ¶ˆå…ƒæ³•**(Gaussian elimination)çš„åŸºæœ¬æ€è·¯ï¼š

- é¦–å…ˆå°†çŸ©é˜µ $A$ å½’çº¦æˆä¸€ä¸ª**ä¸Šä¸‰è§’**(upper-triangular)çŸ©é˜µ
- ç„¶åé€šè¿‡**å›ä»£**(backward-substitution)æ¥æ±‚è§£æœªçŸ¥é‡

<div style="text-align: center">
    <img src="images/C6/1.png" width=30%/>
</div>

å…ˆæ¥çœ‹**æ¶ˆå…ƒ**(elimination)çš„å®ç°ï¼šå…ˆä»¤ $A^{(1)} = A = (a_{ij}^{(1)})_{n \times n}, \bm{b}^{(1)} = \bm{b} = \begin{bmatrix}b_1^{(1)} \\ \vdots \\ b_n^{(1)}\end{bmatrix}$

- ç¬¬1æ­¥ï¼š
    - å¦‚æœ $a_{11}^{(1)} \ne 0$ï¼Œè®¡ç®— $m_{i1} = \dfrac{a_{i1}^{(1)}}{a_{11}^{(1)}}, (i = 2, \dots, n)$
    - é‚£ä¹ˆå¢å¹¿çŸ©é˜µ(augmented matrix)çš„ç¬¬ $i$ è¡Œ $\text{row}_i$ä¸ºï¼š$m_{i1} \times \text{row}_1$ï¼Œå¾—åˆ°

        $$
        \left[
        \begin{array}{cccc|c}
        a_{11}^{(1)} & a_{12}^{(1)} & \cdots & a_{1n}^{(1)} & b_1^{(1)} \\
        0 & & A^{(2)} & & \bm{b}^{(2)} \\
        \end{array}
        \right]
        $$

        å…¶ä¸­ $\begin{cases}a_{ij}^{(2)} = a_{ij}^{(1)} - m_{i1} a_{1j}^{1} \\ b_i^{(2)} = b_i^{(1)} - m_{i1} b_1^{(1)}\end{cases}, (i, j = 2, \dots, n)$


- ç¬¬kæ­¥ï¼š
    - å¦‚æœ $a_{kk}^{(k)} \ne 0$ï¼Œè®¡ç®— $m_{ik} = \dfrac{a_{ik}^{(k)}}{a_{kk}^{(k)}}, (i = k+1, \dots, n)$
    - $\begin{cases}a_{ij}^{(k+1)} = a_{ij}^{(k)} - m_{ik} a_{kj}^{k} \\ b_i^{(k+1)} = b_i^{(k)} - m_{ik} b_k^{(k)}\end{cases}, (i, j = k+1, \dots, n)$

- n-1 æ­¥åï¼š

    $$
    \begin{bmatrix} a_{11}^{(1)} & a_{12}^{(1)} & \dots & a_{1n}^{(1)} \\ & a_{22}^{(2)} & \dots & a_{2n}^{(2)} \\ & & \dots & \vdots \\ & & & a_{nn}^{(n)}\end{bmatrix} \begin{bmatrix}x_1 \\ x_2 \\ \vdots \\ x_n\end{bmatrix} = \begin{bmatrix}b_1^{(1)} \\ b_2^{(2)} \\ \vdots \\ b_n^{(n)}\end{bmatrix}
    $$

---
æ¥ä¸‹æ¥çœ‹**å›ä»£**ï¼š

- $x_n = \dfrac{b_n^{(n)}}{a_{nn}^{(n)}}$
- $x_i = \dfrac{b_i^{(i)} - \sum\limits_{j=i+1}^n a_{ij}^{(i)} x_j}{a_{ii}^{(i)}}, (i = n - 1, \dots, 1)$
- æˆ‘ä»¬å¿…é¡»æ‰¾åˆ°æœ€å°çš„æ•´æ•° $k \ge i$ ä¸” $a_{ki}^{(i)} \ne 0$ï¼Œç„¶åäº¤æ¢ç¬¬ $k$ è¡Œå’Œç¬¬ $i$ è¡Œ

??? code "ä»£ç å®ç°"

    æ±‚è§£ $n \times n$ çº¿æ€§æ–¹ç¨‹ç»„ï¼š

    $$
    \begin{align}
    E_1: & a_{11} x_1 + a_{12} x_2 + \dots + a_{1n} x_n = a_{1, n+1} \notag \\
    E_2: & a_{21} x_1 + a_{22} x_2 + \dots + a_{2n} x_n = a_{2, n+1} \notag \\
    \vdots \quad &  \quad \vdots \quad \quad \quad\ \vdots \quad \quad \quad \quad \quad \quad \vdots \quad \quad \quad \vdots \notag \\
    E_n: & a_{n1} x_1 + a_{n2} x_2 + \dots + a_{nn} x_n = a_{n, n+1} \notag \\
    \end{align}
    $$

    - è¾“å…¥ï¼šæœªçŸ¥é‡å’Œæ–¹ç¨‹çš„æ•°é‡ $n$ï¼›å¢å¹¿çŸ©é˜µ $A = (a_{ij})$ï¼Œå…¶ä¸­ $1 \le i \le n, 1 \le j \le n+1$
    - è¾“å‡ºï¼šè§£ $x_1, x_2, \dots, x_n$ï¼Œæˆ–è€…çº¿æ€§æ–¹ç¨‹ç»„æ²¡æœ‰å”¯ä¸€è§£çš„ä¿¡æ¯

    ```cpp
    Step 1  for i = 1, ..., n - 1 do Steps 2-4:
        Step 2  Let p be the smallest integer with i <= p <= n and a[p][i] != 0;
                if no integer p can be found
                    then Output('no unique solution exists');
                    STOP;
                // row exchange
        Step 3  if p != i then perform (E[p]) <-> (E[i]);
                // elimination
        Step 4  for j = i + 1, ..., n do Step 5 and 6:
            Step 5  Set m[j][i] = a[j][i] / a[i][i]
            Step 6  Perform (E[j] - m[j][i] * E[i]) -> (E[i])
        Step 7  if a[n][n] = 0 then Output('no unique solution exists');
                    STOP;
                // backward substitution
        Step 8  Set x_n = a[n][n+1] / a[n][n]
        Step 9  for i = n - 1, ..., 1 set x[i] = [a[i][n+1] - sum(j=i+1, n, a[i][j] * x[j])] / a[i][i];
        Step 10 Output(x[1], ..., x[n]);
                STOP;    // success
    ```


### Amount of Computation

ç°åœ¨æˆ‘ä»¬æ¥ç»Ÿè®¡ä¸€ä¸‹è®¡ç®—é‡ï¼ˆä»…è€ƒè™‘ä¹˜æ³•/é™¤æ³•ï¼‰ã€‚

- æ¶ˆå…ƒï¼š$\sum\limits_{k=1}^{n-1} (n - k)(n - k + 2) = \dfrac{n^3}{3} + \dfrac{n^2}{2} - \dfrac{5}{6}n$
- å›ä»£ï¼š$1 + \sum\limits_{i=1}^{n-1}(n - i + 1) = \dfrac{n^2}{2} + \dfrac{n}{2}$

æ‰€ä»¥å¯¹äºå¾ˆå¤§çš„ $n$ï¼Œä¹˜æ³•å’Œé™¤æ³•çš„æ€»æ•°å¤§çº¦ä¸º $\textcolor{red}{\dfrac{n^3}{3}}$ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œé«˜æ–¯æ¶ˆå…ƒæ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º **$O(n^3)$**ã€‚


## Pivoting Strategies

>é™¤éæœ‰ç‰¹æ®Šè¯´æ˜ï¼Œä»¥ä¸‹çš„ $k$ æŒ‡çš„æ˜¯ç¬¬ $k$ æ¬¡é«˜æ–¯æ¶ˆå…ƒã€‚

???+ bug "ä¸€èˆ¬é«˜æ–¯æ¶ˆå…ƒæ³•çš„é—®é¢˜"

    åœ¨é«˜æ–¯æ¶ˆå…ƒçš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœå…¶ä¸­ä¸€ä¸ª**ä¸»å…ƒ**(pivot) $a_{kk}^{(k)} = 0$ï¼Œé‚£ä¹ˆå°±éœ€è¦è¿›è¡Œè¡Œäº¤æ¢ $(E_k) \leftrightarrow (E_p)$ï¼Œå…¶ä¸­ $p$ æ˜¯æœ€å°çš„æ»¡è¶³ $p > k$ ä¸” $a_{pk}^{(k)} \ne 0$ çš„æ•´æ•°ã€‚ä½†ä¸ºäº†å‡å°èˆå…¥è¯¯å·®ï¼Œå³ä½¿ä¸»å…ƒå¹¶ä¸ç­‰äº0çš„æ—¶å€™ä¹Ÿè¦åšè¡Œäº¤æ¢ã€‚

    å¦‚æœ $a_{kk}^{(k)}$ ç›¸æ¯” $a_{jk}^{(k)}$ è¾ƒå°çš„è¯ï¼Œé‚£ä¹ˆä¹˜æ•° $m_{jk} = \dfrac{a_{jk}^{(k)}}{a_{kk}^{(k)}}$ ä¼šå¤§äº1ï¼Œå¯¼è‡´è¯¯å·®çš„ç§¯ç´¯ã€‚å¹¶ä¸”åœ¨å›ä»£çš„æ—¶å€™ï¼Œ$x_k$ çš„å€¼å› ä¸ºåˆ†æ¯ $a_{kk}^{(k)}$ çš„å€¼è¿‡å°ï¼Œå…¶è®¡ç®—è¯¯å·®ä¹Ÿä¼šè¢«æ”¾å¤§ã€‚

æ‰€ä»¥ï¼Œæˆ‘ä»¬éœ€è¦é€‰å–åˆé€‚çš„ä¸»å…ƒä»¥å‡å°è¯¯å·®ã€‚ä¸‹é¢ç»™å‡ºä¸€äº›é€‰å–ä¸»å…ƒçš„ç­–ç•¥ã€‚

???+ info "ç½®æ¢çŸ©é˜µ"

    æ‰¾åˆ°åˆé€‚çš„ä¸»å…ƒåï¼Œä¸€èˆ¬æˆ‘ä»¬ä¼šåšä¸€ä¸ªè¡Œäº¤æ¢ã€‚åœ¨åé¢æ¶‰åŠåˆ°[çŸ©é˜µåˆ†è§£](#matrix-factorization)çš„æ—¶å€™ï¼Œâ€œè¡Œäº¤æ¢â€è¿™ä¸€æ“ä½œå°±å¯ä»¥ç”¨ä¸€ä¸ª**ç½®æ¢çŸ©é˜µ**(permutation matrix) $P$ æ¥è¡¨ç¤ºã€‚å®ƒçš„å…ƒç´ åŸºäº**å•ä½çŸ©é˜µ**(identity matrix) $I$ï¼Œåœ¨æ­¤åŸºç¡€ä¸Šå¯¹é‡Œé¢çš„å…ƒç´ åšè¡Œäº¤æ¢ï¼Œä¾¿å¯è¡¨ç¤ºå¯¹åº”çš„è¡Œäº¤æ¢æ“ä½œã€‚

    æ¯”å¦‚ $P_{12} = \begin{bmatrix}0 & 1 & 0 \\ 1 & 0 & 0 \\ 0 & 0 & 1\end{bmatrix}$ è¡¨ç¤ºäº¤æ¢ç¬¬1è¡Œå’Œç¬¬2è¡Œã€‚å¦‚æœ $\bm{x} = \begin{bmatrix}x_1 \\ x_2 \\ x_3\end{bmatrix}$ï¼Œé‚£ä¹ˆ $P_{12} \bm{x} = \begin{bmatrix}x_2 \\ x_1 \\ x_3\end{bmatrix}$ã€‚


### Partial Pivoting

**éƒ¨åˆ†ä¸»å…ƒæ³•**(partial pivoting)ï¼ˆæˆ–ç§°ä¸ºæœ€å¤§åˆ—ä¸»å…ƒæ³•(maximal column pivoting)ï¼‰ï¼šæ‰¾åˆ°æœ€å°çš„ $p$ï¼Œä½¿å¾— $|a_{pk}^{(k)}| = \max\limits_{k \le i \le n} |a_{ik}^{(k)}|$ï¼Œç„¶åäº¤æ¢ç¬¬ $p$ è¡Œå’Œç¬¬ $k$ è¡Œã€‚

??? code "ä»£ç å®ç°"

    æ±‚è§£ $n \times n$ çº¿æ€§æ–¹ç¨‹ç»„ï¼š

    $$
    \begin{align}
    E_1: & a_{11} x_1 + a_{12} x_2 + \dots + a_{1n} x_n = a_{1, n+1} \notag \\
    E_2: & a_{21} x_1 + a_{22} x_2 + \dots + a_{2n} x_n = a_{2, n+1} \notag \\
    \vdots \quad &  \quad \vdots \quad \quad \quad\ \vdots \quad \quad \quad \quad \quad \quad \vdots \quad \quad \quad \vdots \notag \\
    E_n: & a_{n1} x_1 + a_{n2} x_2 + \dots + a_{nn} x_n = a_{n, n+1} \notag \\
    \end{align}
    $$

    - è¾“å…¥ï¼šæœªçŸ¥é‡å’Œæ–¹ç¨‹çš„æ•°é‡ $n$ï¼›å¢å¹¿çŸ©é˜µ $A = (a_{ij})$ï¼Œå…¶ä¸­ $1 \le i \le n, 1 \le j \le n+1$
    - è¾“å‡ºï¼šè§£ $x_1, x_2, \dots, x_n$ï¼Œæˆ–è€…çº¿æ€§æ–¹ç¨‹ç»„æ²¡æœ‰å”¯ä¸€è§£çš„ä¿¡æ¯

    ```cpp
    Step 1  for i = 1, ..., n set NROW(i) = i;    // initialize row pointer
    Step 2  for i = 1, ..., n - 1 do Steps 3-6:    // elimination process
        Step 3  Let p be the smallest integer with i <= p <= n and
                |a(NROW(p), i)| = max_{i <= j <= n}|a(NROW(j), i)|;
        Step 4  if a(NROW(p), i) = 0 then Output('no unique solution exists');
                    STOP;
        Step 5  if NROW(i) != NROW(p) then set NCOPY = NROW(i);    // simulated row interchange
                                              NROW(i) = NROW(p);
                                              NROW(p) = NCOPY;
        Step 6  for j = i + 1, ..., n do Steps 7-8:
            Step 7  Set m(NROW(j), i) = a(NROW(j), i) / a(NROW(i), i);
            Step 8  Perform (E_NROW(j) - m(NROW(j), i) * E_NROW(i)) -> (E_NROW(j));
        Step 9  if a(NROW(n), n) = 0 then Output('no unique solution exists');
                    STOP;
        // start backward substitution
        Step 10 Set x[n] = a(NROW(n), n + 1) / a(NROW(n), n);
        Step 11 for i = n - 1, ..., 1
                    set x[i] = (a(NROW(i), n + 1) - sum(j=i+1, n, a(NROW(i), j) * x[j])) / a(NROW(i), i);
        Step 12 Output(x[1], ..., x[n]);    // procedure completed successfully
                STOP;
    ```

???+ example "ä¾‹å­"

    === "é¢˜ç›®"

        æ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ $\begin{cases}30.00 x_1 + 594100 x_2 = 591700 \\ 5.291 x_1 - 6.130 x_2 = 46.78\end{cases}$ï¼Œèˆå…¥ç²¾åº¦ä¸º 4 ä½ã€‚

    === "åˆ†æ"

        å¯ä»¥çœ‹åˆ°ï¼Œè™½ç„¶æ ¹æ®éƒ¨åˆ†ä¸»å…ƒæ³•ï¼Œè§£æ–¹ç¨‹æ—¶æ— éœ€äº¤æ¢è¡Œï¼Œç„¶è€Œæ³¨æ„åˆ°ç¬¬ä¸€ä¸ªæ–¹ç¨‹ä¸­åŒä¸€è¡Œçš„å…ƒç´ é‡çº§ç›¸å·®å·¨å¤§ï¼Œè€Œç¬¬äºŒè¡Œå…ƒç´ çš„é‡çº§æ¯”è¾ƒæ¥è¿‘ï¼Œæ‰€ä»¥ä¼šäº§ç”Ÿè¾ƒå¤§çš„è¯¯å·®ï¼ˆè¿™ä¹Ÿåæ˜ äº†éƒ¨åˆ†ä¸»å…ƒæ³•çš„ç¼ºé™·ï¼‰ã€‚


### Scaled Partial Pivoting

**ç¼©æ”¾éƒ¨åˆ†ä¸»å…ƒæ³•**(scaled partial pivoting)ï¼ˆæˆ–ç§°ä¸ºç¼©æ”¾åˆ—ä¸»å…ƒæ³•(scaled-column pivoting)ï¼‰ï¼šå°†ä¸€è¡Œä¸­æœ€å¤§çš„å…ƒç´ æ”¾åœ¨ä¸»å…ƒçš„ä½ç½®ä¸Šã€‚

- ç¬¬1æ­¥ï¼šå®šä¹‰æ¯ä¸€è¡Œçš„**ç¼©æ”¾å› å­**(scale factor) $s_i = \max\limits_{1 \le j \le n} |a_{ij}|$ï¼ˆå³æ¯è¡Œä¸­**ç»å¯¹å€¼æœ€å¤§**çš„å…ƒç´ ï¼‰
- ç¬¬2æ­¥ï¼šï¼ˆå¯¹äºç¬¬ $k$ æ¬¡é«˜æ–¯æ¶ˆå…ƒï¼Œï¼‰æ‰¾åˆ°æœ€å°çš„ $p \ge k$ï¼Œä½¿å¾— $\dfrac{|a_{pk}^{(k)}|}{s_p} = \max\limits_{k \le i \le n} \dfrac{|a_{ik}^{(k)}|}{s_i}$ï¼Œç„¶åäº¤æ¢ç¬¬ $p$ è¡Œå’Œç¬¬ $k$ è¡Œ

!!! note "æ³¨"

    ç¼©æ”¾å› å­**åªè®¡ç®—ä¸€æ¬¡**ï¼ˆåœ¨é«˜æ–¯æ¶ˆå…ƒå‰ï¼‰ï¼Œä»¥ç¡®ä¿è®¡ç®—æ•ˆç‡ã€‚

??? code "ä»£ç å®ç°"

    å’Œéƒ¨åˆ†ä¸»å…ƒæ³•çš„å®ç°ç›¸æ¯”ï¼ŒåŒºåˆ«åœ¨äºå‰3æ­¥ï¼Œåç»­æ­¥éª¤éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå› æ­¤ä¸‹é¢åªåˆ—å‡ºå‰3æ­¥ï¼š

    ```cpp
    Step 1  for i = 1, ..., n set s_i = max_{1 <= j <= n}(|a_ij|);
                              if s_i = 0 then Output('no unique solution exists');
                                              STOP;
    Step 2  for i = 1, ..., n - 1 do Steps 3-6:    // elimination process
        Step 3  Let p be the smallest integer with i <= p <= n and
                |a(NROW(p), i)| / s(NROW(p)) = max_{i <= j <= n}(|a(NROW(j), i)| / s(NROW(j)));
    ```

??? question "ç¼©æ”¾éƒ¨åˆ†ä¸»å…ƒæ³•çš„å¥½å¤„åœ¨å“ªé‡Œï¼Ÿ"

    ä¸€èˆ¬çš„éƒ¨åˆ†ä¸»å…ƒæ³•è€ƒè™‘çš„æ˜¯**ç»å¯¹å¤§å°**ï¼ˆå½“å‰åˆ—ç»å¯¹å€¼æœ€å¤§çš„å…ƒç´ ï¼‰ï¼Œè€Œç¼©æ”¾éƒ¨åˆ†ä¸»å…ƒæ³•è€ƒè™‘çš„æ˜¯**ç›¸å¯¹å¤§å°**ï¼ˆå½“å‰åˆ—ä¸­ï¼Œå…ƒç´ ç»å¯¹å€¼ä¸è¯¥è¡Œæœ€å¤§ç»å¯¹å€¼ä¹‹æ¯”æœ€å¤§çš„å…ƒç´ ï¼‰ã€‚è™½ç„¶ä¸€èˆ¬çš„éƒ¨åˆ†ä¸»å…ƒæ³•è¶³ä»¥åº”å¯¹å¤§å¤šæ•°æƒ…å†µï¼Œä½†ä»æ•°å€¼ç¨³å®šæ€§ä¸Šçœ‹ï¼Œåè€…èƒ½å¤Ÿåœ¨çŸ©é˜µå…ƒç´ æœ‰è¾ƒå¤§é‡çº§å·®å¼‚çš„æç«¯æƒ…å½¢ä¸‹èƒ½å¤Ÿå‡å°‘è¯¯å·®çš„ç§¯ç´¯ï¼Œä»è€Œè¡¨ç°å‡ºæ›´å¥½çš„ç¨³å®šæ€§ï¼ˆæ¯”å¦‚ $1$ å’Œ $10^5$ è¿™ä¹ˆå¤§çš„é‡çº§å·®å¼‚ï¼‰ã€‚


### Complete Pivoting

**å®Œå…¨ä¸»å…ƒæ³•**(complete pivoting)ï¼ˆæˆ–ç§°ä¸ºæœ€å¤§ä¸»å…ƒæ³•(maximal pivoting)ï¼‰ï¼šæœç´¢æ‰€æœ‰çš„å…ƒç´  $a_{ij} (i, j = k, \dots, n)$ï¼Œæ‰¾å‡ºå…¶ä¸­æ•°å€¼æœ€å¤§çš„å…ƒç´ ã€‚é€šè¿‡**äº’æ¢**(interchange)è¡Œå’Œåˆ—ï¼Œä½¿å¾—è¯¥å…ƒç´ æ¥åˆ°ä¸»å…ƒçš„ä½ç½®ä¸Šã€‚


### Amount of Computation

- éƒ¨åˆ†ä¸»å…ƒæ³•ï¼šéœ€è¦ $O(n^2)$ æ¬¡**æ¯”è¾ƒ**
- ç¼©æ”¾éƒ¨åˆ†ä¸»å…ƒæ³•ï¼šéœ€è¦ $O(n^2)$ æ¬¡**æ¯”è¾ƒ**ï¼Œä»¥åŠ $O(n^2)$ æ¬¡**é™¤æ³•**ï¼ˆåˆå§‹è®¡ç®—ï¼‰
- å®Œå…¨ä¸»å…ƒæ³•ï¼šéœ€è¦ $O(\dfrac{n^3}{3})$ æ¬¡**æ¯”è¾ƒ**

>æ‰€ä»¥ï¼Œè¦æƒ³è¿½æ±‚æ›´å¥½çš„ç¨³å®šæ€§ï¼Œå°±è¦ä»¥æ›´å¤§çš„è®¡ç®—é‡ä¸ºä»£ä»·ã€‚

!!! note "æ³¨"

    å¦‚æœæ–°çš„ç¼©æ”¾å› å­åœ¨è¡Œäº¤æ¢çš„æ—¶å€™æ‰è¢«ç¡®å®šï¼Œé‚£ä¹ˆç¼©æ”¾éƒ¨åˆ†ä¸»å…ƒæ³•éœ€è¦ $O(\dfrac{n^3}{3})$ æ¬¡é¢å¤–çš„**æ¯”è¾ƒ**ï¼Œä»¥åŠ $O(n^2)$ æ¬¡**é™¤æ³•**


## Matrix Factorization

é«˜æ–¯æ¶ˆå…ƒæ³•æ˜¯ä¸€ç§ç®€å•ç²—æš´çš„æ–¹æ³•ï¼Œä½†æ•ˆç‡ä¸æ˜¯å¾ˆé«˜ã€‚å› æ­¤ä¸‹é¢ä»‹ç»ä¸€ç§åŸºäºé«˜æ–¯æ¶ˆå…ƒæ³•å®ç°çš„æ”¹è¿›æ–¹æ³•â€”â€”**çŸ©é˜µåˆ†è§£**(matrix factorization)ã€‚å®ƒçš„è®¡ç®—è¿‡ç¨‹å¦‚ä¸‹ï¼š

- ç¬¬ 1 æ­¥ï¼š
    - $m_{i1} = \dfrac{a_{i1}}{a_{11}} (a_{11} \ne 0)$
    - ä»¤ $L_1 = \begin{bmatrix}1 & & & \\ -m_{21} & 1 & & \\ \vdots & & \ddots \\ -m_{n1} & & &1\end{bmatrix}$ï¼ˆè¿™å°±æ˜¯**ç¬¬ä¸€é«˜æ–¯å˜æ¢çŸ©é˜µ**(first Gaussian transformation matrix)ï¼‰ï¼Œé‚£ä¹ˆ $L_1 [A^{(1)} \quad \bm{b}^{(1)}] = \begin{bmatrix}a_{11}^{(1)} & \dots a_{1n}^{(1)} & b_1^{(1)} \\ 0 & A^{(2)} & \bm{b}^{(2)}\end{bmatrix}$

- ç¬¬ k æ­¥ï¼š
    - **ç¬¬ké«˜æ–¯å˜æ¢çŸ©é˜µ**(kth Gaussian transformation matrix)ï¼š$L_k = \begin{bmatrix}1 & & & & \\ & \ddots & & & \\ & & 1 & & \\ & & -m_{k+1, k} & & \\ & & \vdots &\ddots & \\ & & -m_{n, k} & & 1\end{bmatrix}$ï¼ˆç©ºçš„åœ°æ–¹éƒ½æ˜¯0ï¼‰

- ç¬¬ n-1 æ­¥ï¼š
    
    $$
    L_{n-1}L_{n-2} \dots L_1 [A \quad \bm{b}] = \begin{bmatrix}a_{11}^{(1)} & a_{12}^{(1)} & \dots & a_{1n}^{(1)} & b_1^{(1)}\\ & a_{22}^{(2)} & \dots & a_{2n}^{(2)} & b_2^{(2)} \\ & & \dots & \vdots & \vdots\\ & & & a_{nn}^{(n)} & b_n^{(n)}\end{bmatrix}
    $$

!!! theorem "å®šç†"

    è‹¥é«˜æ–¯æ¶ˆå…ƒæ³•èƒ½å¤Ÿåœ¨ä¸ä½¿ç”¨è¡Œäº’æ¢çš„åŸºç¡€ä¸Šæ±‚è§£çº¿æ€§æ–¹ç¨‹ç»„ $A \bm{x} = \bm{b}$ï¼Œé‚£ä¹ˆçŸ©é˜µ $A$ å¯ä»¥è¢«å› å¼åˆ†è§£ä¸ºä¸€ä¸ªä¸‹ä¸‰è§’çŸ©é˜µ $L$ å’Œä¸Šä¸‰è§’çŸ©é˜µ $U$ çš„ä¹˜ç§¯ï¼Œå³ $A = LU$ã€‚

    å…¶ä¸­ï¼š

    $$
    U = \begin{bmatrix}a_{11}^{(1)} & a_{12}^{(1)} & \dots & a_{1n}^{(1)} \\ 0 & a_{22}^{(2)} & \dots & a_{2n}^{(2)} \\ \vdots & \vdots & \ddots & \vdots \\ 0 & \dots & \dots & a_{nn}^{(n)}\end{bmatrix} \quad L = \begin{bmatrix}1 & 0 & \dots & 0 \\ m_{21} & 1 & \dots & 0 \\ \vdots & \vdots & \ddots & \vdots \\ m_{n1} & \dots & m_{n, n-1} & 1\end{bmatrix} \quad m_{ji} = \dfrac{a_{ji}^{(i)}}{a_{ii}^{(i)}}
    $$

    å¦‚æœçŸ©é˜µ $L$ æ˜¯**å•ä½çš„**(unitary)ï¼ˆä¹Ÿå°±æ˜¯è¯´ä¸»å¯¹è§’çº¿å…ƒç´ éƒ½æ˜¯1ï¼‰ï¼Œé‚£ä¹ˆå¾—åˆ°çš„çŸ©é˜µåˆ†è§£æ˜¯**å”¯ä¸€çš„**ã€‚

    ??? proof "å”¯ä¸€æ€§è¯æ˜"

        å¦‚æœåˆ†è§£ä¸æ˜¯å”¯ä¸€çš„ï¼Œé‚£ä¹ˆå­˜åœ¨ $L_1, L_2, U_1, U_2$ï¼Œä½¿å¾— $A = L_1 U_1 = L_2 U_2$ï¼Œå› æ­¤ï¼š

        $$
        \underbrace{U_1U_2^{-1}}_{\text{Upper-triangular}} = L_1^{-1} L_2 U_2 U_2^{-1} = \underbrace{L_1^{-1} L_2}_{\substack{\text{Lower-triangular} \\ \text{with diagnoal entries } \textcolor{red}{1}}} = I
        $$

!!! note "æ³¨"

    å¦‚æœ $U$ ä¹Ÿæ˜¯**å•ä½çš„**ï¼Œé‚£ä¹ˆè¿™ç§åˆ†è§£å°±ç§°ä¸º[**Crout åˆ†è§£**](https://en.wikipedia.org/wiki/Crout_matrix_decomposition)ã€‚æˆ‘ä»¬å¯é€šè¿‡å¯¹ $A^T$ çš„ $LU$ åˆ†è§£æ¥å®ç° Crout åˆ†è§£ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰¾åˆ° $A^T = LU$ï¼Œé‚£ä¹ˆ $A = U^T L^T$ å°±æ˜¯ $A$ çš„ Crout åˆ†è§£ã€‚

??? code "$LU$ åˆ†è§£çš„ä»£ç å®ç°"

    å°† $n \times n$ çš„çŸ©é˜µ $A = (a_{ij})$ åˆ†è§£ä¸ºä¸‹ä¸‰è§’çŸ©é˜µ $L = (l_{ij})$ å’Œä¸Šä¸‰è§’çŸ©é˜µ $U = (u_{ij})$ï¼Œä¹Ÿå°±æ˜¯è¯´ $A = LU$ï¼Œå…¶ä¸­ $L$ æˆ– $U$ çš„ä¸»å¯¹è§’çº¿å…ƒç´ å‡ä¸º1ã€‚

    - è¾“å…¥ï¼šç»´åº¦ $n$ï¼›$A$ çš„å…ƒç´  $a_{ij}, 1 \le i, j \le n$ï¼›$L$ çš„å¯¹è§’å…ƒç´  $l_{11} = \dots = l_{nn} = 1$ æˆ– $U$ çš„å¯¹è§’å…ƒç´  $u_{11} = \dots = u_{nn} = 1$
    - è¾“å‡ºï¼š$L$ çš„é¡¹ $l_{ij}, 1 \le j \le i, 1 \le i \le n$ï¼Œä»¥åŠ $U$ çš„é¡¹ $u_{ij}, i \le j \le n, 1 \le i \le n$

    ```cpp
    Step 1  Select l_11 and u_11 satisfying l_11 * u_11 = a_11;
            if l_11 * u_11 = 0 then Output('Factorization impossible');
                Stop;
    Step 2  for j = 2, ..., n set u_1j = a_1j / l_11;    // first row of U
                                  l_j1 = a_j1 / u_11;    // first column of L
    Step 3  for i = 2, ..., n - 1 do Steps 4 and 5:
        Step 4  Select l_ii and u_ii safisfying l_ii * u_ii = a_ii - sum(k=1, i-1, l_ik * u_ki);
                if l_ii * u_ii = 0 then Output('Factorization impossible');
                    Stop;
        Step 5  for j = i + 1, ..., n:
                    set u_ij = 1 / l_ii * (a_ij - sum(k=1, i-1, l_ik * u_kj));    // ith row of U
                    set l_ji = 1 / u_ii * (a_ji - sum(k=1, i-1, l_jk * u_ki));    // ith column of L
    Step 6  Select l_nn and u_nn satisfying l_nn * u_nn = a_nn - sum(k=1, n-1, l_nk * u_kn);
    // if l_nn * u_nn = 0, then A = LU but A is singular
    Step 7  Output(l_ij for j = 1, ..., i and i = 1, ..., n);
            Output(u_ij for j = i, ..., n and i = 1, ..., n);
            STOP;
    ```

    è¿™æ ·æˆ‘ä»¬åªå¾—åˆ°äº† $L$ å’Œ $U$ï¼Œè¿˜æ²¡æœ‰è§£å‡ºè¿™ä¸ªçº¿æ€§æ–¹ç¨‹ç»„ï¼ˆçŸ©é˜µï¼‰ï¼Œæ‰€ä»¥è¿˜è¦ç»§ç»­å¾€ä¸‹è½¬æ¢ã€‚

    å› ä¸º $A \bm{x} = LU \bm{x} = \bm{b}$ï¼Œæ‰€ä»¥æˆ‘ä»¬ä»¤ $\bm{y} = U\bm{x}$ï¼Œ

    - å…ˆè§£ $L \bm{y} = \bm{b}$
        - $y_1 = \dfrac{b_1}{l_{11}}$
        - $y_i = \dfrac{1}{l_{ii}} \Big[b_i - \sum\limits_{j=1}^{i-1} u_{ij} y_j\Big]$
    - å†è§£ $U \bm{x} = \bm{y}$
        - $x_n = \dfrac{y_n}{u_{nn}}$
        - $x_i = \dfrac{1}{u_{ii}} \Big[y_i - \sum\limits_{j=i+1}^n u_{ij} x_j\Big]$

??? abstract "é«˜æ–¯æ¶ˆå…ƒæ³• v.s. LU åˆ†è§£ï¼ˆby Gemini 2.5 Flashï¼‰"

    | ç‰¹æ€§             | ä¸€èˆ¬é«˜æ–¯æ¶ˆå…ƒæ³•ï¼ˆç›´æ¥å¯¹ $[A\|b]$ï¼‰ | LUåˆ†è§£                                       |
    | :--------------- | :------------------------------- | :------------------------------------------- |
    | **åŸºæœ¬æ€æƒ³**     | å°† $[A\|b]$ è½¬åŒ–ä¸º $[U'\|b']$      | å°† $A$ åˆ†è§£ä¸º $L$ å’Œ $U$                     |
    | **æ±‚è§£ $Ax=b$**  | æ¯æ¬¡ $O(N^3)$                    | åˆ†è§£ $O(N^3)$ï¼Œæ¯æ¬¡æ±‚è§£ $O(N^2)$            |
    | **å¤šå³ç«¯å‘é‡**   | æ¯æ¬¡ $O(N^3)$                    | **é«˜æ•ˆ**ï¼šåˆ†è§£ä¸€æ¬¡ $O(N^3)$ï¼Œåç»­æ¯æ¬¡ $O(N^2)$ |
    | **è®¡ç®— $A^{-1}$** | $O(N^4)$                         | **é«˜æ•ˆ**ï¼š$O(N^3)$                           |
    | **è®¡ç®— $\det(A)$** | éœ€è®°å½•æ¶ˆå…ƒè¿‡ç¨‹                   | **ç›´æ¥**ï¼šå¯¹è§’çº¿å…ƒç´ ä¹˜ç§¯                     |
    | **ç»“æ„**         | ç´§å¯†è€¦åˆ $A$ å’Œ $b$              | **æ¨¡å—åŒ–**ï¼šåˆ†è§£ä¸æ±‚è§£åˆ†ç¦»                   |
    | **å­˜å‚¨**         | æ¯æ¬¡é‡æ–°è®¡ç®—                     | $L, U$ å¯å­˜å‚¨é‡ç”¨                            |
    | **æ•°å€¼ç¨³å®šæ€§**   | ä¾èµ–äºä¸»å…ƒé€‰æ‹©                   | ä¾èµ–äºä¸»å…ƒé€‰æ‹©ï¼Œé€šå¸¸ä¸ä¸»å…ƒæ³•ç»“åˆ             |


## Special Types of Matrices

### Strictly Diagonally Dominant Matrix

**ä¸¥æ ¼å¯¹è§’å ä¼˜çŸ©é˜µ**(strictly diagonally dominant matrix)æ»¡è¶³ï¼š

$$
|a_{ii}| > \sum\limits_{\substack{j = 1 \\ j \ne i}}^n |a_{ij}|
$$

å³å¯¹è§’çº¿å…ƒç´ çš„ç»å¯¹å€¼æ˜¯å…¶æ‰€åœ¨è¡Œå†…æ‰€æœ‰å…ƒç´ çš„ç»å¯¹å€¼ä¸­çš„æœ€å¤§è€…ã€‚

!!! theorem "å®šç†"

    - ä¸¥æ ¼å¯¹è§’å ä¼˜çŸ©é˜µ $A$ æ˜¯**éå¥‡å¼‚çš„**(nonsigular)ï¼ˆå³è¡Œåˆ—å¼ä¸ä¸º0ï¼Œä¸”å­˜åœ¨é€†çŸ©é˜µï¼‰
    - åœ¨è¿™ç§çŸ©é˜µä¸Šä½¿ç”¨é«˜æ–¯æ¶ˆå…ƒæ³•**æ— éœ€**è¡Œæˆ–åˆ—çš„**äº’æ¢**
    - å¹¶ä¸”è®¡ç®—å°†ç›¸å¯¹äºèˆå…¥è¯¯å·®çš„å¢é•¿ä¿æŒ**ç¨³å®š**

    ??? proof "è¯æ˜"

        - $A$ æ˜¯éå¥‡å¼‚çš„â€”â€”åè¯æ³•è¯æ˜
        - é«˜æ–¯æ¶ˆå…ƒæ³•æ— éœ€è¡Œæˆ–åˆ—çš„äº’æ¢â€”â€”å½’çº³æ³•è¯æ˜ï¼šé€šè¿‡é«˜æ–¯æ¶ˆå…ƒæ³•å¾—åˆ°çš„æ¯ä¸€ä¸ªçŸ©é˜µ $A^{(2)}, A^{(3)}, \dots, A^{(n)}$ éƒ½æ˜¯ä¸¥æ ¼å¯¹è§’å ä¼˜çš„
        - ç•¥è¿‡


### Choleski's Method for Positive Definite Matrix

!!! definition "å®šä¹‰"

    å¯¹äºä¸€ä¸ªçŸ©é˜µ $A$ï¼Œå¦‚æœå®ƒæ˜¯**å¯¹ç§°çš„**ï¼Œä¸” $\forall \bm{x} \ne \bm{0}, \bm{x}^T A \bm{x} > 0$ æˆç«‹ï¼Œé‚£ä¹ˆç§°è¯¥çŸ©é˜µæ˜¯**æ­£å®š**(positive definite)çŸ©é˜µã€‚

!!! theorem "å®šç†"

    æ­£å®šçŸ©é˜µ $A$ çš„æ€§è´¨ï¼š

    a. $A$ æ˜¯éå¥‡å¼‚çš„

    b. $a_{ii} > 0, i = 1, 2, \dots n$

    c. $\max_{1 \le k, j \le n} |a_{kj}| \le \max_{1 \le i \le n} |a_{ii}|$

    d. $(a_{ij})^2 < a_{ii} a_{jj}, i \ne j$

    PPT ä¸Šè¿˜æœ‰è¿™äº›æ€§è´¨ï¼š

    - $A^{-1}$ ä¹Ÿæ˜¯æ­£å®šçš„
    - $A$ çš„æ¯ä¸ª**å‰å¯¼ä¸»å­çŸ©é˜µ**(leading principal submatrices) $A_k$ çš„è¡Œåˆ—å¼(determinant)éƒ½æ˜¯æ­£çš„

    ??? info "å‰å¯¼ä¸»å­çŸ©é˜µ"

        çŸ©é˜µ $A$ çš„å‰å¯¼ä¸»å­çŸ©é˜µä¸º $A_k = \begin{bmatrix}a_{11} & a_{12} & \dots & a_{1k} \\ a_{21} & a_{22} & \dots & a_{2k} \\ \vdots & \vdots & \ddots & \vdots \\ a_{k1} & a_{k2} & \dots & a_{kk} \end{bmatrix}, 1 \le k \le n$

    ??? proof "è¯æ˜"

        <div style="text-align: center">
            <img src="images/C6/6.png" width=80%/>
        </div>

        <div style="text-align: center">
            <img src="images/C6/7.png" width=80%/>
        </div>

---
æˆ‘ä»¬å°† $A = LU$ ä¸­çš„ $U$ è¿›ä¸€æ­¥æ‹†åˆ†æˆå¯¹è§’çŸ©é˜µ $D$ å’Œå•ä½ä¸Šä¸‰è§’çŸ©é˜µ $\widetilde{U}$ï¼š

<div style="text-align: center">
    <img src="images/C6/3.png" width=70%/>
</div>

å¯ä»¥æ¨å¯¼å‡ºï¼š$A$ æ˜¯å¯¹ç§°çŸ©é˜µï¼ˆ$A = A^T \rightarrow LU = LD \widetilde{U} = \widetilde{U^T} DL^T$ï¼‰$\Rightarrow L = \widetilde{U}^T \Rightarrow A = LDL^T$ã€‚è¿™æ ·æˆ‘ä»¬å¾—åˆ°äº†å¦ä¸€ç§çŸ©é˜µåˆ†è§£â€”â€” $LDL^T$ åˆ†è§£ï¼š

??? code "$LDL^T$ åˆ†è§£çš„ä»£ç å®ç°"

    å°† $n \times n$ çš„çŸ©é˜µ $A = (a_{ij})$ åˆ†è§£ä¸º $LDL^T$ çš„å½¢å¼ï¼Œå…¶ä¸­ $L$ æ˜¯ä¸‹ä¸‰è§’çŸ©é˜µï¼Œå¯¹è§’çº¿å…ƒç´ å‡ä¸º1ï¼›$D$ ä¸ºå¯¹è§’çŸ©é˜µï¼Œå¯¹è§’çº¿ä¸Šçš„å…ƒç´ å‡ä¸ºæ­£æ•°ã€‚

    - è¾“å…¥ï¼šç»´åº¦ $n$ï¼›$A$ çš„å…ƒç´  $a_{ij}, 1 \le i, j \le n$
    - è¾“å‡ºï¼š$L$ çš„é¡¹ $l_{ij}, 1 \le j \le i, 1 \le i \le n$ï¼Œä»¥åŠ $D$ çš„é¡¹ $u_{i}, 1 \le i \le n$

    ```cpp
    Step 1  for i = 1, ..., n do Steps 2-4:
        Step 2  for j = 1, ..., i - 1, set v_j = l_ij * d_j;
        Step 3  Set d_i = a_ii - sum(j=1, i-1, l_ij * v_j);
        Step 4  for j = i + 1, ..., n, set l_ji = (a_ji - sum(k=1, i-1, l_jk * v_k)) / d_i;
    ```

---
ä»¤ $D^{\frac{1}{2}} = \begin{bmatrix}\sqrt{u_{11}} & & & \\ & \sqrt{u_{22}} & & \\ & & & & \\ & & & \sqrt{u_{nn}}\end{bmatrix}$ï¼Œ$\widetilde{L} = LD^{\frac{1}{2}}$ ä»ç„¶æ˜¯ä¸€ä¸ªä¸Šä¸‰è§’çŸ©é˜µï¼Œå› æ­¤ $A = \widetilde{L} \widetilde{L}^T$

>å› ä¸ºå‰å¯¼ä¸»å­çŸ©é˜µéƒ½æ˜¯æ­£çš„ï¼Œæ‰€ä»¥ $u_{ii} > 0$

ç»¼ä¸Šï¼Œè‹¥ $A$ æ˜¯**æ­£å®šçŸ©é˜µ**ï¼Œé‚£ä¹ˆï¼š

- å½“ $L$ æ˜¯ä¸€ä¸ªå¯¹è§’çº¿å…ƒç´ å‡ä¸º1çš„ä¸‹ä¸‰è§’çŸ©é˜µï¼Œå¹¶ä¸” $D$ æ˜¯ä¸€ä¸ªå¯¹è§’é¡¹å‡ä¸ºæ­£æ•°çš„å¯¹è§’çŸ©é˜µæ—¶ï¼Œ$A$ å¯è¢«åˆ†è§£ä¸º $LDL^T$
- å½“ $L$ æ˜¯ä¸€ä¸ªå¯¹è§’çº¿ä¸Šå‡ä¸ºéé›¶å…ƒç´ çš„ä¸‹ä¸‰è§’çŸ©é˜µæ—¶ï¼Œ$A$ å¯è¢«åˆ†è§£ä¸º $LL^T$

???+ code "ç®—æ³•ï¼šCholeski æ³•"

    ç›®æ ‡ï¼šå°†è§„æ¨¡ä¸º $n \times n$ çš„å¯¹ç§°çš„æ­£å®šçŸ©é˜µ $A$ åˆ†è§£ä¸º $LL^T$ï¼Œå…¶ä¸­ $L$ æ˜¯ä¸‹ä¸‰è§’çŸ©é˜µã€‚

    è¾“å…¥ï¼š$n$ ç»´çŸ©é˜µ $A$ï¼Œå…¶å…ƒç´ ä¸º $a_{ij}, 1 \le i, j \le n$
    
    è¾“å‡ºï¼šçŸ©é˜µ $L$ï¼Œå…¶å…ƒç´ ä¸º $l_{ij}, 1 \le j \le i, 1 \le i \le n$

    ```cpp
    Step 1  set l_11 = sqrt(a_11);
    Step 2  for j = 2, ..., n, set l_j1 = a_j1 / l_11;
    Step 3  for i = 2, ..., n - 1 do steps 4 and 5
        Step 4  set l_ii = sqrt(a_ii - sum(pow(l_ik, 2), 1, i - 1))
        // LDL^T is faster, but must be modified to solve Ax = b

        Step 5  for j = i + 1, ..., n, set l_ji = (a_ji - sum(l_jk * l_ik, 1, i - 1)) / l_ii;
    Step 6  set l_nn = sqrt(a_nn - sum(pow(l_nk, 2), 1, n - 1))
    Step 7  output (l_ij for j = 1, ..., i and i = 1, ..., n);
    Stop.
    ```

??? note "Choleski æ³•çš„ä¼˜ç‚¹ï¼ˆby Gemini 2.5 Flashï¼‰"

    - æ•°å€¼ç¨³å®šæ€§é«˜ï¼šCholeski æ³•åœ¨æ•°å€¼ä¸Šéå¸¸ç¨³å®šï¼Œå› ä¸ºå®ƒä¸éœ€è¦ä¸»å…ƒé€‰æ‹©ã€‚ç”±äºçŸ©é˜µæ˜¯æ­£å®šçš„ï¼Œå¯ä»¥ä¿è¯å¯¹è§’çº¿å…ƒç´  $l_{ii}$ çš„å¹³æ–¹æ ¹æ€»æ˜¯æ­£å®æ•°ï¼Œå¹¶ä¸”ä¸ä¼šå‡ºç°é™¤ä»¥é›¶çš„æƒ…å†µã€‚
    - è®¡ç®—æ•ˆç‡é«˜ï¼šç›¸æ¯”äºä¸€èˆ¬çš„ LU åˆ†è§£ï¼ˆéœ€è¦ $2N^3/3$ æ¬¡æµ®ç‚¹è¿ç®—ï¼‰ï¼ŒCholeski æ³•åªéœ€è¦å¤§çº¦ $N^3/3$ æ¬¡æµ®ç‚¹è¿ç®—ï¼Œå› ä¸ºå®ƒåˆ©ç”¨äº†çŸ©é˜µçš„å¯¹ç§°æ€§ï¼Œåªéœ€è¦è®¡ç®— $L$ çš„ä¸‹ä¸‰è§’éƒ¨åˆ†ï¼ˆæˆ– $U$ çš„ä¸Šä¸‰è§’éƒ¨åˆ†ï¼‰ã€‚è¿™ä½¿å¾—å®ƒåœ¨å¤„ç†å¤§å‹å¯¹ç§°æ­£å®šç³»ç»Ÿæ—¶éå¸¸é«˜æ•ˆã€‚
    - å­˜å‚¨æ•ˆç‡é«˜ï¼šç”±äº $L$ å’Œ $L^T$ ä¹‹é—´å­˜åœ¨å…³ç³»ï¼Œæˆ‘ä»¬åªéœ€è¦å­˜å‚¨ $L$ï¼ˆæˆ– $U$ï¼‰ï¼Œè¿™èŠ‚çœäº†å­˜å‚¨ç©ºé—´ã€‚
    - ä¿è¯æ­£å®šæ€§ï¼šå¦‚æœ Choleski æ³•æˆåŠŸå®Œæˆï¼ˆå³æ‰€æœ‰ $l_{ii}$ éƒ½æ˜¯æ­£å®æ•°ï¼‰ï¼Œåˆ™å¯ä»¥ç¡®è®¤åŸå§‹çŸ©é˜µæ˜¯æ­£å®šçš„ã€‚åä¹‹ï¼Œå¦‚æœåˆ†è§£è¿‡ç¨‹ä¸­é‡åˆ°è´Ÿæ•°æˆ–é›¶çš„å¹³æ–¹æ ¹ï¼Œåˆ™çŸ©é˜µä¸æ˜¯æ­£å®šçš„ã€‚


### Crout Reduction for Tridiagonal Linear System

???+ info "å¸¦çŠ¶çŸ©é˜µ"

    å¯¹äºä¸€ä¸ª $n \times n$ çš„çŸ©é˜µï¼Œå¦‚æœæœ‰æ•´æ•° $p, q$ï¼Œæ»¡è¶³ $1 < p, q < n$ï¼Œå½“ $i + p \le j$ æˆ– $j + q \le i$ æ—¶ï¼Œæœ‰ $a_{ij} = 0$ï¼Œé‚£ä¹ˆç§°è¯¥çŸ©é˜µä¸º**å¸¦çŠ¶çŸ©é˜µ**(band matrix)ï¼Œå…¶**å¸¦å®½**(bandwidth)ä¸º $w = p + q - 1$ã€‚

å½“ $p = q = 2$ æ—¶ï¼Œ$w = 3$ï¼Œæ­¤æ—¶çš„çŸ©é˜µç§°ä¸º**ä¸‰å¯¹è§’çŸ©é˜µ**(tridiagonal matrix)ï¼Œå…¶å½¢å¼å¦‚ä¸‹ï¼š

$$
A = \begin{bmatrix}a_{11} & a_{12} & 0 & \dots & \dots & 0 \\ a_{21} & a_{22} & a_{23} & \dots & \dots & \vdots \\ 0 & a_{32} & a_{33} & \dots & \dots & \vdots \\ \vdots & \ddots & \ddots & \ddots & \ddots & a_{n-1, n} \\ 0 & \dots & \dots & 0 & a_{n, n-1} & a_{nn}\end{bmatrix}
$$

å¯¹äºä¸Šè¿°å½¢å¼çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼ˆ$A \bm{x} = \bm{f}$ï¼‰ï¼Œæˆ‘ä»¬é‡‡ç”¨ä¸€ç§ç‰¹æ®Šçš„ $LU$ åˆ†è§£ï¼Œç§°ä¸º **Crout åˆ†è§£**ã€‚ä¸‹é¢ç»™å‡ºå…·ä½“æ±‚è§£æ­¥éª¤ï¼š

1. å¯»æ‰¾çŸ©é˜µ $A$ çš„ Crout åˆ†è§£ï¼Œ$L, U$ åˆ†åˆ«ä¸ºï¼š

    $$
    L = \begin{bmatrix}l_{11} & 0 & \dots & \dots & 0 \\ l_{21} & l_{22} & \ddots & & \vdots \\ 0 & \ddots & \ddots & \ddots & 0 \\ 0 & \dots & 0 & l_{n, n-1} & l_{nn}\end{bmatrix} \quad U = \begin{bmatrix}1 & u_{12} & 0 & \dots & 0 \\ 0 & 1 & \ddots & \ddots & \vdots \\ \vdots & & \ddots & \ddots & u_{n-1, n} \\ 0 & \dots & \dots & 0 & 1\end{bmatrix}
    $$

2. æ±‚è§£ $L\bm{y} = \bm{f} \Rightarrow y_1 = \dfrac{f_1}{l_{11}}, y_i = \dfrac{(f_i - l_{i, i-1} y_{i-1})}{l_{ii}} (i = 2, \dots, n)$
3. æ±‚è§£ $U\bm{x} = \bm{y} \Rightarrow x_n = y_n, x_i = y_i - u_{i,i+1} x_{i+1}$

!!! theorem "å®šç†"

    å¦‚æœ $A$ æ˜¯ä¸‰å¯¹è§’çº¿çŸ©é˜µï¼Œä¸”æ˜¯å¯¹è§’çº¿å ä¼˜çš„ï¼Œå¹¶æ»¡è¶³ $|b_1| > |c_1| > 0, |b_n| > |a_n| > 0, a_i \ne 0, c_i \ne 0$ï¼Œé‚£ä¹ˆ $A$ æ˜¯éå¥‡å¼‚çš„ï¼Œå¯¹åº”çš„çº¿æ€§æ–¹ç¨‹ç»„æœ‰è§£ã€‚

!!! note "æ³¨"

    - å¦‚æœ $A$ æ˜¯ä¸¥æ ¼å¯¹è§’å ä¼˜çš„ï¼Œé‚£ä¹ˆæ²¡æœ‰å¿…è¦è®©æ‰€æœ‰çš„ $a_i, b_i, c_i$ éƒ½æ˜¯éé›¶çš„
    - è¯¥æ–¹æ³•æ˜¯ç¨³å®šçš„ï¼Œå› ä¸ºæ‰€æœ‰ä»è®¡ç®—è¿‡ç¨‹ä¸­è·å¾—çš„å€¼ä¼šè¢«çº¦æŸåœ¨åŸæœ‰å…ƒç´ çš„èŒƒå›´å†…
    - è®¡ç®—é‡ä¸º $O(n)$

??? code "ä»£ç å®ç°"

    æ±‚è§£ $n \times n$ çš„çº¿æ€§æ–¹ç¨‹ç»„ï¼š

    $$
    \begin{align}
    E_1: a_{11} x_1 + a_{12} x_2 \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad & = a_{1, n+1} \notag \\
    E_2: a_{21} x_1 + a_{22} x_2 + a_{23} x_3 \quad \quad \quad \quad \quad \quad \quad \quad \quad \ \ & = a_{2, n+1} \notag \\
    \vdots \quad \quad \quad \quad \quad \quad \quad \quad \quad \vdots \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \ \ & \ \ \vdots \notag \\
    E_{n-1}: \quad a_{n-1, n-2} x_{n-2} + a_{n-1, n-1} x_{n-1} + a_{n-1, n} x_n & = a_{n-1, n+1} \notag \\
    E_{n}: \quad \quad \quad \quad \quad \quad \quad \quad \quad \quad \ a_{n, n-1} x_{n-1} + a_{n, n} x_n & = a_{n, n+1} \notag \\
    \end{align}
    $$

    å‡è®¾è¿™ä¸ªçº¿æ€§æ–¹ç¨‹ç»„æœ‰å”¯ä¸€è§£ã€‚

    - è¾“å…¥ï¼šç»´åº¦ $n$ï¼›$A$ çš„å…ƒç´ 
    - è¾“å‡ºï¼šè§£ $x_1, \dots, x_n$

    ```cpp
    Step 1  Set l_11 = a_11;
                u_12 = a_12 / l_11;
                z_1 = a_{1,n+1} / l_11;
    Step 2  for i = 2, ..., n-1 set l_{i, i-1} = a_{i, i-1};    // ith row of L
                                    l_ii = a_ii - l_{i, i-1} * u_{i-1, i};
                                    u_{i, i+1} = a_{i, i+1} / l_ii;    // (i+1)th column of U
                                    z_i = (a_{i, n+1} - l_{i, i-1} * z_{i-1}) / l_ii;
    Step 3  Set l_{n, n-1} = a_{n, n-1};    // nth row of L
                l_nn = a_nn - l_{n, n-1} * u_{n-1, n};
                z_n = (a_{n, n+1} - l_{n, n-1} * z_{n-1}) / l_nn;
    // Step 4 and 5 solve Ux = z
    Step 4  x_n = z_n;
    Step 5  for i = n-1, ..., 1 set x_i = z_i - u_{i, i+1} * x_{i+1};
    Step 6  Output(x_1, ..., x_n);
            STOP;
    ```

>å¯¹åº”çš„[ä½œä¸šç»ƒä¹ ](hw.md#chap-6-direct-methods-for-solving-linear-systems)ğŸ“

>å¯¹åº”[å°æµ‹3å’Œ4](quizzes.md)ğŸ’¯