# Chap 6 Priority Queues(Heaps)

> When to use heap?
> å½“æˆ‘ä»¬åªå…³å¿ƒä¸€ä¸ªåˆ—è¡¨ä¸­æœ€å°ï¼ˆå¤§ï¼‰çš„å…ƒç´ æ—¶ï¼ˆé¢‘ç¹æŸ¥æ‰¾æˆ–ä½¿ç”¨ï¼‰ï¼Œæˆ‘ä»¬åº”ä¼˜å…ˆä½¿ç”¨**å †**
## ADT Model

**ä¼˜å…ˆé˜Ÿåˆ—ï¼ˆå †ï¼‰**
+ **å¯¹è±¡(Objects)**ï¼šå«æœ‰0ä¸ªæˆ–å¤šä¸ªå…ƒç´ çš„æœ‰é™æœ‰åºè¡¨
+ **è¿ç®—(Operations)**ï¼š
	+ `PriorityQueue Initialize(int MaxElements);`
	+ `void Insert(ElementType X, PriorityQueue H);`â—
	+ `ElmentType DeleteMin(PriorityQueue H);`â—
	+ `ElementType FindMin(PriorityQueue H);`

## Simple Implementation

+ æ•°ç»„
	+ æ’å…¥ï¼šåœ¨å°¾éƒ¨æ·»åŠ é¡¹~$\Theta(1)$
	+ åˆ é™¤ï¼šæ‰¾æœ€å¤§/æœ€å°çš„é”®~$\Theta(n)$ï¼›åˆ é™¤é¡¹åç§»åŠ¨å‰©ä½™é¡¹~$O(n)$
+ **é“¾è¡¨**ï¼š
	+ æ’å…¥ï¼šåœ¨å¤´éƒ¨æ·»åŠ é¡¹~$\Theta(1)$
	+ åˆ é™¤ï¼šæ‰¾æœ€å¤§/æœ€å°çš„é”®~$\Theta(n)$ï¼›åˆ é™¤é¡¹~$\Theta(1)$
+ æœ‰åºæ•°ç»„ï¼š
	+ æ’å…¥ï¼šæ‰¾åˆ°æ­£ç¡®çš„ä½ç½®~$O(n)$ï¼›ç§»åŠ¨æ•°ç»„å¹¶åŠ å…¥è¯¥é¡¹~$O(n)$
	+ åˆ é™¤ï¼šç§»é™¤é¦–é¡¹/æœ«é¡¹~$\Theta(1)$
+ æœ‰åºé“¾è¡¨ï¼š
	+ æ’å…¥ï¼šæ‰¾åˆ°æ­£ç¡®çš„ä½ç½®~$O(n)$ï¼›åŠ å…¥é¡¹~$\Theta(1)$
	+ åˆ é™¤ï¼šç§»é™¤é¦–é¡¹/æœ«é¡¹~$\Theta(1)$

>å¯ä»¥çœ‹å‡ºï¼Œè¿™äº›ç»“æ„å®ç°èµ·æ¥ç›¸å¯¹æ¯”è¾ƒå®¹æ˜“ï¼Œä¸”å„æœ‰ä¼˜åŠ£ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œ==æ’å…¥çš„æ“ä½œ > åˆ é™¤çš„æ“ä½œ==ï¼Œå› æ­¤æœ¬æ•™æçš„ä½œè€…ä¼šåœ¨è¿™å››ç§æ–¹æ³•ä¸­é€‰æ‹©**é“¾è¡¨**ã€‚

>What about *BST(äºŒåˆ†æœç´¢æ ‘)*ï¼Ÿ
>äºŒåˆ†æœç´¢æ ‘æœ‰ä»¥ä¸‹é—®é¢˜ï¼š
>+ è™½ç„¶ç†è®ºä¸Šå®ƒçš„æ’å…¥å’Œåˆ é™¤æ“ä½œæ—¶é—´å¤æ‚åº¦ä¸º$O(\log n)$ï¼Œç„¶è€Œå®é™…åº”ç”¨ä¸­**æ’å…¥**æ“ä½œæ˜¯*éšæœº*çš„ï¼Œè¿™ä¼šå¯¼è‡´æ ‘çš„ä¸å¹³è¡¡ï¼Œä»è€Œå½±å“æ—¶é—´å¤æ‚åº¦
>+ è™½ç„¶**åˆ é™¤**æ“ä½œå¹¶ä¸æ˜¯éšæœºçš„ï¼Œä½†æˆ‘ä»¬åªè¦æ‰¾æœ€å°èŠ‚ç‚¹å¹¶ä¸”åˆ é™¤å®ƒï¼Œè¿™ä¼šå¯¼è‡´å·¦å­æ ‘è¶Šæ¥è¶Šå°ï¼Œç ´åäº†æ ‘çš„å¹³è¡¡ï¼Œä»è€Œå½±å“å¤æ‚åº¦
>+ æˆ‘ä»¬å¯èƒ½æƒ³åˆ°æ„å»ºä¸€æ£µå¹³è¡¡çš„æ ‘ï¼Œæ¯”å¦‚AVLæ ‘ã€‚ä½†æ˜¯AVLæ ‘ä¸­çš„å¾ˆå¤šæ“ä½œåœ¨ä¼˜å…ˆé˜Ÿåˆ—ä¸­ç”¨ä¸åˆ°ï¼Œä¸”å®ƒçš„æŒ‡é’ˆä½¿ç”¨å¾ˆå±é™©ã€‚ 

å› æ­¤æˆ‘ä»¬é‡‡ç”¨ä¸€ç§æ–°çš„æ•°æ®ç»“æ„â€”â€”**äºŒå‰å †**(binary heap, ç®€ç§°**å †**(heap))

## Binary Heap

### Structure Property

**å®Œå…¨(Complete)äºŒå‰æ ‘**ï¼šå¯¹äºä¸€æ£µæœ‰$n$ä¸ªèŠ‚ç‚¹ä¸”é«˜ä¸º$h$çš„æ ‘ï¼Œå¦‚æœå®ƒçš„èŠ‚ç‚¹ä¸ä¸€æ£µé«˜ä¸º$h$çš„*å®Œç¾äºŒå‰æ ‘(å³æ»¡äºŒå‰æ ‘ï¼Œperfect binary tree)* çš„èŠ‚ç‚¹ï¼ˆä»1åˆ°$n$æ ‡å·ï¼‰ä¸€ä¸€å¯¹åº”
>å¦ä¸€ç§å®šä¹‰ï¼šé™¤äº†æœ€åä¸€å±‚å¤–ï¼Œæ¯å±‚çš„èŠ‚ç‚¹éƒ½å¡«æ»¡ï¼Œæœ€åä¸€å±‚çš„èŠ‚ç‚¹ä»å·¦å¾€å³å¡«è¡¥çš„æ ‘

ä¸€æ£µé«˜ä¸º$h$çš„å®Œå…¨äºŒå‰æ ‘æœ‰$2^h$~$2^{h + 1} - 1$ä¸ªèŠ‚ç‚¹ $\Leftrightarrow$ $h = \lfloor \log N \rfloor$

å› ä¸ºå®Œå…¨äºŒå‰æ ‘çš„è§„å¾‹æ€§ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨**æ•°ç»„**å­˜å‚¨äºŒå‰å †ï¼Œç”¨*ç´¢å¼•*æ‰¾åˆ°ç›¸åº”èŠ‚ç‚¹ï¼ˆè§ä¸‹é¢å¼•ç†ï¼‰ï¼Œååˆ†ç®€å•ï¼Œä½†åˆ›å»ºå †çš„æ—¶å€™è¦è€ƒè™‘*æœ€å¤§å®¹é‡*
![](Images/C6/Quicker_20240403_145352.png)
ğŸŒŸå¼•ç†ï¼šå¦‚æœä¸€æ£µæœ‰$n$ä¸ªèŠ‚ç‚¹çš„å®Œå…¨äºŒå‰æ ‘é¡ºåºè¡¨ç¤ºï¼Œåˆ™å¯¹äºç´¢å¼•ä¸º$i(1 \le i \le n)$çš„èŠ‚ç‚¹ï¼Œæˆ‘ä»¬æœ‰ï¼š
+ **çˆ¶èŠ‚ç‚¹**çš„ç´¢å¼• $= \begin{cases} \lfloor \dfrac{i}{2} \rfloor & \text{if } i \ne 1 \\ \text{None} & \text{if } i = 1\end{cases}$
>å¾ˆå·§çš„æ˜¯ï¼ŒCè¯­è¨€çš„æ•´æ•°é™¤æ³•è‡ªåŠ¨å¸®æˆ‘ä»¬å‘ä¸‹å–æ•´ï¼Œå› æ­¤ç›´æ¥é™¤å°±è¡Œäº†
+ **å·¦å­©å­**çš„ç´¢å¼• $= \begin{cases} 2i & \text{if } 2i \le n \\ \text{None} & \text{if } 2i > n\end{cases}$
+ **å³å­©å­**çš„ç´¢å¼• $= \begin{cases} 2i + 1 & \text{if } 2i + 1 \le n \\ \text{None} & \text{if } 2i + 1 > n\end{cases}$
>æ³¨ï¼šç´¢å¼•ä»1å¼€å§‹ï¼Œåªæ˜¯ä¸ºäº†å¾—åˆ°ä¸Šé¢çœ‹èµ·æ¥æŒºå¥½çœ‹çš„å¼•ç†ã€‚ä½†è¿™æ ·åšåï¼Œç´¢å¼•ä¸º0çš„ä½ç½®å°±ç©ºå‡ºæ¥äº†ã€‚æˆ‘ä»¬ä¹‹åä¼šåˆ©ç”¨è¿™ä¸ªä½ç½®ï¼Œä½œä¸º**å“¨å…µ(sentinel)**ï¼ˆå°†å…¶è®¾ä¸ºæ•´ä¸ªå †çš„æœ€å°å€¼ï¼‰ï¼Œæ–¹ä¾¿åé¢çš„*æ’å…¥*å’Œ*åˆ é™¤*æ“ä½œ

``` c
struct HeapStruct
{
	/* Maximum # that can fit in the heap */
	unsigned int max_heap_size;
	/* Current # of elements in the heap */
	unsigned int size;
	element_type *elements;
};
typedef struct HeapStruct *PriorityQueue;
```
#### Initialize
``` c
PriorityQueue Initiailize(int MaxElments)
{
	PriorityQueue H;
	if (MaxElements < MinPQSize)
		return Error("Priority queue size is too small");
	H = (PriorityQueue)malloc(sizeof(struct HeapStruct));
	if (H == NULL)
		return FatalError("Out of Space!!!");
	// Allocate the array plus one extra for sentinel
	H->Elements = (ElementType * )malloc((MaxElements + 1) * sizeof(ElementType));
	if (H->Elements == NULL)
		return FatalError("Out of Space!!!");
	H->Capacity = MaxElements;
	H->Size = 0;
	H->Elements[0] = MinData;  // set the sentinel
	return H;
}
```
### Heap Order Property

+ **æœ€å°æ ‘(min tree)**ï¼šä¸€æ£µæ ‘ä¸­æ¯ä¸ªèŠ‚ç‚¹çš„é”®å€¼ä¸å¤§äºå®ƒçš„å­©å­
+ **æœ€å°å †(min heap)**ï¼š*å®Œå…¨äºŒå‰æ ‘* + *æœ€å°æ ‘*
> æˆ‘ä»¬ä¹Ÿèƒ½ä»¥ç±»ä¼¼çš„æ–¹æ³•å®šä¹‰**æœ€å¤§å †**ï¼Œè¿™é‡Œå°±ä¸å†™å‡ºæ¥äº†

![](Images/C6/Quicker_20240403_151551.png)

>æ³¨ï¼š
>+ æ˜¾è€Œæ˜“è§ï¼Œ**æ ¹èŠ‚ç‚¹**æ˜¯å †ä¸­æœ€å°(å¤§)çš„èŠ‚ç‚¹
>+ ä»å †çš„æ ¹èŠ‚ç‚¹å‡ºå‘ï¼Œåˆ°ä»»æ„èŠ‚ç‚¹çš„è·¯å¾„æ˜¯*æœ‰åº*çš„ã€‚ä½†æ˜¯å †ä¸èƒ½è¡¨ç¤ºæ•´æ£µæ ‘çš„é¡ºåº

### Basic Heap Operations

#### Insertion
>æ€è·¯ï¼šå› ä¸ºè¦ä¿æŒå®Œå…¨äºŒå‰æ ‘çš„çŠ¶æ€ï¼Œå› æ­¤**å”¯ä¸€**å¯æ’å…¥èŠ‚ç‚¹çš„ä½ç½®æ˜¯**æœ€åä¸€ä¸ªä½ç½®**ã€‚æ’å…¥ä»¥åè¦è°ƒæ•´èŠ‚ç‚¹çš„ä½ç½®ï¼šå°†è¯¥èŠ‚ç‚¹ä¸å…¶çˆ¶èŠ‚ç‚¹æ¯”è¾ƒï¼Œå¦‚æœæ¯”çˆ¶èŠ‚ç‚¹å°ï¼Œåˆ™å°†çˆ¶èŠ‚ç‚¹å¾€ä¸‹ç§»ï¼Œç›´è‡³æ¯”å½“å‰æ¯”è¾ƒçš„èŠ‚ç‚¹æ›´å¤§åˆ™åœæ­¢ï¼Œæ­¤æ—¶çš„ä½ç½®å³ä¸ºæ–°èŠ‚ç‚¹çš„ä½ç½®ã€‚è¿™ç§æŠ€å·§è¢«ç§°ä¸ºâ€œ**ä¸Šæ»¤(Percolate up)** â€ã€‚

å›¾ç¤ºï¼š
![](Images/C6/Quicker_20240404_134118.png)

ä»£ç å®ç°ï¼š
``` c
// H->Elements[0] is a sentinel
void Insert(ElementType X, PriorityQueue H)
{
	int i;

	if (IsFull(H))
	{
		Error("Priority queue is full");
		return;
	}

	for (i = ++H->Size; H->Elements[i / 2] > X; i /= 2)
		H->Elements[i] = H->Elements[i / 2];

	H->Elements[i] = X;
}
```
>æ³¨ï¼š
>1. åœ¨æ¯”è¾ƒè¿‡ç¨‹ä¸­ï¼Œå¹¶æ²¡æœ‰ç›´æ¥äº¤æ¢ä¸¤ä¸ªæ•°ï¼Œå› ä¸ºå®ç°ä¸€æ¬¡äº¤æ¢å°±éœ€è¦ä¸‰æ¡èµ‹å€¼è¯­å¥ã€‚å¦‚æœä¸€ä¸ªèŠ‚ç‚¹å‘ä¸Šç§»åŠ¨$d$å±‚ï¼Œåˆ™éœ€è¦æ‰§è¡Œ$3d$æ¬¡è¿ç®—ï¼›è€Œä¸Šé¢çš„æ–¹æ³•åªéœ€$d + 1$æ¬¡è¿ç®—ï¼Œæ˜¾ç„¶**æ›´å¿«**
>2. æ­£å¦‚ä¸Šé¢æ‰€è¯´ï¼Œ0ä½ç½®çš„èŠ‚ç‚¹è¢«ç§°ä¸º**å“¨å…µ**ï¼Œå°†å®ƒçš„å€¼è®¾ä¸ºæ•´ä¸ªå †çš„æœ€å°å€¼ã€‚æœ‰äº†å®ƒï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦ç”¨â€œ`while`å¾ªç¯+æ ¹èŠ‚ç‚¹ä½ç½®ç‰¹åˆ¤â€œè¿™ä¹ˆéº»çƒ¦ï¼Œå¯¹å¾…æ ¹èŠ‚ç‚¹ä¹Ÿèƒ½åƒå¯¹å¾…å…¶ä»–èŠ‚ç‚¹ä¸€æ ·ï¼Œå› æ­¤åªè¦ç”¨ç®€å•çš„`for`å¾ªç¯å°±èƒ½å®ç°
>3. $T(N) = O(\log N)$

#### DeleteMin
>æ€è·¯ï¼šè¦æ‰¾åˆ°æœ€å°å€¼éå¸¸ç®€å•â€”â€”å°±æ˜¯**é¦–é¡¹**ã€‚ä½†æ˜¯åˆ é™¤é¦–é¡¹åï¼Œè¿˜æ˜¯è¦ä¿è¯è¯¥æ ‘æ˜¯å®Œå…¨äºŒå‰æ ‘+æœ€å°æ ‘ã€‚å› æ­¤å®é™…ä¸Šæˆ‘ä»¬åº”åˆ é™¤**æœ€åä¸€ä¸ªèŠ‚ç‚¹**ï¼Œç„¶åè€ƒè™‘å¦‚ä½•å®‰ç½®åŸæ¥åœ¨æœ€åä½ç½®ä¸Šçš„èŠ‚ç‚¹ï¼šå…ˆå°†å®ƒæ”¾å…¥æ ¹èŠ‚ç‚¹çš„ä½ç½®ï¼ˆå› ä¸ºâ€åˆ é™¤â€œæ“ä½œï¼Œè¿™ä¸ªä½ç½®ç©ºå‡ºæ¥äº†ï¼‰ï¼Œå†è®©å®ƒå’Œå·¦å³å­©å­æ¯”è¾ƒã€‚å¦‚æœæ¯”å·¦å³å­©å­éƒ½å¤§ï¼Œåˆ™è¦å°†æœ€å°çš„å­©å­æ”¾å…¥æ ¹èŠ‚ç‚¹ï¼Œæ¥ç€å°†å®ƒä¸è¿™ä¸ªå­©å­çš„å·¦å³å­©å­æ¯”è¾ƒï¼Œâ€¦â€¦ï¼Œç›´è‡³æ¯”å·¦å³å­©å­éƒ½å°ä¸ºæ­¢ã€‚è¿™ç§æŠ€å·§è¢«ç§°ä¸ºâ€**ä¸‹æ»¤(Percolate down)** â€œ

å›¾ç¤ºï¼š
![](Images/C6/Quicker_20240404_134223.png)
![](Images/C6/Quicker_20240404_134237.png)


ä»£ç å®ç°ï¼š
``` c
ElementType DeleteMin(PriorityQueue H)
{
	int i, Child;
	ElementType MinElement, LastElment;
	
	if (isEmpty(H))
	{
		Error("Priority queue is empty");
		return H->Elements[0];
	}
	MinElement = H->Elements[1];   // save the min element
	LastElment = H->Elements[H->Size--];  // take last and reset size
	for (i = 1; i * 2 <= H->Size; i = Child)  // find smaller child
	{
		Child = i * 2;
		if (Child != H->Size && H->Elements[Child + 1] < H->Elements[Child]) // percolate one level
			Child++;
		if (LastElement > H->Elements[Child]);
		else break;  // find the proper position
	}
	H->Elements[i] = LastElement;
	
	return MinElement;
}
```
>æ³¨ï¼š
>1. `for`å¾ªç¯ä¸­çš„ç¬¬ä¸€ä¸ª`if`è¯­å¥è€ƒè™‘äº†åªæœ‰ä¸€ä¸ªå·¦å­©å­çš„èŠ‚ç‚¹çš„æƒ…å†µï¼šæ²¡æœ‰è¿™å¥è¯çš„è¯ï¼Œç¨‹åºä¼šé»˜è®¤æ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰ä¸¤ä¸ªå­©å­ï¼Œæ˜¾ç„¶ä¼šå¯¼è‡´é”™è¯¯ï¼›åŒæ—¶ï¼Œå®ƒä¹Ÿé€‰æ‹©äº†æœ€å°çš„å­©å­ä½œä¸ºæ¥ä¸‹æ¥çš„æ¯”è¾ƒå¯¹è±¡
>2. å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ª**å“¨å…µ**æ¥ç§»é™¤è¿™ä¸ª`if`è¯­å¥ï¼šå¯¹äºèŠ‚ç‚¹æ€»æ•°ä¸ºå¶æ•°çš„å †(ç”±å®Œå…¨äºŒå‰æ ‘çš„æ€§è´¨çŸ¥ï¼Œæ­¤æ—¶å­˜åœ¨ä¸€ä¸ªåªæœ‰å·¦å­©å­çš„èŠ‚ç‚¹)ï¼Œåœ¨æœ€åä½ç½®çš„ä¸‹ä¸€ä¸ªä½ç½®ä¸Šæ·»åŠ ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¹¶å°†å…¶å€¼è®¾ä¸ºæ•´ä¸ªå †çš„æœ€å¤§å€¼ï¼Œè¿™æ ·å°±å¯ä»¥é˜²æ­¢æŸä¸ªèŠ‚ç‚¹ä¸‹æ»¤çš„æ—¶å€™è¢«å®‰ç½®åœ¨ä¸å­˜åœ¨çš„èŠ‚ç‚¹ä¸Šï¼Œè€Œä¸éœ€è¦ç‰¹åˆ¤
>3. $T(N) = O(\log N)$

### Other Heap Operations

>æ³¨ï¼š
>1. å¦‚æœæˆ‘ä»¬æƒ³è¦é¢‘ç¹åœ°**æŸ¥æ‰¾**æŸä¸ªåˆ—è¡¨ä¸­çš„**ä»»æ„**å…ƒç´ ï¼Œé‚£ä¹ˆ*å †*ç»å¯¹==ä¸æ˜¯==åˆç†çš„é€‰æ‹©ï¼Œå› ä¸ºåœ¨å †é‡Œæ‰¾å…ƒç´ éœ€è¦çº¿æ€§æ‰«æ($O(n)$)ã€‚æˆ‘ä»¬åº”è¯¥é‡‡ç”¨äºŒåˆ†æœç´¢æ ‘ã€æ•£åˆ—è¡¨ç­‰æ–¹æ³•
>2. åœ¨æœ€å°å †ä¸­æ‰¾æœ€å¤§å€¼ä¹Ÿæ˜¯ä¸åˆç†çš„ï¼Œç†ç”±åŒä¸Š

$DecreaseKey(P, \Delta, H)$
>å°†ä½ç½®ä¸º$P$çš„èŠ‚ç‚¹çš„é”®å€¼å‡å»$\Delta$ï¼Œè¿™æ ·å¯¹åº”èŠ‚ç‚¹çš„ä¼˜å…ˆçº§å°±ä¼šæé«˜ï¼ˆ**ä¸Šæ»¤**ï¼‰

$IncreaseKey(P, \Delta, H)$
>å°†ä½ç½®ä¸º$P$çš„èŠ‚ç‚¹çš„é”®å€¼åŠ ä¸Š$\Delta$ï¼Œè¿™æ ·å¯¹åº”èŠ‚ç‚¹çš„ä¼˜å…ˆçº§å°±ä¼šä¸‹é™ï¼ˆ**ä¸‹æ»¤**ï¼‰

>æ³¨ï¼šè¿™ä¸¤ä¸ªæ“ä½œä¸€èˆ¬ç”±*ç³»ç»Ÿç®¡ç†å‘˜*ï¼Œè€Œéä¸€èˆ¬çš„ç”¨æˆ·ä½¿ç”¨ã€‚æ¯”å¦‚ï¼Œå‰è€…å¯ä½¿æŸä¸ªç¨‹åºæåˆ°æœ€é«˜ä¼˜å…ˆçº§ï¼›åè€…å¯å°†å ç”¨CPUæ—¶é—´è¿‡å¤šçš„è¿›ç¨‹çš„ä¼˜å…ˆçº§å¾€ä¸‹è°ƒ

$Delete(P, H)$
>ä»å †ä¸­ç§»é™¤ä½ç½®ä¸º$P$çš„èŠ‚ç‚¹ï¼ˆåˆ é™¤ç”±ç”¨æˆ·ç»ˆæ­¢ï¼ˆéæ­£å¸¸ç»“æŸï¼‰çš„è¿›ç¨‹ï¼‰ã€‚çœ‹ä¼¼å¾ˆå¤æ‚ï¼Œå®é™…ä¸Šæˆ‘ä»¬å¯ä»¥è¿ç”¨ä¹‹å‰çš„`DecreaseKey()`å’Œ`DeleteMin()`å‡½æ•°ï¼Œå…¶ä¸­å‰è€…ç¬¬äºŒä¸ªå‚æ•°ä»¤ä¸º$\infty$ï¼ˆå‡å»æ— é™å¤§çš„æ•°ï¼Œæˆä¸ºæœ€å°çš„æ•°ï¼Œç„¶ååˆ©ç”¨`DeleteMin()`ï¼‰

$BuildHeap(H)$
> é¢˜ç›®ï¼šå°†æŸä¸ªåˆ—è¡¨ä¸­çš„ä¸€ç»„æ•°æ”¾å…¥ç©ºçš„å †ä¸­
> æ–¹æ³•ï¼š
> + å¯¹äºæ¯ä¸ªèŠ‚ç‚¹ä½¿ç”¨`Insert()`å‡½æ•° $\rightarrow O(N\log N)$ ï¼ŸâŒ
> + é‡‡ç”¨â€œ**ä¸‹æ»¤**â€æ€æƒ³ï¼šç°å°†è¡¨ä¸­çš„å…ƒç´ æŒ‰å±‚åºæ”¾å…¥ä¸€æ£µå®Œå…¨äºŒå‰æ ‘ä¸­ï¼Œç„¶åä»**é«˜åº¦ä¸º1çš„æœ€åä¸€ä¸ªèŠ‚ç‚¹**å¼€å§‹ï¼ˆæœ€åº•å±‚é«˜åº¦ä¸º0ï¼‰ï¼Œè·Ÿå­æ ‘æ¯”è¾ƒå¤§å°ï¼Œå¦‚æœæ¯”å­æ ‘å¤§ï¼Œåˆ™éœ€è¦ä¸‹æ»¤ï¼Œç›´è‡³åˆé€‚çš„ä½ç½®ï¼ˆå…·ä½“å®ç°å¯å€Ÿé‰´`DeleteMin()`ï¼‰
>
> 	å›¾ç¤ºï¼š
>	![](notebooks/fds/Images/C6/Quicker_20240404_134503.png)
>	![](notebooks/fds/Images/C6/Quicker_20240404_134514.png)
>	
> 	ç®€å•ä»£ç å®ç°ï¼š
``` c
for (i = N / 2; i > 0; i--)
	PercolateDown(i);
```


å®šç†ï¼šå¯¹äºä¸€æ£µé«˜ä¸º$h$ï¼Œæ‹¥æœ‰$2^{h+1}-1$ä¸ªèŠ‚ç‚¹çš„å®Œç¾äºŒå‰æ ‘ï¼Œæ‰€æœ‰èŠ‚ç‚¹é«˜åº¦ä¹‹å’Œä¸º$2^{h+1} - 1 - (h+1)$

ç”±æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥æ¨å‡º`BuildHeap(H)`çš„æ—¶é—´å¤æ‚åº¦ä¸º$O(N)$

## Applications of Priority Queues

ä¸¾ä¾‹ï¼š
+ æ“ä½œç³»ç»Ÿï¼ˆè§[[Chap 6 Priority Queues(Heaps)#Other Heap Operations|è¿™é‡Œ]]ï¼‰
+ å¤–éƒ¨æ’åºï¼ˆç¬¬7ç« ï¼‰
+ [[Chap 3 Algorithms#^19ef1a|è´ªå¿ƒç®—æ³•]]
+ ç¦»æ•£äº‹ä»¶æ¨¡æ‹Ÿï¼ˆè§ä¸‹é¢çš„ä¾‹å­ï¼‰

### The Selection Problem

>é—®é¢˜ï¼šç»™å®š$N$ä¸ªå…ƒç´ ï¼Œæ‰¾åˆ°ç¬¬$k$å¤§çš„å…ƒç´ 

ç®—æ³•ï¼š
åœ¨ç¬¬ä¸€ç« ä¸­ï¼Œå·²ç»ç»™å‡ºä¸¤ä¸ªç®—æ³•ï¼Œæ˜“äºç†è§£ä½†æ•ˆç‡ä¸é«˜ï¼š
1. å¯¹æ‰€æœ‰å…ƒç´ æ’å¥½åºï¼Œå†æ‰¾ç¬¬$k$å¤§çš„æ•° $\rightarrow O(N^2)$
2. å…ˆå–å‰$k$ä¸ªæ•°å¹¶å¯¹è¿™äº›æ•°æ’å¥½åºï¼Œå†å°†å‰©ä½™$N - k$ä¸ªæ•°åˆ†åˆ«ä¸è¿™$k$ä¸ªæ•°æ¯”è¾ƒï¼šå¦‚æœæ¯”è¿™$k$ä¸ªæ•°ä¸­æœ€å°çš„æ•°æ›´å¤§ï¼Œå°†æœ€å°çš„æ•°è¸¢å‡ºå»ï¼Œè¿™ä¸ªæ•°è¿›å»å¹¶æ”¾å…¥æ­£ç¡®çš„ä½ç½®ã€‚æ—¶é—´å¤æ‚åº¦ä¸º$O(N \cdot k)$ï¼Œæœ€åæƒ…å†µ$k = \lceil N/2 \rceil$æ—¶ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$O(N^2)$

åˆ©ç”¨æˆ‘ä»¬åˆšå­¦çš„å †ï¼Œå¯ä»¥å¾—åˆ°ä¸¤ä¸ªå¤æ‚åº¦å‡ä¸º$O(N \log N)$çš„ç®—æ³•ï¼š
3. ä¸ºäº†æ–¹ä¾¿èµ·è§ï¼Œè¿™é‡Œæˆ‘ä»¬è®¨è®ºæ‰¾ç¬¬$k$å°çš„æ•°ï¼ˆé“ç†éƒ½æ˜¯ä¸€æ ·çš„ï¼‰ã€‚å…ˆå¯¹è¿™$N$ä¸ªå…ƒç´ æ„å»ºå †(ä½¿ç”¨`BuildHeap()`å‡½æ•°)ï¼Œç„¶åä½¿ç”¨$k$æ¬¡`DeleteMin()`å‡½æ•°ï¼Œæœ€åä¸€æ¬¡ä»å †ä¸­å¾—åˆ°çš„å…ƒç´ ä¾¿æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç¬¬$k$å°çš„å…ƒç´ ã€‚æ—¶é—´å¤æ‚åº¦$O(N + k \log N)$ï¼Œæœ€åæƒ…å†µä¸º$k = \lceil N/2 \rceil$ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º$\Theta(N \log N)$
4. å€Ÿé‰´ç®—æ³•2çš„æ€æƒ³ï¼Œå…ˆå¯¹å‰$k$ä¸ªæ•°æ„å»ºå †(ä½¿ç”¨`BuildHeap()`å‡½æ•°)ï¼Œç„¶åå°†å‰©ä¸‹$N - k$ä¸ªå…ƒç´ ä¸å †ä¸­æ ¹èŠ‚ç‚¹(æœ€å°å€¼)è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœæ¯”å®ƒå¤§ï¼Œåˆ™éœ€è¦ä½¿ç”¨`DeleteMin()`å’Œ`Insert()`ä¸¤ä¸ªå‡½æ•°ã€‚æ—¶é—´å¤æ‚åº¦ä¸º$O(k + (N - k)\log k) = O(N \log k)$ï¼Œæœ€åæƒ…å†µä¸º$\Theta(N \log N)$

### Event Simulation
>é—®é¢˜ï¼šåœ¨é“¶è¡Œä¸­ï¼Œé¡¾å®¢æ’åœ¨ä¸€åˆ—é˜Ÿä¼ä¸­ï¼Œç­‰å¾…$k$ä½å‡ºçº³å‘˜ä¸­çš„ä¸€ä½æœ‰ç©ºã€‚åˆ†ææ¯ä½é¡¾å®¢çš„å¹³å‡ç­‰å¾…æ—¶é—´ã€é˜Ÿä¼çš„é•¿åº¦

åˆ†æï¼š
è¯¥æ¨¡æ‹Ÿä¸­åŒ…å«ä¸¤ä¸ªäº‹ä»¶ï¼š*é¡¾å®¢åˆ°è¾¾é“¶è¡Œ*ï¼Œ*é¡¾å®¢ç¦»å¼€é“¶è¡Œï¼ˆä¸€ä½å‡ºçº³å‘˜å› æ­¤å¤„äºç©ºé—²çŠ¶æ€ï¼‰*

æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¦‚ç‡å‡½æ•°äº§ç”Ÿè¾“å…¥æµï¼Œè¯¥è¾“å…¥æµåŒ…å«ä¸€ç»„æœ‰*åˆ°è¾¾æ—¶é—´*å’Œ*æœåŠ¡æ—¶é—´*çš„æœ‰åºå¯¹ï¼ŒæŒ‰åˆ°è¾¾æ—¶é—´æ’åºã€‚æˆ‘ä»¬ä¸é‡‡ç”¨ç²¾ç¡®çš„æ—¶é—´ï¼Œè€Œæ˜¯ä»¥tickä½œä¸ºè®¡æ—¶å•ä½ã€‚å¼€å§‹æ—¶ï¼Œå°†tickåˆå§‹åŒ–ä¸º0ï¼›å½“æ²¡æœ‰é¡¾å®¢è¿›æ¥ä¸”æ‰€æœ‰å‡ºçº³å‘˜éƒ½å¤„äºç©ºé—²çŠ¶æ€æ—¶ï¼Œæ¨¡æ‹Ÿç»“æŸã€‚

å¦‚æœæˆ‘ä»¬é€šè¿‡å¾ªç¯æ¯ä¸ªtickæ¥å¤„ç†æ•´ä¸ªç¨‹åºçš„è¯ï¼Œé‚£ä¹ˆè¿è¡Œæ—¶é—´è·Ÿé¡¾å®¢å’Œæ—¶é—´çš„æ•°é‡æ— å…³ï¼Œè€Œä¸”è¿è¡Œæ•ˆç‡å¾ˆä½ã€‚å› æ­¤æˆ‘ä»¬**æ ¹æ®æœ€è¿‘æ—¶é—´å‘ç”Ÿçš„äº‹ä»¶æ¥å¢åŠ tick**ï¼Œè¿™åˆ†ä¸ºä¸¤ç§æƒ…å†µï¼šä¸‹ä¸€ä½é¡¾å®¢çš„åˆ°æ¥ï¼Œæœ‰ä¸€ä½é¡¾å®¢ç¦»å¼€ã€‚

å¯¹äºæ­£åœ¨æ’é˜Ÿçš„é¡¾å®¢ï¼Œæˆ‘ä»¬ç”¨**é˜Ÿåˆ—**æ¥å­˜å‚¨ï¼›å¯¹äºæ¯ä½é¡¾å®¢ç¦»å¼€æ—¶é—´çš„å­˜å‚¨ï¼Œæˆ‘ä»¬ç”¨**ä¼˜å…ˆé˜Ÿåˆ—**å­˜å‚¨ï¼Œä»¥ä¾¿æˆ‘ä»¬æ‰¾åˆ°æœ€è¿‘å‘ç”Ÿçš„äº‹ä»¶ã€‚æ—¶é—´å¤æ‚åº¦ï¼š$O(C \log(k + 1))$
## d-Heaps
>å¯¹äºè¿™ç§å †ï¼Œæ‰€æœ‰èŠ‚ç‚¹æœ€å¤šæœ‰$d$ä¸ªå­©å­

![](Images/C6/Quicker_20240403_163113.png)
>æ³¨ï¼š$d$å¹¶ä¸æ˜¯è¶Šå¤§è¶Šå¥½ï¼Œç†ç”±â€”â€”
>1. è™½ç„¶`Insert()`é€Ÿåº¦å˜å¿«($O(\log_dN))$)ï¼Œä½†`DeleteMin()`è¦æ‰¾åˆ°æœ€å°çš„å­©å­ï¼Œéœ€è¦$d - 1$æ¬¡æ¯”è¾ƒï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦å°†ä¼šå˜æˆ$O(d \log_d N)$
>2. åœ¨æ‰¾æŸä¸ªèŠ‚ç‚¹çš„å·¦å³å­©å­æˆ–çˆ¶èŠ‚ç‚¹æ—¶ï¼ŒäºŒå‰å †ä¸­çš„$\times 2$æˆ– /2ä»…ä»…æ˜¯ä¸ª**ç§»ä½**æ“ä½œï¼Œä½†d-Heapä¸­çš„$\times d$æˆ– / d åˆ™æ›´åŠ å¤æ‚
>
>ä¼˜åŠ¿ï¼š
>1. å°±å¦‚å‰æ–‡æ‰€è¯´ï¼Œæ’å…¥æ“ä½œå¾€å¾€æ¯”åˆ é™¤æ“ä½œå¤šï¼Œå› æ­¤æˆ‘ä»¬ä»`Insert()`çš„æé€Ÿä¸­è·å¾—çš„å¥½å¤„æ¯”`DeleteMin()`çš„é™é€Ÿå¸¦æ¥çš„å¼Šç«¯æ›´å¤š
>2. å¦‚æœä¼˜å…ˆé˜Ÿåˆ—å¤ªå¤§ï¼Œä»¥è‡³äºä¸»å†…å­˜æ— æ³•å®¹çº³ï¼Œåˆ™d-Heapæ¯”äºŒå‰å †æ›´æœ‰ä¼˜åŠ¿ğŸ˜•
>
>è¡¥å……ï¼šå¯¹äºèŠ‚ç‚¹$i$
>+ çˆ¶èŠ‚ç‚¹ï¼š$\lfloor \dfrac{i + d - 2}{d} \rfloor$
>+ ç¬¬ä¸€ä¸ªå­©å­ï¼š$(i - 1)d + 2$
>+ æœ€åä¸€ä¸ªå­©å­ï¼š$id + 1$